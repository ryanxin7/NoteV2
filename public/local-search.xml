<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>等保2.0项目-日志收集实践</title>
    <link href="/2021/10/19/%E7%AD%89%E4%BF%9D2.0%E9%A1%B9%E7%9B%AE-%E6%97%A5%E5%BF%97%E6%94%B6%E9%9B%86%E5%AE%9E%E8%B7%B5/"/>
    <url>/2021/10/19/%E7%AD%89%E4%BF%9D2.0%E9%A1%B9%E7%9B%AE-%E6%97%A5%E5%BF%97%E6%94%B6%E9%9B%86%E5%AE%9E%E8%B7%B5/</url>
    
    <content type="html"><![CDATA[<p> 在等保2.0 测评单位对业务系统进行评测后，给出整改意见中提出：</p><p>应启用安全审计功能，审计覆盖到每个用户，对重要的用户行为和重要安全事件进行审计；建议对启用安全审计功能，对所有用户操作行为及系统安全事件进行审计记录。</p><p>应对审计记录进行保护，定期备份，避免受到未预期的删除、修改或覆盖等。建议定期对审计记录进行备份，保证审计记录不会受到未预期的删除、修改或覆盖。</p><span id="more"></span><h1 id="搭建ELK平台收集各系统日志"><a href="#搭建ELK平台收集各系统日志" class="headerlink" title="搭建ELK平台收集各系统日志"></a>搭建ELK平台收集各系统日志</h1><h2 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h2><p>要收集的设备清单如下：</p><ul><li>深信服防火墙设备</li><li>H3C 核心交换机</li><li>深信服SSL VPN 设备</li><li>业务通用服务器</li></ul><br><h3 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h3><p>因为日志量不大所以使用四台服务器搭建ELK，部署情况如下：</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-number">192.168.10.106</span>  部署ES + head 插件 用来处理日志数据<br><br><span class="hljs-number">192.168.10.107</span>  部署Logstash 收集filebeat数据并将数据传送给ES <br><br><span class="hljs-number">192.168.10.108</span>  部署Kibana 将数据从ES中读取出进行可视化展示<br><br><span class="hljs-number">192.168.10.109</span>  部署rsyslog + filebeat 收集汇总各系统日志文件并将日志文件传送给logstash<br><br>系统版本为：Ubuntu <span class="hljs-number">20</span>.<span class="hljs-number">04</span>.<span class="hljs-number">3</span> LTS <br>ELK组件版本：<span class="hljs-number">7</span>.<span class="hljs-number">14</span>.x<br></code></pre></td></tr></table></figure><br><h2 id="Rsyslog-部署"><a href="#Rsyslog-部署" class="headerlink" title="Rsyslog 部署"></a>Rsyslog 部署</h2><p>rsyslog用于收集对端系统的日志推送</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#替换源</span><br>vim /etc/apt/sources.list<br>deb http://mirrors.aliyun.com/ubuntu/ focal main restricted universe multiverse<br>deb-src http://mirrors.aliyun.com/ubuntu/ focal main restricted universe multiverse<br><br>deb http://mirrors.aliyun.com/ubuntu/ focal-security main restricted universe multiverse<br>deb-src http://mirrors.aliyun.com/ubuntu/ focal-security main restricted universe multiverse<br><br>deb http://mirrors.aliyun.com/ubuntu/ focal-updates main restricted universe multiverse<br>deb-src http://mirrors.aliyun.com/ubuntu/ focal-updates main restricted universe multiverse<br><br>deb http://mirrors.aliyun.com/ubuntu/ focal-proposed main restricted universe multiverse<br>deb-src http://mirrors.aliyun.com/ubuntu/ focal-proposed main restricted universe multiverse<br><br>deb http://mirrors.aliyun.com/ubuntu/ focal-backports main restricted universe multiverse<br><br>deb-src http://mirrors.aliyun.com/ubuntu/ focal-backports main restricted universe multiverse<br><br><span class="hljs-comment">#安装rsyslog</span><br>sudo apt-get install rsyslog<br><br><span class="hljs-comment">#编辑配置文件</span><br>vim /etc/rsyslog.conf<br><br><span class="hljs-comment">#设置日志收集目录，以主机名+IP+时间的格式 并排除本机的日志</span><br><span class="hljs-variable">$template</span> Remote,<span class="hljs-string">&quot;/var/log/attack-syslog/%hostname%_%fromhost-ip%/log_%<span class="hljs-variable">$YEAR</span>%-%<span class="hljs-variable">$MONTH</span>%-%<span class="hljs-variable">$DAY</span>%.log&quot;</span>   <span class="hljs-comment">#定义模板，接受日志文件路径，区分了不同主机的日志                                   </span><br>:fromhost-ip, !isequal, <span class="hljs-string">&quot;127.0.0.1&quot;</span> ?Remote       <span class="hljs-comment"># 过滤server 本机的日志</span><br><br><span class="hljs-comment">#开启udp tcp 传输</span><br><span class="hljs-variable">$ModLoad</span> imudp<br><span class="hljs-variable">$UDPServerRun</span> 514<br> <br><span class="hljs-variable">$ModLoad</span> imtcp<br><span class="hljs-variable">$InputTCPServerRun</span> 514<br><br><span class="hljs-comment">#然后,以root身份修改rsyslog启动配置文件(Ubuntu在/etc/default/rsyslog下)</span><br><span class="hljs-comment"># Options to syslogd</span><br><span class="hljs-comment"># -m 0 disables &#x27;MARK&#x27; messages.</span><br><span class="hljs-comment"># -r enables logging from remote machines</span><br><span class="hljs-comment"># -x disables DNS lookups on messages recieved with -r //禁用掉dns记录项不够齐全或其他的日志中心的日志</span><br><br><span class="hljs-comment"># See syslogd(8) for more details</span><br><span class="hljs-comment"># </span><br>SYSLOGD_OPTIONS=<span class="hljs-string">&quot;-r&quot;</span> <br><span class="hljs-comment">#SYSLOGD_OPTIONS=&quot;-r -x -m 180&quot; </span><br><span class="hljs-comment"># 加 -r 选项以允许接受外来日志消息</span><br><span class="hljs-comment"># 加 -x 禁用掉dns记录项不够齐全或其他的日志中心的日志# </span><br><span class="hljs-comment"># 加 -m 修改syslog的内部mark消息写入间隔时间（0为关闭）。例如-m 180，表示每隔180分钟（每天8次）在日志文件里增加一行时间戳消息</span><br><span class="hljs-comment"># 加 -h 默认情况下，syslog不会发送从远端接受过来的消息到其他主机，而使用该选项，则把该开关打开，所有接受到的信息都可根据syslog.conf中定义的@主机转发过去。</span><br><span class="hljs-comment"># Options to klogd</span><br><span class="hljs-comment"># -2 prints all kernel oops messages twice; once for klogd to decode, and</span><br><span class="hljs-comment">#    once for processing with &#x27;ksymoops&#x27;</span><br><span class="hljs-comment"># -x disables all klogd processing of oops messages entirely</span><br><span class="hljs-comment"># See klogd(8) for more detailsKLOGD_OPTIONS=&quot;-x&quot;</span><br><span class="hljs-comment">#SYSLOG_UMASK=077# set this to a umask value to use for all log files as in umask(1).</span><br><span class="hljs-comment"># By default, all permissions are removed for &quot;group&quot; and &quot;other&quot;. </span><br><br><span class="hljs-comment">#重启rsyslog</span><br>service rsyslog restart<br><br><span class="hljs-comment">#查看其是否启动</span><br>netstat -nultp | grep 514<br><br><span class="hljs-comment">#验证</span><br><span class="hljs-comment">#在rsyslog server端,用tail动态查看</span><br>tail -f /var/<span class="hljs-built_in">log</span>/host/<span class="hljs-string">&#x27;hostname&#x27;</span>_<span class="hljs-string">&#x27;ip&#x27;</span>/log_<span class="hljs-string">&#x27;y&#x27;</span>_<span class="hljs-string">&#x27;m&#x27;</span>_<span class="hljs-string">&#x27;d&#x27;</span>.<span class="hljs-built_in">log</span><br></code></pre></td></tr></table></figure><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linux/elks/rsyslog.png" alt="rsyslog"></p><br><h3 id="对端深信服防火墙配置"><a href="#对端深信服防火墙配置" class="headerlink" title="对端深信服防火墙配置"></a>对端深信服防火墙配置</h3><p><code>版本号：AF 8.0.45</code></p><p>在监控—&gt; 日志—&gt;设置 中开启行为审计日志选项，配置对端syslog服务器地址和端口号。</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linux/elks/image-20211119143240455.png" alt="image-20211119143240455"></p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linux/elks/image-20211119142929809.png" alt="image-20211119142929809"></p><br><h3 id="对端深信服SSL-VPN配置"><a href="#对端深信服SSL-VPN配置" class="headerlink" title="对端深信服SSL VPN配置"></a>对端深信服SSL VPN配置</h3><p><code>版本号： SSL 7.6.9R1</code></p><p>在系统设置—&gt; 系统配置—&gt; 数据中心中启用Syslog 设置添加对端服务器地址</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linux/elks/image-20211119143328696.png" alt="image-20211119143328696"></p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linux/elks/image-20211119143710182.png" alt="image-20211119143710182"></p><p>点击测试连通性测试对端服务器连接状况</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linux/elks/image-20211119143907307.png" alt="image-20211119143907307"></p><p>设置日志输出类型，注意根据实际需求选择相应日志等级，避免不必要的资源浪费。</p><h3 id="对端H3C核心交换机配置"><a href="#对端H3C核心交换机配置" class="headerlink" title="对端H3C核心交换机配置"></a>对端H3C核心交换机配置</h3><p><code>设备型号：H3C S7503E-M </code></p><p><a href="https://www.h3c.com/cn/d_202109/1466386_30005_0.htm">详情见交换机配置手册-15-信息中心配置-新华三集团-H3C</a></p><figure class="highlight tcl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs tcl">[Intranet-CSW-S7503E]<span class="hljs-keyword">info</span>-center enable <br><span class="hljs-comment">#开启信息中心</span><br>[Intranet-CSW-S7503E]<span class="hljs-keyword">info</span>-center loghost <span class="hljs-number">192.168</span><span class="hljs-number">.10</span><span class="hljs-number">.109</span> port <span class="hljs-number">514</span> facility <br>local5<br><span class="hljs-comment">#配置发送日志信息到IP地址为192.168.10.109端口为514的日志主机，日志主机记录工具为local5。</span><br>[Intranet-CSW-S7503E]<span class="hljs-keyword">info</span>-center <span class="hljs-keyword">source</span> default loghost deny<br><span class="hljs-comment"># 关闭loghost方向所有模块日志信息的输出开关。</span><br>[Intranet-CSW-S7503E]<span class="hljs-keyword">info</span>-center <span class="hljs-keyword">source</span> ftp loghost level notification<br><span class="hljs-comment"># 配置输出规则：允许FTP模块的、等级高于等于notification的日志信息输出到日志主机（注意：允许输出信息的模块由产品决定）。</span><br></code></pre></td></tr></table></figure><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linux/elks/image-20211119144942011.png" alt="image-20211119144942011"></p><p>由于系统对各方向允许输出的日志信息的缺省情况不一样，所以配置前必须将所有模块的需求方向（本例为loghost）上日志信息的输出开关关闭，再根据当前的需求配置输出规则，以免输出太多不需要的信息。</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linux/elks/image-20211119150315381.png" alt="image-20211119150315381"></p><br><p>完成对端设备日志的推送设置后，相关日志保存在109本地服务器对应目录下的。</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linux/elks/image-20211119151217426.png" alt="image-20211119151217426"></p><p>可见 防火墙日志中记录了之前在服务器中指定收集的日志类型</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linux/elks/image-20211119151333025.png" alt="image-20211119151333025"></p><p>至此rsyslog收集工作结束</p><h2 id="Filebeat-组件配置"><a href="#Filebeat-组件配置" class="headerlink" title="Filebeat 组件配置"></a>Filebeat 组件配置</h2><p><strong>环境变量配置</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">vim /etc/profile.d/filebeat.sh<br><span class="hljs-comment">#/bin/bash</span><br><span class="hljs-built_in">export</span> PATH=/usr/share/filebeat/bin:<span class="hljs-variable">$PATH</span><br></code></pre></td></tr></table></figure><p>经过配置rsyslog服务，已经收集到了各业务系统的日志文件，下一步工作就是收集到的文件通过ELK中的Filebeat组件对日志进行初步加工。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-comment">#编辑配置文件</span><br><span class="hljs-string">vim</span> <span class="hljs-string">/etc/filebeat/filebeat.yml</span><br><br><br><span class="hljs-comment">#filebeat inputs 部分 设置日志的所在目录位置</span><br><span class="hljs-comment">#一定要注意格式 特别是插件前后顺序和-的位置。</span><br><span class="hljs-comment">#经过实践踩坑大部分问题都是因为格式导致的。 </span><br><br><span class="hljs-attr">filebeat.inputs:</span><br><br><span class="hljs-bullet">-</span> <span class="hljs-attr">type:</span> <span class="hljs-string">log</span><br><br>  <span class="hljs-comment"># Change to true to enable this input configuration.</span><br>  <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span><br><br>  <span class="hljs-comment"># Paths that should be crawled and fetched. Glob based paths.</span><br>  <span class="hljs-attr">paths:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">/var/log/attack-syslog/localhost_10.123.0.2/*.log</span><br>  <span class="hljs-attr">fields:</span><br>   <span class="hljs-attr">logtype1:</span> <span class="hljs-string">&quot;sangfor-af&quot;</span><br>    <span class="hljs-comment">#- c:\programdata\elasticsearch\logs\*</span><br><br><span class="hljs-bullet">-</span> <span class="hljs-attr">type:</span> <span class="hljs-string">log</span><br>  <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span><br>  <span class="hljs-attr">paths:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">/var/log/attack-syslog/sslvpn_10.123.0.27/*.log</span><br>  <span class="hljs-attr">fields:</span><br>   <span class="hljs-attr">logtype1:</span> <span class="hljs-string">&quot;sangfor-sslvpn&quot;</span><br><br><span class="hljs-bullet">-</span> <span class="hljs-attr">type:</span> <span class="hljs-string">log</span><br>  <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span><br>  <span class="hljs-attr">paths:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">/var/log/attack-syslog/sslvpn_10.123.0.28/*.log</span><br>  <span class="hljs-attr">fields:</span><br>   <span class="hljs-attr">logtype1:</span> <span class="hljs-string">&quot;sangfor-sslvpn&quot;</span><br><br><span class="hljs-bullet">-</span> <span class="hljs-attr">type:</span> <span class="hljs-string">log</span><br>  <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span><br>  <span class="hljs-attr">paths:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">/var/log/attack-syslog/2021_192.168.10.254/*.log</span><br>  <span class="hljs-attr">fields:</span><br>   <span class="hljs-attr">logtype1:</span> <span class="hljs-string">&quot;hc-nwhx&quot;</span><br><br><span class="hljs-comment">#抓取数据并对日志进行打标签，后续通过标签建立独自的索引</span><br><br><br><br><span class="hljs-comment">#Outputs部分</span><br><span class="hljs-comment">#注释 Elasticsearch Output 配置Logstash Output</span><br><span class="hljs-attr">output.logstash:</span><br>  <span class="hljs-comment"># The Logstash hosts</span><br>  <span class="hljs-attr">hosts:</span> [<span class="hljs-string">&quot;192.168.10.107:5044&quot;</span>]<br><br><span class="hljs-comment">#可选项</span><br>  <span class="hljs-comment"># Optional SSL. By default is off.</span><br>  <span class="hljs-comment"># List of root certificates for HTTPS server verifications</span><br>  <span class="hljs-comment">#ssl.certificate_authorities: [&quot;/etc/pki/root/ca.pem&quot;]</span><br><br>  <span class="hljs-comment"># Certificate for SSL client authentication</span><br>  <span class="hljs-comment">#ssl.certificate: &quot;/etc/pki/client/cert.pem&quot;</span><br><br>  <span class="hljs-comment"># Client Certificate Key</span><br>  <span class="hljs-comment">#ssl.key: &quot;/etc/pki/client/cert.key&quot;</span><br>  <br>  <span class="hljs-comment">#启动</span><br>  <span class="hljs-string">systemctl</span> <span class="hljs-string">start</span> <span class="hljs-string">filebeat</span><br></code></pre></td></tr></table></figure><br><h3 id="Filebeat-组件排错方法"><a href="#Filebeat-组件排错方法" class="headerlink" title="Filebeat 组件排错方法"></a>Filebeat 组件排错方法</h3><p>   在发生错误时，服务仍在运行状态时使用<code>systemctl status filebeat</code> 能看到的错误信息很少，通过前端手动指定运行日志的方式更易于问题的定位。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">filebeat -c /etc/filebeat/filebeat.yml -path.home /usr/share/filebeat -path.config /etc/filebeat -path.data /var/lib/filebeat -path.logs /var/<span class="hljs-built_in">log</span>/filebeat<br></code></pre></td></tr></table></figure><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linux/elks/image-20211119155142314.png" alt="image-20211119155142314"></p><br><h3 id="Logstash-组件配置"><a href="#Logstash-组件配置" class="headerlink" title="Logstash 组件配置"></a>Logstash 组件配置</h3><p><strong>环境变量定制</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;export PATH=/usr/share/logstash/bin:$PATH&#x27;</span> &gt; /etc/profile.d/logstash.sh<br><span class="hljs-built_in">source</span> /etc/profile.d/logstash.sh<br></code></pre></td></tr></table></figure><p><strong>生成配置文件</strong></p><p>以命令行的方式来进行启动太繁琐，我们最好还是以配置文件的方式来进行服务的启动管理，对于 logstash来说，它提供好了一个专门用于生成配置文件的命令 system-install，我们只需要按照既定的 配置文件规则，定制应用配置，最后执行该命令，即可实现服务脚本的配置。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#进入应用目录</span><br><span class="hljs-built_in">cd</span> /etc/logstash<br><span class="hljs-comment">#编辑启动参数文件</span><br><span class="hljs-comment"># vim startup.options</span><br>...<br><span class="hljs-comment"># Arguments to pass to logstash</span><br>LS_OPTS=<span class="hljs-string">&quot;--path.settings <span class="hljs-variable">$&#123;LS_SETTINGS_DIR&#125;</span> -f /etc/logstash/conf.d&quot;</span><br> <span class="hljs-comment">#注意： -f 指定的是 logstash的应用配置文件(比如 logstash.conf)存放到的目录</span><br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">以root用户执行下面的命令</span><br>system-install<br><span class="hljs-meta">#</span><span class="bash">查看生成的服务配置文件</span><br><span class="hljs-meta">#</span><span class="bash"> ls /etc/systemd/system/logstash.service</span><br>/etc/systemd/system/logstash.service<br><span class="hljs-meta">#</span><span class="bash">查看服务配置文件内容</span><br><span class="hljs-meta">#</span><span class="bash"> cat /etc/systemd/system/logstash.service</span><br>[Unit]<br>Description=logstash<br>[Service]<br>Type=simple<br>User=logstash<br>Group=logstash<br><span class="hljs-meta">#</span><span class="bash"> Load env vars from /etc/default/ and /etc/sysconfig/ <span class="hljs-keyword">if</span> they exist.</span><br><span class="hljs-meta">#</span><span class="bash"> Prefixing the path with <span class="hljs-string">&#x27;-&#x27;</span> makes it try to load, but <span class="hljs-keyword">if</span> the file doesn<span class="hljs-string">&#x27;t</span></span><br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-string"> exist, it continues onward.</span></span><br>EnvironmentFile=-/etc/default/logstash<br>EnvironmentFile=-/etc/sysconfig/logstash<br>ExecStart=/usr/share/logstash/bin/logstash &quot;--path.settings&quot; &quot;/etc/logstash&quot; &quot;-<br>f&quot; &quot;/etc/logstash/conf.d&quot;<br>Restart=always<br>WorkingDirectory=/<br>Nice=19<br>LimitNOFILE=16384<br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-string"> When stopping, how long to wait before giving up and sending SIGKILL?</span></span><br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-string"> Keep in mind that SIGKILL on a process can cause data loss.</span></span><br>TimeoutStopSec=infinity<br>[Install]<br>WantedBy=multi-user.target<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-string">注意：</span></span><br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-string"> 由于服务启动的时候，用户名和用户组都是 logstash ，所以，我们采集数据的文件必须是具备查看的</span></span><br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-string">权限</span></span><br></code></pre></td></tr></table></figure><p>日志在经过filebeat组件的初步改造，将各系统收集到的日志打上了type类型，Logstash根据类型创建不同的索引文件。这里通过grok插件对日志进行了字段自定义改造。以便后续在kibana中更好的绘图展示。<a href="">详情见 grok插件用法</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs bash">vim /etc/logstash/conf.d/logstash.conf<br><br><span class="hljs-comment">#input 部分 </span><br><span class="hljs-comment">#读取filebeat主机推送到5044端口的数据</span><br><br>input &#123;<br>beats &#123;<br>port =&gt; 5044<br>&#125;<br>&#125;<br><br>filter &#123;<br>    grok &#123;<br>        match =&gt; &#123;<br>            <span class="hljs-string">&quot;message&quot;</span> =&gt; <span class="hljs-string">&quot;%&#123;TIMESTAMP_ISO8601:times&#125; %&#123;HOSTNAME:hosts&#125; %&#123;USERNAME:logtype&#125;: message repeated %&#123;INT:repetition_times&#125; times: \[ 日志类型:(?&lt;Operation_type&gt;(?&lt;=)(.&#123;4&#125;)), (?&lt;Operation_typ1e&gt;(?&lt;=)(.&#123;2&#125;)):%&#123;USER:user&#125;\(%&#123;HOSTNAME:connection_method&#125;\)\(%&#123;HOSTNAME:connection_method&#125;\), IP地址:%&#123;IPV4:connection_ip&#125;, 操作对象:%&#123;GREEDYDATA:Action_log&#125;, 操作类型:(?&lt;behaviour_t&gt;(?&lt;=)(.&#123;4&#125;)), 描述:(?&lt;Behavior_performance&gt;(?&lt;=)(.&#123;4&#125;))\]&quot;</span><br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">#output 部分</span><br><br><br><span class="hljs-comment">#注意if后需要加 [fields]并添加之前filebeat中定制的字段[logtype1]，经测试直接加logtype1不好使。</span><br>output &#123;<br><span class="hljs-keyword">if</span> [fields][logtype1] == <span class="hljs-string">&quot;sangfor-af&quot;</span> &#123;<br>elasticsearch &#123;<br>hosts =&gt; [<span class="hljs-string">&quot;http://localhost:9200&quot;</span>]<br>index =&gt; <span class="hljs-string">&quot;sangfor-af01-%&#123;+YYYY.MM.dd&#125;&quot;</span><br>&#125;<br>&#125;<br><br><span class="hljs-keyword">if</span> [fields][logtype1] == <span class="hljs-string">&quot;hc-nwhx&quot;</span> &#123;<br>elasticsearch &#123;<br>hosts =&gt; [<span class="hljs-string">&quot;http://localhost:9200&quot;</span>]<br>index =&gt; <span class="hljs-string">&quot;hc-nwhx-%&#123;+YYYY.MM.dd&#125;&quot;</span><br>&#125;<br>&#125;<br><br><span class="hljs-keyword">if</span> [fields][logtype1] == <span class="hljs-string">&quot;sangfor-sslvpn&quot;</span> &#123;<br>elasticsearch &#123;<br>hosts =&gt; [<span class="hljs-string">&quot;http://localhost:9200&quot;</span>]<br>index =&gt; <span class="hljs-string">&quot;sangfor-sslvpn-%&#123;+YYYY.MM.dd&#125;&quot;</span><br>&#125;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><br><p><strong>启动服务</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs shell">重载服务<br>systemctl daemon-reload<br>启动服务<br>systemctl start logstash.service<br>systemctl status logstash.service<br>查看效果<br><span class="hljs-meta">#</span><span class="bash"> netstat -tnulp | egrep <span class="hljs-string">&#x27;Add|java&#x27;</span></span><br>Proto Recv-Q Send-Q Local Address     Foreign Address   State       PID/Program <br>name  <br>tcp6       0     0 127.0.0.1:9600   :::*               LISTEN     88794/java <br>       <br>tcp6       0     0 :::9200           :::*               LISTEN     87210/java <br>       <br>tcp6       0     0 :::9300           :::*               LISTEN     87210/java<br><br>结果显示：<br> logstash的默认端口是 9600 <br><br></code></pre></td></tr></table></figure><h3 id="logstash-排错"><a href="#logstash-排错" class="headerlink" title="logstash 排错"></a>logstash 排错</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#查看日志：</span><br>tail -f /var/<span class="hljs-built_in">log</span>/logstash/logstash-plain.log<br> <br><span class="hljs-comment">#可以看到默认报错：</span><br> [2021-08-15T18:44:08,643][WARN ]<br>[filewatch.tailmode.handlers.createinitial][main]<br>[cc34021140e2525e95d5755b6135b9801f3595239bcda82a1cca03a1d0f857d6] failed to <br>open file &#123;:path=&gt;<span class="hljs-string">&quot;/var/log/syslog&quot;</span>, :exception=&gt;Errno::EACCES, <br>:message=&gt;<span class="hljs-string">&quot;Permission denied - /var/log/syslog&quot;</span>&#125;<br> <br> <br><span class="hljs-comment">#临时增加一个 logstash 允许访问的权限</span><br>chown logstash.logstash /var/<span class="hljs-built_in">log</span>/syslog<br></code></pre></td></tr></table></figure><p><strong>通过head插件查看数据传递效果</strong></p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linux/elks/image-20211119161952112.png" alt="image-20211119161952112"></p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linux/elks/image-20211119162040416.png" alt="SSL VPN日志索引"></p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linux/elks/image-20211119162131164.png" alt="防火墙日志索引"></p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linux/elks/image-20211119162152721.png" alt="交换机日志索引"></p>]]></content>
    
    
    <categories>
      
      <category>ElasticStack</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Ubuntu</tag>
      
      <tag>运维实战</tag>
      
      <tag>日志收集</tag>
      
      <tag>等保2.0</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ELK-beats</title>
    <link href="/2021/10/06/elk-Filebeat/"/>
    <url>/2021/10/06/elk-Filebeat/</url>
    
    <content type="html"><![CDATA[<p><strong>轻量型数据采集器</strong> Beats 是一个免费且开放的平台，集合了多种单一用途数据采集器。它们从成百上千或成千上万台机器和系统向 Logstash 或 Elasticsearch 发送数据。Beats 是数据采集的得力工具。将 Beats 和您的容器一起置于服务器上，或者将 Beats 作为功能加以部署，然后便可在 Elasticsearch 中集中处理数据。Beats 能够采集符合 <a href="https://www.elastic.co/guide/en/ecs/current/index.html">Elastic Common Schema (ECS)</a> 要求的数据，如果您希望拥有更加强大的处理能力，Beats 能够将数据转发至 Logstash 进行转换和解析。</p><span id="more"></span><h2 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h2><h3 id="功能简介"><a href="#功能简介" class="headerlink" title="功能简介"></a>功能简介</h3><p>根据我们对ELK的经典架构的了解，他的数据收集和处理流程是：beats - logstash -<br>elasticsearch - kibana。Beats 默认提供了很多中场景的组件，最常见的就是FileBeat</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linux/elks/image-20211116143335268.png" alt="image-20211116143335268"></p><br><p><strong>运行环境</strong></p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">安装<span class="hljs-keyword">java8环境</span><br><span class="hljs-keyword"></span>apt <span class="hljs-keyword">install </span>openjdk<span class="hljs-number">-8</span>-<span class="hljs-keyword">jdk</span><br><span class="hljs-keyword"></span>检查效果<br><span class="hljs-keyword">java </span>-version<br></code></pre></td></tr></table></figure><br><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linux/elks/beats.jpg" alt="beats"></p><br><h3 id="软件安装"><a href="#软件安装" class="headerlink" title="软件安装"></a><strong>软件安装</strong></h3><p><strong>apt源码方式</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs shell">获取软件源<br>wget -qO - https://artifacts.elastic.co/GPG-KEY-elasticsearch | sudo apt-key add<br>-<br>apt install apt-transport-https<br>echo &quot;deb https://artifacts.elastic.co/packages/7.x/apt stable main&quot; | sudo tee<br>–a /etc/apt/sources.list.d/elastic-7.x.list<br>apt update<br>安装软件<br>apt install filebeat<br></code></pre></td></tr></table></figure><br><p><strong>软件包安装</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sh">wget https://artifacts.elastic.co/downloads/beats/filebeat/filebeat-7.14.0-<br>amd64.deb<br>wget https://artifacts.elastic.co/downloads/beats/filebeat/filebeat-7.14.0-<br>amd64.deb.sha512<br>shasum -a 512 -c filebeat-7.14.0-amd64.deb.sha512<br>dpkg -i filebeat-7.14.0-amd64.deb<br></code></pre></td></tr></table></figure><br><p><strong>配置查看</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs bash">查看配置文件<br><span class="hljs-comment"># dpkg -L filebeat</span><br>/.<br>/etc<br>/etc/init.d<br>/etc/init.d/filebeat<br>/etc/filebeat<br>/etc/filebeat/filebeat.yml 核心配置文件<br>...<br>/etc/filebeat/filebeat.reference.yml<br>/etc/filebeat/fields.yml<br>...<br>/usr/share/filebeat/bin<br>/usr/share/filebeat/bin/filebeat<br>/usr/share/filebeat/bin/filebeat-god<br>/usr/share/doc<br>/usr/share/doc/filebeat<br>/usr/share/doc/filebeat/changelog.gz<br>/usr/bin<br>/usr/bin/filebeat<br>/lib<br>/lib/systemd<br>/lib/systemd/system<br>/lib/systemd/system/filebeat.service 服务启动文件<br></code></pre></td></tr></table></figure><p><strong>查看配置文件</strong></p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs basic"># grep -Env <span class="hljs-comment">&#x27;#|^$&#x27; /etc/filebeat/filebeat.yml</span><br><span class="hljs-number">15</span>:filebeat.inputs: 数据的采集<br><span class="hljs-number">21</span>:- type: <span class="hljs-keyword">log</span><br><span class="hljs-number">24</span>: enabled: false 默认该功能没有开启<br><span class="hljs-number">27</span>: paths:<br><span class="hljs-number">28</span>: - /var/<span class="hljs-keyword">log</span>/*.<span class="hljs-keyword">log</span><br><span class="hljs-number">66</span>:- type: filestream<br><span class="hljs-number">69</span>: enabled: false<br><span class="hljs-number">72</span>: paths:<br><span class="hljs-number">73</span>: - /var/<span class="hljs-keyword">log</span>/*.<span class="hljs-keyword">log</span><br><span class="hljs-number">96</span>:filebeat.config.modules:<br><span class="hljs-number">98</span>: path: $&#123;path.config&#125;/modules.d/*.yml<br><span class="hljs-number">101</span>: reload.enabled: false<br><span class="hljs-number">108</span>:setup.template.settings:<br><span class="hljs-number">109</span>: index.number_of_shards: <span class="hljs-number">1</span> 默认的数据分片个数是 <span class="hljs-number">1</span><br><span class="hljs-number">145</span>:setup.kibana:<br><span class="hljs-number">176</span>:output.elasticsearch: 数据的输出<br><span class="hljs-number">178</span>: hosts: [<span class="hljs-string">&quot;localhost:9200&quot;</span>]<br><span class="hljs-number">204</span>:processors:<br><span class="hljs-number">205</span>: - add_host_metadata:<br><span class="hljs-number">206</span>: when.<span class="hljs-keyword">not</span>.contains.tags: forwarded<br><span class="hljs-number">207</span>: - add_cloud_metadata: ~<br><span class="hljs-number">208</span>: - add_docker_metadata: ~<br><span class="hljs-number">209</span>: - add_kubernetes_metadata: ~<br><br>结果显示：<br>filebeat.yml 这就是filebeat的配置文件，里面有<span class="hljs-number">12</span>部分的配置，而我们重点关心的就<br>是<span class="hljs-string">&quot;Filebeat inputs&quot;</span> 和 <span class="hljs-string">&quot;Outputs&quot;</span>,<br></code></pre></td></tr></table></figure><br><p><strong>定制环境变量</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;export PATH=/usr/share/kibana/bin:$PATH&#x27;</span> &gt; /etc/profile.d/kibana.sh<br><span class="hljs-built_in">source</span> /etc/profile.d/kibana.sh<br></code></pre></td></tr></table></figure><br><h3 id="简单实践"><a href="#简单实践" class="headerlink" title="简单实践"></a>简单实践</h3><p>定制配置文件</p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs basic">备份配置文件<br>cd /etc/filebeat/<br>cp filebeat.yml filebeat.yml-bak<br>定制配置文件<br>filebeat.inputs:<br>- type: <span class="hljs-keyword">log</span><br>paths:<br>- /var/<span class="hljs-keyword">log</span>/syslog<br>setup.template.settings:<br>index.number_of_shards: <span class="hljs-number">5</span><br>output.elasticsearch:<br>hosts: [<span class="hljs-string">&quot;192.168.8.12:9200&quot;</span>]<br>template.<span class="hljs-keyword">name</span>: <span class="hljs-string">&quot;filebeat&quot;</span><br>属性解析：<br>enabled: true 表示启用这条配置<br>template.<span class="hljs-keyword">name</span> 在将数据传入到elasticsearch的时候，自动添加一个索引，名称是filebeat<br></code></pre></td></tr></table></figure><br><p><strong>启动服务</strong></p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs basic">启动服务<br>systemctl start filebeat.service<br>systemctl status filebeat.service<br><br>查看效果<br># curl <span class="hljs-number">192.168</span>.<span class="hljs-number">8.12</span>:<span class="hljs-number">9200</span>/_cat/indices<br>green <span class="hljs-keyword">open</span> filebeat-<span class="hljs-number">7.14</span>.<span class="hljs-number">0</span>-<span class="hljs-number">2021.08</span>.<span class="hljs-number">15</span>-<span class="hljs-number">000001</span> yTq8KQtGSpOyGohS4kcLhQ <span class="hljs-number">5</span> <span class="hljs-number">1</span> <span class="hljs-number">730</span> <span class="hljs-number">0</span><br><span class="hljs-number">348.5</span>kb <span class="hljs-number">587</span>b<br><br>结果显示：<br>在elasticsearch中多了好几条索引数据<br>索引命名格式：<span class="hljs-string">&quot;自定义索引名-版本号-日期-6位编号&quot;</span><br></code></pre></td></tr></table></figure><br><hr><p><strong>小结：</strong></p><ul><li>核心的配置<pre><code>inputoutputmoduleselasticsearch....</code></pre></li><li>实践<pre><code>只获取指定文件内部包含 404 的文件内容输出的时候，设定索引名称</code></pre></li><li>要点<pre><code>如果需要filebeat 定制es的索引名称的话，需要自己设定模板</code></pre></li></ul>]]></content>
    
    
    <categories>
      
      <category>ElasticStack</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Ubuntu</tag>
      
      <tag>运维实战</tag>
      
      <tag>日志收集</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ELK-experiment</title>
    <link href="/2021/10/06/elk-experiment/"/>
    <url>/2021/10/06/elk-experiment/</url>
    
    <content type="html"><![CDATA[<h1 id="ELK-综合实践"><a href="#ELK-综合实践" class="headerlink" title="ELK 综合实践"></a>ELK 综合实践</h1><h2 id="实践案例"><a href="#实践案例" class="headerlink" title="实践案例"></a>实践案例</h2><p>项目实现效果图</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linux/elks/image-20211116154018274.png" alt="image-20211116154018274"></p><br><h3 id="需求简介"><a href="#需求简介" class="headerlink" title="需求简介"></a>需求简介</h3><p> 在我们的项目中，日志信息会输出到定制的目录里面了，那么接下来，我们就以nignx的日志数据为对象，使用filebeat来获取这些日志，将其输入到logstash中，logstash接收到数据后，定制显示格式，将其输入到elasticsearch中，kibana从elasticsearch中获取数据，并展示到当前界面。</p><br><h3 id="流程分析"><a href="#流程分析" class="headerlink" title="流程分析"></a>流程分析</h3><ol><li>确定nginx的日志文件 </li><li>filebeat 读取本机的nginx日志，并传输到 logstash </li><li>logstash 接收到数据后，定制输出格式，将数据转交给 elasticsearch </li><li>kibana 根据定制的索引名称，从 elasticsearch中获取数据。</li></ol><br><p><strong>关键点分析</strong></p><p><strong>准备工作</strong>：</p><ul><li><p> nginx 日志文件径在<code>/var/log/nginx/access.log</code>，我们来获取.log格式文件数据</p></li><li><p>filebeat数据收集 </p><p>   基于默认的 input 方式确定数据文件，output 方式选择 logstash <br></p><p>   注意： input 内部的 nabled 必须开启<br></p></li><li><p>logstash传输 </p><p>  基于 input 属性获取 filebeat 的内容，基于output属性将数据发送给es </p></li><li><p>kibana展示 </p><p>  基于索引名称到 elasticsearch 获取数据，然后在discover中确认数据</p></li></ul><br><p><strong>实践步骤</strong></p><ol><li>环境还原 清空filebeat程序 关闭kibana程序 清空elasticsearch索引 </li><li>定制filebeat  编写配置文件 启动filebeat </li><li>定制logstash  定制logstash文件 启动logstash </li><li>定制kibana 配置查询索引 验证效果</li></ol><br><h3 id="项目实践"><a href="#项目实践" class="headerlink" title="项目实践"></a>项目实践</h3><p>环境还原</p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs basic">清除所有的index<br><br><span class="hljs-keyword">for</span> index in $(curl -s http://<span class="hljs-number">192.168</span>.<span class="hljs-number">8.12</span>:<span class="hljs-number">9200</span>/_cat/indices | awk <span class="hljs-comment">&#x27;&#123;print </span><br>$<span class="hljs-number">3</span>&#125;<span class="hljs-comment">&#x27;)</span><br>do<br>curl -XDELETE <span class="hljs-number">192.168</span>.<span class="hljs-number">8.12</span>:<span class="hljs-number">9200</span>/$index<br>done<br><br>filebeat主机安装nginx<br>apt install -y nginx<br><br>关闭所有服务<br>systemctl <span class="hljs-keyword">stop</span> logstash<br>systemctl <span class="hljs-keyword">stop</span> filebeat<br>systemctl <span class="hljs-keyword">stop</span> kibana<br></code></pre></td></tr></table></figure><br><p><strong>编写 filebeat 配置文件</strong></p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs basic">定制配置文件<br># cd /etc/filebeat/<br># cat filebeat.yaml <br>filebeat.inputs:<br>- type: <span class="hljs-keyword">log</span><br> paths:<br>   - /var/<span class="hljs-keyword">log</span>/nginx/*.<span class="hljs-keyword">log</span><br>output.logstash:<br> hosts: [<span class="hljs-string">&quot;192.168.8.13:5044&quot;</span>]<br>启动filebeat<br>systemctl start filebeat<br></code></pre></td></tr></table></figure><br><p><strong>编写 logstash 配置文件</strong></p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs basic"># cd /etc/logstash/conf.d<br># vim logstash.conf<br><span class="hljs-keyword">input</span> &#123;<br> beats &#123;<br>   port =&gt; <span class="hljs-number">5044</span><br> &#125;<br>&#125;<br>output&#123;<br> elasticsearch &#123;<br>   hosts =&gt; [<span class="hljs-string">&quot;192.168.8.12:9200&quot;</span>]<br>   index =&gt; <span class="hljs-string">&quot;nginx-%&#123;+YYYY.MM.dd&#125;&quot;</span><br> &#125;<br>&#125;<br>重启logstash<br>systemctl start logstash<br>检查效果<br>curl <span class="hljs-number">192.168</span>.<span class="hljs-number">8.12</span>:<span class="hljs-number">9200</span>/_cat/indices <br>查看日志<br>tail -f /var/<span class="hljs-keyword">log</span>/logstash/logstash-plain.<span class="hljs-keyword">log</span><br></code></pre></td></tr></table></figure><br><p><strong>启动 kibana</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">systemctl start kibana<br>netstat -tnulp<br></code></pre></td></tr></table></figure><br><p>浏览器登录到 192.168.8.14:5601，点击左上角的logo图标，进入到home页面</p><br><p>通过以下方式进入：</p><ol><li> 选择 左边栏的 Stack Management  </li><li>点击 kibana 栏的 索引模式</li></ol><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linux/elks/image-20211116155122354.png" alt="image-20211116155122354"></p><p><strong>点击 创建索引模式</strong> </p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linux/elks/image-20211116155136008.png" alt="image-20211116155136008"></p><p>在索引模式中，输入正则表达式，看是否能够匹配现有的日志，匹配到的话，点击下一步</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linux/elks/image-20211116155146517.png" alt="image-20211116155146517"></p><p>时间字段选择 默认的 @timestamp 字段，然后点击右下角的 创建索引模式</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linux/elks/image-20211116155156697.png" alt="image-20211116155156697"></p><p>我们收集到的数据中，包含58个字段，当我们点击某些属性的时候，还会显示简单的排序，到此为止，我们的kibana从elasticsearch中获取数据就配置完毕了</p><p>点击左边栏的第一个”Discover”按钮,点击”Add ﬁlter”的下拉框，选择nginx-*索引名，在”Refresh”右侧选择日志的时间范围，就可以实时的查看到说有数据的获取效果</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linux/elks/image-20211116155212628.png" alt="image-20211116155212628"></p><br><p><strong>界面解析</strong></p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linux/elks/image-20211116155244331.png" alt="image-20211116155244331"></p><p>Filters 部分的规则，其实就是日志中的键名是否包含某些关键信息，等同于 KQL的示例 message is 200。</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linux/elks/image-20211116155305504.png" alt="image-20211116155305504"></p><p>点开每条记录旁边的”&gt;”表示查看该条日志的具体信息</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linux/elks/image-20211116155312321.png" alt="image-20211116155312321"></p>]]></content>
    
    
    <categories>
      
      <category>ElasticStack</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Ubuntu</tag>
      
      <tag>运维实战</tag>
      
      <tag>日志收集</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ELK-Kibana</title>
    <link href="/2021/10/05/elk-Kibana/"/>
    <url>/2021/10/05/elk-Kibana/</url>
    
    <content type="html"><![CDATA[<p><strong>一张图片胜过千万行日志</strong>，Kibana 让您能够自由地选择如何呈现自己的数据。Kibana 是一个免费且开放的用户界面，能够让您对 Elasticsearch 数据进行可视化，并让您在 Elastic Stack 中进行导航。您可以进行各种操作，从跟踪查询负载，到理解请求如何流经您的整个应用，都能轻松完成。</p><span id="more"></span><h2 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h2><h3 id="功能简介"><a href="#功能简介" class="headerlink" title="功能简介"></a>功能简介</h3><p>Kibana 是一个开源的分析和可视化平台，设计用于和Elasticsearch一起工作。Kibana来搜索，查看，并和存储在Elasticsearch索引中的数据进行交互。可以轻松地执行高级数据分析，并且以各种图标、表格和地图的形式可视化数据。Kibana使得理解大量数据变得很容易。它简单的、基于浏览器的界面使你能够快速创建和共享动态仪表板，实时显示Elasticsearch查询的变化。</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linux/elks/kabina.jpg" alt="kabina"></p><br><p><strong>运行环境</strong></p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">安装<span class="hljs-keyword">java8环境</span><br><span class="hljs-keyword"></span>apt <span class="hljs-keyword">install </span>openjdk<span class="hljs-number">-8</span>-<span class="hljs-keyword">jdk</span><br><span class="hljs-keyword"></span>检查效果<br><span class="hljs-keyword">java </span>-version<br></code></pre></td></tr></table></figure><br><h3 id="软件安装"><a href="#软件安装" class="headerlink" title="软件安装"></a><strong>软件安装</strong></h3><p><strong>apt源码方式</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs shell">获取软件源<br>wget -qO - https://artifacts.elastic.co/GPG-KEY-elasticsearch | sudo apt-key add<br>-<br>apt install apt-transport-https<br>echo &quot;deb https://artifacts.elastic.co/packages/7.x/apt stable main&quot; | sudo tee<br>–a /etc/apt/sources.list.d/elastic-7.x.list<br>apt update<br>安装软件<br>apt install kibana<br></code></pre></td></tr></table></figure><br><p><strong>软件包安装</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sh">wget https://artifacts.elastic.co/downloads/kibana/kibana-7.14.0-amd64.deb<br>wget https://artifacts.elastic.co/downloads/kibana/kibana-7.14.0-<br>amd64.deb.sha512<br>shasum -a 512 -c kibana-7.14.0-amd64.deb.sha512<br>dpkg -i kibana-7.14.0-amd64.deb<br></code></pre></td></tr></table></figure><br><p><strong>配置查看</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># dpkg -L kibana</span><br>/.<br>/etc<br>/etc/default<br>/etc/default/kibana<br>/etc/init.d<br>/etc/init.d/kibana<br>/etc/kibana kibana家目录<br>/etc/kibana/kibana.yml<br>/etc/kibana/node.options<br>/etc/systemd<br>/etc/systemd/system<br>/etc/systemd/system/kibana.service 服务启动文件<br>/usr<br>/usr/share<br>/usr/share/kibana<br>...<br>/usr/share/kibana/bin 执行命令目录文件<br>/usr/share/kibana/bin/kibana-encryption-keys<br>/usr/share/kibana/bin/kibana-plugin<br>/usr/share/kibana/bin/kibana<br>/usr/share/kibana/bin/kibana-keystore<br></code></pre></td></tr></table></figure><br><p><strong>定制环境变量</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;export PATH=/usr/share/kibana/bin:$PATH&#x27;</span> &gt; /etc/profile.d/kibana.sh<br><span class="hljs-built_in">source</span> /etc/profile.d/kibana.sh<br></code></pre></td></tr></table></figure><br><h3 id="简单实践"><a href="#简单实践" class="headerlink" title="简单实践"></a>简单实践</h3><p>命令格式</p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs basic">修改配置文件<br># vim /etc/kibana/kibana.yml<br># 设定kibana对外开放的通信端口<br>server.port: <span class="hljs-number">5601</span><br># 设定可以访问kibana的主机地址<br>server.host: <span class="hljs-string">&quot;0.0.0.0&quot;</span><br># 设定elasticsearch的主机地址<br>elasticsearch.hosts: [<span class="hljs-string">&quot;http://192.168.8.12:9200&quot;</span>]<br># 设定kibana的数据索引<br>kibana.index: <span class="hljs-string">&quot;.kibana&quot;</span><br># 设定中文显示格式<br>i18n.locale: <span class="hljs-string">&quot;zh-CN&quot;</span><br></code></pre></td></tr></table></figure><br><p><strong>启动服务</strong></p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs basic">启动服务<br>systemctl start kibana.service<br>systemctl status kibana.service<br><br>查看端口<br># netstat -tnulp | egrep <span class="hljs-comment">&#x27;Add|node&#x27;</span><br>Proto Recv-Q Send-Q Local Address Foreign Address State<br>PID/Program <span class="hljs-keyword">name</span><br>tcp <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:<span class="hljs-number">5601</span> <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:* LISTEN<br><span class="hljs-number">31992</span>/node<br><br>结果显示：<br>kibana默认端口是 <span class="hljs-number">5601</span><br></code></pre></td></tr></table></figure><br><p><strong>浏览器查看效果</strong> <a href="http://192.168.10.108:5601/">http://192.168.10.108:5601</a></p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linux/elks/ka.jpg" alt="ka"></p><p>kibana默认帮我们提供了非常多的示例数据</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linux/elks/ka1.jpg" alt="ka1"></p><hr><p><strong>小结：</strong></p><ul><li>定位<pre><code>数据的可视化平台</code></pre></li><li>部署<pre><code>安装软件配置文件启动查看效果</code></pre></li><li>注意：<pre><code>默认的地图虽然支持中文，但是国家地图有问题，</code></pre></li><li>核心点：<pre><code>1 数据采集2 数据可视化</code></pre></li></ul>]]></content>
    
    
    <categories>
      
      <category>ElasticStack</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Ubuntu</tag>
      
      <tag>运维实战</tag>
      
      <tag>日志收集</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ELK-Logstash</title>
    <link href="/2021/10/03/elk-logstash/"/>
    <url>/2021/10/03/elk-logstash/</url>
    
    <content type="html"><![CDATA[<p><strong>Logstash</strong> 能够动态地采集、转换和传输数据，不受格式或复杂度的影响。Logstash 采用可插拔框架，拥有 200 多个插件。您可以将不同的输入选择、过滤器和输出选择混合搭配、精心安排，让它们在管道中和谐地运行。利用 Grok 从非结构化数据中派生出结构，从 IP 地址解码出地理坐标，匿名化或排除敏感字段，并简化整体处理过程。Logstash 提供<a href="https://www.elastic.co/guide/en/logstash/current/output-plugins.html">众多输出选择</a>，您可以将数据发送到您要指定的地方，并且能够灵活地解锁众多下游用例。</p><span id="more"></span><h2 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h2><h3 id="功能简介"><a href="#功能简介" class="headerlink" title="功能简介"></a>功能简介</h3><p>logstash 就是借助于大量的功能插件，实现从数据源获取数据，然后将数据传输到elasticsearch。</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linux/elks/ELK-logstash.jpg" alt="ELK-logstash"></p><br><p>在图中我们可以明显看到，logstash组件至少包含两个插件：input和output，这两个主要用于信息的接入和输出。</p><p><strong>注意：</strong><br>logstash 软件本身无序安装，它仅仅是一个软件运行命令程序，但是该软件的运行依赖于java环境</p><br><p><strong>运行环境</strong></p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">安装<span class="hljs-keyword">java8环境</span><br><span class="hljs-keyword"></span>apt <span class="hljs-keyword">install </span>openjdk<span class="hljs-number">-8</span>-<span class="hljs-keyword">jdk</span><br><span class="hljs-keyword"></span>检查效果<br><span class="hljs-keyword">java </span>-version<br></code></pre></td></tr></table></figure><br><h3 id="软件安装"><a href="#软件安装" class="headerlink" title="软件安装"></a><strong>软件安装</strong></h3><p><strong>apt源码方式</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs shell">获取软件源<br>wget -qO - https://artifacts.elastic.co/GPG-KEY-elasticsearch | sudo apt-key add<br>-<br>apt install apt-transport-https<br>echo &quot;deb https://artifacts.elastic.co/packages/7.x/apt stable main&quot; | sudo tee –a /etc/apt/sources.list.d/elastic-7.x.list<br>apt update<br><br>安装软件<br>apt install logstash<br></code></pre></td></tr></table></figure><br><p><strong>软件包安装</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sh">wget https://artifacts.elastic.co/downloads/logstash/logstash-7.14.0-amd64.deb<br>wget https://artifacts.elastic.co/downloads/logstash/logstash-7.14.0-<br>amd64.deb.sha512<br>shasum -a 512 -c logstash-7.14.0-amd64.deb.sha512<br>dpkg -i logstash-7.14.0-amd64.deb<br></code></pre></td></tr></table></figure><br><p><strong>配置查看</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs bash">dpkg -L logstash<br>/.<br>/usr<br>/usr/share<br>/usr/share/logstash<br>...<br>/etc<br>/etc/logstash<br>/etc/logstash/conf.d<br>/etc/logstash/log4j2.properties<br>/etc/logstash/startup.options 服务启动环境变量文件<br>/etc/logstash/jvm.options jvm相关配置<br>/etc/logstash/logstash.yml 服务配置文件<br>/etc/logstash/logstash-sample.conf 应用配置文件模板<br>/etc/logstash/pipelines.yml<br>...<br>/usr/share/logstash/bin<br>/usr/share/logstash/bin/benchmark.bat<br>/usr/share/logstash/bin/benchmark.sh<br>/usr/share/logstash/bin/cpdump<br>/usr/share/logstash/bin/dependencies-report<br>/usr/share/logstash/bin/ingest-convert.bat<br>/usr/share/logstash/bin/ingest-convert.sh<br>/usr/share/logstash/bin/logstash<br>/usr/share/logstash/bin/logstash-keystore<br>/usr/share/logstash/bin/logstash-keystore.bat<br>/usr/share/logstash/bin/logstash-plugin<br>/usr/share/logstash/bin/logstash-plugin.bat<br>/usr/share/logstash/bin/logstash.bat<br>/usr/share/logstash/bin/logstash.lib.sh<br>/usr/share/logstash/bin/pqcheck<br>/usr/share/logstash/bin/pqcheck.bat<br>/usr/share/logstash/bin/pqrepair<br>/usr/share/logstash/bin/pqrepair.bat<br>/usr/share/logstash/bin/ruby<br>/usr/share/logstash/bin/setup.bat<br>/usr/share/logstash/bin/system-install 生成系统管理配置文件<br>...<br></code></pre></td></tr></table></figure><br><p><strong>定制环境变量</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;export PATH=/usr/share/logstash/bin:$PATH&#x27;</span> &gt; /etc/profile.d/logstash.sh<br><span class="hljs-built_in">source</span> /etc/profile.d/logstash.sh<br></code></pre></td></tr></table></figure><br><h3 id="简单实践"><a href="#简单实践" class="headerlink" title="简单实践"></a>简单实践</h3><p>命令格式</p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs basic">logstash -e <span class="hljs-comment">&#x27;启动参数&#x27;</span><br>启动参数：<br><span class="hljs-keyword">input</span> &#123;<br>stdin &#123;&#125;<br>&#125;<br>output &#123;<br>stdout &#123;&#125;<br>&#125;<br><br>参数解析：<br><span class="hljs-keyword">input</span> &#123;&#125; 用于接受信息的输入<br>output &#123;&#125; 用于对内部的数据输出<br>stdin &#123;&#125; 表示屏幕上的标准输入<br>stdout &#123;&#125; 表示屏幕的标准输出<br></code></pre></td></tr></table></figure><br><p><strong>实践1 - 简单的输入输出测试</strong></p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs basic"># logstash -e <span class="hljs-comment">&#x27;input &#123; stdin &#123; &#125; &#125; output &#123; stdout &#123;&#125; &#125;&#x27;</span><br>...<br>[INFO ] <span class="hljs-number">2021</span>-<span class="hljs-number">08</span>-<span class="hljs-number">15</span> <span class="hljs-number">18</span>:<span class="hljs-number">03</span>:<span class="hljs-number">54.011</span> [Api Webserver] agent - Successfully started<br>Logstash API endpoint &#123;:port=&gt;<span class="hljs-number">9600</span>&#125;<br># 看到上面准备好的信息后，接下来我们在屏幕上随便输入一段信息<br><br>nihao logstash<br># 信息输入完毕后，他会自动格式化的输出一些内容<br><br>&#123;<br><span class="hljs-string">&quot;host&quot;</span> =&gt; <span class="hljs-string">&quot;ubuntu&quot;</span>, # 当前的主机信息<br><span class="hljs-string">&quot;@timestamp&quot;</span> =&gt; <span class="hljs-number">2021</span>-<span class="hljs-number">08</span>-<span class="hljs-number">15</span>T10:<span class="hljs-number">04</span>:<span class="hljs-number">32.873</span>Z, # 该条信息的时间戳<br><span class="hljs-string">&quot;message&quot;</span> =&gt; <span class="hljs-string">&quot;nihao logstash&quot;</span>, # 我们输入的内容<br><span class="hljs-string">&quot;@version&quot;</span> =&gt; <span class="hljs-string">&quot;1&quot;</span> # 版本信息<br>&#125;<br><br>结果展示：<br>信息展示出来的内容，其实包含两部分： index(搜索数据时候的索引)和value(具体的数据内容)<br></code></pre></td></tr></table></figure><br><p><strong>实践2 - 信息传递到es</strong></p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">配置logstash将信息输出到es中<br><span class="hljs-comment"># logstash -e &#x27;input &#123; stdin&#123;&#125; &#125; output &#123; elasticsearch &#123; hosts =&gt;</span><br>[<span class="hljs-string">&quot;192.168.10.106:9200&quot;</span>] index =&gt; <span class="hljs-string">&quot;message&quot;</span> &#125; &#125;&#x27;<br><span class="hljs-string">...</span><br>[2021-08-15 18<span class="hljs-function">:07</span><span class="hljs-function">:51.678</span>][INFO ][logstash.agent ] Successfully started<br>Logstash API endpoint &#123;<span class="hljs-function">:port</span>=&gt;9600&#125;<br><span class="hljs-comment"># 看到上面准备好的信息后，接下来我们在屏幕上随便输入一段信息</span><br>hello elasticsearch<br><br><br>     结果展示：<br>           因为我们将信息输入到es中了，所以这里看不到信息输入<br><br><br><br>es检查查看效果<br><span class="hljs-comment"># curl 192.168.10.106:9200/_cat/indices</span><br>green open message x3JlhXwBQsmGYITwOnlWEw 1 1 1 0 10.8kb 5.3kb<br><br><br><span class="hljs-comment"># curl 192.168.10.106:9200/message?pretty</span><br>&#123;<br><br><span class="hljs-string">&quot;message&quot;</span> : &#123;<br><span class="hljs-string">...</span>,<br>        <span class="hljs-string">&quot;number_of_shards&quot;</span> : <span class="hljs-string">&quot;1&quot;</span>,<br>        <span class="hljs-string">&quot;provided_name&quot;</span> : <span class="hljs-string">&quot;message&quot;</span>,<br>        <span class="hljs-string">&quot;creation_date&quot;</span> : <span class="hljs-string">&quot;1629022162762&quot;</span>,<br>        <span class="hljs-string">&quot;number_of_replicas&quot;</span> : <span class="hljs-string">&quot;1&quot;</span>,<br>        <span class="hljs-string">&quot;uuid&quot;</span> : <span class="hljs-string">&quot;x3JlhXwBQsmGYITwOnlWEw&quot;</span>,<br>        <span class="hljs-string">&quot;version&quot;</span> : &#123;<br>        <span class="hljs-string">&quot;created&quot;</span> : <span class="hljs-string">&quot;7140099&quot;</span><br>          &#125;<br>        &#125;<br>      &#125;<br>   &#125;<br>&#125;<br><br>查看内容信息<br><span class="hljs-comment"># curl 192.168.10.106:9200/message/_search?pretty</span><br>&#123;<br><span class="hljs-string">&quot;took&quot;</span> : 88,<br><span class="hljs-string">&quot;timed_out&quot;</span> : <span class="hljs-literal">false</span>,<br><span class="hljs-string">&quot;_shards&quot;</span> : &#123;<br><span class="hljs-string">&quot;total&quot;</span> : 1,<br><span class="hljs-string">&quot;successful&quot;</span> : 1,<br><span class="hljs-string">&quot;skipped&quot;</span> : 0,<br><span class="hljs-string">&quot;failed&quot;</span> : 0<br>&#125;,<br><span class="hljs-string">&quot;hits&quot;</span> : &#123;<br><span class="hljs-string">&quot;total&quot;</span> : &#123;<br><span class="hljs-string">&quot;value&quot;</span> : 1,<br><span class="hljs-string">&quot;relation&quot;</span> : <span class="hljs-string">&quot;eq&quot;</span><br>&#125;,<br><span class="hljs-string">&quot;max_score&quot;</span> : 1.0,<br><span class="hljs-string">&quot;hits&quot;</span> : [<br>&#123;<br><span class="hljs-string">&quot;_index&quot;</span> : <span class="hljs-string">&quot;message&quot;</span>,<br><span class="hljs-string">&quot;_type&quot;</span> : <span class="hljs-string">&quot;_doc&quot;</span>,<br><span class="hljs-string">&quot;_id&quot;</span> : <span class="hljs-string">&quot;3UZJSXsBvfqpwa_-kJ8V&quot;</span>,<br><span class="hljs-string">&quot;_score&quot;</span> : 1.0,<br><span class="hljs-string">&quot;_source&quot;</span> : &#123;<br><span class="hljs-string">&quot;host&quot;</span> : <span class="hljs-string">&quot;python-auto&quot;</span>,<br><span class="hljs-string">&quot;@timestamp&quot;</span> : <span class="hljs-string">&quot;2021-08-15T10:09:22.359Z&quot;</span>,<br><span class="hljs-string">&quot;message&quot;</span> : <span class="hljs-string">&quot;hello elasticsearch&quot;</span>,<br><span class="hljs-string">&quot;@version&quot;</span> : <span class="hljs-string">&quot;1&quot;</span><br>              &#125;<br>             &#125;<br>           ]<br>         &#125;<br>       &#125;<br></code></pre></td></tr></table></figure><br><p><strong>实践3 - 读取日志文件到es</strong></p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs stata">模块简介<br>    logstash的信息采集模块支持<span class="hljs-keyword">file</span>模块，可以通过指定日志文件，直接从文件中读取相关信息。<br><br>参考资料：<br>    https:<span class="hljs-comment">//www.elastic.co/guide/en/logstash/7.14/plugins-inputs-file.html</span><br><br>基本属性：<br>    path 指定文件路径<br>    start_position 设定从文件的那个位置开始读取，可选值 -- beginning, end(默认)<br>    <span class="hljs-keyword">type</span> 传递信息的时候，增加一个额外的属性字段<br><br>配置示例：<br>    <span class="hljs-keyword">file</span> &#123;<br>       path =&gt; <span class="hljs-string">&quot;/var/log/syslog&quot;</span><br>       start_position =&gt; <span class="hljs-string">&quot;beginning&quot;</span><br>       <span class="hljs-keyword">type</span> =&gt; <span class="hljs-string">&quot;elasticsearch&quot;</span><br>&#125;<br><br>从系统日志文件中读取信息，输出到es中<br># logstash -<span class="hljs-keyword">e</span> &#x27;<span class="hljs-keyword">input</span> &#123; <span class="hljs-keyword">file</span>&#123;path =&gt; <span class="hljs-string">&quot;/var/log/syslog&quot;</span> start_position =&gt;<br><span class="hljs-string">&quot;beginning&quot;</span> <span class="hljs-keyword">type</span> =&gt; <span class="hljs-string">&quot;elasticsearch&quot;</span>&#125; &#125; output &#123; elasticsearch &#123; hosts =&gt;<br>[<span class="hljs-string">&quot;192.168.10.106&quot;</span>] index =&gt; <span class="hljs-string">&quot;message&quot;</span> &#125; &#125;&#x27;<br>...<br>[INFO ] 2021-08-15 18:32:50.789 [[main]-pipeline-manager] elasticsearch - New<br>Elasticsearch output &#123;:<span class="hljs-keyword">class</span>=&gt;<span class="hljs-string">&quot;LogStash::Outputs::ElasticSearch&quot;</span>, :hosts=&gt;<br>[<span class="hljs-string">&quot;//192.168.8.12:9200&quot;</span>]&#125;<br>...<br>[INFO ] 2021-08-15 18:32:54.992 [[main]-pipeline-manager] <span class="hljs-keyword">file</span> - <span class="hljs-keyword">No</span> sincedb_path<br><span class="hljs-keyword">set</span>, generating <span class="hljs-keyword">one</span> based <span class="hljs-keyword">on</span> the <span class="hljs-string">&quot;path&quot;</span> setting<br>&#123;:sincedb_path=&gt;&quot;/usr/share/logstash/data/plugins/inputs/<span class="hljs-keyword">file</span>/.sincedb_f5fdf6ea0<br>ea92860c6a6b2b354bfcbbc<span class="hljs-string">&quot;, :path=&gt;[&quot;</span>/<span class="hljs-keyword">var</span>/<span class="hljs-keyword">log</span>/syslog&quot;]&#125;<br><br><br>在head插件中查看日志效果<br></code></pre></td></tr></table></figure><br><h3 id="服务文件方式"><a href="#服务文件方式" class="headerlink" title="服务文件方式"></a>服务文件方式</h3><p>  生成配置文件</p><p>​    以命令行的方式来进行启动太繁琐，我们最好还是以配置文件的方式来进行服务的启动管理，对于<br>logstash来说，它提供好了一个专门用于生成配置文件的命令 <code>system-install</code>，我们只需要按照既定的<br>配置文件规则，定制应用配置，最后执行该命令，即可实现服务脚本的配置。</p><br><p><strong>服务启动参数</strong></p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs vim">进入应用目录<br><span class="hljs-keyword">cd</span> /etc/logstash<br>编辑启动参数文件<br><br># <span class="hljs-keyword">vim</span> startup.<span class="hljs-keyword">options</span><br>...<br># Arguments <span class="hljs-keyword">to</span> pass <span class="hljs-keyword">to</span> logstash<br>LS_OPTS=<span class="hljs-string">&quot;--path.settings $&#123;LS_SETTINGS_DIR&#125; -f /etc/logstash/conf.d&quot;</span><br>     注意： -<span class="hljs-keyword">f</span> 指定的是 logstash的应用配置文件(比如 logstash.<span class="hljs-keyword">conf</span>)存放到的目录<br></code></pre></td></tr></table></figure><br><p><strong>定制配置文件信息输入到es的配置文件</strong></p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs basic">生成配置文件<br>cp logstash-sample.conf conf.d/logstash.conf<br><br><br>修改配置文件 conf.d/logstash.conf<br># Sample Logstash configuration <span class="hljs-keyword">for</span> creating a simple<br># Beats -&gt; Logstash -&gt; Elasticsearch pipeline.<br><br><br>#输入部分<br><span class="hljs-keyword">input</span> &#123;<br># beats &#123;<br># port =&gt; <span class="hljs-number">5044</span><br># &#125;<br><br>#插件<br>file &#123;<br>path =&gt; [<span class="hljs-string">&quot;/var/log/syslog&quot;</span>]<br>start_position =&gt; <span class="hljs-string">&quot;beginning&quot;</span><br>type =&gt; <span class="hljs-string">&quot;elasticsearch&quot;</span><br>&#125;<br>&#125;<br><br>#输出部分<br>output &#123;<br>elasticsearch &#123;<br>hosts =&gt; [<span class="hljs-string">&quot;http://192.168.8.12:9200&quot;</span>]<br>index =&gt; <span class="hljs-string">&quot;logstash-test-%&#123;+YYYY.MM.dd&#125;&quot;</span><br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><br><p><strong>生成配置文件</strong></p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs basic">以root用户执行下面的命令<br><span class="hljs-keyword">system</span>-install<br><br><br>查看生成的服务配置文件<br># ls /etc/systemd/<span class="hljs-keyword">system</span>/logstash.service<br>/etc/systemd/<span class="hljs-keyword">system</span>/logstash.service<br><br><br>查看服务配置文件内容<br># cat /etc/systemd/<span class="hljs-keyword">system</span>/logstash.service<br>[Unit]<br>Description=logstash<br>[Service]<br>Type=simple<br>User=logstash<br>Group=logstash<br># <span class="hljs-keyword">Load</span> env vars from /etc/default/ <span class="hljs-keyword">and</span> /etc/sysconfig/ <span class="hljs-keyword">if</span> they exist.<br># Prefixing the path with <span class="hljs-comment">&#x27;-&#x27; makes it try to load, but if the file doesn&#x27;t</span><br># exist, it continues onward.<br>EnvironmentFile=-/etc/default/logstash<br>EnvironmentFile=-/etc/sysconfig/logstash<br>ExecStart=/<span class="hljs-keyword">usr</span>/share/logstash/bin/logstash <span class="hljs-string">&quot;--path.settings&quot;</span> <span class="hljs-string">&quot;/etc/logstash&quot;</span> <span class="hljs-string">&quot;-</span><br><span class="hljs-string">f&quot;</span> <span class="hljs-string">&quot;/etc/logstash/conf.d&quot;</span><br>Restart=always<br>WorkingDirectory=/<br>Nice=<span class="hljs-number">19</span><br>LimitNOFILE=<span class="hljs-number">16384</span><br># When stopping, how long <span class="hljs-keyword">to</span> <span class="hljs-keyword">wait</span> before giving up <span class="hljs-keyword">and</span> sending SIGKILL?<br># Keep in mind that SIGKILL <span class="hljs-keyword">on</span> a process can cause <span class="hljs-keyword">data</span> loss.<br>TimeoutStopSec=infinity<br>[Install]<br>WantedBy=multi-user.target<br><br>注意：<br>由于服务启动的时候，用户名和用户组都是 logstash ，所以，我们采集数据的文件必须是具备查看的权限<br></code></pre></td></tr></table></figure><br><p><strong>启动服务</strong></p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs basic">重载服务<br>systemctl daemon-reload<br><br><br>启动服务<br>systemctl start logstash.service<br>systemctl status logstash.service<br><br><br>查看效果<br># netstat -tnulp | egrep <span class="hljs-comment">&#x27;Add|java&#x27;</span><br>Proto Recv-Q Send-Q Local Address Foreign Address State PID/Program<br><span class="hljs-keyword">name</span><br>tcp6 <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">9600</span> :::* LISTEN <span class="hljs-number">88794</span>/java<br>tcp6 <span class="hljs-number">0</span> <span class="hljs-number">0</span> :::<span class="hljs-number">9200</span> :::* LISTEN <span class="hljs-number">87210</span>/java<br>tcp6 <span class="hljs-number">0</span> <span class="hljs-number">0</span> :::<span class="hljs-number">9300</span> :::* LISTEN <span class="hljs-number">87210</span>/java<br><br><br>结果显示：<br>logstash的默认端口是 <span class="hljs-number">9600</span><br><br><br>查看日志<br>tail -f /var/<span class="hljs-keyword">log</span>/logstash/logstash-plain.<span class="hljs-keyword">log</span><br><br><br>可以看到默认报错：<br>[<span class="hljs-number">2021</span>-<span class="hljs-number">08</span>-<span class="hljs-number">15</span>T18:<span class="hljs-number">44</span>:<span class="hljs-number">08</span>,<span class="hljs-number">643</span>][WARN ]<br>[filewatch.tailmode.handlers.createinitial][main]<br>[cc34021140e2525e95d5755b6135b9801f3595239bcda82a1cca03a1d0f857d6] failed <span class="hljs-keyword">to</span><br><span class="hljs-keyword">open</span> file &#123;:path=&gt;<span class="hljs-string">&quot;/var/log/syslog&quot;</span>, :exception=&gt;Errno::EACCES,<br>:message=&gt;<span class="hljs-string">&quot;Permission denied - /var/log/syslog&quot;</span>&#125;<br><br><br>临时增加一个 logstash 允许访问的权限<br>chown logstash.logstash /var/<span class="hljs-keyword">log</span>/syslog<br></code></pre></td></tr></table></figure><br><p><strong>通过head插件查看数据传递效果</strong></p><br><hr><p><strong>小结：</strong></p><ul><li>定位<pre><code>数据的采集和传递&lt;br&gt;</code></pre></li><li>组成：<pre><code>核心：input - filter - output&lt;br&gt;辅助：codec &lt;br&gt;</code></pre></li><li>特点：<pre><code>每个部分都有对应业务场景的插件来实现功能</code></pre></li></ul><ul><li><strong>守护进程方式运行logstash</strong><br><br>定制服务的启动参数<br><br>system-install 生成服务启动文件<br><br>应用服务启动文件<br></li></ul><ul><li><strong>临时测试文件的方式</strong><br>logstash -f xxx.conf</li></ul>]]></content>
    
    
    <categories>
      
      <category>ElasticStack</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Ubuntu</tag>
      
      <tag>运维实战</tag>
      
      <tag>日志收集</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ELK-Elasticsearch</title>
    <link href="/2021/10/02/elk-Elasticsearch/"/>
    <url>/2021/10/02/elk-Elasticsearch/</url>
    
    <content type="html"><![CDATA[<p>两三年前ELK还是一套日志分析平台的解决方案 ，它是由Elastic公司开发，管理和维护的三款开源产品Elasticsearch，Logstash和Kibana的首字母缩写，随着该套解决方案的软件生态逐渐壮大，其组件和功能也渐渐多了起来，尤其是Beats组件的引入，逐渐形成了这个系列的四大支柱，然后公司将这套解决方案重新命名为：Elastic Stack，最新版本7.X。</p><span id="more"></span><h1 id="ELK日志收集系统"><a href="#ELK日志收集系统" class="headerlink" title="ELK日志收集系统"></a>ELK日志收集系统</h1><h2 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h2><p><strong>简介</strong></p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs gcode">    所谓的 搜索引擎<span class="hljs-comment">(Search Engine)</span>，通常指的是收集了 几千万到几十亿个条数据，为了方便后续精<br>确查询，我们为这些数据的多个词<span class="hljs-comment">(关键词)</span>进行索引，建立索引数据库的全文搜索引擎。<br>    这样，当用户查找某个关键词的时候，所有在页面内容中包含了该关键词的网页都将作为搜索结果被搜出来。再经过复杂的算法进行排序<span class="hljs-comment">(或者包含商业化的竞价排名、商业推广或者广告)</span>后，这些结果将按照与搜索关键词的相关度高低（或与相关度毫无关系），依次排列。<br></code></pre></td></tr></table></figure><br><p><strong>应用场景</strong></p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs makefile"><span class="hljs-section">搜索与推荐:</span><br>搜索 - 用户在网上，主动根据关键字去搜索相关的数据<br>推荐 - 网站程序，根据用户日常的搜索习惯，通过分析用户的行为数据，主动推送一些用户感兴趣的事情。<br><br><br>搜索领域：<br>门户网站 - 提供各种用户感兴趣的网站入口，便于用户快速获取相关信息，一般是爬虫爬取的数据。<br>定向搜索 - 搜索特定领域的内容，一般是网站自身根据产品设计的样式，结构化存储的数据。<br><br>搜索功能：<br>智能搜索 - 根据用户搜索的历史或者关键字，自动弹出或者扩展类似的关键字，提高用户搜索的效率。<br>普通搜索 - 用户输入数据然后正常的搜索。<br>相关搜索 - 默认提供的其他关联网站的入口。<br></code></pre></td></tr></table></figure><br><h2 id="数据流程"><a href="#数据流程" class="headerlink" title="数据流程"></a>数据流程</h2><p><strong>数据采集</strong> </p><figure class="highlight node-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs node-repl">物理层：文件、设备等<br>代理层：nginx、haproxy等<br>web层：nginx、apache、tomcat等<br>数据库层：mysql、mongodb、redis等<br>存储层：ceph、k8s、docker等<br><span class="hljs-meta">...</span><br></code></pre></td></tr></table></figure><h3 id="流程解析"><a href="#流程解析" class="headerlink" title="流程解析"></a><strong>流程解析</strong></h3><p>要完成一次完整的数据采集与处理至少需要有以下几方面来组成：</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linux/elks/ELK.jpg" alt="ELK"></p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs gcode">① 数据采集：根据业务的特性，采取多种方式，进行对一些针对性的数据进行采集<br>② 数据整理：对上报后的数据源进行收集、清洗、整理<br>③ 实时分析：对某些重要的核心的业务数据，进行实时分析<br>④ 离线分析：对普通的数据、非紧急的业务数据进行存储，后续进行相应的分析<br>⑤ 结果输出：将实时分析和离线分析后的数据结果展现出来，供决策参考<br>⑥ 问题决策：根据当前业务情况，人工或者自动方式对输出的结构进行分析，并判定下一步的行动<span class="hljs-comment">(警告或修</span><br><span class="hljs-comment">复)</span>，<br>同时将其决策记录保存下来，以便为后序决策提供依据<br>也就是说：采集、传输、存储、分析、警告这几部分是非常必要的。<br></code></pre></td></tr></table></figure><br><h3 id="方案梳理"><a href="#方案梳理" class="headerlink" title="方案梳理"></a><strong>方案梳理</strong></h3><p>在这个流程图中涉及到两种场景：<font color='red'>实时分析与离线分析</font>，如果需要使用市面<br>上的开源解决方案来实现的话，有两套方案比较有优势：</p><ul><li>方案一：ELK + Kafka + 分布式存储<br>中数据量场景下，实时的数据多一些</li><li>方案二：Spark + Flume + Kafka + Hadoop(Hive + HBase)<br>大数据量场景下，离线的数据多一些</li></ul><h2 id="快速入门"><a href="#快速入门" class="headerlink" title="快速入门"></a>快速入门</h2><h3 id="ELK简介"><a href="#ELK简介" class="headerlink" title="ELK简介"></a>ELK简介</h3><figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs lasso">两三年前ELK还是一套日志分析平台的解决方案 ，它是由Elastic公司开发，管理和维护的三款开源产品<br>Elasticsearch，Logstash和Kibana的首字母缩写，随着该套解决方案的软件生态逐渐壮大，其组件和功<br>能也渐渐多了起来，尤其是Beats组件的引入，逐渐形成了这个系列的四大支柱，然后公司将这套解决方案重<br>新命名为：Elastic <span class="hljs-built_in">Stack</span>，最新版本<span class="hljs-number">7.</span>X。<br></code></pre></td></tr></table></figure><br><p><strong>官方介绍</strong></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">The</span> products in the Elastic Stack are designed to be used together and releases<br><span class="hljs-attribute">are</span><br><span class="hljs-attribute">synchronized</span> to simplify the installation and upgrade process. The full stack<br><span class="hljs-attribute">consists</span><br><span class="hljs-attribute">of</span>:<br><span class="hljs-attribute">Beats</span> <span class="hljs-number">7</span>.<span class="hljs-number">14</span> APM Server <span class="hljs-number">7</span>.<span class="hljs-number">14</span> Elasticsearch Hadoop <span class="hljs-number">7</span>.<span class="hljs-number">14</span><br><span class="hljs-attribute">Kibana</span> <span class="hljs-number">7</span>.<span class="hljs-number">14</span> Elasticsearch <span class="hljs-number">7</span>.<span class="hljs-number">14</span> Logstash <span class="hljs-number">7</span>.<span class="hljs-number">14</span><br></code></pre></td></tr></table></figure><br><p><strong>开发语言</strong></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs go">java：Elasticsearch、Logstash、Kibana<br><span class="hljs-keyword">go</span>：FileBeats<br></code></pre></td></tr></table></figure><br><p><strong>组件发展</strong></p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linux/elks/ELKfz.jpg" alt="ELKfz"></p><p><strong>相关网站</strong></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">官方网站：https:<span class="hljs-regexp">//</span>www.elastic.co<br>github：https:<span class="hljs-regexp">//gi</span>thub.com/elastic<br>示例网站：https:<span class="hljs-regexp">//</span>demo.elastic.co<br></code></pre></td></tr></table></figure><br><h3 id="架构组件"><a href="#架构组件" class="headerlink" title="架构组件"></a><strong>架构组件</strong></h3><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc">四个组件：<br><span class="hljs-code">  Beats是安装在边缘主机上的轻型代理，可收集不同类型的数据以转发到堆栈中</span><br><span class="hljs-code">  Logstash是一个日志聚合器，可从各种输入源收集数据，执行不同的转换和增强功能，然后将数据发送</span><br>到各种受支持的输出目标<br><span class="hljs-code">  Elasticsearch是基于Apache Lucene搜索引擎的开源全文搜索和分析引擎</span><br><span class="hljs-code">  Kibana是在Elasticsearch之上工作的可视化层，为用户提供了分析和可视化数据的能力</span><br><br>这四个组件在官方的介绍主要分成了两组势力：数据收集和展示<br><br><span class="hljs-bullet">- </span>数据收集和处理：Beats和Logstash负责数据收集和处理。<br><span class="hljs-bullet">- </span>数据搜索和展示：Elasticsearch索引并存储数据，Kibana提供了用于查询数据和可视化数据的用户界面<br><br><span class="hljs-code">  这些组件在设计的时候，组件间的交流就非常简单，所以我们只需要简单的几条配置，就可以将不同的组件组</span><br><span class="hljs-code">  合起来实现一个简单而强大的解决方案。而且还可以基于应用场景的不同随意组合，比如日志管理、日志分</span><br><span class="hljs-code">  析、应用监控、故障排除和保护IT环境等。</span><br></code></pre></td></tr></table></figure><br><p><strong>对于小型的应用项目开发环境，ELK的四个组件可以实现一个非常经典的组合：</strong></p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linux/elks/ELKzj.jpg" alt="ELKzj"></p><br><p><strong>对于中大型场景，ELK基于丰富灵活的信息接口将非常多的功能整合到经典组合中，以提高其架构弹性和安全性：</strong></p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linux/elks/ELKzdxjg.jpg" alt="ELKzdxjg"></p><br><h2 id="安装部署"><a href="#安装部署" class="headerlink" title="安装部署"></a>安装部署</h2><p><strong>要点</strong></p><pre><code>1 组件间如何联通2 组件如何在不同场景中使用对应插件        elasticsearch    实践术语及分片实践        logstash        组件(插件)实现数据的转移及转移过程中对数据的封装        filebeat        采集数据集转移        kibana            可视化的流程及大量可视化实践</code></pre><h3 id="环境"><a href="#环境" class="headerlink" title="环境"></a><strong>环境</strong></h3><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs dns">前提：<br>java环境很重要，但是很可惜，elasticsearch软件内部已经有了java环境，<br>默认情况下，elasticsearch 软件包里面已经包含了java环境，而且是最新版的 JDK-<span class="hljs-number">16</span>.<span class="hljs-number">0</span>.<span class="hljs-number">1</span><br><br>环境布局<br><span class="hljs-number">10.0.0.12</span>  elasticsearch   elasticsearch_head<br><span class="hljs-number">10.0.0.13</span>  elasticsearch   logstash<br><span class="hljs-number">10.0.0.14</span>  kibana<br><span class="hljs-number">10.0.0.15</span>  filebeat + 项目代码<br></code></pre></td></tr></table></figure><p><strong>定位</strong></p><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs delphi">日志分析平台解决方案 - 大量小方案的整合<br>Store, Search, <span class="hljs-keyword">and</span> Analyze<br><br>组成<br>Elasticsearch- 数据的存储和分析<br>Logstash- 数据采集和传输<span class="hljs-comment">(*)</span><br><span class="hljs-comment">Kibana- 数据的可视化(二次处理)  KQL</span><br><span class="hljs-comment">Beats- 数据采集(*)</span>和传输<br><br>中小场景方案<br>Beats - Logstash - elasticsearch - kibana<br><br>中大场景方案<br>Beats - 消息队列 - Logstash - 消息队列 - elasticsearch - kibana(Nginx)<br></code></pre></td></tr></table></figure><br><p><strong>基本环境</strong></p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">安装<span class="hljs-keyword">java8环境</span><br><span class="hljs-keyword"></span>apt <span class="hljs-keyword">install </span>openjdk<span class="hljs-number">-8</span>-<span class="hljs-keyword">jdk</span><br><span class="hljs-keyword"></span>检查效果<br><span class="hljs-keyword">java </span>-version<br>注意:<br>默认情况下，elasticsearch 软件包里面已经包含了<span class="hljs-keyword">java环境，而且是最新版的 </span><span class="hljs-keyword">JDK-16.0.1</span><br></code></pre></td></tr></table></figure><br><h3 id="软件安装"><a href="#软件安装" class="headerlink" title="软件安装"></a><strong>软件安装</strong></h3><p><strong>apt 源码安装方式</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs shell">获取软件源<br>wget -qO - https://artifacts.elastic.co/GPG-KEY-elasticsearch | sudo apt-key add -<br>apt install apt-transport-https<br>echo &quot;deb https://artifacts.elastic.co/packages/7.x/apt stable main&quot; | sudo tee<br>–a /etc/apt/sources.list.d/elastic-7.x.list<br>apt update<br><br>安装软件<br>apt install elasticsearch<br></code></pre></td></tr></table></figure><br><p><strong>软件安装方法2 - 包安装</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs shell">wget https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-7.14.0-<br>amd64.deb<br><br>wget https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-7.14.0-<br>amd64.deb.sha512<br><br>shasum -a 512 -c elasticsearch-7.14.0-amd64.deb.sha512<br>dpkg -i elasticsearch-7.14.0-amd64.deb<br><br>注意：<br>这里推荐 两台服务器来部署 elasticsearch<br></code></pre></td></tr></table></figure><br><p><strong>基本配置</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs bash">查看配置结构<br><span class="hljs-comment">#dpkg -L elasticsearch</span><br>/usr<br>/usr/share<br>/usr/share/elasticsearch<br>/usr/share/elasticsearch/bin<br>/usr/share/elasticsearch/bin/elasticsearch-geoip<br>...<br>/etc<br>/etc/elasticsearch<br>/etc/elasticsearch/elasticsearch.yml 核心配置文件<br>/etc/elasticsearch/log4j2.properties 日志相关的配置<br>/etc/elasticsearch/roles.yml<br>/etc/elasticsearch/jvm.options jvm相关的配置<br>/etc/elasticsearch/role_mapping.yml<br>/etc/elasticsearch/users_roles<br>/etc/elasticsearch/users<br>/etc/default<br>/etc/default/elasticsearch 环境变量配置文件<br>/usr/lib<br>/usr/lib/tmpfiles.d<br>/usr/lib/tmpfiles.d/elasticsearch.conf<br>/usr/lib/systemd<br>/usr/lib/systemd/system<br>/usr/lib/systemd/system/elasticsearch.service 服务启动文件<br>...<br></code></pre></td></tr></table></figure><br><p><strong>环境变量定制</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;export PATH=/usr/share/elasticsearch/bin:$PATH&#x27;</span> &gt;<br>/etc/profile.d/elasticsearch.sh<br><span class="hljs-built_in">source</span> /etc/profile.d/elasticsearch.sh<br></code></pre></td></tr></table></figure><br><h3 id="简单实践"><a href="#简单实践" class="headerlink" title="简单实践"></a><strong>简单实践</strong></h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs sh">修改配置文件<br>vim /etc/elasticsearch/elasticsearch.yml<br><br><span class="hljs-comment"># 设定elasticsearch集群的名称</span><br>cluster.name: elastic.example.com<br><br><span class="hljs-comment"># 设定集群master界面的名称</span><br>node.name: 192.168.8.12<br><br><span class="hljs-comment"># 设定elasticsearch的存储目录，包括数据目录和日志目录</span><br>path.data: /var/lib/elasticsearch<br>path.logs: /var/<span class="hljs-built_in">log</span>/elasticsearch<br><br><span class="hljs-comment"># 允许所有主机都能访问我们的elasticsearch</span><br>network.host: 0.0.0.0<br><br><span class="hljs-comment"># 设置elasticsearch对外的访问端口</span><br>http.port:9200<br><br><span class="hljs-comment"># 设定主机发现</span><br>discovery.seed_hosts: [<span class="hljs-string">&quot;192.168.10.106&quot;</span>,<span class="hljs-string">&quot;192.168.10.107&quot;</span>]<br>cluster.initial_master_nodes: [<span class="hljs-string">&quot;192.168.10.106&quot;</span>]<br><br><span class="hljs-comment"># 开启跨域访问支持，默认为false</span><br>http.cors.enabled: <span class="hljs-literal">true</span><br><br><span class="hljs-comment"># 跨域访问允许的域名地址，(允许所有域名)以上使用正则</span><br>http.cors.allow-origin: <span class="hljs-string">&quot;*&quot;</span><br><br>注意：<br>对于 node 主机只需要更改一处 node.name 即可<br>如果是重新还原es集群，启动前将 path.data 和 path.logs 目录下的数据清空，避免数据不一致<br></code></pre></td></tr></table></figure><br><p><strong>重启服务</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs sh">重启es服务<br>systemctl start elasticsearch<br><br>检查效果<br><span class="hljs-comment"># netstat -tnulp | egrep &#x27;Add|java&#x27;</span><br>Proto Recv-Q Send-Q Local Address Foreign Address State<br>PID/Program name<br>tcp6 0 0 :::9300 :::* LISTEN<br>12004/java<br>tcp6 0 0 :::9200 :::* LISTEN<br>12004/java<br><br>结果显示<br>默认elasticsearch开启了两个端口，<br>9200 elasticsearch对外提供服务的接口<br>9300 集群节点间的通信端口<br>先启动 9300，然后再开启9200<br></code></pre></td></tr></table></figure><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linux/elks/image-20211115144835005.png" alt="image-20211115144835005"></p><br><p><strong>常用地址</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs powershell">查看集群状态<br><span class="hljs-built_in">curl</span> <span class="hljs-literal">-XGET</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">10.106</span>:<span class="hljs-number">9200</span>/_cat/health<br><span class="hljs-built_in">curl</span> <span class="hljs-literal">-XGET</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">10.107</span>:<span class="hljs-number">9200</span>/_cat/health?v<br>注意：在所有的地址后面，增加 ? 和 ?v ，会逐渐显示更多的详细内容<br><br>查看集群节点<br><span class="hljs-built_in">curl</span> <span class="hljs-literal">-XGET</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">10.106</span>:<span class="hljs-number">9200</span>/_cat/nodes<br><br>查看索引<br><span class="hljs-built_in">curl</span> <span class="hljs-literal">-XGET</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">10.106</span>:<span class="hljs-number">9200</span>/_cat/indices<br><br>创建索引<br><span class="hljs-built_in">curl</span> <span class="hljs-literal">-XPUT</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">10.106</span>:<span class="hljs-number">9200</span>/index_test<br><span class="hljs-built_in">curl</span> <span class="hljs-literal">-XGET</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">10.106</span>:<span class="hljs-number">9200</span>/_cat/indices<br><br>格式化展示<br><span class="hljs-built_in">curl</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">8.12</span>:<span class="hljs-number">9200</span>/index_test?pretty<br><br>删除索引<br><span class="hljs-built_in">curl</span> <span class="hljs-literal">-XDELETE</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">10.106</span>:<span class="hljs-number">9200</span>/index_test<br><span class="hljs-built_in">curl</span> <span class="hljs-literal">-XGET</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">10.106</span>:<span class="hljs-number">9200</span>/_cat/indices<br><br>批量删除<br><span class="hljs-built_in">curl</span> <span class="hljs-literal">-s</span> http://<span class="hljs-number">192.168</span>.<span class="hljs-number">10.106</span>:<span class="hljs-number">9200</span>/_cat/indices | awk <span class="hljs-string">&#x27;&#123;print $3&#125;&#x27;</span><br><span class="hljs-keyword">for</span> index <span class="hljs-keyword">in</span> <span class="hljs-variable">$</span>(<span class="hljs-built_in">curl</span> <span class="hljs-literal">-s</span> http://<span class="hljs-number">192.168</span>.<span class="hljs-number">10.106</span>:<span class="hljs-number">9200</span>/_cat/indices | awk <span class="hljs-string">&#x27;&#123;print</span><br><span class="hljs-string">$3&#125;&#x27;</span>)<br><span class="hljs-keyword">do</span><br><span class="hljs-built_in">curl</span> <span class="hljs-literal">-XDELETE</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">10.106</span>:<span class="hljs-number">9200</span>/<span class="hljs-variable">$index</span><br>done<br><br>修改切片属性<br><span class="hljs-built_in">curl</span> <span class="hljs-literal">-X</span> PUT <span class="hljs-number">192.168</span>.<span class="hljs-number">10.106</span>:<span class="hljs-number">9200</span>/index_test <span class="hljs-literal">-H</span> <span class="hljs-string">&#x27;Content-Type:application/json&#x27;</span> <span class="hljs-literal">-d</span><span class="hljs-string">&#x27;</span><br><span class="hljs-string">&#123;</span><br><span class="hljs-string">   &quot;settings&quot; : &#123;</span><br><span class="hljs-string">   &quot;number_of_shards&quot; : 3,</span><br><span class="hljs-string">   &quot;number_of_replicas&quot; : 1</span><br><span class="hljs-string">   &#125;</span><br><span class="hljs-string">&#125;&#x27;</span><br><span class="hljs-built_in">curl</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">10.107</span>:<span class="hljs-number">9200</span>/index_test?pretty<br>注意：<br>在设置切片属性的时候，一定要注意在历史数据中，最好不要存在同名的索引，否则报错<br></code></pre></td></tr></table></figure><br><h3 id="功能插件"><a href="#功能插件" class="headerlink" title="功能插件"></a><strong>功能插件</strong></h3><p>插件管理</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs awk">elasticsearch最擅长的场景就是索引的操作，而索引的使用场景在不同的公司非常不同，所以<br>elasticsearch的索引场景可以基于不同的插件来实现对应的功能，而插件也是ELK非常重要的属性。<br><br>elasticsearch提供了两种插件的管理方式：<br>- 专用的插件管理可以使用命令 elasticsearch-plugin，它可以对默认的插件进行管理；<br>- 定制的插件管理可以基于离线方式安装插件。<br> <br>常见插件：<br>  分词插件：analysis-icu、analysis-ik、等<br>  管理插件：head、kopf、bigdest、等<br> <br>注意：<br>  随着elasticsearch的版本更新，很多之前可以直接安装的插件，目前无法直接安装了，<br>  需要采取自定义的方式来安装<br>  <br>旧的插件地址<br>  https:<span class="hljs-regexp">//</span>www.elastic.co<span class="hljs-regexp">/guide/</span>en<span class="hljs-regexp">/elasticsearch/</span>plugins<span class="hljs-regexp">/2.4/m</span>anagement.html<br>  <br>官方地址<br>  https:<span class="hljs-regexp">//</span>www.elastic.co<span class="hljs-regexp">/guide/</span>en<span class="hljs-regexp">/elasticsearch/</span>plugins<span class="hljs-regexp">/current/i</span>ndex.html<br></code></pre></td></tr></table></figure><br><p><strong>安装插件命令</strong></p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs stata">在线方式：<br>elasticsearch-<span class="hljs-keyword">plugin</span> install [plugin_name]/[<span class="hljs-keyword">version</span>]<br><br>离线方式：<br>方法1：elasticsearch-<span class="hljs-keyword">plugin</span> install <span class="hljs-keyword">file</span>:<span class="hljs-comment">///path/to/plugin.zip</span><br>方法2：将下载的插件解压到elasticsearch的plugins目录即可<br><br>查看已安装插件<br>elasticsearch-<span class="hljs-keyword">plugin</span> <span class="hljs-keyword">list</span><br><br>删除插件<br>elasticsearch-<span class="hljs-keyword">plugin</span> remove [plugin_name]<br><br>注意：<br>删除插件的时候，推荐先关闭结点，然后再关闭。<br></code></pre></td></tr></table></figure><p>安装默认的插件</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><code class="hljs ada">安装中文语法分析后重启服务<br>elasticsearch-plugin install analysis-smartcn<br>elasticsearch-plugin install analysis-icu<br>systemctl restart elasticsearch.service<br><br>检查效果<br># elasticsearch-plugin list<br>analysis-icu<br>analysis-smartcn<br><br># ls /usr/share/elasticsearch/<br>bin jdk lib modules NOTICE.txt plugins README.asciidoc<br><br># ls /usr/share/elasticsearch/plugins/<br>analysis-icu analysis-smartcn<br><br>简单测试<br># curl -X POST <span class="hljs-symbol">&#x27;http</span>://<span class="hljs-number">192.168</span>.<span class="hljs-number">10.106_</span>analyze?pretty=<span class="hljs-literal">true</span>&#x27; -H <span class="hljs-symbol">&#x27;content</span>-<span class="hljs-keyword">type</span>:<br><br>application/json&#x27; -d &#x27;&#123;<br><span class="hljs-string">&quot;analyzer&quot;</span>: <span class="hljs-string">&quot;icu_analyzer&quot;</span>,<br><span class="hljs-string">&quot;text&quot;</span>: <span class="hljs-string">&quot;中华人民共和国国歌&quot;</span><br>&#125;&#x27;<br><span class="hljs-comment">---- 下面是显示的内容</span><br>&#123;<br><span class="hljs-string">&quot;tokens&quot;</span> : [<br>&#123;<br><span class="hljs-string">&quot;token&quot;</span> : &quot;中华&quot;,<br><span class="hljs-string">&quot;start_offset&quot;</span> : 0,<br><span class="hljs-string">&quot;end_offset&quot;</span> : 2,<br><span class="hljs-string">&quot;type&quot;</span> : &quot;&lt;<span class="hljs-type">IDEOGRAPHIC</span>&gt;<span class="hljs-string">&quot;,</span><br><span class="hljs-string">&quot;</span>position<span class="hljs-string">&quot; : 0</span><br><span class="hljs-string">&#125;,</span><br><span class="hljs-string">&#123;</span><br><span class="hljs-string">&quot;</span>token<span class="hljs-string">&quot; : &quot;</span>人民<span class="hljs-string">&quot;,</span><br><span class="hljs-string">&quot;</span>start_offset<span class="hljs-string">&quot; : 2,</span><br><span class="hljs-string">&quot;</span>end_offset<span class="hljs-string">&quot; : 4,</span><br><span class="hljs-string">&quot;</span><span class="hljs-keyword">type</span><span class="hljs-string">&quot; : &quot;</span>&lt;IDEOGRAPHIC&gt;<span class="hljs-string">&quot;,</span><br><span class="hljs-string">&quot;</span>position<span class="hljs-string">&quot; : 1</span><br><span class="hljs-string">&#125;,</span><br><span class="hljs-string">&#123;</span><br><span class="hljs-string">&quot;</span>token<span class="hljs-string">&quot; : &quot;</span>共和国<span class="hljs-string">&quot;,</span><br><span class="hljs-string">&quot;</span>start_offset<span class="hljs-string">&quot; : 4,</span><br><span class="hljs-string">head插件安装</span><br><span class="hljs-string">&quot;</span>end_offset<span class="hljs-string">&quot; : 7,</span><br><span class="hljs-string">&quot;</span><span class="hljs-keyword">type</span><span class="hljs-string">&quot; : &quot;</span>&lt;IDEOGRAPHIC&gt;<span class="hljs-string">&quot;,</span><br><span class="hljs-string">&quot;</span>position<span class="hljs-string">&quot; : 2</span><br><span class="hljs-string">&#125;,</span><br><span class="hljs-string">&#123;</span><br><span class="hljs-string">&quot;</span>token<span class="hljs-string">&quot; : &quot;</span>国歌<span class="hljs-string">&quot;,</span><br><span class="hljs-string">&quot;</span>start_offset<span class="hljs-string">&quot; : 7,</span><br><span class="hljs-string">&quot;</span>end_offset<span class="hljs-string">&quot; : 9,</span><br><span class="hljs-string">&quot;</span><span class="hljs-keyword">type</span><span class="hljs-string">&quot; : &quot;</span>&lt;IDEOGRAPHIC&gt;<span class="hljs-string">&quot;,</span><br><span class="hljs-string">&quot;</span>position<span class="hljs-string">&quot; : 3</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">]</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string"># curl -X POST &#x27;http://192.168.10.106:9200/_analyze?pretty=true&#x27; -H &#x27;content-type:</span><br><span class="hljs-string"></span><br><span class="hljs-string">application/json&#x27; -d &#x27;&#123;</span><br><span class="hljs-string">&quot;</span>analyzer<span class="hljs-string">&quot;: &quot;</span>smartcn<span class="hljs-string">&quot;,</span><br><span class="hljs-string">&quot;</span>text<span class="hljs-string">&quot;: &quot;</span>中华人民共和国国歌<span class="hljs-string">&quot;</span><br><span class="hljs-string">&#125;&#x27;</span><br><span class="hljs-string">---- 下面是显示的内容</span><br><span class="hljs-string">&#123;</span><br><span class="hljs-string">&quot;</span>tokens<span class="hljs-string">&quot; : [</span><br><span class="hljs-string">&#123;</span><br><span class="hljs-string">&quot;</span>token<span class="hljs-string">&quot; : &quot;</span>中华人民共和国<span class="hljs-string">&quot;,</span><br><span class="hljs-string">&quot;</span>start_offset<span class="hljs-string">&quot; : 0,</span><br><span class="hljs-string">&quot;</span>end_offset<span class="hljs-string">&quot; : 7,</span><br><span class="hljs-string">&quot;</span><span class="hljs-keyword">type</span><span class="hljs-string">&quot; : &quot;</span>word<span class="hljs-string">&quot;,</span><br><span class="hljs-string">&quot;</span>position<span class="hljs-string">&quot; : 0</span><br><span class="hljs-string">&#125;,</span><br><span class="hljs-string">&#123;</span><br><span class="hljs-string">&quot;</span>token<span class="hljs-string">&quot; : &quot;</span>国歌<span class="hljs-string">&quot;,</span><br><span class="hljs-string">&quot;</span>start_offset<span class="hljs-string">&quot; : 7,</span><br><span class="hljs-string">&quot;</span>end_offset<span class="hljs-string">&quot; : 9,</span><br><span class="hljs-string">&quot;</span><span class="hljs-keyword">type</span><span class="hljs-string">&quot; : &quot;</span>word<span class="hljs-string">&quot;,</span><br><span class="hljs-string">&quot;</span>position<span class="hljs-string">&quot; : 1</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">]</span><br><span class="hljs-string">&#125;</span><br></code></pre></td></tr></table></figure><br><h3 id="head插件安装"><a href="#head插件安装" class="headerlink" title="head插件安装"></a><strong>head插件安装</strong></h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs awk">简介<br><br>  head插件，在elasticsearch中，应用的还算可以，但是自动<span class="hljs-number">2</span>.x之后的版本，就不再支持了，需要我们自己来进行独立的部署。<br> <br>  代码资料：https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/mobz/</span>elasticsearch-head<br><br>准备工作<br>apt install npm git -y<br><br>安装插件<br>mkdir <span class="hljs-regexp">/data/</span>server<span class="hljs-regexp">/elasticsearch/</span>plugins -p<br>cd <span class="hljs-regexp">/data/</span>server<span class="hljs-regexp">/elasticsearch/</span>plugins<br>git clone git:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/mobz/</span>elasticsearch-head.git<br>cd elasticsearch-head<br>npm config set registry https:<span class="hljs-regexp">//</span>registry.npm.taobao.org<br>npm install --force<br><br>配置软件的访问地址<br><br><span class="hljs-comment"># vim Gruntfile.js</span><br>...<br>connect: &#123;<br>server: &#123;<br>options: &#123;<br>hostname: <span class="hljs-string">&#x27;*&#x27;</span>, <span class="hljs-comment"># 增加这一行</span><br>port: <span class="hljs-number">9100</span>,<br>base: <span class="hljs-string">&#x27;.&#x27;</span>,<br>keepalive: true<br>&#125;<br>&#125;<br>&#125;<br>...<br>配置插件访问es<br><br><span class="hljs-comment"># vim _site/app.js</span><br>...<br><span class="hljs-number">4372</span> this._super();<br><span class="hljs-number">4373</span> this.prefs = services.Preferences.instance();<br><span class="hljs-number">4374</span> this.base_uri = this.config.base_uri ||<br>this.prefs.get(<span class="hljs-string">&quot;app-base_uri&quot;</span>) || <span class="hljs-string">&quot; http://192.168.10.106:9200&quot;</span>; <span class="hljs-comment"># 修改连接es的连接地址</span><br>...<br>启动服务<br>npm run start &gt;&gt;<span class="hljs-regexp">/dev/</span>null <span class="hljs-number">2</span>&gt;&amp;<span class="hljs-number">1</span> &amp;<br>检查效果<br><br><span class="hljs-comment"># netstat -tnulp | egrep &#x27;Add|grunt&#x27;</span><br>Proto Recv-Q Send-Q Local Address Foreign Address State<br>PID/Program name<br>tcp6 <span class="hljs-number">0</span> <span class="hljs-number">0</span> :::<span class="hljs-number">9100</span> :::* LISTEN<br><span class="hljs-number">19818</span>/grunt<br></code></pre></td></tr></table></figure><br><p><strong>head插件图</strong></p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linux/elks/image-20211115150016025.png" alt="image-20211115150016025"></p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs x86asm">属性解析：<br>一定要先保证连接按钮左侧的<span class="hljs-built_in">es</span>地址是正确的，然后再来点击<span class="hljs-string">&quot;连接&quot;</span><br>* 代表索引<span class="hljs-built_in">es</span>的主节点，黑色加粗的方框<span class="hljs-number">0</span>表示，索引的主副本。<br>  黄色代表有从分片丢失，但是没有主分片数据丢失，即当前没有数据丢失。<br>  红色代表主分配丢失，即有数据丢失；绿色代表所有主分片和从分片的数据正常<br></code></pre></td></tr></table></figure><br><p><strong>服务启动脚本</strong></p><p><strong>启动脚本</strong></p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs gradle"># cat <span class="hljs-regexp">/data/</span>scripts/elasticsearch_head.sh<br>#!<span class="hljs-regexp">/bin/</span>bash<br># 启动elasticsearch 脚本<br>cd <span class="hljs-regexp">/data/</span>server<span class="hljs-regexp">/elasticsearch/</span>plugins/elasticsearch-head<br>npm run start &gt;&gt;<span class="hljs-regexp">/dev/</span><span class="hljs-keyword">null</span> <span class="hljs-number">2</span>&gt;&amp;<span class="hljs-number">1</span><br># vim <span class="hljs-regexp">/lib/</span>systemd<span class="hljs-regexp">/system/</span>elasticsearch_head.service<br>[Unit]<br><span class="hljs-keyword">Description</span>= elasticsearch head server <span class="hljs-keyword">project</span><br>[Service]<br>User=root<br>ExecStart=<span class="hljs-regexp">/bin/</span>bash <span class="hljs-regexp">/data/</span>scripts/elasticsearch_head.sh<br>TimeoutStopSec=<span class="hljs-number">10</span><br>Restart=on-failure<br>RestartSec=<span class="hljs-number">5</span><br>[Install]<br>WantedBy=multi-user.target<br>启动服务<br>systemctl daemon-reload<br>systemctl start elasticsearch_head.service<br>systemctl status elasticsearch_head.service<br></code></pre></td></tr></table></figure><br><hr><p>小结</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs awk">elasticsearch 几乎所有的特色功能都是以插件的样式来整合的<br>elasticsearch-plugin install | remove | list<br><br>默认情况下，这些插件安装在了 <br><span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/elasticsearch/</span>plugins<br><br>这些插件安装完毕后，需要重新启动环境，才会生效<br><br>关键插件<br>head插件，是需要独立部署的，可以不安装到 plugins<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ElasticStack</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Ubuntu</tag>
      
      <tag>运维实战</tag>
      
      <tag>日志收集</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MHA高可用部署 — 故障模拟及故障处理</title>
    <link href="/2020/07/23/dba09-1/"/>
    <url>/2020/07/23/dba09-1/</url>
    
    <content type="html"><![CDATA[<hr><h1 id="MHA配合Atlas实现读写分离"><a href="#MHA配合Atlas实现读写分离" class="headerlink" title="MHA配合Atlas实现读写分离"></a>MHA配合Atlas实现读写分离</h1><p>[[toc]]</p>]]></content>
    
    
    <categories>
      
      <category>DBA</category>
      
    </categories>
    
    
    <tags>
      
      <tag>DBA</tag>
      
      <tag>RDBMS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MHA高可用部署 — MHA配合Atlas实现读写分离</title>
    <link href="/2020/07/23/dba09-2/"/>
    <url>/2020/07/23/dba09-2/</url>
    
    <content type="html"><![CDATA[<hr><h1 id="MHA配合Atlas实现读写分离"><a href="#MHA配合Atlas实现读写分离" class="headerlink" title="MHA配合Atlas实现读写分离"></a>MHA配合Atlas实现读写分离</h1><p>[[toc]]</p>]]></content>
    
    
    <categories>
      
      <category>DBA</category>
      
    </categories>
    
    
    <tags>
      
      <tag>DBA</tag>
      
      <tag>RDBMS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>主从复制高级进阶</title>
    <link href="/2020/07/22/dba08-1/"/>
    <url>/2020/07/22/dba08-1/</url>
    
    <content type="html"><![CDATA[<hr><h1 id="主从复制高级进阶"><a href="#主从复制高级进阶" class="headerlink" title="主从复制高级进阶"></a>主从复制高级进阶</h1><p>[[toc]]</p><h2 id="1-上节回顾"><a href="#1-上节回顾" class="headerlink" title="1.上节回顾"></a>1.上节回顾</h2><h3 id="1-1-binlog-format"><a href="#1-1-binlog-format" class="headerlink" title="1.1   binlog_format"></a>1.1   binlog_format</h3><ul><li><p>SBR   update t1 set name=’zs’ where id&gt;50; 更新50条数据 记录1条命令</p></li><li><p>RBR  记录50行日志</p></li><li><p>MBR  由系统自动选择</p></li></ul><br><br><h3 id="1-2-主从故障"><a href="#1-2-主从故障" class="headerlink" title="1.2  主从故障"></a>1.2  主从故障</h3><br><p><strong>IO线程故障</strong> </p><ul><li>连主库<br>取日志<br>存到 relaylog</li></ul><p><strong>SQL 线程</strong></p><ul><li>回放拿过来的日志</li></ul><br><br><h3 id="1-3-主从延时"><a href="#1-3-主从延时" class="headerlink" title="1.3  主从延时"></a>1.3  主从延时</h3><p>需要在两方面解决由于单进程和串行处理导致的主从延迟问题。</p><br><p><strong>主库</strong>: </p><p><strong>DUMP_T</strong> 线程  默认串行执行</p><p>参数：<code>show variables like &#39;group_commit%&#39;;</code>  允许主库等一段时间一起提交给从库</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section8-2-1.png" alt="从库只读"></p><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">--使用 gtid </span><br>sync_binlog<br>binlog_group_commit_sync_delay <span class="hljs-comment">--等待时间毫秒</span><br>binlog_group_commit_sync_no_delay_count <span class="hljs-comment">--累计多少个</span><br></code></pre></td></tr></table></figure><br><br><p><strong>从库</strong>:</p><p><strong>SQL</strong> 线程 :  5.7 GTID MTS  默认只有一个线程进行回放,由于从库是单SQL线程,导致,不管传的日志有多少,只能一次执行一个事务。<br></p><p><strong>5.6 版本</strong>,有了GTID,可以实现多SQL线程,但是只能基于不同库的事务进行并发回放.(database)  （不能保证同一库内事务无法保证顺序按一定逻辑顺序执行）。<br></p><p> <strong>5.7 版本</strong>中,有了增强的GTID,增加了seq_no（通线程下的序列号码）标记,增加了新型的并发SQL线程模式(logical_clock 逻辑时钟),MTS技术   。<br></p><p><strong>查看从库的SQL工作线程</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">show</span> variables <span class="hljs-keyword">like</span> <span class="hljs-string">&#x27;%worker%&#x27;</span>;<br></code></pre></td></tr></table></figure><br><h3 id="1-4-主从延时的监控"><a href="#1-4-主从延时的监控" class="headerlink" title="1.4 主从延时的监控"></a>1.4 主从延时的监控</h3><br><p>主从延迟相关检查参数</p><br><p><strong>(1) 检查主从有没有的问题?</strong></p><p><code>Seconds_Behind_Master: 0</code></p><br><p><strong>(2) 有没有主库原因?</strong></p><p><code>Master_Log_File: mysql-bin.000003</code><br><code>Read_Master_Log_Pos: 154</code></p><p><code>| mysql-bin.000003 |      154</code></p><br><p><strong>(3) 有没有及时回放</strong></p><p><code>Master_Log_File: mysql-bin.000003</code><br><code>Read_Master_Log_Pos: 154</code></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sh">cat relay-log.info <br>./db01-relay-bin.000009<br>367<br>mysql-bin.000003<br>154<br></code></pre></td></tr></table></figure><br><br><h2 id="2-主从复制高级进阶"><a href="#2-主从复制高级进阶" class="headerlink" title="2. 主从复制高级进阶"></a>2. 主从复制高级进阶</h2><h3 id="2-1-延时从库"><a href="#2-1-延时从库" class="headerlink" title="2.1 延时从库"></a>2.1 延时从库</h3><p><strong>介绍及配置</strong></p><br><p><strong>主要使 SQL线程延时</strong>:  数据已经写入relaylog中了,SQL线程”慢点”运行<br>一般企业建议3-6小时,具体看公司运维人员对于故障的反应时间</p><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span>stop slave;<br>mysql<span class="hljs-operator">&gt;</span>CHANGE MASTER <span class="hljs-keyword">TO</span> MASTER_DELAY <span class="hljs-operator">=</span> <span class="hljs-number">300</span>;<br>mysql<span class="hljs-operator">&gt;</span><span class="hljs-keyword">start</span> slave;<br></code></pre></td></tr></table></figure><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">show</span> slave status \G<br>SQL_Delay: <span class="hljs-number">300</span><br>SQL_Remaining_Delay: <span class="hljs-keyword">NULL</span> 最近的日志还差多少秒执行<br></code></pre></td></tr></table></figure><h3 id="2-2-延时从库处理逻辑故障"><a href="#2-2-延时从库处理逻辑故障" class="headerlink" title="2.2  延时从库处理逻辑故障"></a>2.2  延时从库处理逻辑故障</h3><p><strong>延时从库的恢复思路</strong> （用于从延迟从库的回放日志中恢复主库误删数据）</p><p>(1) 监控到数据库逻辑故障<br>(2) 停从库SQL线程,记录已经回放的位置点(截取日志起点)</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql">stop slave sql_thread ;<br><span class="hljs-keyword">show</span> slave status \G<br>Relay_Log_File: db01<span class="hljs-operator">-</span>relay<span class="hljs-operator">-</span>bin<span class="hljs-number">.000002</span><br>Relay_Log_Pos: <span class="hljs-number">320</span><br></code></pre></td></tr></table></figure><p>(3) 截取relaylog</p><p><strong>起点</strong>:     </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">show</span> slave status \G<br>Relay_Log_File ,Relay_Log_Pos<br></code></pre></td></tr></table></figure><p><strong>终点</strong>:  主库drop之前的位置点</p><pre><code>show relaylog events in &#39;&#39;    进行截取</code></pre><p>(4) 模拟SQL线程回访日志</p><p>​    <strong>从库</strong>  source  导入经过截取的回放日志</p><p>(5) 恢复业务</p><p><strong>情况一</strong>: 就一个库的话</p><p>从库替代主库工作</p><p><strong>情况二</strong>:<br>    从库导出故障库,还原到主库中.</p><br><br><h4 id="2-2-1-故障演练"><a href="#2-2-1-故障演练" class="headerlink" title="2.2.1 故障演练"></a>2.2.1 故障演练</h4><br><p><strong>主库</strong> : 模拟误删数据库操作</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> database delay charset utf8mb4;<br>use delay;<br><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> t1 (id <span class="hljs-type">int</span>);<br><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> t1 <span class="hljs-keyword">values</span>(<span class="hljs-number">1</span>),(<span class="hljs-number">2</span>),(<span class="hljs-number">3</span>);<br><span class="hljs-keyword">commit</span>;<br><span class="hljs-keyword">drop</span> database delay;<br></code></pre></td></tr></table></figure><br><p><strong>从库</strong>:</p><p>1.停止从库SQL 线程,获取relay的位置点 626</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> stop slave sql_thread;<br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">show</span> slave status \G<br><span class="hljs-comment">--获取起点位置</span><br>Relay_Log_File: db01<span class="hljs-operator">-</span>relay<span class="hljs-operator">-</span>bin<span class="hljs-number">.000002</span><br>Relay_Log_Pos: <span class="hljs-number">626</span><br></code></pre></td></tr></table></figure><p>2.找到relay的截取终点</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">show</span> relaylog events <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;db01-relay-bin.000002&#x27;</span>;<br><span class="hljs-operator">|</span>db01<span class="hljs-operator">-</span>relay<span class="hljs-operator">-</span>bin<span class="hljs-number">.000002</span><span class="hljs-operator">|</span><span class="hljs-number">1299</span><span class="hljs-operator">|</span>Query<span class="hljs-operator">|</span><span class="hljs-number">7</span><span class="hljs-operator">|</span><span class="hljs-number">1228</span><span class="hljs-operator">|</span> <span class="hljs-keyword">drop</span> database delay<br><span class="hljs-comment">--截取1299 不用看右边</span><br></code></pre></td></tr></table></figure><p>​      </p><p>3.截取relay</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">cd</span> /data/3308/data/<br>mysqlbinlog --start-position=626 --stop-position=1299 db01-relay-bin.000002 &gt;/tmp/relay.sql<br><span class="hljs-comment">#起点626 终点1299</span><br></code></pre></td></tr></table></figure><p>4.恢复relay到从库</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql <span class="hljs-operator">-</span>uroot <span class="hljs-operator">-</span>p <span class="hljs-operator">-</span>S <span class="hljs-operator">/</span>data<span class="hljs-operator">/</span><span class="hljs-number">3308</span><span class="hljs-operator">/</span>mysql.sock <br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">set</span> sql_log_bin<span class="hljs-operator">=</span><span class="hljs-number">0</span>;<br>mysql<span class="hljs-operator">&gt;</span> source <span class="hljs-operator">/</span>tmp<span class="hljs-operator">/</span>relay.sql<br></code></pre></td></tr></table></figure><p>从库恢复逻辑损坏比直接在主库用备份恢复要快</p><br><br><h3 id="2-3-过滤复制"><a href="#2-3-过滤复制" class="headerlink" title="2.3 过滤复制"></a>2.3 过滤复制</h3><p>快速恢复测试环境</p><p><strong>从库</strong> :</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql <span class="hljs-operator">-</span>S <span class="hljs-operator">/</span>data<span class="hljs-operator">/</span><span class="hljs-number">3308</span><span class="hljs-operator">/</span>mysql.sock<br><span class="hljs-keyword">drop</span> database delay ;<br>stop slave;<br>reset slave <span class="hljs-keyword">all</span>; 清掉主库信息<br></code></pre></td></tr></table></figure><p><strong>主库</strong>: </p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">mysql -S /data/33078/mysql.sock<br>reset master;<br></code></pre></td></tr></table></figure><p><strong>从库</strong>: </p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">mysql -S /data/3308/mysql.sock <br></code></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sql">CHANGE MASTER <span class="hljs-keyword">TO</span> <br>MASTER_HOST<span class="hljs-operator">=</span><span class="hljs-string">&#x27;10.0.0.51&#x27;</span>,<br>MASTER_USER<span class="hljs-operator">=</span><span class="hljs-string">&#x27;repl&#x27;</span>,<br>MASTER_PASSWORD<span class="hljs-operator">=</span><span class="hljs-string">&#x27;123&#x27;</span>,<br>MASTER_PORT<span class="hljs-operator">=</span><span class="hljs-number">3307</span>,<br>MASTER_LOG_FILE<span class="hljs-operator">=</span><span class="hljs-string">&#x27;mysql-bin.000001&#x27;</span>,<br>MASTER_LOG_POS<span class="hljs-operator">=</span><span class="hljs-number">154</span>,<br>MASTER_CONNECT_RETRY<span class="hljs-operator">=</span><span class="hljs-number">10</span>;<br><span class="hljs-keyword">start</span> slave;<br></code></pre></td></tr></table></figure><br><br><p>选择复制的单个 库或表</p><p><strong>主库</strong>: </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">show</span> master status ;<br>binlog_do_db      <span class="hljs-comment">--白名单</span><br>binlog_ignore_db   <span class="hljs-comment">--黑名单</span><br></code></pre></td></tr></table></figure><p><strong>从库</strong>: </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">show</span> slave status \G<br>Replicate_Do_DB:             <span class="hljs-comment">--库级别 白名单</span><br>Replicate_Ignore_DB:         <span class="hljs-comment">--黑名单</span><br><br>Replicate_Do_Table:          <span class="hljs-comment">--表级别 白名单</span><br>Replicate_Ignore_Table:      <span class="hljs-comment">--黑名单</span><br><br>Replicate_Wild_Do_Table:     <span class="hljs-comment">--模糊 白名单</span><br>Replicate_Wild_Ignore_Table: <span class="hljs-comment">--黑名单</span><br></code></pre></td></tr></table></figure><p><strong>例子</strong>: 只复制REPL库</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">vim /etc/my.cnf<br>replicate_do_db=repl<br>systemctl restart mysqld3308<br></code></pre></td></tr></table></figure><br><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section8-2-2.png" alt="从库过滤复制"></p><br><h3 id="2-4-GTID-复制"><a href="#2-4-GTID-复制" class="headerlink" title="2.4  GTID 复制"></a>2.4  GTID 复制</h3><p><strong>应用介绍</strong></p><p><strong>GTID</strong> (Global Transaction ID)是对于一个已提交事务的唯一编号，并且是一个全局(主从复制)唯一的编号。</p><p><strong>它的官方定义如下</strong>：<br></p><p><code>GTID = source_id</code> ：<code>transaction_id</code><br><code>7E11FA47-31CA-19E1-9E56-C43AA21293967:29</code></p><br>**什么是sever_uuid，和Server-id 区别**？<p><strong>核心特性</strong>: 全局唯一,具备幂等性</p><br><br><p><strong>GTID 核心参数</strong></p><p>重要参数：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql">gtid<span class="hljs-operator">-</span>mode<span class="hljs-operator">=</span><span class="hljs-keyword">on</span>                                <span class="hljs-comment">--启用gtid类型，否则就是普通的复制架构</span><br>enforce<span class="hljs-operator">-</span>gtid<span class="hljs-operator">-</span>consistency<span class="hljs-operator">=</span><span class="hljs-literal">true</span>               <span class="hljs-comment">--强制GTID的一致性   必加</span><br>log<span class="hljs-operator">-</span>slave<span class="hljs-operator">-</span>updates<span class="hljs-operator">=</span><span class="hljs-number">1</span>                         <span class="hljs-comment">--slave 更新是否记入日志   强制刷新binlog</span><br></code></pre></td></tr></table></figure><br><h3 id="2-5-GTID复制配置过程"><a href="#2-5-GTID复制配置过程" class="headerlink" title="2.5 GTID复制配置过程"></a>2.5 GTID复制配置过程</h3><br><p>(1) 清理环境</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql">pkill mysqld<br>\rm <span class="hljs-operator">-</span>rf <span class="hljs-operator">/</span>data<span class="hljs-operator">/</span>mysql<span class="hljs-operator">/</span>data<span class="hljs-comment">/*</span><br><span class="hljs-comment">\rm -rf /data/binlog/*</span><br></code></pre></td></tr></table></figure><br><p>(2) 准备配置文件</p><p><strong>主库db01</strong>：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs sh">cat &gt; /etc/my.cnf &lt;&lt;<span class="hljs-string">EOF</span><br><span class="hljs-string">[mysqld]</span><br><span class="hljs-string">basedir=/application/mysql/</span><br><span class="hljs-string">datadir=/data/mysql/data</span><br><span class="hljs-string">socket=/tmp/mysql.sock</span><br><span class="hljs-string">server_id=51</span><br><span class="hljs-string">port=3306</span><br><span class="hljs-string">secure-file-priv=/tmp</span><br><span class="hljs-string">autocommit=0</span><br><span class="hljs-string">log_bin=/data/binlog/mysql-bin</span><br><span class="hljs-string">binlog_format=row</span><br><span class="hljs-string">gtid-mode=on</span><br><span class="hljs-string">enforce-gtid-consistency=true</span><br><span class="hljs-string">log-slave-updates=1</span><br><span class="hljs-string">[mysql]</span><br><span class="hljs-string">prompt=db01 [\\d]&gt; </span><br><span class="hljs-string">EOF</span> <br></code></pre></td></tr></table></figure><p><code>prompt=db01 [\\d]&gt;</code> <strong>作用</strong>：定制连接进去的窗口连接会话名字  <code>\\d</code>显示当前库</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section8-2-3.png" alt="扩展mysql界面"></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs routeros">slave1(db02)：<br>cat &gt; /etc/my.cnf &lt;&lt;EOF<br>[mysqld]<br><span class="hljs-attribute">basedir</span>=/application/mysql<br><span class="hljs-attribute">datadir</span>=/data/mysql/data<br><span class="hljs-attribute">socket</span>=/tmp/mysql.sock<br><span class="hljs-attribute">server_id</span>=52<br><span class="hljs-attribute">port</span>=3306<br><span class="hljs-attribute">secure-file-priv</span>=/tmp<br><span class="hljs-attribute">autocommit</span>=0<br><span class="hljs-attribute">log_bin</span>=/data/binlog/mysql-bin<br><span class="hljs-attribute">binlog_format</span>=row<br><span class="hljs-attribute">gtid-mode</span>=on<br><span class="hljs-attribute">enforce-gtid-consistency</span>=<span class="hljs-literal">true</span><br><span class="hljs-attribute">log-slave-updates</span>=1<br>[mysql]<br><span class="hljs-attribute">prompt</span>=db02 [\\d]&gt;<br>EOF<br></code></pre></td></tr></table></figure><p><code>\d:</code> 当前数据库连接客户端时通过参数指定。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs sql">slave2(db03)：<br>cat <span class="hljs-operator">&gt;</span> <span class="hljs-operator">/</span>etc<span class="hljs-operator">/</span>my.cnf <span class="hljs-operator">&lt;&lt;</span>EOF<br>[mysqld]<br>basedir<span class="hljs-operator">=</span><span class="hljs-operator">/</span>application<span class="hljs-operator">/</span>mysql<br>datadir<span class="hljs-operator">=</span><span class="hljs-operator">/</span>data<span class="hljs-operator">/</span>mysql<span class="hljs-operator">/</span>data<br>socket<span class="hljs-operator">=</span><span class="hljs-operator">/</span>tmp<span class="hljs-operator">/</span>mysql.sock<br>server_id<span class="hljs-operator">=</span><span class="hljs-number">53</span><br>port<span class="hljs-operator">=</span><span class="hljs-number">3306</span><br>secure<span class="hljs-operator">-</span>file<span class="hljs-operator">-</span>priv<span class="hljs-operator">=</span><span class="hljs-operator">/</span>tmp<br>autocommit<span class="hljs-operator">=</span><span class="hljs-number">0</span><br>log_bin<span class="hljs-operator">=</span><span class="hljs-operator">/</span>data<span class="hljs-operator">/</span>binlog<span class="hljs-operator">/</span>mysql<span class="hljs-operator">-</span>bin<br>binlog_format<span class="hljs-operator">=</span><span class="hljs-type">row</span><br>gtid<span class="hljs-operator">-</span>mode<span class="hljs-operator">=</span><span class="hljs-keyword">on</span><br>enforce<span class="hljs-operator">-</span>gtid<span class="hljs-operator">-</span>consistency<span class="hljs-operator">=</span><span class="hljs-literal">true</span><br>log<span class="hljs-operator">-</span>slave<span class="hljs-operator">-</span>updates<span class="hljs-operator">=</span><span class="hljs-number">1</span><br>[mysql]<br>prompt<span class="hljs-operator">=</span>db03 [\\d]<span class="hljs-operator">&gt;</span><br>EOF<br></code></pre></td></tr></table></figure><p>(3) 初始化数据</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">mysqld --initialize-insecure --user=mysql --basedir=/application/mysql  --datadir=/data/mysql/data <br></code></pre></td></tr></table></figure><p>(4) 启动数据库</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">/etc/init.d/mysqld start<br></code></pre></td></tr></table></figure><p>(5) 构建主从：<br></p><p>IP地址 主机名：</p><ul><li>master:51<br>slave:52,53</li></ul><p><strong>51主</strong>:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">grant</span> replication slave  <span class="hljs-keyword">on</span> <span class="hljs-operator">*</span>.<span class="hljs-operator">*</span> <span class="hljs-keyword">to</span> repl@<span class="hljs-string">&#x27;10.0.0.%&#x27;</span> identified <span class="hljs-keyword">by</span> <span class="hljs-string">&#x27;123&#x27;</span>;<br></code></pre></td></tr></table></figure><p><strong>52\53</strong>: <strong>从库</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql">change master <span class="hljs-keyword">to</span> <br>master_host<span class="hljs-operator">=</span><span class="hljs-string">&#x27;10.0.0.51&#x27;</span>,<br>master_user<span class="hljs-operator">=</span><span class="hljs-string">&#x27;repl&#x27;</span>,<br>master_password<span class="hljs-operator">=</span><span class="hljs-string">&#x27;123&#x27;</span> ,<br>MASTER_AUTO_POSITION<span class="hljs-operator">=</span><span class="hljs-number">1</span>;  <span class="hljs-comment">--自动检查本地和远程设置GTID号码  ，读取relaylog最后一个事务的GTID。只要gtid号比从库新就推过来</span><br><span class="hljs-keyword">start</span> slave;<br></code></pre></td></tr></table></figure><br><h3 id="2-6-GTID-复制和普通复制的区别"><a href="#2-6-GTID-复制和普通复制的区别" class="headerlink" title="2.6 GTID 复制和普通复制的区别"></a>2.6 GTID 复制和普通复制的区别</h3><p>（0）在主从复制环境中，主库发生过的事务，在全局都是由唯一GTID记录的，更方便Failover<br><br>（1）额外功能参数（3个）<br><br>（2）change master to 的时候不再需要binlog 文件名和position号,MASTER_AUTO_POSITION=1;<br><br>（3）在复制过程中，从库不再依赖master.info文件，而是直接读取最后一个relaylog的 GTID号<br><br>（4） mysqldump备份时，默认会将备份中包含的事务操作，以下方式:<br></p><p><code>SET @@GLOBAL.GTID_PURGED=&#39;8c49d7ec-7e78-11e8-9638-000c29ca725d:1-11&#39;;</code></p><p>告诉从库，我的备份中已经有以上事务，你就不用运行了，直接从下一个GTID开始请求binlog就行。<br></p><br><p><strong><code>mysqldump --set-gitd-purged=off</code> 这个参数加了就构建不了主从</strong></p><br><br><h2 id="3-半同步"><a href="#3-半同步" class="headerlink" title="3.半同步"></a>3.半同步</h2><p>主库做完的从库不一定做，从库宕机<br></p><p>用于解决主从复制数据一致性问题.<br></p><p>主库的 ACK_reciver 线程专门在应用层面增加反馈机制.<br></p><p>从库relay log 落地写入磁盘会发送ACK确认 ,IO线程会返回一个ACK,主库事务才能提交.<br></p><p>如果一直ACK没收到,超过10秒钟会切换为异步复制.   放弃事务。<br></p>]]></content>
    
    
    <categories>
      
      <category>DBA</category>
      
    </categories>
    
    
    <tags>
      
      <tag>DBA</tag>
      
      <tag>RDBMS</tag>
      
      <tag>主从复制</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MHA 高可用部署</title>
    <link href="/2020/07/22/dba09/"/>
    <url>/2020/07/22/dba09/</url>
    
    <content type="html"><![CDATA[<hr><h1 id="MHA-高可用部署"><a href="#MHA-高可用部署" class="headerlink" title="MHA 高可用部署"></a>MHA 高可用部署</h1><p>[[toc]]</p><h2 id="1-搭建MHA"><a href="#1-搭建MHA" class="headerlink" title="1.搭建MHA"></a>1.搭建MHA</h2><br><p>(1) <strong>配置关键程序软连接</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">ln -s /data/mysql/bin/mysqlbinlog    /usr/bin/mysqlbinlog<br>ln -s /data/mysql/bin/mysql          /usr/bin/mysql<br></code></pre></td></tr></table></figure><p>因为MHA软件里面默认路径就是/usr/bin下。</p><br><p>(2) <strong>配置互信</strong></p><p><strong>db01</strong>：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sh">rm -rf /root/.ssh <br>ssh-keygen<br><span class="hljs-built_in">cd</span> /root/.ssh <br>mv id_rsa.pub authorized_keys<br>scp  -r  /root/.ssh  10.0.0.52:/root <br>scp  -r  /root/.ssh  10.0.0.53:/root <br></code></pre></td></tr></table></figure><p><strong>各节点验证</strong></p><br><p>db01:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">ssh 10.0.0.51 date<br>ssh 10.0.0.52 date<br>ssh 10.0.0.53 date<br></code></pre></td></tr></table></figure><br><p>db02:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">ssh 10.0.0.51 date<br>ssh 10.0.0.52 date<br>ssh 10.0.0.53 date<br></code></pre></td></tr></table></figure><p><br>db03:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">ssh 10.0.0.51 date<br>ssh 10.0.0.52 date<br>ssh 10.0.0.53 date<br></code></pre></td></tr></table></figure><br><p>(3)安装软件包 (所有节点)</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">yum install perl-DBD-MySQL -y<br>rpm -ivh mha4mysql-node-0.56-0.el6.noarch.rpm<br></code></pre></td></tr></table></figure><br><p>(4) 在db01主库中创建mha需要的用户</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">grant</span> <span class="hljs-keyword">all</span> privileges <span class="hljs-keyword">on</span> <span class="hljs-operator">*</span>.<span class="hljs-operator">*</span> <span class="hljs-keyword">to</span> mha@<span class="hljs-string">&#x27;10.0.0.%&#x27;</span> identified <span class="hljs-keyword">by</span> <span class="hljs-string">&#x27;mha&#x27;</span>;<br></code></pre></td></tr></table></figure><br><p>(5) Manager 节点软件安装（db03）</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql">yum install <span class="hljs-operator">-</span>y perl<span class="hljs-operator">-</span>Config<span class="hljs-operator">-</span>Tiny epel<span class="hljs-operator">-</span><span class="hljs-keyword">release</span> perl<span class="hljs-operator">-</span>Log<span class="hljs-operator">-</span>Dispatch perl<span class="hljs-operator">-</span>Parallel<span class="hljs-operator">-</span>ForkManager perl<span class="hljs-operator">-</span><span class="hljs-type">Time</span><span class="hljs-operator">-</span>HiRes<br>rpm <span class="hljs-operator">-</span>ivh mha4mysql<span class="hljs-operator">-</span>manager<span class="hljs-number">-0.56</span><span class="hljs-number">-0.</span>el6.noarch.rpm<br></code></pre></td></tr></table></figure><br><p>(6) 配置文件准备(db03)</p><p>创建配置文件目录</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">mkdir -p /etc/mha<br></code></pre></td></tr></table></figure><p>创建日志目录</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">mkdir -p /var/<span class="hljs-built_in">log</span>/mha/app1<br></code></pre></td></tr></table></figure><p>​<br>编辑mha配置文件</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs sh">cat &gt; /etc/mha/app1.cnf &lt;&lt;<span class="hljs-string">EOF</span><br><span class="hljs-string">[server default]</span><br><span class="hljs-string">manager_log=/var/log/mha/app1/manager        </span><br><span class="hljs-string">manager_workdir=/var/log/mha/app1            </span><br><span class="hljs-string">master_binlog_dir=/data/binlog       </span><br><span class="hljs-string">user=mha                                   </span><br><span class="hljs-string">password=mha                               </span><br><span class="hljs-string">ping_interval=2</span><br><span class="hljs-string">repl_password=123</span><br><span class="hljs-string">repl_user=repl</span><br><span class="hljs-string">ssh_user=root                               </span><br><span class="hljs-string">[server1]                                   </span><br><span class="hljs-string">hostname=10.0.0.51</span><br><span class="hljs-string">port=3306                                  </span><br><span class="hljs-string">[server2]            </span><br><span class="hljs-string">hostname=10.0.0.52</span><br><span class="hljs-string">port=3306</span><br><span class="hljs-string">[server3]</span><br><span class="hljs-string">hostname=10.0.0.53</span><br><span class="hljs-string">port=3306</span><br><span class="hljs-string">EOF</span><br></code></pre></td></tr></table></figure><p>(7)  状态检查(db03)</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">masterha_check_ssh  --conf=/etc/mha/app1.cnf <br>masterha_check_repl  --conf=/etc/mha/app1.cnf <br></code></pre></td></tr></table></figure><p>(8) 开启MHA(db03)：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">nohup masterha_manager --conf=/etc/mha/app1.cnf --remove_dead_master_conf --ignore_last_failover  &lt; /dev/null&gt; /var/<span class="hljs-built_in">log</span>/mha/app1/manager.log 2&gt;&amp;1 &amp;<br></code></pre></td></tr></table></figure><p>(9)  查看MHA状态</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">masterha_check_status --conf=/etc/mha/app1.cnf<br></code></pre></td></tr></table></figure><br><h2 id="2-MHA-架构软件结构说明"><a href="#2-MHA-架构软件结构说明" class="headerlink" title="2. MHA 架构软件结构说明"></a>2. MHA 架构软件结构说明</h2><p><strong>节点规划</strong>:</p><ul><li><p><strong>manager端</strong>: db03</p></li><li><p><strong>node端</strong>: db01,db02,db03 装node软件</p></li><li><p>数据库节点, 必须至少是1主2从,独立数据库实例</p></li><li><p>MHA 管理节点，最好是独立一台机器</p></li></ul><br><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section9-1.png" alt="MHA节点构架"></p><p>MHA-Manager 管理节点 管理所有数据库节点：</p><p>最终达到目的 管理节点对所有数据库节点进行检测，当主库宕机时</p><br><h2 id="3-MHA软件的构成-perl语言"><a href="#3-MHA软件的构成-perl语言" class="headerlink" title="3. MHA软件的构成(perl语言)"></a>3. MHA软件的构成(perl语言)</h2><br><p><strong>Manager 工具包主要包括以下几个工具</strong>：</p><p><code>mha4mysql-manager-0.56-0.el6.noarch.rpm</code></p><p><strong>脚本</strong>：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sh">masterha_manger             <span class="hljs-comment">#启动MHA </span><br>masterha_stop --conf=/etc/mha/app1.cnf <span class="hljs-comment">#关闭MHA</span><br>masterha_check_ssh          <span class="hljs-comment">#检查MHA的SSH配置状况 </span><br>masterha_check_repl         <span class="hljs-comment">#检查MySQL复制状况 </span><br>masterha_master_monitor     <span class="hljs-comment">#检测master是否宕机 </span><br>masterha_check_status       <span class="hljs-comment">#检测当前MHA运行状态 </span><br>masterha_master_switch  <span class="hljs-comment">#控制故障转移（自动或者手动）</span><br>masterha_conf_host      <span class="hljs-comment">#添加或删除配置的server信息</span><br></code></pre></td></tr></table></figure><br><p><strong>Node工具包主要包括以下几个工具</strong>：</p><p><code>mha4mysql-node-0.56-0.el6.noarch.rpm</code></p><p>这些工具通常由MHA Manager的脚本触发，无需人为操作</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">save_binary_logs            <span class="hljs-comment">#保存和复制master的二进制日志 </span><br>apply_diff_relay_logs       <span class="hljs-comment">#识别差异的中继日志事件并将其差异的事件应用于其他的</span><br>purge_relay_logs            <span class="hljs-comment">#清除中继日志（不会阻塞SQL线程）</span><br></code></pre></td></tr></table></figure><br><h2 id="4-MHA-配置过程细节说明"><a href="#4-MHA-配置过程细节说明" class="headerlink" title="4.MHA 配置过程细节说明"></a>4.MHA 配置过程细节说明</h2><h3 id="4-1-软连接"><a href="#4-1-软连接" class="headerlink" title="4.1  软连接"></a>4.1  软连接</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sh">\rm -rf /usr/bin/mysqlbinlog<br>\rm -rf /usr/bin/mysql<br>ln -s /application/mysql/bin/mysqlbinlog    /usr/bin/mysqlbinlog<br>ln -s /application/mysql/bin/mysql          /usr/bin/mysql<br>ls -l /usr/bin/mysql<br>ls -l /usr/bin/mysqlbinlog <br></code></pre></td></tr></table></figure><br><h3 id="4-2-互信-多节点直接不需要用密码-："><a href="#4-2-互信-多节点直接不需要用密码-：" class="headerlink" title="4.2 互信 多节点直接不需要用密码 ："></a>4.2 互信 多节点直接不需要用密码 ：</h3><br><p>实现脚本免交互</p><p>db01：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sh">rm -rf /root/.ssh <br>ssh-keygen<br><span class="hljs-built_in">cd</span> /root/.ssh <br>mv id_rsa.pub authorized_keys <span class="hljs-comment">#默认定义的公钥名字</span><br>scp  -r  /root/.ssh  10.0.0.52:/root <br>scp  -r  /root/.ssh  10.0.0.53:/root <br></code></pre></td></tr></table></figure><br><p>更改公钥默认文件名:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">vim /etc/ssh/sshd_config <br>AuthorizedKeysFile  .ssh/authorized_key<br></code></pre></td></tr></table></figure><br><p><strong>各节点验证</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#db01:</span><br>ssh 10.0.0.51 date<br>ssh 10.0.0.52 date<br>ssh 10.0.0.53 date<br><br><span class="hljs-comment">#db02:</span><br>ssh 10.0.0.51 date<br>ssh 10.0.0.52 date<br>ssh 10.0.0.53 date<br><br><span class="hljs-comment">#db03:</span><br>ssh 10.0.0.51 date<br>ssh 10.0.0.52 date<br>ssh 10.0.0.53 date<br></code></pre></td></tr></table></figure><br><h3 id="4-3-安装软件包-所有节点"><a href="#4-3-安装软件包-所有节点" class="headerlink" title="4.3 安装软件包(所有节点)"></a>4.3 安装软件包(所有节点)</h3><br><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">yum</span> install perl-DBD-MySQL -y<br><span class="hljs-attribute">rpm</span> -ivh mha<span class="hljs-number">4</span>mysql-node-<span class="hljs-number">0</span>.<span class="hljs-number">56</span>-<span class="hljs-number">0</span>.el<span class="hljs-number">6</span>.noarch.rpm<br></code></pre></td></tr></table></figure><br><h3 id="4-4-在db01主库中创建mha需要的用户"><a href="#4-4-在db01主库中创建mha需要的用户" class="headerlink" title="4.4 在db01主库中创建mha需要的用户"></a>4.4 在db01主库中创建mha需要的用户</h3><br><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">grant</span> <span class="hljs-keyword">all</span> <span class="hljs-keyword">privileges</span> <span class="hljs-keyword">on</span> *.* <span class="hljs-keyword">to</span> mha@<span class="hljs-string">&#x27;10.0.0.%&#x27;</span> identified <span class="hljs-keyword">by</span> <span class="hljs-string">&#x27;mha&#x27;</span>;<br></code></pre></td></tr></table></figure><br><h3 id="4-5-Manager软件安装（db03）"><a href="#4-5-Manager软件安装（db03）" class="headerlink" title="4.5  Manager软件安装（db03）"></a>4.5  Manager软件安装（db03）</h3><br><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">yum</span> install -y perl-Config-Tiny epel-release perl-Log-Dispatch perl-Parallel-ForkManager perl-Time-HiRes<br><span class="hljs-attribute">rpm</span> -ivh mha<span class="hljs-number">4</span>mysql-manager-<span class="hljs-number">0</span>.<span class="hljs-number">56</span>-<span class="hljs-number">0</span>.el<span class="hljs-number">6</span>.noarch.rpm<br></code></pre></td></tr></table></figure><br><h3 id="4-6-配置文件准备-db03"><a href="#4-6-配置文件准备-db03" class="headerlink" title="4.6 配置文件准备(db03)"></a>4.6 配置文件准备(db03)</h3><br><p>– 创建配置文件目录</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">mkdir -p <span class="hljs-regexp">/etc/m</span>ha<br></code></pre></td></tr></table></figure><p>– 创建日志目录</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">mkdir -p <span class="hljs-regexp">/var/</span>log<span class="hljs-regexp">/mha/</span>app1<br></code></pre></td></tr></table></figure><p>– 编辑mha配置文件</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs sh">cat &gt; /etc/mha/app1.cnf &lt;&lt;<span class="hljs-string">EOF #名字 目录随便定义</span><br><span class="hljs-string">[server default] #默认配置</span><br><span class="hljs-string">manager_log=/var/log/mha/app1/manager  #记录日志文件       核心日志</span><br><span class="hljs-string">manager_workdir=/var/log/mha/app1      #启动日志      </span><br><span class="hljs-string">master_binlog_dir=/data/binlog #主库binlog （所有节点都要打开二进制日志并且目录名要一样）   </span><br><span class="hljs-string">user=mha             #管理用户                     </span><br><span class="hljs-string">password=mha         #密码                   </span><br><span class="hljs-string">ping_interval=2      #探测心跳的间隔时间 一共给三次机会 也就是最多6秒无响应就算宕机</span><br><span class="hljs-string">repl_password=123    #构建主从时的用户密码</span><br><span class="hljs-string">repl_user=repl       #构建主从时的用户</span><br><span class="hljs-string">ssh_user=root        #各节点互信用户                            </span><br><span class="hljs-string"></span><br><span class="hljs-string">[server1]            #后端的三个节点（自动检测谁是主库）             </span><br><span class="hljs-string">hostname=10.0.0.51</span><br><span class="hljs-string">port=3306                                  </span><br><span class="hljs-string">[server2]            #如果无压力的状况下根据顺序选中新主</span><br><span class="hljs-string">hostname=10.0.0.52</span><br><span class="hljs-string">port=3306</span><br><span class="hljs-string">[server3]</span><br><span class="hljs-string">hostname=10.0.0.53</span><br><span class="hljs-string">port=3306</span><br><span class="hljs-string">EOF</span><br></code></pre></td></tr></table></figure><br><br><p>一台 Manager 节点可以负责多个业务组，通过多个不同的配置文件区分如：</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section9-2.png" alt="MHA节点构架2"></p><br><p>4.7 状态检查(db03)</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">masterha_check_ssh  --conf=/etc/mha/app1.cnf <br>masterha_check_repl  --conf=/etc/mha/app1.cnf <br></code></pre></td></tr></table></figure><br><p>4.8 开启MHA(db03)：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh">nohup masterha_manager --conf=/etc/mha/app1.cnf --remove_dead_master_conf --ignore_last_failover  &lt; /dev/null&gt; /var/<span class="hljs-built_in">log</span>/mha/app1/manager.log 2&gt;&amp;1 &amp;<br><br>--remove_dead_master_conf  <span class="hljs-comment">#自动在配置文件中去掉宕机的节点</span><br>--ignore_last_failover   <span class="hljs-comment">#忽略上一次故障切换</span><br></code></pre></td></tr></table></figure><br><h2 id="4-MHA-FailOver-过程详解"><a href="#4-MHA-FailOver-过程详解" class="headerlink" title="4.MHA FailOver 过程详解"></a>4.MHA FailOver 过程详解</h2><h3 id="4-1-什么是Failover"><a href="#4-1-什么是Failover" class="headerlink" title="4.1 什么是Failover?"></a>4.1 什么是Failover?</h3><p><strong>故障转移</strong><br></p><p>主库宕机一直到业务恢复正常的处理过程(自动)</p><br><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section9-3.png" alt="收到和执行了多少事务"></p><p>收到和执行了多少事务对比。</p><br><br><h3 id="4-2-MHA的Failover如何实现"><a href="#4-2-MHA的Failover如何实现" class="headerlink" title="4.2 MHA的Failover如何实现?"></a>4.2 MHA的Failover如何实现?</h3><p>从启动—&gt;故障—&gt;转移—&gt;业务恢复</p><ol><li><p>MHA通过<code>masterha_manger</code>脚本启动MHA的功能.</p></li><li><p>在manager启动之前,会自动检查ssh互信(<code>masterha_check_ssh</code>)和主从状态(<code>masterha_check_repl</code>)</p></li><li><p>MHA-manager 通过 <code>masterha_master_monitor</code>脚本(每隔<code>ping_interval</code>秒配置文件中)</p></li><li><p><code>masterha_master_monitor</code> 探测主库3次无心跳之后,就认为主库宕机了.</p></li><li><p>进行选主过程采用如下</p><p>[^算法]: </p><ul><li>算法一:<br>读取配置文件中是否有强制选主的参数?<br><br><code>candidate_master=1</code> 优先竞选<br><br><code>check_repl_delay=0</code>  跳过检查差异<br><br>加在相应主机标签下面<br></li><li>算法二:<br>自动判断所有从库的日志量.将最接近主库数据的从库作为新主.<br></li><li>算法三:<br>按照配置文件先后顺序的进行选新主.<br></li></ul></li><li><p>数据补偿，判断主库SSH的连通性在SSH能连的情况下调用 save_binary_logs脚本,立即保存缺失部分的binlog到各个从节点,恢复，针对主库缺失部分进行补全 GTID号判断。</p><p>SSH无法连接调用 apply_diff_relay_logs 脚本,计算从库的relaylog的差异,恢复到2号从库，在其他从库 尽快能找到差异恢复一部分数据。</p></li><li><p>解除从库身份</p></li><li><p>剩余从库和新主库建立主从关系</p></li><li><p>应用透明</p></li><li><p>故障提醒</p></li></ol><br><br><ul><li>算法一:<br>读取配置文件中是否有强制选主的参数?<br><br><code>candidate_master=1</code> 优先竞选<br><br><code>check_repl_delay=0</code>  跳过检查差异<br><br>加在相应主机标签下面<br></li><li>算法二:<br>自动判断所有从库的日志量.将最接近主库数据的从库作为新主.<br></li><li>算法三:<br>按照配置文件先后顺序的进行选新主.<br></li></ul><p><strong>扩展一下</strong>: 强制选主应用场景<br><br><code>candidate_master=1</code> 应用场景?<br></p><p>(1) MHA+KeepAlive VIP(早期MHA架构) <br><br>(2) 多地多中心 facebook架构 多节点在不同的机房<br></p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section9-4.png" alt="多数据中心"></p><br><br><h2 id="5-应用透明"><a href="#5-应用透明" class="headerlink" title="5.应用透明"></a>5.应用透明</h2><br><p><strong>db03:</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">cp /root/master_ip_failover.txt /usr/local/bin/master_ip_failover #vip切换脚本<br>vim /usr/local/bin/master_ip_failover<br>my $vip = &#x27;10.0.0.55/24&#x27;; #设定那个地址为VIP<br>my $key = &#x27;1&#x27;;<br></code></pre></td></tr></table></figure><br><p>这里的变量 key 是指 <code>ifconfig eth0:1 10.0.0.55/24</code> 的那个网卡别名</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">my <span class="hljs-variable">$ssh_start_vip</span> = <span class="hljs-string">&quot;/sbin/ifconfig eth0:<span class="hljs-variable">$key</span> <span class="hljs-variable">$vip</span>&quot;</span>;  <span class="hljs-comment">#生成地址 注意网卡名称</span><br><span class="hljs-comment">#等于 </span><br>ifconfig eth0:1 10.0.0.55/24<br></code></pre></td></tr></table></figure><br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">my <span class="hljs-variable">$ssh_stop_vip</span> = <span class="hljs-string">&quot;/sbin/ifconfig eth0:<span class="hljs-variable">$key</span> down&quot;</span>; <span class="hljs-comment">#注意网卡名称</span><br><span class="hljs-comment">#等于 </span><br>ifconfig eth0:1 down<br></code></pre></td></tr></table></figure><br><br><p>上下线地址</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sh">yum install -y dos2unix<br>dos2unix /usr/<span class="hljs-built_in">local</span>/bin/master_ip_failover 转换掉中文字符<br>chmod +x /usr/<span class="hljs-built_in">local</span>/bin/master_ip_failover <br>vim /etc/mha/app1.cnf<br><span class="hljs-comment">#在[server default] 下面加 在主库宕机时才会掉用</span><br>master_ip_failover_script=/usr/<span class="hljs-built_in">local</span>/bin/master_ip_failover  <br></code></pre></td></tr></table></figure><br><br><p><strong>db01主库:手工添加 vip</strong></p><p><strong>查看是主库</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">masterha_check_status --conf=/etc/mha/wordpress.cnf<br></code></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#db01:添加VIP</span><br>ifconfig eth0:1 10.0.0.55/24<br> <br><span class="hljs-comment">#db03:重启MHA</span><br>masterha_stop --conf=/etc/mha/wordpress.cnf<br>nohup masterha_manager --conf=/etc/mha/app1.cnf --remove_dead_master_conf --ignore_last_failover &lt; /dev/null&gt; /var/<span class="hljs-built_in">log</span>/mha/app1/manager.log 2&gt;&amp;1 &amp;<br><span class="hljs-comment">#db03:检查</span><br>masterha_check_status --conf=/etc/mha/app1.cnf<br>app1 (pid:14410) is running(0:PING_OK), master:10.0.0.51<br></code></pre></td></tr></table></figure><br><br><h2 id="6-MHA-故障邮件提醒"><a href="#6-MHA-故障邮件提醒" class="headerlink" title="6.MHA 故障邮件提醒"></a>6.MHA 故障邮件提醒</h2><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs elixir">[root<span class="hljs-variable">@db03</span> ~]<span class="hljs-comment"># cp -a email/* /usr/local/bin/</span><br>[root<span class="hljs-variable">@db03</span> ~]<span class="hljs-comment"># cd /usr/local/bin/</span><br>[root<span class="hljs-variable">@db03</span> ]<span class="hljs-comment"># chmod +x *</span><br><br>[root<span class="hljs-variable">@db03</span> bin]<span class="hljs-comment"># vim /etc/mha/app1.cnf </span><br>report_script=<span class="hljs-regexp">/usr/local</span><span class="hljs-regexp">/bin/send</span><br></code></pre></td></tr></table></figure><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section9-5.png" alt="故障提醒"></p><p><strong>重启MHA</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">masterha_stop --conf=/etc/mha/app1.cnf<br>nohup masterha_manager --conf=/etc/mha/app1.cnf --remove_dead_master_conf --ignore_last_failover &lt; /dev/null&gt; /var/<span class="hljs-built_in">log</span>/mha/app1/manager.log 2&gt;&amp;1 &amp;<br></code></pre></td></tr></table></figure><br><br><h2 id="7-额外的数据补偿服务器"><a href="#7-额外的数据补偿服务器" class="headerlink" title="7.额外的数据补偿服务器"></a>7.额外的数据补偿服务器</h2><p>(binlog_server) 节点用于在SSH无法连接到主库时做额外的数据补偿</p><br><p>找一台额外的机器，必须要有5.6以上的版本，支持gtid并开启，这里我们直接用的第二个slave（db03）</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sh">vim /etc/mha/app1.cnf <br>[binlog1]         <span class="hljs-comment">#添加新节点</span><br>no_master=1 <span class="hljs-comment">#不参与切换</span><br>hostname=10.0.0.53<br>master_binlog_dir=/data/mysql/binlog <span class="hljs-comment">#日志路径</span><br></code></pre></td></tr></table></figure><br><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section9-6.png" alt="数据补偿服务器"></p><br><p><strong>(2) 创建必要目录</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">mkdir -p /data/mysql/binlog<br>chown -R mysql.mysql /data/*<br></code></pre></td></tr></table></figure><br><p><strong>(3) 实时拉取主库binlog日志</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">cd</span> /data/mysql/binlog     <span class="hljs-comment">#必须进入到自己创建好的目录</span><br>mysqlbinlog  -R --host=10.0.0.51 --user=mha --password=mha --raw  --stop-never mysql-bin.000001 &amp; <span class="hljs-comment">#主库一单有变动就来取</span><br></code></pre></td></tr></table></figure><p>在切换新日志时也会实时抓取</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section9-7.png" alt="在切换新日志时也会实时抓取"></p><br><p><strong>注意</strong>：<br>拉取日志的起点,需要按照目前主库正在使用的binlog为起点.</p><p><strong>(4) 重启MHA-manager</strong> </p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#db03</span><br>masterha_stop --conf=/etc/mha/app1.cnf<br>nohup masterha_manager --conf=/etc/mha/app1.cnf --remove_dead_master_conf --ignore_last_failover  &lt; /dev/null&gt; /var/<span class="hljs-built_in">log</span>/mha/app1/manager.log 2&gt;&amp;1 &amp;<br></code></pre></td></tr></table></figure><br><br><h2 id="8-故障模拟及故障处理"><a href="#8-故障模拟及故障处理" class="headerlink" title="8.故障模拟及故障处理"></a>8.故障模拟及故障处理</h2><br><p>因为MHA故障转移是一次性的宕掉的节点不会自动添加回来，所有就需要实施监控并启动故障节点。</p><br><h3 id="8-1-宕掉-db01-数据库"><a href="#8-1-宕掉-db01-数据库" class="headerlink" title="8.1 宕掉 db01 数据库"></a>8.1 宕掉 db01 数据库</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#db01</span><br>/etc/init.d/mysqld stop<br></code></pre></td></tr></table></figure><br><h3 id="8-2-恢复故障"><a href="#8-2-恢复故障" class="headerlink" title="8.2 恢复故障"></a>8.2 恢复故障</h3><p><strong>(1) 启动故障节点</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#db01</span><br>/etc/init.d/mysqld start<br></code></pre></td></tr></table></figure><br><p><strong>(2) 恢复1主2从(db01)模式</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sh">grep <span class="hljs-string">&quot;CHANGE MASTER TO&quot;</span>  /var/<span class="hljs-built_in">log</span>/mha/app1/manager <span class="hljs-comment">#这时已经切到slave2节点</span><br>Thu Jul 18 18:31:54 2019 - [info]  All other slaves should start replication from here. Statement should be: CHANGE MASTER TO MASTER_HOST=<span class="hljs-string">&#x27;10.0.0.52&#x27;</span>, MASTER_PORT=3306, MASTER_AUTO_POSITION=1, MASTER_USER=<span class="hljs-string">&#x27;repl&#x27;</span>, MASTER_PASSWORD=<span class="hljs-string">&#x27;xxx&#x27;</span>;<br><span class="hljs-comment">#重新添加db01到Manager中</span><br>db01 [(none)]&gt;CHANGE MASTER TO MASTER_HOST=<span class="hljs-string">&#x27;10.0.0.52&#x27;</span>, MASTER_PORT=3306, MASTER_AUTO_POSITION=1, MASTER_USER=<span class="hljs-string">&#x27;repl&#x27;</span>, MASTER_PASSWORD=<span class="hljs-string">&#x27;123&#x27;</span>;<br>db01 [(none)]&gt;start slave; <span class="hljs-comment">#启动线程</span><br></code></pre></td></tr></table></figure><br><p><strong>(3) 恢复配置文件(db03)</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sh">[server1]<br>hostname=10.0.0.51<br>port=3306<br>[server2]<br>hostname=10.0.0.52<br>port=3306<br>[server3]<br>hostname=10.0.0.53<br>port=3306<br>report_script=/usr/<span class="hljs-built_in">local</span>/bin/send<br></code></pre></td></tr></table></figure><br><p><strong>(4) 启动MHA</strong> </p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#db03</span><br>nohup masterha_manager --conf=/etc/mha/app1.cnf --remove_dead_master_conf --ignore_last_failover  &lt; /dev/null&gt; /var/<span class="hljs-built_in">log</span>/mha/app1/manager.log 2&gt;&amp;1 &amp;<br>[1] 16543<br><span class="hljs-comment">#db03</span><br>masterha_check_status --conf=/etc/mha/app1.cnf<br>app1 (pid:16543) is running(0:PING_OK), master:10.0.0.52<br></code></pre></td></tr></table></figure><br><p><strong>(5)恢复 binlogserver</strong> </p><p>更换抓取目标</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment">#binlogserver</span><br><span class="hljs-built_in">cd</span> /data/mysql/binlog    <br>rm -rf /data/mysql/binlog/*<br>mysqlbinlog  -R --host=10.0.0.52 --user=mha --password=mha --raw  --stop-never mysql-bin.000001 &amp;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>DBA</category>
      
    </categories>
    
    
    <tags>
      
      <tag>DBA</tag>
      
      <tag>RDBMS</tag>
      
      <tag>MHA</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>高可用架构方案</title>
    <link href="/2020/07/21/dba08/"/>
    <url>/2020/07/21/dba08/</url>
    
    <content type="html"><![CDATA[<hr><h1 id="MySQL-Replication"><a href="#MySQL-Replication" class="headerlink" title="MySQL Replication"></a>MySQL Replication</h1><p>[[toc]]</p><p>#高可用架构方案</p><ul><li>负载均衡：有一个定的高可用性</li></ul><p>​       LVS  Nginx</p><ul><li>主备系统：有高可用性，但是需要别换，是单活的构架</li></ul><p>​       KA ， MHA ,MMM</p><ul><li>真正的高可用（多活系统）</li></ul><p>​       NDB Cluster Oracle RAC Sysbase cluster ，InnoDB Cluster （MGR） ，PXC , MGC</p><br><h2 id="1-职责介绍"><a href="#1-职责介绍" class="headerlink" title="1. 职责介绍"></a>1. 职责介绍</h2><ul><li>搭建主从复制   </li><li>主从原理熟悉   </li><li>主从的故障处理 </li><li>主从延时     </li><li>主从的特殊架构的配置使用 </li><li>主从架构的演变 </li></ul><br><br><h2 id="2-主从复制介绍"><a href="#2-主从复制介绍" class="headerlink" title="2. 主从复制介绍"></a>2. 主从复制介绍</h2><p>(1) 主从复制基于binlog来实现的<br>(2) 主库发生新的操作,都会记录binlog<br>(3) 从库取得主库的binlog进行回放<br>(4) 主从复制的过程是异步</p><br><br><h2 id="3-主从复制的前提-搭建主从复制"><a href="#3-主从复制的前提-搭建主从复制" class="headerlink" title="3. 主从复制的前提 (搭建主从复制)"></a>3. 主从复制的前提 (搭建主从复制)</h2><p>(1) 2个或以上的数据库实例<br>(2) 主库需要开启二进制日志<br>(3) server_id要不同,区分不同的节点<br>(4) 主库需要建立专用的复制用户 (replication slave)<br>(5) 从库应该通过备份主库,恢复的方法进行”补课”<br>(6) 人为告诉从库一些复制信息(ip port user pass,二进制日志起点)<br>(7) 从库应该开启专门的复制线程</p><br><br><h2 id="4-主从复制搭建过程-生产"><a href="#4-主从复制搭建过程-生产" class="headerlink" title="4.主从复制搭建过程(生产)"></a>4.主从复制搭建过程(生产)</h2><h3 id="4-1-准备多实例"><a href="#4-1-准备多实例" class="headerlink" title="4.1 准备多实例"></a>4.1 准备多实例</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs shell">pkill mysqld <br>systemctl start mysqld3307<br>\rm -rf /data/3308/data/*<br>\rm -rf /data/3308/mysql-bin.*<br>mysqld --initialize-insecure --user=mysql --basedir=/application/mysql --datadir=/data/3308/data 初始化数据库<br>systemctl start mysqld3308<br>mysql -S /data/3308/mysql.sock -e &quot;select @@port&quot;   查看端口<br>mysql -uroot -p123 -S /data/3307/mysql.sock -e &quot;select @@port&quot;; <br><br>3307主库 3308从库<br></code></pre></td></tr></table></figure><br><h3 id="4-2-检查配置文件"><a href="#4-2-检查配置文件" class="headerlink" title="4.2 检查配置文件"></a>4.2 检查配置文件</h3><p><strong>主库</strong>: 二进制日志是否开启</p><p>两个节点: <code>server_id</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs shell">cat /data/3308/my.cnf <br>[mysqld]<br>basedir=/application/mysql<br>datadir=/data/3308/data<br>socket=/data/3308/mysql.sock<br>log_error=/data/3308/mysql.log<br>port=3308<br>server_id=8<br>log_bin=/data/3308/mysql-bin<br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs shell">cat /data/3307/my.cnf <br>[mysqld]<br>basedir=/application/mysql<br>datadir=/data/3307/data<br>socket=/data/3307/mysql.sock<br>log_error=/data/3307/mysql.log<br>port=3307<br>server_id=7  主库要小些<br>log_bin=/data/3307/mysql-bin<br>[root@db01 data]# <br></code></pre></td></tr></table></figure><br><br><h3 id="4-3-主库创建复制用户"><a href="#4-3-主库创建复制用户" class="headerlink" title="4.3 主库创建复制用户"></a>4.3 主库创建复制用户</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">mysql -uroot -p123 -S /data/3307/mysql.sock -e &quot;grant replication slave on *.* to repl@&#x27;10.0.0.%&#x27; identified by &#x27;123&#x27;&quot;<br></code></pre></td></tr></table></figure><br><br><h3 id="4-4-补课"><a href="#4-4-补课" class="headerlink" title="4.4 补课"></a>4.4 补课</h3><p>主库数据做备份恢复到从库</p><p><strong>主</strong>: </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">mysqldump -uroot -p123 -S /data/3307/mysql.sock -A --master-data=2 --single-transaction -R -E --triggers &gt;/tmp/full.sql<br></code></pre></td></tr></table></figure><p><strong>从</strong>:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">mysql -S /data/3308/mysql.sock <br><span class="hljs-meta">mysql&gt;</span><span class="bash"> <span class="hljs-built_in">set</span> sql_log_bin=0;</span><br><span class="hljs-meta">mysql&gt;</span><span class="bash"> <span class="hljs-built_in">source</span> /tmp/full.sql</span><br></code></pre></td></tr></table></figure><br><br><h3 id="4-5-告诉从库信息"><a href="#4-5-告诉从库信息" class="headerlink" title="4.5 告诉从库信息"></a>4.5 告诉从库信息</h3><p>从库：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs shell">help change master to<br>mysql -S /data/3308/mysql.sock <br><br>CHANGE MASTER TO <br>MASTER_HOST=&#x27;10.0.0.51&#x27;, 地址或域名<br>MASTER_USER=&#x27;repl&#x27;, 用户名<br>MASTER_PASSWORD=&#x27;123&#x27;,  密码<br>MASTER_PORT=3307,  端口号<br>MASTER_LOG_FILE=&#x27;mysql-bin.000004&#x27;, 二进制日志<br>MASTER_LOG_POS=444,<br>MASTER_CONNECT_RETRY=10; 自动重连次数<br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">vim /tmp/full.sql 查看日志提取备份记录点<br>-- CHANGE MASTER TO MASTER_LOG_FILE=&#x27;mysql-bin.000004&#x27;, MASTER_LOG_POS=444;<br></code></pre></td></tr></table></figure><br><br><h3 id="4-6-从库开启复制线程-IO-SQL"><a href="#4-6-从库开启复制线程-IO-SQL" class="headerlink" title="4.6 从库开启复制线程(IO,SQL)"></a>4.6 从库开启复制线程(IO,SQL)</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">mysql -S /data/3308/mysql.sock <br><span class="hljs-meta">mysql&gt;</span><span class="bash"> start slave;</span><br></code></pre></td></tr></table></figure><h3 id="4-7-检查主从复制状态"><a href="#4-7-检查主从复制状态" class="headerlink" title="4.7 检查主从复制状态"></a>4.7 检查主从复制状态</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">mysql -S /data/3308/mysql.sock <br><span class="hljs-meta">mysql&gt;</span><span class="bash"> show slave status \G</span><br>            Slave_IO_Running: Yes<br>            Slave_SQL_Running: Yes<br></code></pre></td></tr></table></figure><p>主库:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">mysql -uroot -p123 -S /data/3307/mysql.sock -e &quot;create database alexsb&quot;<br></code></pre></td></tr></table></figure><p>从库:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">mysql -S /data/3308/mysql.sock -e &quot;show databases&quot;<br></code></pre></td></tr></table></figure><br><br><h2 id="5-主从复制原理"><a href="#5-主从复制原理" class="headerlink" title="5.主从复制原理"></a>5.主从复制原理</h2><br><h3 id="5-1-主从复制中涉及的文件"><a href="#5-1-主从复制中涉及的文件" class="headerlink" title="5.1 主从复制中涉及的文件"></a>5.1 主从复制中涉及的文件</h3><br><p><strong>主库</strong>:<br>    <code>binlog</code> </p><p><strong>从库</strong>:<br>    <code>relaylog</code>  中继日志<br>    <code>master.info</code>  主库信息文件<br>    <code>relaylog.info relaylog</code>   从库应用的信息</p><h3 id="5-2-主从复制中涉及的线程"><a href="#5-2-主从复制中涉及的线程" class="headerlink" title="5.2 主从复制中涉及的线程"></a>5.2 主从复制中涉及的线程</h3><p><strong>主库</strong>:<br>    <code>Binlog_Dump Thread : DUMP_T</code></p><p><strong>从库</strong>:<br>    <code>SLAVE_IO_THREAD     : IO_T</code><br>    <code>SLAVE_SQL_THREAD    : SQL_T</code></p><br><br><h3 id="5-3-主从复制工作-过程-原理"><a href="#5-3-主从复制工作-过程-原理" class="headerlink" title="5.3 主从复制工作(过程)原理"></a>5.3 主从复制工作(过程)原理</h3><br><ol><li>从库执行change master to 命令(主库的连接信息+复制的起点)</li><li>从库会将以上信息,记录到master.info文件</li><li>从库执行 start slave 命令,立即开启IO_T和SQL_T</li><li>从库 IO_T,读取master.info文件中的信息获取到IP,PORT,User,Pass,binlog的位置信息</li><li>从库IO_T请求连接主库,主库专门提供一个DUMP_T,负责和IO_T交互</li><li>IO_T根据binlog的位置信息(mysql-bin.000004 , 444),请求主库新的binlog</li><li>主库通过DUMP_T将最新的binlog,通过网络TP给从库的IO_T</li><li>IO_T接收到新的binlog日志,存储到TCP/IP缓存,立即返回ACK给主库,并更新master.info</li><li>IO_T将TCP/IP缓存中数据,转储到磁盘relaylog中.</li><li>SQL_T读取relay.info中的信息,获取到上次已经应用过的relaylog的位置信息</li><li>SQL_T会按照上次的位置点回放最新的relaylog,再次更新relay.info信息</li><li>从库会自动purge应用过relay进行定期清理</li></ol><br><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section8-1.png" alt="主从搭建原理"></p><br><p><strong>补充说明</strong>:</p><p>一旦主从复制构建成功,主库当中发生了新的变化,都会通过dump_T发送信号给IO_T,增强了主从复制的实时性.</p><h3 id="5-4-主从复制监控"><a href="#5-4-主从复制监控" class="headerlink" title="5.4 主从复制监控"></a>5.4 主从复制监控</h3><br><p>命令:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">show</span> slave status \G 从库执行<br><br>主库有关的信息(master.info):<br>Master_Host: <span class="hljs-number">10.0</span><span class="hljs-number">.0</span><span class="hljs-number">.51</span><br>Master_User: repl<br>Master_Port: <span class="hljs-number">3307</span><br>Connect_Retry: <span class="hljs-number">10</span><br><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><br>Master_Log_File: mysql<span class="hljs-operator">-</span>bin<span class="hljs-number">.000004</span><br>Read_Master_Log_Pos: <span class="hljs-number">609</span><br><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span><br></code></pre></td></tr></table></figure><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section8-1-1.png" alt="主从状态监控"></p><br><br><p><strong>从库relay应用信息有关的</strong>(<code>relay.info</code>):</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">Relay_Log_File: db01-relay-bin.000002<br>Relay_Log_Pos: 320  #上次已经运行到320<br>Relay_Master_Log_File: mysql-bin.000004 #对应主库binlog文件<br></code></pre></td></tr></table></figure><br><p><strong>从库线程运行状态(排错)</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell">Slave_IO_Running: Yes<br>Slave_SQL_Running: Yes<br>Last_IO_Errno: 0<br>Last_IO_Error: <br>Last_SQL_Errno: 0<br>Last_SQL_Error: <br></code></pre></td></tr></table></figure><p>​        <br></p><br>            **过滤复制有关的信息**:            <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql">Replicate_Do_DB: <br>Replicate_Ignore_DB: <br>Replicate_Do_Table: <br>Replicate_Ignore_Table: <br>Replicate_Wild_Do_Table: <br>Replicate_Wild_Ignore_Table: <br></code></pre></td></tr></table></figure><br>**从库延时主库的时间(秒)**:  <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">Seconds_Behind_Master: 0<br></code></pre></td></tr></table></figure><br>                <p><strong>延时从库</strong>:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">SQL_Delay: 0<br>SQL_Remaining_Delay: NULL<br></code></pre></td></tr></table></figure><br><p><strong>GTID复制有关的状态信息</strong>          </p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">Retrieved_Gtid_Set: <br>Executed_Gtid_Set: <br>Auto_Position: 0<br></code></pre></td></tr></table></figure><br><br><h3 id="5-5-主从复制故障"><a href="#5-5-主从复制故障" class="headerlink" title="5.5 主从复制故障"></a>5.5 主从复制故障</h3><br><h4 id="5-5-1-IO-线程故障"><a href="#5-5-1-IO-线程故障" class="headerlink" title="5.5.1 IO 线程故障"></a>5.5.1 IO 线程故障</h4><p>(1) 连接主库: connecting</p><p>网络,连接信息错误或变更了,防火墙,连接数上线</p><p><strong>排查思路</strong>:</p><ol><li>使用复制用户手工登录</li></ol>  <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">mysql -urepl -p12321321 -h 10.0.0.51 -P 3307<br>mysql: [Warning] Using a password on the <span class="hljs-built_in">command</span> line interface can be insecure.<br>ERROR 1045 (28000): Access denied <span class="hljs-keyword">for</span> user <span class="hljs-string">&#x27;repl&#x27;</span>@<span class="hljs-string">&#x27;db01&#x27;</span> (using password: YES)<br></code></pre></td></tr></table></figure><p>密码错误</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">mysql -urep -p123 -h 10.0.0.51 -P 3307<br>mysql: [Warning] Using a password on the <span class="hljs-built_in">command</span> line interface can be insecure.<br>ERROR 1045 (28000): Access denied <span class="hljs-keyword">for</span> user <span class="hljs-string">&#x27;rep&#x27;</span>@<span class="hljs-string">&#x27;db01&#x27;</span> (using password: YES)<br></code></pre></td></tr></table></figure><p>用户名错误</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">mysql -urepl -p123 -h 10.0.0.52 -P 3307<br>mysql: [Warning] Using a password on the <span class="hljs-built_in">command</span> line interface can be insecure.<br>ERROR 2003 (HY000): Can<span class="hljs-string">&#x27;t connect to MySQL server on &#x27;</span>10.0.0.52<span class="hljs-string">&#x27; (113)</span><br></code></pre></td></tr></table></figure><p>ip地址错误</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh">mysql -urepl -p123 -h 10.0.0.51 -P 3309<br>mysql: [Warning] Using a password on the <span class="hljs-built_in">command</span> line interface can be insecure.<br>ERROR 2003 (HY000): Can<span class="hljs-string">&#x27;t connect to MySQL server on &#x27;</span>10.0.0.51<span class="hljs-string">&#x27; (111)</span><br><span class="hljs-string">[root@db01 data]# </span><br></code></pre></td></tr></table></figure><p>端口错误</p><p>解决: </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql">stop slave <br>reset slave <span class="hljs-keyword">all</span>; 清空 master.info信息<br>change master <span class="hljs-keyword">to</span> <br><span class="hljs-keyword">start</span> slave<br></code></pre></td></tr></table></figure><p>(2) 请求Binlog</p><p>binlog 没开<br>binlog 损坏,不存在，不完整</p><p>主库 reset master 处理: （清理binlog日志）<br>从库 </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs sql">stop slave ;<br>reset slave <span class="hljs-keyword">all</span>; <br>CHANGE MASTER <span class="hljs-keyword">TO</span> <br>MASTER_HOST<span class="hljs-operator">=</span><span class="hljs-string">&#x27;10.0.0.51&#x27;</span>,<br>MASTER_USER<span class="hljs-operator">=</span><span class="hljs-string">&#x27;repl&#x27;</span>,<br>MASTER_PASSWORD<span class="hljs-operator">=</span><span class="hljs-string">&#x27;123&#x27;</span>,<br>MASTER_PORT<span class="hljs-operator">=</span><span class="hljs-number">3307</span>,<br>MASTER_LOG_FILE<span class="hljs-operator">=</span><span class="hljs-string">&#x27;mysql-bin.000001&#x27;</span>,<br>MASTER_LOG_POS<span class="hljs-operator">=</span><span class="hljs-number">154</span>,<br>MASTER_CONNECT_RETRY<span class="hljs-operator">=</span><span class="hljs-number">10</span>;<br><span class="hljs-keyword">start</span> slave;<br></code></pre></td></tr></table></figure><p>(3) 存储binlog到relaylog</p><br><h4 id="5-5-2-SQL线程故障"><a href="#5-5-2-SQL线程故障" class="headerlink" title="5.5.2 SQL线程故障"></a>5.5.2 SQL线程故障</h4><ul><li>relay-log 损坏</li><li>回放 relaylog</li></ul><p><strong>实际上就是 研究一条SQL语句为什么执行失败</strong>?</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">insert</span> <span class="hljs-keyword">delete</span>  update     <span class="hljs-comment">---&gt; t1 表 不存在</span><br><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span>  xin     <span class="hljs-comment">---&gt;  xin 已存在</span><br></code></pre></td></tr></table></figure><p><strong>约束冲突(主键,唯一键,非空..)</strong></p><p><strong>合理处理方法</strong>:<br>把握一个原则,一切以主库为准进行解决.<br>如果出现问题,尽量进行反操作<br>最直接稳妥办法,重新构建主从</p><p><strong>暴力的解决方法</strong><br>方法一：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">stop slave; <br>set global sql_slave_skip_counter = 1;<br>start slave;<br></code></pre></td></tr></table></figure><p>#将同步指针向下移动一个，如果多次不同步，可以重复操作。<br>start slave;</p><p>方法二： 直接写在配置文件里面 跳过以下错误</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sh">/etc/my.cnf<br>slave-skip-errors = 1032,1062,1007<br><br><span class="hljs-comment">#常见错误代码:</span><br>1007:对象已存在<br>1032:无法执行DML<br>1062:主键冲突,或约束冲突<br></code></pre></td></tr></table></figure><p>但是，以上操作有时是有<strong>风险</strong>的，最安全的做法就是重新构建主从。把握一个原则,一切以主库为主.</p><br><p><strong>对于主键冲突问题</strong>：</p><p>错误的在从库插入的已有数据行的主键值重复导致主从不同步</p><p><strong>解决方法</strong>：找到主从两个数据库手动改为一致后 跳过</p><br><br><p><strong>为了很大程度的避免SQL线程故障</strong></p><p>(1) 从库只读</p><p><strong>read_only</strong><br><strong>super_read_only</strong></p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section8-1-2.png" alt="从库只读"></p><p>(2) 使用读写分离中间件</p><ul><li>atlas </li><li>mycat</li><li>ProxySQL </li><li>MaxScale</li></ul><p>写得数据发往主库，读的操作发往从库</p><h2 id="6-主从延时监控及原因"><a href="#6-主从延时监控及原因" class="headerlink" title="6. 主从延时监控及原因"></a>6. 主从延时监控及原因</h2><h3 id="6-1-主库方面原因"><a href="#6-1-主库方面原因" class="headerlink" title="6.1 主库方面原因"></a>6.1 主库方面原因</h3><p>(1) binlog写入不及时</p><p><code>sync_binlog=1</code> 直接刷写到磁盘</p><p>(2) 默认情况下dump_t 是串行传输 binlog<br>在并发事务量大时或者大事务,由于dump_t 是串型工作的,导致传送日志较慢</p><p>由于串行工作大事务导致阻塞会越堆越多</p><p><strong>如何解决问题</strong>?<br>必须GTID,使用<strong>Group commit</strong>方式.可以支持DUMP_T并行</p><p>(3) 主库极其繁忙<br>慢语句<br>锁等待<br>从库个数<br>网络延时</p><h3 id="6-2-从库方面原因"><a href="#6-2-从库方面原因" class="headerlink" title="6.2 从库方面原因"></a>6.2 从库方面原因</h3><p>(1) 传统复制(Classic)中</p><p>主库并发事务，但是从库SQL还是单线程。</p><p>如果主库并发事务量很大,或者出现大事务<br>由于从库是单SQL线程,导致,不管传的日志有多少,只能一次执行一个事务.<br>5.6 版本,有了GTID,可以实现多SQL线程,但是只能基于不同库的事务进行并发回放.(database)  （不能保证同一库内事务无法保证顺序按一定逻辑顺序执行）</p><p>所以在 5.7 版本中,有了增强的GTID,增加了seq_no（通线程下的序列号码）标记,增加了新型的并发SQL线程模式(logical_clock),MTS技术   逻辑时钟</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section8-1-3.png" alt="从库的SQL工作线程"></p><p>从库的SQL工作线程</p><p>(2) 主从硬件差异太大<br>(3) 主从的参数配置<br>(4) 从库和主库的索引不一致<br>(5) 版本有差异</p><br><h2 id="7-主从延时的监控"><a href="#7-主从延时的监控" class="headerlink" title="7. 主从延时的监控"></a>7. 主从延时的监控</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">show</span> slave  status\G<br>Seconds_Behind_Master: <span class="hljs-number">0</span><br></code></pre></td></tr></table></figure><br><p><strong>主库方面原因的监控</strong></p><p><strong>主库</strong>: 传输了这些</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">mysql&gt; show <span class="hljs-keyword">master</span> <span class="hljs-title">status</span> ;<br>File: mysql-bin.<span class="hljs-number">000001</span><br>Position: <span class="hljs-number">1373</span><br></code></pre></td></tr></table></figure><br><p><strong>从库</strong>: 接收了这些</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql">Master_Log_File: mysql<span class="hljs-operator">-</span>bin<span class="hljs-number">.000001</span><br>Read_Master_Log_Pos: <span class="hljs-number">1373</span><br></code></pre></td></tr></table></figure><p><strong>主库对应从库的Position 号是否一致</strong></p><p><strong>从库方面原因监控</strong>:</p><p>拿了多少:</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Master_Log_File</span>: mysql-bin.<span class="hljs-number">000001</span><br><span class="hljs-attribute">Read_Master_Log_Pos</span>: <span class="hljs-number">691688</span><br></code></pre></td></tr></table></figure><p>看的是binlaog  从库对应的Relay_log 号 找对应关系</p><p>执行了多少:</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Relay_Log_File</span>: db<span class="hljs-number">01</span>-relay-bin.<span class="hljs-number">000004</span><br><span class="hljs-attribute">Relay_Log_Pos</span>: <span class="hljs-number">690635</span><br><span class="hljs-attribute">Exec_Master_Log_Pos</span>: <span class="hljs-number">691688</span><br><span class="hljs-attribute">Relay_Log_Space</span>: <span class="hljs-number">690635</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>DBA</category>
      
    </categories>
    
    
    <tags>
      
      <tag>高可用</tag>
      
      <tag>DBA</tag>
      
      <tag>RDBMS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>逻辑备份与恢复</title>
    <link href="/2020/07/20/dba07/"/>
    <url>/2020/07/20/dba07/</url>
    
    <content type="html"><![CDATA[<hr><h1 id="逻辑备份与恢复"><a href="#逻辑备份与恢复" class="headerlink" title="逻辑备份与恢复"></a>逻辑备份与恢复</h1><p>[[toc]]</p><br><h2 id="1-上节回顾"><a href="#1-上节回顾" class="headerlink" title="1. 上节回顾"></a>1. 上节回顾</h2><br><h3 id="1-1-日志"><a href="#1-1-日志" class="headerlink" title="1.1  日志"></a>1.1  日志</h3><p><strong>binlog</strong> 如何开启?</p><p><code>binlog_format=row</code>    SBR 模式参数   </p><br><p><strong>RBR 与 SBR  模式之间的区别</strong>：</p><p>例如要更新大于2000的数据行 ，此时需要更新1000行数据，RBR记录每一行的变化，SBR则只记录这一条命令，但是SBR有可能会记录错误的日志，如在函数 now 当前时间的命令会有错误。</p> <br> <br><p><strong>双一标准的其中一个</strong>：</p><p><code>sync_binlog=1</code> 每次事务提交都立即刷写binlog到磁盘 </p>  <br><p><strong>双一标准的另一个：</strong></p><p><code>innodb_flush_log_at_trx_commit=1</code>    在事务提交时刷写 redo 到磁盘策略 </p><p><strong>查看日志：</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">show</span> master status ;<br><span class="hljs-keyword">show</span> binlog events <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;日志名称&#x27;</span><br></code></pre></td></tr></table></figure><p>非GTID 截取日志</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">mysqlbinlog --start-position  --stop-position  <span class="hljs-comment">#截取日志</span><br>--base64-output=decode-rows  -vvv  <span class="hljs-comment">#(--help可以查到)   翻译成人话</span><br></code></pre></td></tr></table></figure> <br> <br><p> <strong>GTID</strong> 5.6版本出现 <strong>5.7版本</strong> 推荐使用</p> <br><p><strong>GTID的开启和配置</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">vim /etc/my.cnf<br>gtid-mode=on<br>enforce-gtid-consistency=<span class="hljs-literal">true</span> <span class="hljs-comment">#强制gtid一致性</span><br></code></pre></td></tr></table></figure> <br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql">不知道参数的情况下：<br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">show</span> variables <span class="hljs-keyword">like</span> <span class="hljs-string">&#x27;%gtid%&#x27;</span>; <span class="hljs-comment">--查看GTIT有有关的参数</span><br></code></pre></td></tr></table></figure> <br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># mysqlbinlog --help |grep gtid 帮助</span><br> --skip-gtids  跳过GTIP检查 导出日志时不记录日志  <br> --include-gtids=<span class="hljs-string">&#x27;&#x27;</span>   想截取哪一段日志<br> --exclude-gtids=<span class="hljs-string">&#x27;&#x27;</span>  想排除哪一段日志<br> <br><span class="hljs-built_in">set</span> sql_log_bin=0;    临时关闭当前窗口的二进制日志<br><span class="hljs-built_in">source</span> ..             恢复命令<br></code></pre></td></tr></table></figure>  <br> <p><strong>幂等性</strong>：在数据恢复时检查幂等性功能做过的事情就不会再做了</p> <br> <br><h3 id="1-2-二进制日志清理"><a href="#1-2-二进制日志清理" class="headerlink" title="1.2 二进制日志清理"></a>1.2 二进制日志清理</h3>  <br><h3 id="1-2-1-自动清理"><a href="#1-2-1-自动清理" class="headerlink" title="1.2.1 自动清理"></a>1.2.1 自动清理</h3><p><strong>设置的依据</strong>: 至少1轮全备周期长度的过期时间.  7天一个全备 两轮加一天</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">show variables like <span class="hljs-string">&#x27;%expire%&#x27;</span>；<br>expire_logs_days=15 <br></code></pre></td></tr></table></figure><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section7-1.png" alt="日志清理1"></p> <br> <br><h3 id="1-2-2-手动清理"><a href="#1-2-2-手动清理" class="headerlink" title="1.2.2 手动清理"></a>1.2.2 手动清理</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> help purge <span class="hljs-comment">--手工</span><br>PURGE <span class="hljs-type">BINARY</span> LOGS <span class="hljs-keyword">TO</span> <span class="hljs-string">&#x27;mysql-bin.000032&#x27;</span>; <span class="hljs-comment">--删除到那个日志为止</span><br>PURGE <span class="hljs-type">BINARY</span> LOGS BEFORE <span class="hljs-string">&#x27;2008-04-02 22:46:26&#x27;</span>; <span class="hljs-comment">--按照时间删除</span><br>mysql<span class="hljs-operator">&gt;</span> reset master ; <span class="hljs-comment">--全清了 主从主库绝对不能删</span><br></code></pre></td></tr></table></figure><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section7-1-1.png" alt="日志清理2"></p> <br> <br><h3 id="1-3-日志如何滚动"><a href="#1-3-日志如何滚动" class="headerlink" title="1.3 日志如何滚动"></a>1.3 <strong>日志如何滚动</strong></h3> <br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">flush logs; <span class="hljs-comment">--重新的一个文件开始记录日志</span><br></code></pre></td></tr></table></figure><p><strong>数据库重启</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">show</span> variables <span class="hljs-keyword">like</span> <span class="hljs-string">&#x27;%max%&#x27;</span><br>max_binlog_size<span class="hljs-operator">=</span><span class="hljs-number">1073741824</span>  <span class="hljs-comment">--二进制文件的最大大小</span><br></code></pre></td></tr></table></figure>  <br>  <br><h3 id="1-4-slow-log-慢语句分析"><a href="#1-4-slow-log-慢语句分析" class="headerlink" title="1.4 slow log 慢语句分析"></a>1.4 slow log 慢语句分析</h3> <br><p>慢语句开关</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section7-1-2.png" alt="慢语句开关"></p> <br><p>文件位置</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">show</span> variables <span class="hljs-keyword">like</span> <span class="hljs-string">&#x27;slow_query_log%&#x27;</span>;<br></code></pre></td></tr></table></figure><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section7-1-3.png" alt="慢语句位置"></p> <br><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section7-1-4.png" alt="慢语句位置"></p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section7-1-5.png" alt="慢语句位置"></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">show</span> variables <span class="hljs-keyword">like</span> <span class="hljs-string">&#x27;long%&#x27;</span>; <span class="hljs-comment">--时间阈值超过这个时间就算慢语句</span><br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">show</span> variables <span class="hljs-keyword">like</span> <span class="hljs-string">&#x27;%using_indexes%&#x27;</span>; <span class="hljs-comment">--是否记录不走索引的语句</span><br></code></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysqldumpslow <span class="hljs-operator">-</span>s c <span class="hljs-operator">-</span>t <span class="hljs-number">10</span> <span class="hljs-operator">/</span>xxxxx <span class="hljs-comment">--分析慢语句</span><br></code></pre></td></tr></table></figure> <br> <br><h3 id="1-5-innodb-核心参数"><a href="#1-5-innodb-核心参数" class="headerlink" title="1.5 innodb 核心参数"></a>1.5 innodb 核心参数</h3><p><strong>双一参数</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sh">innodb_flush_log_at_trx_commit=1  <span class="hljs-comment">#最安全模式 为1时每次提交事务都刷新到磁盘</span><br>innodb_flush_method=o_direct      <span class="hljs-comment">#数据刷新到磁盘绕过系统缓存由于不走缓存性能较慢 直通模式</span><br>innodb_flush_log_at_trx_commit=0  <span class="hljs-comment">#最高性能模式</span><br>innodb_flush_method=fsync         <span class="hljs-comment">#为0 时事务每秒刷写到磁盘不管提交没提交</span><br>                                  <span class="hljs-comment">#但是每秒发生无数事务断电可能导致事务丢失。 </span><br></code></pre></td></tr></table></figure> <br> <br><h2 id="2-在备份恢复中的职责"><a href="#2-在备份恢复中的职责" class="headerlink" title="2. 在备份恢复中的职责"></a>2. 在备份恢复中的职责</h2> <br><h3 id="2-1-备份策略的设计"><a href="#2-1-备份策略的设计" class="headerlink" title="2.1 备份策略的设计"></a>2.1 备份策略的设计</h3><p>通过三个方面设计 </p><p><strong>(1) 备份周期:</strong> </p><p>根据数据量设计备份周期 </p><p><strong>例如</strong>：</p><p>60G数据大小所需备份时间大约为30分钟尽量每天备份一次</p><p>而到达 9T 数据量就应该是按照每周备份一次了。</p>  <br><p> <strong>(2)备份工具</strong>:</p><ul><li><p>mysqldump (MDP) 用于每天 </p></li><li><p>XBK (PBK) percona Xtrabackup 用于每周 </p></li><li><p>MEB(MySQL Enterprise BACKUP MEB官方企业版工具) </p></li><li><p>MySQL binlog 二进制日志截取恢复</p><br></li></ul><p><strong>(3)备份方式</strong>:</p><p><strong>逻辑备份</strong>:</p><ul><li>全备  mysqldump 整个备份</li><li>增量  binlog (flush logs 滚动日志拷贝最后一个文件之前的日志 ,cp靠走) 增量备份</li></ul> <br><p><strong>物理备份</strong>:</p><ul><li>全备 : XBK </li><li>增量 : XBK</li></ul> <br><h3 id="2-2-检查备份可用性"><a href="#2-2-检查备份可用性" class="headerlink" title="2.2 检查备份可用性"></a>2.2 检查备份可用性</h3> <br><p>一般晚上11点执行 </p><p><strong>检查流程</strong>：</p><ul><li><p>crontab -l </p></li><li><p>备份脚本 </p></li><li><p>备份路径 </p></li><li><p>看备份日志,检查备份文件(大小,内容)</p></li><li><p>定期的恢复演练</p><br></li></ul> <br> <h3 id="2-3-数据恢复"><a href="#2-3-数据恢复" class="headerlink" title="2.3 数据恢复"></a>2.3 数据恢复</h3><p>只要备份和日志是完整的,恢复到故障之前的时间点(快速)</p> <br> <br><h3 id="2-4-数据迁移"><a href="#2-4-数据迁移" class="headerlink" title="2.4 数据迁移"></a>2.4 数据迁移</h3><p><strong>操作系统不同的迁移</strong></p><ul><li><p>mysql 同平台迁移 </p></li><li><p>其他操作系统数据库软件  迁移到 mysql  异构平台</p></li><li><p>mysql  迁移到  其他操作系统数据库软件</p><br></li></ul> <br><h3 id="2-5-备份情况介绍"><a href="#2-5-备份情况介绍" class="headerlink" title="2.5 备份情况介绍"></a>2.5 备份情况介绍</h3> <br><ul><li>热备 : 对于业务影响最小  InnoDB</li><li>温备 : 长时间锁表备份   MyISAM</li><li>冷备 : 业务关闭情况下备份 </li></ul> <br><h2 id="3-逻辑备份操作"><a href="#3-逻辑备份操作" class="headerlink" title="3 . 逻辑备份操作"></a>3 . 逻辑备份操作</h2><h3 id="mysqldump-参数介绍"><a href="#mysqldump-参数介绍" class="headerlink" title="mysqldump 参数介绍"></a>mysqldump 参数介绍</h3><h3 id="3-1-连接数据库参数"><a href="#3-1-连接数据库参数" class="headerlink" title="3.1  连接数据库参数"></a>3.1  <strong>连接数据库参数</strong></h3> <br><ul><li>-u 指定用户登录 </li><li>-p 账户密码</li><li>-S 使用Soket文件登录</li><li>-h 登录网段</li><li>P 指定端口 </li></ul> <br><h3 id="3-2-基础备份参数"><a href="#3-2-基础备份参数" class="headerlink" title="3.2 基础备份参数"></a>3.2 基础备份参数</h3><p><strong>-A</strong>  <strong>全备</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">mysqldump -uroot -p123 -A &gt;/backup/full.sql<br></code></pre></td></tr></table></figure>  <br><p>-<strong>B</strong> <strong>单库</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">mysqldump -uroot -p123 -B world oldguo wordpress &gt;/backup/db.sql<br></code></pre></td></tr></table></figure>  <br><p><strong>分库分表备份</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">mysqldump -uroot -p123 world city country &gt; /backup/tab.sql<br><span class="hljs-meta">#</span><span class="bash"> 第一个是库名 其他都是表名</span><br></code></pre></td></tr></table></figure>   <br>  <br><h3 id="3-3-特殊备份参数"><a href="#3-3-特殊备份参数" class="headerlink" title="3.3 特殊备份参数"></a>3.3 特殊备份参数</h3>   <br><ul><li><p><code>-R</code> 存储过程和函数 类型与shell脚本</p></li><li><p><code>-E</code> 事件 类似Linux中计划任务</p></li><li><p><code>--triggers</code> 触发器</p></li><li><p><code>--master-data=2</code>  自动记录日志起点</p> <br></li></ul><p><strong>案例模拟</strong>：</p><p>备份计划每天全备，大约60G数据。有一次周三下午数据库损坏。</p>   <br><p><strong>恢复思路</strong>：</p><p><strong>1.首先找到周二的全备恢复</strong></p><p><strong>2.截取全备到损坏之前的 binlog</strong></p><p><strong>找起点问题</strong>： </p><p><code>--master-data=2</code> 参数会自动把全备结束时二进制日志起点记下来但是他会自动锁表</p><p><strong>终点：</strong></p><p>查询二进制文件最后的位置</p><br><br><h3 id="3-4-恢复-binlog"><a href="#3-4-恢复-binlog" class="headerlink" title="3.4 恢复 binlog"></a>3.4 恢复 binlog</h3> <br><p>(1) 记录备份时刻的binlog信息</p><p>(2) 自动锁表</p><p>不加<code>--single-transaction</code> ,全局锁表温备份，长时间锁表备份。</p><p>加了<code>--single-transaction</code>,对于InnoDB存储引擎的表不锁表备份，(快照备份)但是其他引擎锁表。</p><p><code>--single-transaction</code> 对于InnoDB的表,进行一致性快照备份,不锁表. 备份的是快照的数据</p>  <br> <br><h2 id="4-恢复案例"><a href="#4-恢复案例" class="headerlink" title="4. 恢复案例"></a>4. 恢复案例</h2>  <br><h3 id="4-1-背景环境"><a href="#4-1-背景环境" class="headerlink" title="4.1 背景环境"></a>4.1 背景环境</h3><p>正在运行的网站系统，mysql-5.7.20 数据库，数据量50G，日业务增量1-5M。</p>  <br><h3 id="4-2-备份策略"><a href="#4-2-备份策略" class="headerlink" title="4.2 备份策略"></a>4.2 备份策略</h3><p>每天23:00点，计划任务调用mysqldump执行全备脚本</p>  <br><h3 id="4-3-故障时间点"><a href="#4-3-故障时间点" class="headerlink" title="4.3 故障时间点"></a>4.3 故障时间点</h3><p><strong>年底故障演练</strong>: 模拟周三上午10点误删除数据库.</p>   <br><h3 id="4-4-思路"><a href="#4-4-思路" class="headerlink" title="4.4  思路"></a>4.4  思路</h3>  <br><ol><li>停业务，挂维护页,避免数据的二次伤害</li><li>找一个临时库，恢复周二 23：00 点的全备</li><li>截取周二23：00 到 周三10点误删除之间的 binlog，恢复到临时库</li><li>测试可用性和完整性</li><li> <strong>方法一</strong> 直接使用临时库顶替原生产库，前端应用割接到新库</li><li> <strong>方法二</strong> 将误删除的表导出，导入到原生产库</li><li>开启业务</li><li>经过20分钟的处理，最终业务恢复正常</li></ol>  <br><h3 id="4-5-故障模拟演练"><a href="#4-5-故障模拟演练" class="headerlink" title="4.5  故障模拟演练"></a>4.5  故障模拟演练</h3>  <br><h4 id="4-5-1-准备数据"><a href="#4-5-1-准备数据" class="headerlink" title="4.5.1 准备数据"></a>4.5.1 准备数据</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> database backup;<br>use backup<br><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> t1 (id <span class="hljs-type">int</span>);<br><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> t1 <span class="hljs-keyword">values</span>(<span class="hljs-number">1</span>),(<span class="hljs-number">2</span>),(<span class="hljs-number">3</span>);<br><span class="hljs-keyword">commit</span>;<br>rm <span class="hljs-operator">-</span>rf <span class="hljs-operator">/</span>backup<span class="hljs-comment">/*</span><br></code></pre></td></tr></table></figure><h4 id="4-5-2-准备周二-23：00点的全备"><a href="#4-5-2-准备周二-23：00点的全备" class="headerlink" title="4.5.2 准备周二 23：00点的全备"></a>4.5.2 准备周二 23：00点的全备</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysqldump <span class="hljs-operator">-</span>uroot <span class="hljs-operator">-</span>p123 <span class="hljs-operator">-</span>A <span class="hljs-operator">-</span>R <span class="hljs-comment">--triggers --set-gtid-purged=OFF --master-data=2 --single-transaction|gzip &gt; /backup/full_$(date +%F).sql.gz</span><br></code></pre></td></tr></table></figure><p><strong>检查备份可用性</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">cd /backup/ ll*<br><span class="hljs-meta">#</span><span class="bash">注意查看备份文件大小和时间点必要时打开文件查看是否备份正确</span><br></code></pre></td></tr></table></figure><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section7-1-7.png" alt="检查备份完整性"></p>  <br><h4 id="4-5-3-模拟周二-23：00到周三-10点之间数据变化"><a href="#4-5-3-模拟周二-23：00到周三-10点之间数据变化" class="headerlink" title="4.5.3 模拟周二 23：00到周三 10点之间数据变化"></a>4.5.3 模拟周二 23：00到周三 10点之间数据变化</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql">use backup<br><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> t1 <span class="hljs-keyword">values</span>(<span class="hljs-number">11</span>),(<span class="hljs-number">22</span>),(<span class="hljs-number">33</span>);<br><span class="hljs-keyword">commit</span>;<br><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> t2 (id <span class="hljs-type">int</span>);<br><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> t2 <span class="hljs-keyword">values</span>(<span class="hljs-number">11</span>),(<span class="hljs-number">22</span>),(<span class="hljs-number">33</span>);<br><span class="hljs-keyword">commit</span>;<br></code></pre></td></tr></table></figure><h4 id="4-5-4-模拟故障-删除表-只是模拟，不代表生产操作"><a href="#4-5-4-模拟故障-删除表-只是模拟，不代表生产操作" class="headerlink" title="4.5.4 模拟故障,删除表(只是模拟，不代表生产操作)"></a>4.5.4 模拟故障,删除表(只是模拟，不代表生产操作)</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">drop</span> database backup;<br></code></pre></td></tr></table></figure>   <br>  <br><h3 id="4-6-恢复过程"><a href="#4-6-恢复过程" class="headerlink" title="4.6 恢复过程"></a>4.6 恢复过程</h3><h4 id="4-6-1-准备临时数据库（多实例3307）"><a href="#4-6-1-准备临时数据库（多实例3307）" class="headerlink" title="4.6.1 准备临时数据库（多实例3307）"></a>4.6.1 准备临时数据库（多实例3307）</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">systemctl <span class="hljs-keyword">start</span> mysqld3307<br></code></pre></td></tr></table></figure><h4 id="4-6-2-准备备份"><a href="#4-6-2-准备备份" class="headerlink" title="4.6.2 准备备份"></a>4.6.2 准备备份</h4><p>（1）准备全备：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">cd /backup<br>gunzip full_2018-10-14.sql.gz <br></code></pre></td></tr></table></figure><p>（2）截取二进制日志</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"> <br><span class="hljs-comment">-- CHANGE MASTER TO MASTER_LOG_FILE=&#x27;mysql-bin.000002&#x27;, MASTER_LOG_POS=753;</span><br>起点 <span class="hljs-number">753</span><br><span class="hljs-keyword">show</span> master status; <span class="hljs-comment">--查看日志 </span><br></code></pre></td></tr></table></figure><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section7-1-8.png" alt="查找日志起点"></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sql">#找终点 <br><br><span class="hljs-keyword">show</span> binlog event <span class="hljs-keyword">in</span> &quot;mysql-bin.000002&quot; <br> <br>#找到终点为：<span class="hljs-number">1519</span> <br> <br>#截取日志<br>mysqlbinlog <span class="hljs-comment">--skip-gtids  --start-position=753 --stop-position=1519 /data/binlog/mysql-bin.000002 &gt;/backup/bin.sql</span><br></code></pre></td></tr></table></figure><h4 id="4-6-3-恢复备份到临时库"><a href="#4-6-3-恢复备份到临时库" class="headerlink" title="4.6.3 恢复备份到临时库"></a>4.6.3 恢复备份到临时库</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql <span class="hljs-operator">-</span>S <span class="hljs-operator">/</span>data<span class="hljs-operator">/</span><span class="hljs-number">3307</span><span class="hljs-operator">/</span>mysql.sock<br><span class="hljs-keyword">set</span> sql_log_bin<span class="hljs-operator">=</span><span class="hljs-number">0</span>; <span class="hljs-comment">--关闭二进制日志</span><br>source <span class="hljs-operator">/</span>backup<span class="hljs-operator">/</span>full_2019<span class="hljs-number">-07</span><span class="hljs-number">-15.</span><span class="hljs-keyword">sql</span><br>source <span class="hljs-operator">/</span>backup<span class="hljs-operator">/</span>bin.sql<br></code></pre></td></tr></table></figure><h4 id="4-6-4-将故障表导出并恢复到生产"><a href="#4-6-4-将故障表导出并恢复到生产" class="headerlink" title="4.6.4 将故障表导出并恢复到生产"></a>4.6.4 将故障表导出并恢复到生产</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysqldump  <span class="hljs-operator">-</span>S <span class="hljs-operator">/</span>data<span class="hljs-operator">/</span><span class="hljs-number">3307</span><span class="hljs-operator">/</span>mysql.sock <span class="hljs-operator">-</span>B backup <span class="hljs-operator">&gt;</span><span class="hljs-operator">/</span>backup<span class="hljs-operator">/</span>bak.sql<br>mysql <span class="hljs-operator">-</span>uroot <span class="hljs-operator">-</span>p123 <br><span class="hljs-keyword">set</span> sql_log_bin<span class="hljs-operator">=</span><span class="hljs-number">0</span><br>source <span class="hljs-operator">/</span>backup<span class="hljs-operator">/</span>bak.sql;<br></code></pre></td></tr></table></figure>  <br>  <br><h2 id="5-恢复练习"><a href="#5-恢复练习" class="headerlink" title="5.恢复练习"></a>5.恢复练习</h2><h4 id="5-1-创建一个数据库-test001"><a href="#5-1-创建一个数据库-test001" class="headerlink" title="5.1 创建一个数据库 test001"></a>5.1 创建一个数据库 test001</h4><p><strong>检查日志是否开启</strong> ： <code>select @@sql_log_bin;</code> </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> database test001 charset utf8mb4;<br></code></pre></td></tr></table></figure><h4 id="5-2-在test001下创建一张表t1"><a href="#5-2-在test001下创建一张表t1" class="headerlink" title="5.2 在test001下创建一张表t1"></a>5.2 在test001下创建一张表t1</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql">use test001;<br><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> t1 (id <span class="hljs-type">int</span>);<br></code></pre></td></tr></table></figure><h4 id="5-3-插入5行任意数据"><a href="#5-3-插入5行任意数据" class="headerlink" title="5.3 插入5行任意数据"></a>5.3 插入5行任意数据</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> ti <span class="hljs-keyword">values</span> (<span class="hljs-number">1</span>),(<span class="hljs-number">2</span>),(<span class="hljs-number">3</span>),(<span class="hljs-number">4</span>),(<span class="hljs-number">5</span>);<br></code></pre></td></tr></table></figure><h4 id="5-4-进行全备"><a href="#5-4-进行全备" class="headerlink" title="5.4 进行全备"></a>5.4 进行全备</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">cd /backup/ <br>mysqldump -uroot -p123 -A --master-data=2 --single-transaction -R -E --triggers &gt; /backup/full.sql<br></code></pre></td></tr></table></figure><h4 id="5-5-检查备份完整性"><a href="#5-5-检查备份完整性" class="headerlink" title="5.5 检查备份完整性"></a>5.5 检查备份完整性</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">vim full.sql  <br></code></pre></td></tr></table></figure><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section7-1-9.png" alt="查看日志完整性"></p><h4 id="5-6-插入两行数据，任意修改3行数据，删除1行数据"><a href="#5-6-插入两行数据，任意修改3行数据，删除1行数据" class="headerlink" title="5.6 插入两行数据，任意修改3行数据，删除1行数据"></a>5.6 插入两行数据，任意修改3行数据，删除1行数据</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> t1 <span class="hljs-keyword">values</span>(<span class="hljs-number">6</span>),(<span class="hljs-number">7</span>),(<span class="hljs-number">8</span>);<br><span class="hljs-keyword">commit</span>;<br>update t1 <span class="hljs-keyword">set</span> id<span class="hljs-operator">=</span><span class="hljs-number">10</span> <span class="hljs-keyword">where</span> id <span class="hljs-operator">&gt;</span> <span class="hljs-number">5</span><br><span class="hljs-keyword">commit</span>;<br><span class="hljs-keyword">delete</span> <span class="hljs-keyword">from</span> t1 <span class="hljs-keyword">where</span> id<span class="hljs-operator">=</span><span class="hljs-number">5</span>;<br><span class="hljs-keyword">commit</span>;<br></code></pre></td></tr></table></figure><h4 id="5-7-删除所有数据"><a href="#5-7-删除所有数据" class="headerlink" title="5.7 删除所有数据"></a>5.7 删除所有数据</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">delete</span> <span class="hljs-keyword">from</span> t1;<br><span class="hljs-keyword">commit</span>;<br></code></pre></td></tr></table></figure><h4 id="5-8-再t1中又插入5行新数据，修改3行数据"><a href="#5-8-再t1中又插入5行新数据，修改3行数据" class="headerlink" title="5.8 再t1中又插入5行新数据，修改3行数据"></a>5.8 再t1中又插入5行新数据，修改3行数据</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> t1 <span class="hljs-keyword">values</span>(<span class="hljs-number">1</span>),(<span class="hljs-number">2</span>),(<span class="hljs-number">3</span>),(<span class="hljs-number">4</span>),(<span class="hljs-number">5</span>);<br><span class="hljs-keyword">commit</span>;<br>update t1 <span class="hljs-keyword">set</span> id<span class="hljs-operator">=</span><span class="hljs-number">10</span> <span class="hljs-keyword">where</span> id<span class="hljs-operator">&gt;</span><span class="hljs-number">2</span>;<br><span class="hljs-keyword">commit</span>;<br></code></pre></td></tr></table></figure><p><strong>需求</strong>：跳过第六步恢复表数据，（第六步为错误插入数据 需要排除）</p><p><strong>确认</strong>：1-5 步操作 是日志 12 -17 号 跳过第六步是15号</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section7-1-10.png" alt="跳过第六步恢复表数据"></p><h4 id="5-9-按照需求恢复数据"><a href="#5-9-按照需求恢复数据" class="headerlink" title="5.9 按照需求恢复数据"></a>5.9 按照需求恢复数据</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">set</span> sql_log_bin<span class="hljs-operator">=</span><span class="hljs-number">0</span>  <span class="hljs-comment">--关闭日志</span><br>source <span class="hljs-operator">/</span>backup<span class="hljs-operator">/</span>full.sql <span class="hljs-comment">--恢复全备</span><br></code></pre></td></tr></table></figure><h2 id="6-扩展参数"><a href="#6-扩展参数" class="headerlink" title="6.扩展参数"></a>6.扩展参数</h2><p>在构建主从时,使用 AUTO/ON</p><p><code>--set-gtid-purged=AUTO/ON</code></p><p> 仅是做普通的本机备份恢复时,可以添加</p><p><code>--set-gtid-purged=OFF</code> </p><p><code>SET @@GLOBAL.GTID_PURGED=&#39;aa648280-a6a6-11e9-949f-000c294a1b3b:1-11&#39;;</code></p><p><code>--max_allowed_packet=128M</code> 控制的是备份时传输数据包的大小.</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">mysqldump -uroot -p123 -A -R --max_allowed_packet=128M --triggers --set-gtid-purged=OFF --master-data=2 --single-transaction|gzip &gt; /backup/full_$(date +%F).sql.gz<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>DBA</category>
      
    </categories>
    
    
    <tags>
      
      <tag>DBA</tag>
      
      <tag>RDBMS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>物理备份与恢复 XBK</title>
    <link href="/2020/07/19/dba07-1/"/>
    <url>/2020/07/19/dba07-1/</url>
    
    <content type="html"><![CDATA[<hr><h1 id="物理备份与恢复-XBK"><a href="#物理备份与恢复-XBK" class="headerlink" title="物理备份与恢复 XBK"></a>物理备份与恢复 XBK</h1><p>[[toc]]</p><h2 id="1-上节回顾"><a href="#1-上节回顾" class="headerlink" title="1.上节回顾"></a>1.上节回顾</h2><br><h3 id="1-1-mysqldump核心参数"><a href="#1-1-mysqldump核心参数" class="headerlink" title="1.1 mysqldump核心参数"></a>1.1 mysqldump核心参数</h3><ul><li>-A  全备</li><li>-B  单表备份</li><li> 库 表  备份</li></ul><p> <code>--master-data=2</code></p><p>(1) 以注释的形式记录二进制日志信息</p><p>(2) 自动开启锁表的功能</p><p>记录二进制日志在备份时的起点号 （就是到23.59分截止的binlog日志position号 ）由于备份时不开启二进制日志所以记录的是备份开始时的起点号用作恢复起点</p> <br><br><p><code>--single-transaction</code> 针对InnoDB进行快照备份</p><p><code>-R</code> </p><p><code>-E</code></p><p><code>--triggers</code> </p><p> <code>--set-gtid-purged=AUTO/ON/OFF</code></p><p>默认是auto，主从复制忽略此参数普通备份,可以设置为OFF。</p><p><code>-F</code> 每次备份刷新出一个新的二进制日志，但是在数据库多的时候会刷一堆出来</p> <br><br><h2 id="2-Xtrabackup"><a href="#2-Xtrabackup" class="headerlink" title="2. Xtrabackup"></a>2. Xtrabackup</h2><h3 id="2-1-备份的过程"><a href="#2-1-备份的过程" class="headerlink" title="2.1 备份的过程"></a>2.1 备份的过程</h3><ul><li>非InnoDB表,进行短暂的锁表,然后Copy数据文件</li><li>对于InnoDB表,立即出发checkpoint,会立即记录一个LSN,COPY数据文件</li><li>将备份过程中产生的redo进行截取和保存,并记录此时最新的LSN</li></ul><br><br><h3 id="2-2-恢复过程"><a href="#2-2-恢复过程" class="headerlink" title="2.2 恢复过程"></a>2.2 恢复过程</h3><ul><li>模拟了CSR的全过程,在恢复之前,将数据的LSN号和redo LSN号追平</li><li>恢复方法就是直接cp回去即可</li></ul> <br><br><h3 id="2-3-XBK全备和恢复体验"><a href="#2-3-XBK全备和恢复体验" class="headerlink" title="2.3. XBK全备和恢复体验"></a>2.3. XBK全备和恢复体验</h3><p>MySQL 物理备份工具  xtrabackup(XBK、Xbackup)</p><br><p> <strong>安装依赖包</strong>：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">wget -O /etc/yum.repos.d/epel.repo http://mirrors.aliyun.com/repo/epel-7.repo<br>yum -y install perl perl-devel libaio libaio-devel perl-Time-HiRes perl-DBD-MySQL libev<br></code></pre></td></tr></table></figure><br><p><strong>下载软件并安装</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">wget https://www.percona.com/downloads/XtraBackup/Percona-XtraBackup-2.4.12/binary/redhat/7/x86_64/percona-xtrabackup-24-2.4.12-1.el7.x86_64.rpm<br>wget https://www.percona.com/downloads/XtraBackup/Percona-XtraBackup-2.4.4/binary/redhat/6/x86_64/percona-xtrabackup-24-2.4.4-1.el6.x86_64.rpm<br>yum -y install percona-xtrabackup-24-2.4.4-1.el7.x86_64.rpm<br></code></pre></td></tr></table></figure><br><p><strong>备份命令</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">innobackupex --user=root --password=123  /data/backup<br></code></pre></td></tr></table></figure> <br><br><p><strong>面试题</strong>： xbk 在innodb表备份恢复的流程</p><ul><li>对于非Innodb表（比如 myisam）是，锁表cp数据文件，属于一种温备份。</li><li>对于Innodb的表（支持事务的），不锁表，拷贝数据页，最终以数据文件的方式保存下来，把一部分redo和undo一并备走，属于热备方式。</li></ul> <br><br><h3 id="2-4-innobackupex-命令使用"><a href="#2-4-innobackupex-命令使用" class="headerlink" title="2.4 innobackupex 命令使用"></a>2.4 innobackupex 命令使用</h3><p><strong>全备</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">innobackupex --user=root --password=123 /data/backup<br></code></pre></td></tr></table></figure><p><strong>参数介绍</strong>：</p><p><strong>自主定制备份路径名</strong></p><p> 全备时有2个比较有意思的参数</p><p><code>--no-timestamp</code>：自定义备份的名字</p><p><code>--defaults-file</code>：读取想要的<code>my.cnf</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">innobackupex --user=root --password=123 --no-timestamp /data/backup/full<br></code></pre></td></tr></table></figure>  <br><br><p><strong>备份集中多出来的文件：</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">-rw-r----- 1 root root    24 Jun 29 09:59 xtrabackup_binlog_info<br>-rw-r----- 1 root root   119 Jun 29 09:59 xtrabackup_checkpoints<br>-rw-r----- 1 root root   489 Jun 29 09:59 xtrabackup_info<br>-rw-r----- 1 root root   2560 Jun 29 09:59 xtrabackup_logfile<br></code></pre></td></tr></table></figure><p><code>xtrabackup_binlog_info</code> ：（备份时刻的binlog位置）</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">cat xtrabackup_binlog_info<br>mysql-bin.000003  536749<br>79de40d3-5ff3-11e9-804a-000c2928f5dd:1-7<br></code></pre></td></tr></table></figure><p>记录的是备份时刻，binlog的文件名字和当时的结束的position，可以用来作为截取 binlog 时的起点。</p> <br><p><code>xtrabackup_checkpoints</code> ：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql">backup_type <span class="hljs-operator">=</span> <span class="hljs-keyword">full</span><span class="hljs-operator">-</span>backuped<br>from_lsn <span class="hljs-operator">=</span> <span class="hljs-number">0</span>     <span class="hljs-comment">--上次所到达的LSN号(对于全备就是从0开始,对于增量有别的显示方法)</span><br>to_lsn <span class="hljs-operator">=</span> <span class="hljs-number">160683027</span>  <span class="hljs-comment">--备份开始时间(ckpt)点数据页的LSN</span><br>last_lsn <span class="hljs-operator">=</span> <span class="hljs-number">160683036</span>  <span class="hljs-comment">--备份结束后，redo日志最终的LSN</span><br>compact <span class="hljs-operator">=</span> <span class="hljs-number">0</span><br>recover_binlog_info <span class="hljs-operator">=</span> <span class="hljs-number">0</span><br></code></pre></td></tr></table></figure><ul><li>备份时刻，立即将已经commit过的，内存中的数据页刷新到磁盘(CKPT).开始备份数据，数据文件的LSN会停留在to_lsn位置。</li><li>备份时刻有可能会有其他的数据写入，已备走的数据文件就不会再发生变化了。</li><li>在备份过程中，备份软件会一直监控着redo的undo，如果一旦有变化会将日志也一并备走，并记录LSN到last_lsn。</li><li>从to_lsn —-&gt; last_lsn 就是，备份过程中产生的数据变化。</li></ul> <br> <br><h3 id="2-5-全备的恢复"><a href="#2-5-全备的恢复" class="headerlink" title="2.5 全备的恢复"></a>2.5 全备的恢复</h3>  <br><p><strong>准备备份（Prepared）</strong></p><p>将redo进行重做，已提交的写到数据文件，未提交的使用undo回滚掉。模拟了CSR的过程</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">innobackupex --apply-log /backup/full<br></code></pre></td></tr></table></figure><p><code>apply-log-only</code> 参数（only 指的就是只回放 redo log 阶段，跳过 undo 阶段），避免未完成事务的回滚。</p>  <br><p><strong>恢复备份</strong></p><p> <strong>前提</strong>：</p><ul><li>被恢复的目录是空</li><li>被恢复的数据库的实例是关闭</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">systemctl stop mysqld<br></code></pre></td></tr></table></figure><p><strong>创建新目录</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">mkdir /data/mysql1<br></code></pre></td></tr></table></figure><p><strong>数据授权</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">chown -R mysql.mysql /data/mysql1<br></code></pre></td></tr></table></figure><p><strong>恢复备份</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">cp -a /backup/full/* /data/mysql1/<br></code></pre></td></tr></table></figure><p><strong>启动数据库</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">vim /etc/my.cnf<br>datadir=/data/mysql1<br>chown -R mysql.mysql /data/mysql1<br>systemctl start mysqld<br></code></pre></td></tr></table></figure>  <br>  <br><h2 id="3-增量备份-Incremental"><a href="#3-增量备份-Incremental" class="headerlink" title="3. 增量备份 Incremental"></a>3. 增量备份 Incremental</h2><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section7-2-2.png" alt="&quot;增量备份"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">innobackupex --user=root --password=123 --no-timestamp /backup/full <br>innobackupex --apply-log /backup/full <br></code></pre></td></tr></table></figure><h3 id="3-1-备份产生的文件介绍"><a href="#3-1-备份产生的文件介绍" class="headerlink" title="3.1 备份产生的文件介绍"></a>3.1 备份产生的文件介绍</h3>   <br><p><code>xtrabackup_binlog_info</code></p><p>记录备份时刻的二进制日志信息. 可以作为binlog截取的起点.</p>  <br><p><code>xtrabackup_checkpoints</code></p><p>可以检测备份对不对</p><p><code>from</code> : 备份中包含的LSN号的起点,全备:0,增量:上次备份的结束位置</p><p><code>to</code>     : ckpt 时的LSN</p><p><code>last-9</code> : 备份结束时的LSN.下次增量备份的起始位置. 预留了9个 说明没有</p>  <br><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section7-2-1.png" alt="xtrabackup_checkpoints"></p>  <br>  <br><h3 id="3-2-物理备份过程"><a href="#3-2-物理备份过程" class="headerlink" title="3.2  物理备份过程"></a>3.2  物理备份过程</h3><h4 id="3-2-1-清空备份路径"><a href="#3-2-1-清空备份路径" class="headerlink" title="3.2.1 清空备份路径"></a>3.2.1 清空备份路径</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">\rm -rf /backup/*<br></code></pre></td></tr></table></figure>  <br><h4 id="3-2-2-模拟数据"><a href="#3-2-2-模拟数据" class="headerlink" title="3.2.2 模拟数据"></a>3.2.2 模拟数据</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> database <span class="hljs-keyword">full</span> charset utf8mb4;<br>use <span class="hljs-keyword">full</span>;<br><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> t1 (id <span class="hljs-type">int</span>);<br><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> t1 <span class="hljs-keyword">values</span>(<span class="hljs-number">1</span>),(<span class="hljs-number">2</span>),(<span class="hljs-number">3</span>);<br><span class="hljs-keyword">commit</span>;<br></code></pre></td></tr></table></figure>  <br><h4 id="3-2-3-进行周日的全备"><a href="#3-2-3-进行周日的全备" class="headerlink" title="3.2.3 进行周日的全备"></a>3.2.3 进行周日的全备</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">innobackupex <span class="hljs-comment">--user=root --password=123 --no-timestamp /backup/full</span><br></code></pre></td></tr></table></figure>  <br><h4 id="3-2-4-模拟周一的数据变化"><a href="#3-2-4-模拟周一的数据变化" class="headerlink" title="3.2.4 模拟周一的数据变化"></a>3.2.4 模拟周一的数据变化</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> database inc1 charset utf8mb4;<br>use inc1;<br><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> t1 (id <span class="hljs-type">int</span>);<br><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> t1 <span class="hljs-keyword">values</span>(<span class="hljs-number">1</span>),(<span class="hljs-number">2</span>),(<span class="hljs-number">3</span>);<br><span class="hljs-keyword">commit</span>;<br></code></pre></td></tr></table></figure>  <br><h4 id="3-2-5-进行周一的增量备份"><a href="#3-2-5-进行周一的增量备份" class="headerlink" title="3.2.5 进行周一的增量备份"></a>3.2.5 进行周一的增量备份</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">innobackupex  --user=root --password=123 --no-timestamp --incremental --incremental-basedir=/backup/full /backup/inc1 <br></code></pre></td></tr></table></figure>  <br><p><strong>说明</strong>:<br><code>--incremental</code>    开关 开启增量备份<br><code>--incremental-basedir=/backup/full</code> 基于哪个备份进行增量<br><code>/backup/inc1</code>     增量备份的位置点</p>  <br>  <br><h4 id="3-2-6-检查备份的LSN"><a href="#3-2-6-检查备份的LSN" class="headerlink" title="3.2.6 检查备份的LSN"></a>3.2.6 检查备份的LSN</h4>  <br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell">cat /backup/full/xtrabackup_checkpoints #全备的<br>backup_type = full-backuped<br>from_lsn = 0<br>to_lsn = 217478672 #结束位置<br>last_lsn = 217478681 #默认间隔9个<br>compact = 0<br>recover_binlog_info = 0<br></code></pre></td></tr></table></figure>  <br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell">cat /backup/inc1/xtrabackup_checkpoints #增量备份1的<br>backup_type = incremental<br>from_lsn = 217478672  #全备结束位置<br>to_lsn = 217484653<br>last_lsn = 217484662 #默认间隔9个<br>compact = 0<br>recover_binlog_info = 0<br></code></pre></td></tr></table></figure><br><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section7-2-3.png" alt="xtrabackup_checkpoints对应图"></p><h4 id="3-2-7-模拟周二数据变化"><a href="#3-2-7-模拟周二数据变化" class="headerlink" title="3.2.7 模拟周二数据变化"></a>3.2.7 模拟周二数据变化</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> database inc2 charset utf8mb4;<br>use inc2;<br><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> t1 (id <span class="hljs-type">int</span>);<br><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> t1 <span class="hljs-keyword">values</span>(<span class="hljs-number">1</span>),(<span class="hljs-number">2</span>),(<span class="hljs-number">3</span>);<br><span class="hljs-keyword">commit</span>;<br></code></pre></td></tr></table></figure><h4 id="3-2-8-周二的增量备份"><a href="#3-2-8-周二的增量备份" class="headerlink" title="3.2.8  周二的增量备份"></a>3.2.8  周二的增量备份</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">innobackupex  --user=root --password=123 --no-timestamp --incremental --incremental-basedir=/backup/inc1 /backup/inc2 <br></code></pre></td></tr></table></figure><h4 id="3-2-9-周三的数据变化"><a href="#3-2-9-周三的数据变化" class="headerlink" title="3.2.9 周三的数据变化"></a>3.2.9 周三的数据变化</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> database inc3 charset utf8mb4;<br>use inc3;<br><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> t1 (id <span class="hljs-type">int</span>);<br><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> t1 <span class="hljs-keyword">values</span>(<span class="hljs-number">1</span>),(<span class="hljs-number">2</span>),(<span class="hljs-number">3</span>);<br><span class="hljs-keyword">commit</span>;<br></code></pre></td></tr></table></figure><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section7-2-4.png" alt="xtrabackup_checkpoints对应图"></p><br><h3 id="3-3-模拟数据库崩溃安全演练"><a href="#3-3-模拟数据库崩溃安全演练" class="headerlink" title="3.3 模拟数据库崩溃安全演练"></a>3.3 模拟数据库崩溃安全演练</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">pkill mysqld <br>\rm -rf /data/mysql/data/*<br></code></pre></td></tr></table></figure><h4 id="3-3-1-恢复思路"><a href="#3-3-1-恢复思路" class="headerlink" title="3.3.1 恢复思路"></a>3.3.1 恢复思路</h4><ol><li><p>停业务,挂维护页</p></li><li><p>查找可用备份并处理备份:full+inc1+inc2 </p></li><li><p>binlog: inc2 到 故障时间点的binlog</p></li><li><p>恢复全备+增量+binlog</p></li><li><p>验证数据</p></li><li><p>起业务,撤维护页</p>  <br>  <br></li></ol><h4 id="3-3-2-恢复前的准备"><a href="#3-3-2-恢复前的准备" class="headerlink" title="3.3.2 恢复前的准备"></a>3.3.2 恢复前的准备</h4><p>(1) 整理full</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">innobackupex --apply-log --redo-only  /backup/full   <br></code></pre></td></tr></table></figure><p><code>apply-log</code>  把rudo undo 都应用一下 CSR过程</p><p><code>redo-only</code> 这个选项在整理全备和所有的增量备份合并时使用 除了最后一次增量 ,不做UNDO</p> <br><p>(2) 合并inc1到full,并整理备份</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">innobackupex --apply-log --redo-only --incremental-dir=/backup/inc1 /backup/full <br></code></pre></td></tr></table></figure><p>(3) 合并inc2到full,并整理备份 </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">innobackupex --apply-log --incremental-dir=/backup/inc2 /backup/full <br></code></pre></td></tr></table></figure><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section7-2-5.png" alt="last_lsn追上了"></p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section7-2-6.png" alt="last_lsn追上了"></p><p>合并后可以看到 last_lsn的号码都一致了</p><p>(4) 最后一次整理full</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">innobackupex --apply-log /backup/full<br></code></pre></td></tr></table></figure><p>此时已经恢复到周二晚上的备份</p><br><br><h4 id="3-3-3-截取二进制日志恢复"><a href="#3-3-3-截取二进制日志恢复" class="headerlink" title="3.3.3 截取二进制日志恢复"></a>3.3.3 截取二进制日志恢复</h4><br><p>首先要确认昨晚的备份到今天数据库宕机之前的binlog 起点和终点用于恢复</p><p><strong>起点</strong>: 参数记录的</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">cat /backup/inc2/xtrabackup_binlog_info<br>mysql-bin.0000311997aa648280-a6a6-11e9-949f-000c294a1b3b:1-17,<br>e16db3fd-a6e8-11e9-aee9-000c294a1b3b:1-9<br></code></pre></td></tr></table></figure><p><strong>终点</strong>: 查询当前二进制日志文件</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">mysqlbinlog /data/binlog/mysql-bin.000031 |grep &#x27;SET&#x27;<br>SET @@SESSION.GTID_NEXT= &#x27;e16db3fd-a6e8-11e9-aee9-000c294a1b3b:12&#x27;/*!*/;<br></code></pre></td></tr></table></figure><br><br><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section7-2-7.png" alt="确定终点"></p><br><p>通过分析得到 是从10号开始到12号结束，截取二进制文件得到昨晚到今天宕机之前的数据</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">mysqlbinlog --skip-gtids --include-gtids=&#x27;e16db3fd-a6e8-11e9-aee9-000c294a1b3b:10-12&#x27; /data/binlog/mysql-bin.000031&gt;/backup/binlog.sql<br></code></pre></td></tr></table></figure><br><h4 id="3-3-4-恢复备份数据"><a href="#3-3-4-恢复备份数据" class="headerlink" title="3.3.4 恢复备份数据"></a>3.3.4 恢复备份数据</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">cp -a /backup/full/* /data/mysql/data/<br>chown -R mysql. /data/<br>/etc/init.d/mysqld start<br><span class="hljs-meta">mysql&gt;</span><span class="bash"> <span class="hljs-built_in">set</span> sql_log_bin=0;</span><br><span class="hljs-meta">mysql&gt;</span><span class="bash"> <span class="hljs-built_in">source</span> /backup/binlog.sql</span><br></code></pre></td></tr></table></figure> <br><p><strong>验证数据</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> full.t1;<br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> inc1.t1;<br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> inc2.t1;<br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> inc3.t1;<br></code></pre></td></tr></table></figure> <br> <br><h2 id="4-旧版数据迁移到新版"><a href="#4-旧版数据迁移到新版" class="headerlink" title="4. 旧版数据迁移到新版"></a>4. 旧版数据迁移到新版</h2><p>(5.6.44  —&gt;  5.7.26) 版本</p><h3 id="4-1-搭建5-6的测试环境"><a href="#4-1-搭建5-6的测试环境" class="headerlink" title="4.1 搭建5.6的测试环境"></a>4.1 搭建5.6的测试环境</h3><p>(1)创建必须的目录</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">mkdir /data/mysql/data  -p <br>mkdir /application/ -p<br>mkdir /data/binlog -p<br></code></pre></td></tr></table></figure><p>上传软件至 <code>/application</code> 下并解压</p><p>上传软件至 <code>/application</code> 下并解压</p><p>(2) 建用户,改权限</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">useradd mysql<br>chown -R mysql. /data /application/<br></code></pre></td></tr></table></figure><p>(3) 修改环境变量</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">vim /etc/profile<br>export PATH=/application/mysql/bin:$PATH<br>source /etc/profile<br></code></pre></td></tr></table></figure><p>(4)数据初始化 </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">yum remove mariadb-libs<br>yum install -y libaio-devel<br>\rm -rf /data/mysql/data/*<br>/application/mysql/scripts/mysql_install_db --user=mysql --basedir=/application/mysql --datadir=/data/mysql/data<br></code></pre></td></tr></table></figure><p>(5) 准备配置文件和启动脚本</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs shell">cat &gt; /etc/my.cnf &lt;&lt;EOF<br>[mysqld]<br>basedir=/application/mysql <br>datadir=/data/mysql/data <br>server_id=99<br>user=mysql<br>log_bin=/data/binlog/mysql-bin<br>binlog_format=row<br>socket=/tmp/mysql.sock <br>[mysql]<br>socket=/tmp/mysql.sock<br>EOF<br><br>cp  /application/mysql/support-files/mysql.server /etc/init.d/mysqld<br></code></pre></td></tr></table></figure><p>(5) 启动数据库</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">/etc/init.d/mysqld start<br>mysqladmin -uroot -p password 123<br></code></pre></td></tr></table></figure><h3 id="4-2-迁移5-6-数据到-5-7"><a href="#4-2-迁移5-6-数据到-5-7" class="headerlink" title="4.2 迁移5.6 数据到 5.7"></a>4.2 迁移5.6 数据到 5.7</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">--导入t100w数据</span><br><span class="hljs-keyword">select</span> count（<span class="hljs-operator">*</span>）<span class="hljs-keyword">from</span> t100w;<br></code></pre></td></tr></table></figure><p>(1) 5.6 数据库备份</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">mysqldump -uroot -p123 -A --master-data=2 --single-transaction -R -E --triggers &gt;/tmp/full.sql<br>scp /tmp/full.sql 10.0.0.51:/data/3308 <br></code></pre></td></tr></table></figure><p>(2)恢复数据到 5.7版本数据库</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs powershell">systemctl <span class="hljs-built_in">start</span> mysqld3308<br>mysql <span class="hljs-literal">-S</span> /<span class="hljs-keyword">data</span>/<span class="hljs-number">3308</span>/mysql.sock<br>mysql&gt; source /<span class="hljs-keyword">data</span>/<span class="hljs-number">3308</span>/full.sql<br>mysql_upgrade  <span class="hljs-literal">-uroot</span> <span class="hljs-literal">-p123</span> <span class="hljs-literal">-S</span> /<span class="hljs-keyword">data</span>/<span class="hljs-number">3308</span>/mysql.sock --数据升级到新版本<br></code></pre></td></tr></table></figure><p>最后通过不断追加新的二进制日志在数据同步的差不多时候，停业务业务割接,恢复剩余的binlog，原始库一般要静止2月。</p>]]></content>
    
    
    <categories>
      
      <category>DBA</category>
      
    </categories>
    
    
    <tags>
      
      <tag>DBA</tag>
      
      <tag>RDBMS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>常用日志文件类型介绍</title>
    <link href="/2020/07/18/dba06/"/>
    <url>/2020/07/18/dba06/</url>
    
    <content type="html"><![CDATA[<hr><p>title: 常用日志文件类型介绍<br>##intro:  集群架构环境统一规划说明<br>##featured_image: ss5.jpg<br>tags:<br>    - DBA<br>    - RDBMS<br>categories: </p><ul><li>DBA<br>date: 2020-7-16 13:13:01</li></ul><hr><h1 id="常用日志文件类型介绍"><a href="#常用日志文件类型介绍" class="headerlink" title="常用日志文件类型介绍"></a>常用日志文件类型介绍</h1><p>[[toc]]</p><h2 id="日志管理"><a href="#日志管理" class="headerlink" title="日志管理"></a>日志管理</h2><br><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1.png" alt="日志管理1"></p><br><ul><li>错误日志是用来拍错</li><li>慢速查询用来调优</li><li>二进制日志恢复数据另外与主从复制相关</li></ul><br><h3 id="1-错误日志"><a href="#1-错误日志" class="headerlink" title="1. 错误日志"></a><strong>1. 错误日志</strong></h3><h4 id="1-1-作用"><a href="#1-1-作用" class="headerlink" title="1.1 作用"></a>1.1 作用</h4><p>用来排查 MySQL 服务运行过程中的故障。</p><br><br><h4 id="1-2-默认配置"><a href="#1-2-默认配置" class="headerlink" title="1.2 默认配置"></a>1.2 默认配置</h4><p><strong>默认开启</strong></p><p><strong>默认路径和名字</strong>: <code>datadir/hostname.err</code></p><p><strong>查看方法</strong>: <code>[ERROR]</code> 重点关注</p><br><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-2.png" alt="日志管理2"></p><br><h4 id="1-3-自定义日志存储位置"><a href="#1-3-自定义日志存储位置" class="headerlink" title="1.3 自定义日志存储位置"></a>1.3 自定义日志存储位置</h4><p>建议异地存放，日志位置和数据存储分开，避免目录磁盘坏了时日志文件也丢失了可能导致无法恢复。</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-3.png" alt="日志管理3"></p><p><code>vim /etc/my.cnf</code>  添加到配置文件</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-4.png" alt="日志管理4"></p><p>可以看到已经有这个文件了</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-5.png" alt="日志管理5"></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql">log_error<span class="hljs-operator">=</span><span class="hljs-operator">/</span>tmp<span class="hljs-operator">/</span>mysql3306.log <span class="hljs-comment">-- 重启生效</span><br><span class="hljs-keyword">select</span> @<span class="hljs-variable">@log</span>_error; <span class="hljs-comment">--查询错误日志位置</span><br></code></pre></td></tr></table></figure><br><ol><li><h3 id="二进制日志（重要知识点-star2-）"><a href="#二进制日志（重要知识点-star2-）" class="headerlink" title="二进制日志（重要知识点:star2:）"></a>二进制日志（重要知识点:star2:）</h3></li></ol><br><h4 id="2-1-作用"><a href="#2-1-作用" class="headerlink" title="2.1 作用"></a>2.1 作用</h4><ul><li>部署主从复制依赖二进制日志</li><li>数据恢复时需要依赖于二进制日志</li></ul><h3 id="2-2-如何配置？"><a href="#2-2-如何配置？" class="headerlink" title="2.2 如何配置？"></a>2.2 如何配置？</h3><p>(1) 参数介绍</p><p> 默认没有开启需要手动定义开启。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">server_id=6    一共65535<br>log_bin=/data/binlog/mysql-bin  设置二进制日志的位置<br></code></pre></td></tr></table></figure><p><strong>说明</strong>：</p><p><code>/data/binlog</code> : 提前定制好的目录, 而且要有<code>mysql.mysql</code> 的权限<br><code>mysql-bin</code>      : 二进制日志文件名的前缀<br>例如: <code>mysql-bin.000001</code>  ,<code>mysql-bin.000002</code> ……</p><p>(2) 参数配置</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">server_id=6<br>log_bin=/data/binlog/mysql-bin<br>binlog_format=row<br></code></pre></td></tr></table></figure><p>(3) 创建目录和授权</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">mkdir -p /data/binlog/<br>chown -R mysql.mysql /data<br></code></pre></td></tr></table></figure><p>(4)重启生效</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">[root@db01 tmp]<span class="hljs-comment"># /etc/init.d/mysqld restart</span><br>Shutting down MySQL.. SUCCESS! <br>Starting MySQL. SUCCESS! <br></code></pre></td></tr></table></figure><br><br><h3 id="3-二进制文件记录了什么？"><a href="#3-二进制文件记录了什么？" class="headerlink" title="3. 二进制文件记录了什么？"></a>3. 二进制文件记录了什么？</h3><h4 id="3-1-概括"><a href="#3-1-概括" class="headerlink" title="3.1 概括"></a>3.1 概括</h4><p>记录的数据库所有变更类的操作日志  如：</p><ul><li>DDL 以语句的方式,原模原样的记录.</li><li>DCL 以语句的方式,原模原样的记录.</li><li>DML insert  update delete 操作 （记录的已提交的事务DML语句）</li></ul><p>DML记录格式(statement,row,mixed),通过<code>binlog_format=row</code>参数控制</p><br><p><strong>说明:</strong></p><ul><li><strong>statement</strong>:SBR,语句模式记录日志,做什么命令,记录什么命令.</li><li><strong>row</strong>  :RBR,行模式, 记录数据行的变化 记录数据行 由A=1 变成 A=2的变化过程 redo是记录数据页的变化</li><li><strong>mixed</strong>:MBR,混合模式由MySQL自己调整决定用那种模式 。 一般不用</li></ul><br><p><strong>面试问题:</strong> SBR和RBR什么区别?  怎么选择?</p><p><strong>SBR</strong>:  可读性较强,对于范围操作日志量少,但是可能会出现记录不准确的情况.          </p><p><strong>如</strong>：<code>update t1 set name=&#39;zs&#39;  where id &gt; 5</code> 对五行数据进行修改，但只记录命令。</p><p><code>instart into t1 values （1，&#39;zs&#39;,now()）</code>; 时间列录入时是以前的时间，有可能出现记录不准确问题</p><br><p><strong>RBR</strong>:  可读性较弱,对于范围操作日志大,不会出现记录错误.</p><p> 高可用环境中的新特性要依赖于RBR</p><p><strong>如</strong>：同一个语句要记录5行操作  哪一行变动了就记录几行</p><p>我们公司对数据的严谨性要求较高,也用用到了新型的架构,所以选择RBR。</p><br><br><h3 id="4-二进制日志记录单元"><a href="#4-二进制日志记录单元" class="headerlink" title="4  二进制日志记录单元"></a>4  二进制日志记录单元</h3><h4 id="4-1-event-事件"><a href="#4-1-event-事件" class="headerlink" title="4.1 event 事件"></a>4.1 event 事件</h4><p>二进制日志的最小单元</p><br><p><strong>如</strong>：DDL   <code>create database xin;</code>  事件1</p><p>对于DDL等语句是每一个语句就是一个事件</p><br><p>而 DML: 一个事务包含了多个语句</p><p><code>begin;</code>     事件1<br><code>a</code>             事件2<br><code>b</code>             事件3<br><code>commit;</code>   事件4 </p><br><h4 id="4-2-event-事件的开始和结束位置"><a href="#4-2-event-事件的开始和结束位置" class="headerlink" title="4.2 event 事件的开始和结束位置"></a>4.2 event 事件的开始和结束位置</h4><p>方便我们从日志中截取我们想要的日志事件.</p><br><br><h3 id="5-二进制日志的管理"><a href="#5-二进制日志的管理" class="headerlink" title="5. 二进制日志的管理"></a>5. 二进制日志的管理</h3><h4 id="5-1-查看二进制日志存储位置"><a href="#5-1-查看二进制日志存储位置" class="headerlink" title="5.1 查看二进制日志存储位置"></a>5.1 查看二进制日志存储位置</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">show</span> variables <span class="hljs-keyword">like</span> <span class="hljs-string">&#x27;%log_bin%&#x27;</span>;<br></code></pre></td></tr></table></figure><br><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-6.png" alt="Section6-1-6.png"></p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-7.png" alt="Section6-1-7.png"><br><br></p><h4 id="5-2-查看所有已存在的二进制日志"><a href="#5-2-查看所有已存在的二进制日志" class="headerlink" title="5.2 查看所有已存在的二进制日志"></a>5.2 查看所有已存在的二进制日志</h4><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">show</span> <span class="hljs-type">binary</span> logs;<br>flush logs; <span class="hljs-comment">--滚动一个新的日志</span><br><span class="hljs-keyword">show</span> <span class="hljs-type">binary</span> logs;<br></code></pre></td></tr></table></figure><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-8.png" alt="Section6-1-8.png"></p><br><p><strong>查看正在使用的二进制日志</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">show</span> master status ;<br></code></pre></td></tr></table></figure><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-9.png" alt="Section6-1-9.png"><br><br></p><p><strong>查看二进制日志事件</strong> </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql">模拟建表操作<br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">create</span> database binlog charset utf8mb4;<br>mysql<span class="hljs-operator">&gt;</span> use binlog<br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> t1(id <span class="hljs-type">int</span>);<br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> t1 <span class="hljs-keyword">values</span>(<span class="hljs-number">1</span>);<br></code></pre></td></tr></table></figure><p>:hammer_and_wrench:注意：二进制日志只记录事务提交后的日志 </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">show</span> master status ;<br><span class="hljs-operator">+</span><span class="hljs-comment">------------------+----------+--------------+------------------+-------------------+</span><br><span class="hljs-operator">|</span> File       <span class="hljs-operator">|</span> Position <span class="hljs-operator">|</span> Binlog_Do_DB <span class="hljs-operator">|</span> Binlog_Ignore_DB <span class="hljs-operator">|</span> Executed_Gtid_Set <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">------------------+----------+--------------+------------------+-------------------+</span><br><span class="hljs-operator">|</span> mysql<span class="hljs-operator">-</span>bin<span class="hljs-number">.000004</span> <span class="hljs-operator">|</span>   <span class="hljs-number">501</span> <span class="hljs-operator">|</span>       <span class="hljs-operator">|</span>         <span class="hljs-operator">|</span>          <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">------------------+----------+--------------+------------------+-------------------+</span><br><span class="hljs-number">1</span> <span class="hljs-type">row</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)<br></code></pre></td></tr></table></figure><p><strong>查看日志：</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">show</span> binlog events <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;mysql-bin.000004&#x27;</span> limit <span class="hljs-number">5</span>; 只看前五行内容<br></code></pre></td></tr></table></figure><p><strong>前两行为二进制文件的头部格式信息何版本信息</strong></p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-10.png" alt="Section6-1-10.png"></p><p>经过查找从第三行开始</p><p>根据Position号码截取事务 219-335 标识事务开始位置和结束位置</p><p> 只记录事务提交后的日志提交后：</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-11.png" alt="Section6-1-11.png"></p><h4 id="5-3-查看二进制文件内容"><a href="#5-3-查看二进制文件内容" class="headerlink" title="5.3 查看二进制文件内容"></a>5.3 <strong>查看二进制文件内容</strong></h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">mysqlbinlog mysql-bin.000004 | grep -v <span class="hljs-string">&#x27;^SET&#x27;</span><br></code></pre></td></tr></table></figure><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-12.png" alt="Section6-1-12.png"></p><p><strong>翻译一下：</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">mysqlbinlog --base64-output=decode-rows -vvv mysql-bin.000004 <br></code></pre></td></tr></table></figure><p>sssss</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-13.png" alt="Section6-1-13.png"></p><p>意思是 在1号列插入值1</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">mysqlbinlog -d haoge mysql-bin.000004 按库过滤日志 <br></code></pre></td></tr></table></figure><br><h4 id="5-4-截取二进制日志"><a href="#5-4-截取二进制日志" class="headerlink" title="5.4 截取二进制日志"></a>5.4 截取二进制日志</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">[root@db01 binlog]<span class="hljs-comment"># mysqlbinlog --start-position=219 --stop-position=335 mysql-bin.000004 &gt;/tmp/a.sql</span><br></code></pre></td></tr></table></figure><br><h4 id="5-5-通过binlog恢复数据"><a href="#5-5-通过binlog恢复数据" class="headerlink" title="5.5 通过binlog恢复数据"></a>5.5 通过binlog恢复数据</h4><p>只要二进制日志全就会恢复任何时间点的数据，因为记录日志还做一遍就恢复了</p><p><strong>(1) 模拟数据</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">create</span> database test11 charset utf8mb4;<br>mysql<span class="hljs-operator">&gt;</span> use haoge;<br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> t1(id <span class="hljs-type">int</span>);<br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> t1 <span class="hljs-keyword">values</span>(<span class="hljs-number">1</span>);<br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">commit</span>;<br></code></pre></td></tr></table></figure><p><strong>(2)模拟故障</strong> </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">drop</span> database test11;<br></code></pre></td></tr></table></figure><p><strong>(3)分析和截取 binlog</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">show</span> master status ;    <span class="hljs-comment">---&gt;确认使用的是哪一个日志 确认是004号日志文件</span><br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">show</span> binlog events <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;mysql-bin.000004&#x27;</span> ;   <span class="hljs-comment">---&gt;查看事件</span><br></code></pre></td></tr></table></figure><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-14.png" alt="日志截取"></p><p><strong>说明:</strong> 找到起点和终点,进行截取</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">mysqlbinlog --start-position=823 --stop-position=1420 /data/binlog/mysql-bin.000004 &gt;/tmp/bin.sql<br></code></pre></td></tr></table></figure><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-15.png" alt="日志截取2"></p><p><strong>(4) 恢复binlog</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">set</span> sql_log_bin<span class="hljs-operator">=</span><span class="hljs-number">0</span>;    <span class="hljs-comment">---&gt;在此会话中临时关闭二进制日志    避免恢复时产生的新日志</span><br>mysql<span class="hljs-operator">&gt;</span> source <span class="hljs-operator">/</span>tmp<span class="hljs-operator">/</span>bin.sql<br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">set</span> sql_log_bin<span class="hljs-operator">=</span><span class="hljs-number">1</span>; <span class="hljs-keyword">set</span> sql_log_bin<span class="hljs-operator">=</span><span class="hljs-number">1</span>;    <span class="hljs-comment">---&gt;改回来</span><br></code></pre></td></tr></table></figure><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-16.png" alt="日志截取"></p><p><strong>问题来了， 如果业务跑了两年了，怎么找日志？</strong> </p><p>二进制虽然可以数据恢复，但是它的功能性上是有缺陷的导致它只能作为数据恢复的辅助手段</p><p><strong>如</strong>： 全备份 +二进制日志恢复，先找到最新的全备份然后在用二进制日志恢复到今天的数据就行。</p><br><br><h3 id="6-GTID-记录模式管理-star"><a href="#6-GTID-记录模式管理-star" class="headerlink" title="6. GTID 记录模式管理  :star:"></a>6. GTID 记录模式管理  :star:</h3><h4 id="6-1-GTID-介绍"><a href="#6-1-GTID-介绍" class="headerlink" title="6.1 GTID 介绍"></a>6.1 GTID 介绍</h4><ul><li><p>对于binlog中的每一个事务,都会生成一个GTID号码</p></li><li><p>DDL ,DCL 一个event就是一个事务,就会有一个GTID号.</p></li><li><p>DML语句来讲,begin到commit,是一个事务,就是一个GTID号</p></li></ul><br><h4 id="6-2-GTID的组成"><a href="#6-2-GTID的组成" class="headerlink" title="6.2 GTID的组成"></a><strong>6.2 GTID的组成</strong></h4><p>由两部分组成<br><strong>severi_uuid:TID</strong> 事务的号码</p><p><strong>severi_uuid</strong> 在 <code>auto.cnf</code> 中查看</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">[root@db01 data]<span class="hljs-comment"># cat auto.cnf </span><br>[auto]<br>server-uuid=d60b549f-9e10-11e9-ab04-000c294a1b3b<br></code></pre></td></tr></table></figure><p>**TID **是一个自增长的数据,从1开始  如：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">d60b549f-9e10-11e9-ab04-000c294a1b3b:1-15<br></code></pre></td></tr></table></figure><br><br><h4 id="6-3-GTID的幂等性"><a href="#6-3-GTID的幂等性" class="headerlink" title="6.3 GTID的幂等性"></a>6.3 GTID的幂等性</h4><p>如果拿有GTID的日志去恢复时,检查当前系统中是否有相同GTID号,有相同的就自动跳过  </p><p>同Ansible剧本跳过同理会影响到binlog恢复和主从复制。</p><br><br><h4 id="6-4-GTID的开启和配置"><a href="#6-4-GTID的开启和配置" class="headerlink" title="6.4 GTID的开启和配置"></a>6.4 GTID的开启和配置</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">vim /etc/my.cnf<br>gtid-mode=on<br>enforce-gtid-consistency=<span class="hljs-literal">true</span> 强制gtid一致性<br></code></pre></td></tr></table></figure><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-17.png" alt="GTID"></p><p><strong>注意</strong>：开启后止影响以后的事务 以前的管不着</p><br><h4 id="6-5-查看GTID信息"><a href="#6-5-查看GTID信息" class="headerlink" title="6.5 查看GTID信息"></a>6.5 查看GTID信息</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">create</span> database gtid charset utf8mb4; 创建一个库<br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">show</span> master status; 查看gtid号码 已经产生gtid<br>mysql<span class="hljs-operator">&gt;</span> use gtid;<br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> t1(id <span class="hljs-type">int</span>); 创建一个表<br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">show</span> master status;  查看gtid号码 已经产生gtid <span class="hljs-number">1</span><span class="hljs-number">-2</span><br></code></pre></td></tr></table></figure><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-18.png" alt="GTID2"></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> t1 <span class="hljs-keyword">values</span>(<span class="hljs-number">1</span>);<br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">commit</span>;<br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">show</span> master status; <br></code></pre></td></tr></table></figure><p><strong>提交之后才算一个事务</strong>  </p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-19.png" alt="GTID3"><br><br></p><p><strong>开了GTID 后的日志信息</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">show</span> binlog events <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;mysql-bin.000005&#x27;</span> <br></code></pre></td></tr></table></figure><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-20.png" alt="GTID3"></p><br><br><h3 id="7-基于GTID-恢复数据"><a href="#7-基于GTID-恢复数据" class="headerlink" title="7. 基于GTID 恢复数据"></a>7. 基于GTID 恢复数据</h3><p>开启GTID 后只需截取GTID日志就可以了，GTID是全局事务唯一标号。</p><br><h4 id="7-1-截取日志"><a href="#7-1-截取日志" class="headerlink" title="7.1 截取日志"></a>7.1 <strong>截取日志</strong></h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">[root@db01 data]<span class="hljs-comment"># cd /data/binlog/</span><br>[root@db01 binlog]<span class="hljs-comment"># mysqlbinlog --include-gtids=&#x27;d60b549f-9e10-11e9-ab04-000c294a1b3b:1-3&#x27; mysql-bin.000005 &gt;/tmp/gtid.sql</span><br></code></pre></td></tr></table></figure><br><h4 id="7-2-恢复数据"><a href="#7-2-恢复数据" class="headerlink" title="7.2 恢复数据"></a>7.2 恢复数据</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">set</span> sql_log_bin<span class="hljs-operator">=</span><span class="hljs-number">0</span>; 暂时关闭日志<br>mysql<span class="hljs-operator">&gt;</span> source <span class="hljs-operator">/</span>tmp<span class="hljs-operator">/</span>gtid.sql 恢复<br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">set</span> sql_log_bin<span class="hljs-operator">=</span><span class="hljs-number">1</span>; 开启日志<br></code></pre></td></tr></table></figure><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-21.png" alt="GTID恢复"><br><br></p><br><h4 id="7-3-报错"><a href="#7-3-报错" class="headerlink" title="7.3 报错"></a>7.3 报错</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql">ERROR <span class="hljs-number">1049</span> (<span class="hljs-number">42000</span>): <span class="hljs-literal">Unknown</span> database <span class="hljs-string">&#x27;gtid&#x27;</span><br>Query OK, <span class="hljs-number">0</span> <span class="hljs-keyword">rows</span> affected (<span class="hljs-number">0.00</span> sec)<br>ERROR <span class="hljs-number">1046</span> (<span class="hljs-number">3</span>D000): <span class="hljs-keyword">No</span> database selected<br></code></pre></td></tr></table></figure><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-22.png" alt="GTID恢复报错"><br><br></p><p><strong>为什么报错?</strong></p><p>因为幂等性的检查,1-3事务已经做过了。</p><p><strong>正确的做法</strong>：</p><p>在导出的时候应该忽略GTID的幂等性。 当成新的事务来对待 1-4  跳过并记录新ID号</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">mysqlbinlog --skip-gtids --include-gtids=<span class="hljs-string">&#x27;d60b549f-9e10-11e9-ab04-000c294a1b3b:1-3&#x27;</span> mysql-bin.000005 &gt;/tmp/gtid.sql<br>--skip-gtids <br></code></pre></td></tr></table></figure><p><strong>作用</strong>:在导出时,忽略原有的gtid信息,恢复时生成最新的 GTID 信息</p><p><strong>恢复数据</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">set</span> sql_log_bin<span class="hljs-operator">=</span><span class="hljs-number">0</span>;<br>source <span class="hljs-operator">/</span>tmp<span class="hljs-operator">/</span>gtid.sql<br><span class="hljs-keyword">set</span> sql_log_bin<span class="hljs-operator">=</span><span class="hljs-number">1</span>;<br></code></pre></td></tr></table></figure><br><p><strong>GTID相关的参数</strong>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">--skip-gtids <span class="hljs-comment">#忽略原有的GTID 信息,恢复时生成最新的 GTID 信息</span><br>--include-gtids=<span class="hljs-string">&#x27;d60b549f-9e10-11e9-ab04-000c294a1b3b:6&#x27;</span>,<span class="hljs-string">&#x27;d60b549f-9e10-11e9-ab04-000c294a1b3b:8&#x27;</span> <span class="hljs-comment">#只截取6和8</span><br>--exclude-gtids=<span class="hljs-string">&#x27;d60b549f-9e10-11e9-ab04-000c294a1b3b:6&#x27;</span>,<span class="hljs-string">&#x27;d60b549f-9e10-11e9-ab04-000c294a1b3b:8&#x27;</span> <span class="hljs-comment">#排除</span><br></code></pre></td></tr></table></figure><br><br><h3 id="8-慢日志-（slow-log-）"><a href="#8-慢日志-（slow-log-）" class="headerlink" title="8. 慢日志 （slow-log ）"></a>8. 慢日志 （slow-log ）</h3><br><p><strong>作用</strong>：记录运行较慢的语句,优化过程中常用的工具日志。</p><h4 id="8-1-慢日志配置"><a href="#8-1-慢日志配置" class="headerlink" title="8.1 慢日志配置"></a>8.1 慢日志配置</h4><p><strong>开关</strong></p><p><code>slow_query_log=1</code> </p><p><strong>文件位置及名字</strong> </p><p><code>slow_query_log_file=/data/mysql/slow.log</code></p><p><strong>设定慢查询时间</strong></p><p><code>long_query_time=0.1</code></p><p><strong>没走索引的语句也记录</strong></p><p><code>log_queries_not_using_indexes</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">vim /etc/my.cnf<br>slow_query_log=1 <br>slow_query_log_file=/data/mysql/slow.log<br>long_query_time=0.1<br>log_queries_not_using_indexes<br></code></pre></td></tr></table></figure><p>默认定义慢语句的时间 十秒</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-23.png" alt="GTID恢复报错"></p><br><br><h4 id="8-2-模拟慢查询分析日志"><a href="#8-2-模拟慢查询分析日志" class="headerlink" title="8.2 模拟慢查询分析日志"></a>8.2 模拟慢查询分析日志</h4><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-24.png" alt="慢日志分析"><br><br></p><p><strong>分析慢日志</strong></p><p><code>mysqldumpslow -s c -t 10 /data/mysql/slow.log</code>  优化前十个 自动以时间为第二维度<br><code>-s</code>  排序<br><code>-c</code> 次数<br><code>-t</code> 前十个记录</p><ul><li>不显示重复的 最慢的优先处理</li><li>优先处理优化使用次数最多的语句</li></ul><br><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-25.png" alt="慢日志分析"><br><br></p><p><strong>超过01秒的和不走索引的语句</strong></p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-26.png" alt="慢日志分析2"></p><p><strong>结论</strong>：以查询时间和运行次数为分析结论</p><p>1.运行次数<br>2.时间</p><h3 id="9-第三方工具"><a href="#9-第三方工具" class="headerlink" title="9.  第三方工具"></a>9.  第三方工具</h3><br><p><a href="https://www.percona.com/downloads/percona-toolkit/LATEST/">Percona Toolkit 3.2.0</a> </p><p>Pt-query-digest是用于分析MySQL慢查询的一个工具，它也可以分析binlog、General log、slowlog，也可以通过SHOWPROCESSLIST或者通过tcpdump抓取的MySQL协议数据来进行分析。可以把分析结果输出到文件中，分析过程是先对查询语句的条件进行参数化，然后对参数化以后的查询进行分组统计，统计出各查询的执行时间、次数、占比等，可以借助分析结果找出问题进行优化。</p><br><br><h4 id="9-1-下载安装"><a href="#9-1-下载安装" class="headerlink" title="9.1 下载安装"></a>9.1 下载安装</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">wget https://www.percona.com/downloads/percona-toolkit/3.2.0/binary/redhat/7/x86_64/percona-toolkit-3.2.0-1.el7.x86_64.rpm<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">安装依赖<br>yum install -y perl-DBI perl-DBD-MySQL perl-Time-HiRes perl-IO-Socket-SSL perl-Digest-MD5<br>rpm -ivh percona-toolkit-3.2.0-1.el7.x86_64.rpm <br></code></pre></td></tr></table></figure><br><h4 id="9-2-使用说明"><a href="#9-2-使用说明" class="headerlink" title="9.2 使用说明"></a>9.2 使用说明</h4><br><p><code>shell&gt; pt-query-digest [OPTIONS] [DSN]</code></p><p><strong>详情可参考</strong></p><p> <code>shell&gt;pt-query-digest --help</code></p><p><strong>常用参数</strong>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">--create-review-table ：当使用--review参数把分析结果输出到表中时，如果没有表就自动创建。<br>--create-history-table：当使用--<span class="hljs-built_in">history</span>参数把分析结果输出到表中时，如果没有表就自动创建。<br>--filter ： 对输入的慢查询按指定的字符串进行匹配过滤后再进行分析<br>--<span class="hljs-built_in">limit</span>：限制输出结果百分比或数量，默认值是20,即将最慢的20条语句输出，如果是95%则按总响应时间占比从大到小排序，输出到总和达到95%位置截止。<br>--<span class="hljs-built_in">log</span>=s ：指定输出的日志文件<br>--<span class="hljs-built_in">history</span> 将分析结果保存到表中，分析结果比较详细，下次再使用--<span class="hljs-built_in">history</span>时，如果存在相同的语句，且查询所在的时间区间和历史表中的不同，则会记录到数据表中，可以通过查询同一CHECKSUM来比较某类型查询的历史变化。<br>--review：将分析结果保存到表中，这个分析只是对查询条件进行参数化，一个类型的查询一条记录，比较简单。当下次使用--review时，如果存在相同的语句分析，就不会记录到数据表中。<br>--output 分析结果输出类型，值可以是report(标准分析报告)、slowlog(Mysql slow <span class="hljs-built_in">log</span>)、json、json-anon，一般使用report，以便于阅读。<br>--since：从该指定日期开始分析。<br>--until：截止时间，配合—since可以分析一段时间内的慢查询。<br></code></pre></td></tr></table></figure><br><br><p><strong>9.3 使用示例</strong></p><br><p><strong>Toolkit工具包中的命令:</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs shell">pt-query-diagest  /data/mysql/slow.log<br><span class="hljs-meta">#</span><span class="bash">pt-query-digest分析慢查询日志</span><br><span class="hljs-meta">shell&gt;</span><span class="bash"> pt-query-digest --report slow.log</span><br><span class="hljs-meta">#</span><span class="bash">报告最近半个小时的慢查询：</span><br><span class="hljs-meta">shell&gt;</span><span class="bash"> pt-query-digest --report --since 1800s slow.log</span><br><span class="hljs-meta">#</span><span class="bash">报告一个时间段的慢查询：</span><br><span class="hljs-meta">shell&gt;</span><span class="bash"> pt-query-digest --report --since <span class="hljs-string">&#x27;2013-02-10 21:48:59&#x27;</span> --until <span class="hljs-string">&#x27;2013-02-16 02:33:50&#x27;</span> slow.log</span><br><span class="hljs-meta">#</span><span class="bash">报告只含select语句的慢查询:</span><br><span class="hljs-meta">shell&gt;</span><span class="bash"> pt-query-digest --filter <span class="hljs-string">&#x27;$event-&gt;&#123;fingerprint&#125; =~ m/^select/i&#x27;</span> slow.log</span><br><span class="hljs-meta">#</span><span class="bash">报告针对某个用户的慢查询:</span><br><span class="hljs-meta">shell&gt;</span><span class="bash"> pt-query-digest --filter <span class="hljs-string">&#x27;($event-&gt;&#123;user&#125; || &quot;&quot;) =~ m/^root/i&#x27;</span> slow.log</span><br><span class="hljs-meta">#</span><span class="bash">报告所有的全表扫描或full join的慢查询:</span><br><span class="hljs-meta">shell&gt;</span><span class="bash"> pt-query-digest --filter <span class="hljs-string">&#x27;(($event-&gt;&#123;Full_scan&#125; || &quot;&quot;) eq &quot;yes&quot;) || (($event-&gt;&#123;Full_join&#125; || &quot;&quot;) eq &quot;yes&quot;)&#x27;</span> slow.log</span><br><span class="hljs-meta">#</span><span class="bash">把查询保存到query_review表</span><br><span class="hljs-meta">shell&gt;</span><span class="bash"> pt-query-digest --user=root –password=abc123 --review h=localhost,D=<span class="hljs-built_in">test</span>,t=query_review --create-review-table  slow.log</span><br><span class="hljs-meta">#</span><span class="bash">把查询保存到query_history表</span><br><span class="hljs-meta">shell&gt;</span><span class="bash"> pt-query-digest --user=root –password=abc123 --<span class="hljs-built_in">history</span>  h=localhost,D=<span class="hljs-built_in">test</span>,t=query_history --create-history-table  slow.log</span><br><span class="hljs-meta">#</span><span class="bash">通过tcpdump抓取mysql的tcp协议数据，然后再分析</span><br><span class="hljs-meta">shell&gt;</span><span class="bash"> tcpdump -s 65535 -x -nn -q -tttt -i any -c 1000 port 3306 &gt; mysql.tcp.txt</span><br><span class="hljs-meta">shell&gt;</span><span class="bash"> pt-query-digest --<span class="hljs-built_in">type</span> tcpdump mysql.tcp.txt&gt; slow_report.log</span><br><span class="hljs-meta">#</span><span class="bash">分析binlog</span><br><span class="hljs-meta">shell&gt;</span><span class="bash"> mysqlbinlog mysql-bin.000093 &gt; mysql-bin000093.sql</span><br><span class="hljs-meta">shell&gt;</span><span class="bash"> pt-query-digest --<span class="hljs-built_in">type</span>=binlog mysql-bin000093.sql &gt; slow_report.log</span><br><span class="hljs-meta">#</span><span class="bash">分析general <span class="hljs-built_in">log</span></span><br><span class="hljs-meta">shell&gt;</span><span class="bash"> pt-query-digest --<span class="hljs-built_in">type</span>=genlog localhost.log &gt; slow_report.log</span><br></code></pre></td></tr></table></figure><br><br><p>如下为输入结果示例：</p><br><br><h4 id="9-4-将分析结果可视化"><a href="#9-4-将分析结果可视化" class="headerlink" title="9.4 将分析结果可视化"></a>9.4 将分析结果可视化</h4><p><strong>原理</strong>：使用pt-query-digest分析慢查询日志并将查询分析数据保存到MySQL数据库表中，然后使用应用程序来展示分析结果.</p><p>目前有基于LAMP的Query-Digest-UI、Anemometer开源项目支持。</p><br><br><p><strong>介绍：</strong></p><p><a href="https://github.com/box/Anemometer">Anemometer</a> 是一个图形化显示MySQL慢日志的工具。</p><p>结合Percona-toolkit中pt-query-digest，Anemometer可以很轻松的帮你去分析慢查询日志，让你很容易就能找到哪些SQL需要优化。</p><br><p><strong>需要安装的步骤如下：</strong></p><ol><li>percona-toolkit工具的安装</li><li>php web环境的搭建</li><li>安装Anemometer并配置</li><li>导入慢查询日志</li><li>访问界面，查看慢查询</li><li>其他相关和问题解决</li></ol><br><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-34.png" alt="Anemomete构架图"><br><br></p><br><p><strong>php&amp;web环境的搭建</strong></p><p> <strong>LAMP环境的安装</strong></p><br><p><strong>安装apache</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">yum install httpd httpd-devel -y<br></code></pre></td></tr></table></figure><br><p><strong>安装php</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">yum install php php-mysql php-common php-bcmath php-dba php-cli php-gd php-mbstring php-mcrypt php-devel php-xml php-pdo -y<br></code></pre></td></tr></table></figure><br><p><strong>修改时区</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">vim /etc/php.ini，<br><span class="hljs-comment">#修改为 </span><br>date.timezone = PRC<br></code></pre></td></tr></table></figure><br><p><strong>LAMP环境启动</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">systemctl start httpd<br>systemctl stop httpd<br>systemctl restart httpd<br>systemctl status httpd<br></code></pre></td></tr></table></figure><br><br><p><strong>安装Anemometer并配置</strong></p><p><strong>1.下载安装</strong></p><p><strong>下载地址</strong>：<a href="https://github.com/box/Anemometer">https://github.com/box/Anemometer</a></p><br><p><strong>下载后上传到服务器并解压</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">unzip Anemometer.master.zip<br></code></pre></td></tr></table></figure><br><p><strong>移动到web根目录</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">mv Anemometer /var/www/html/anemometer<br></code></pre></td></tr></table></figure><br><p><strong>2.授予权限</strong></p><p>目标慢查询数据库上需要授予Anemometer主机对应的权限，用于分析目标慢查询数据库<strong>explain</strong>执行计划</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">grant</span> <span class="hljs-keyword">select</span> <span class="hljs-keyword">on</span> <span class="hljs-operator">*</span>.<span class="hljs-operator">*</span> <span class="hljs-keyword">to</span> <span class="hljs-string">&#x27;anemometer&#x27;</span>@<span class="hljs-string">&#x27;$ip&#x27;</span> identified <span class="hljs-keyword">by</span> <span class="hljs-string">&#x27;123456&#x27;</span>;<br>flush privileges;  <span class="hljs-comment">--（$ip为Anemometer主机对应ip地址）</span><br></code></pre></td></tr></table></figure><br><br><p><strong>3.修改配置文件</strong></p><p>增加<strong>explain</strong>读取用户密码信息</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">cp conf/sample.config.inc.php conf/config.inc.php<br>vim conf/config.inc.php<br></code></pre></td></tr></table></figure><br><br><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-28.png" alt="修改配置文件2"></p><br><p>修改配置文件指向数据源文件</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-41.png" alt="修改配置文件2"></p><p>初始化数据源的数据库表的配置</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-40.png" alt="修改配置文件3"><br><br></p><p><strong>4.推送慢语句分析</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sh">pt-query-digest --user=slowlog --password=1 <br>--review h=10.0.0.51,D=slow_query_log,t=global_query_review<br>--<span class="hljs-built_in">history</span> h=10.0.0.51,D=slow_query_log,t=global_query_review_history --no-report <br>--<span class="hljs-built_in">limit</span>=0% --filter=<span class="hljs-string">&quot; \$event-&gt;&#123;Bytes&#125; = length(\$event-&gt;&#123;arg&#125;) and \$event-&gt;&#123;hostname&#125;=\&quot;<span class="hljs-variable">$HOSTNAME</span>\&quot;&quot;</span> <br>slow.log<br></code></pre></td></tr></table></figure><br><br><p><strong>5.访问网页，查看慢语句可视化分析</strong></p><p><a href="http://127.0.0.1/anemometer">http://127.0.0.1/anemometer</a></p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-32.png" alt="web界面1"></p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-33.png" alt="web界面2"></p><p><strong>Query-Digest-UI</strong> 应用</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-31.png" alt="Query-Digest-UI"></p><br><br><p><strong>6.踩坑问题解决</strong></p><p><strong>MySQL 5.7 时间格式问题</strong></p><p>MySQL升级5.7后，出现异常<code>Invalid default value for &#39;create_time&#39;</code> <br></p><p>5.7之后版本 datetime 默认值设置 ‘0000-00-00’<br></p><br><p><strong>解决方案</strong>：</p><p>打开MySQL安装位置，找到<code>my.ini</code>配置文件，添加或修改如下配置：<br></p><p>在 <code>[mysqld]</code> 中添加<br></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">sql-mode=ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,ERROR_FOR_DIVISION_BY_ZERO,<br>NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION<br></code></pre></td></tr></table></figure> <br><p><strong>临时解决方案</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">set</span> session sql_mode<span class="hljs-operator">=</span><span class="hljs-string">&#x27;ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION&#x27;</span>;<br></code></pre></td></tr></table></figure><p> <br>  <br></p><p><code>Expression #1 of SELECT list is not in GROUP BY clause and contains nonaggre</code> 问题解决</p><p><strong>问题出现的原因：</strong> </p><p><strong>MySQL 5.7.5及以上功能依赖检测功能。如果启用了ONLY_FULL_GROUP_BY SQL模式（默认情况下），MySQL将拒绝选择列表，HAVING条件或ORDER BY列表的查询引用在GROUP BY子句中既未命名的非集合列，也不在功能上依赖于它们。（5.7.5之前，MySQL没有检测到功能依赖关系，默认情况下不启用ONLY_FULL_GROUP_BY。有关5.7.5之前的行为的说明，请参见“MySQL 5.6参考手册”。）</strong></p><p><strong>解决方法一：</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> @<span class="hljs-variable">@global</span>.sql_mode<br></code></pre></td></tr></table></figure><p>查询出来的值为：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-string">&#x27;ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION&#x27;</span><br></code></pre></td></tr></table></figure><p> 去掉 <strong>ONLY_FULL_GROUP_BY</strong>，重新设置值。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">set</span> @<span class="hljs-variable">@global</span>.sql_mode <span class="hljs-operator">=</span><span class="hljs-string">&#x27;STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION&#x27;</span>;<br></code></pre></td></tr></table></figure><p><strong>解决方法二：</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">vim /etc/mysql/conf.d/mysql.cnf<br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">[mysqld] <br>sql_mode=STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION<br>service mysqld restart<br></code></pre></td></tr></table></figure><br><br><p><strong>3.时间不同步问题</strong></p><p><strong>问题描述</strong>：MySQL 5.7 开启慢日志后发现日志的时间与系统时间相差8小时</p><br><p><strong>Time</strong>: <strong>2020-08-05T05:35:50.667976K</strong>，实际时间应该是<strong>12:24:30</strong><br></p><p>这是由于<strong>log_timestamps</strong>这个参数设置造成的，查询当前设置<br></p><br> <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">show</span> variables <span class="hljs-keyword">like</span> <span class="hljs-string">&#x27;%log_time%&#x27;</span>;<br><span class="hljs-operator">+</span><span class="hljs-comment">----------------+-------+</span><br><span class="hljs-operator">|</span> Variable_name <span class="hljs-operator">|</span> <span class="hljs-keyword">Value</span>  <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">----------------+-------+</span><br><span class="hljs-operator">|</span> log_timestamps <span class="hljs-operator">|</span> UTC   <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">----------------+-------+</span><br><span class="hljs-number">1</span> <span class="hljs-type">row</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">set</span> (<span class="hljs-number">0.01</span> sec)<br></code></pre></td></tr></table></figure><p><strong>UTC</strong>是世界统一时间，而现在的系统为北京时间是东八区，比<strong>UTC</strong>早了8个小时，所以这里设置为<strong>SYSTEM</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">set</span> <span class="hljs-keyword">global</span> log_timestamps<span class="hljs-operator">=</span><span class="hljs-keyword">SYSTEM</span>;<br><br>Query OK, <span class="hljs-number">0</span> <span class="hljs-keyword">rows</span> affected (<span class="hljs-number">0.00</span> sec)<br><br> mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">show</span> variables <span class="hljs-keyword">like</span> <span class="hljs-string">&#x27;%log_time%&#x27;</span>;<br><span class="hljs-operator">+</span><span class="hljs-comment">----------------+--------+</span><br><span class="hljs-operator">|</span> Variable_name <span class="hljs-operator">|</span> <span class="hljs-keyword">Value</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">----------------+--------+</span><br><span class="hljs-operator">|</span> log_timestamps <span class="hljs-operator">|</span> <span class="hljs-keyword">SYSTEM</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">----------------+--------+</span><br><span class="hljs-number">1</span> <span class="hljs-type">row</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">set</span> (<span class="hljs-number">0.01</span> sec)<br></code></pre></td></tr></table></figure>  <br><br> <p>Mysql 5.7 时间字段不得为空或0000-00-00 00:00:00</p><p><strong>问题原因：</strong></p><p><code>NO_ZERO_IN_DATE</code>,<code>NO_ZERO_DATE</code> 限制无法默认为 <code>0000-00-00 00:00:</code>00</p><p><code>NO_ZERO_IN_DATE</code>：在严格模式下，不接受月或日部分为0的日期</p><p><code>NO_ZERO_DATE</code>：在严格模式，<code>0000-00-00</code>报错</p> <br><br><p><strong>解决方法：</strong></p><p>1、使用root登陆数据库，命令界面执行 ，查看sql_mode</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> @<span class="hljs-variable">@sql</span>_mode;<br></code></pre></td></tr></table></figure><p>返回结果如下：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-string">&#x27;ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION&#x27;</span><br></code></pre></td></tr></table></figure><p> 修改 <code>sql_mode</code></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SET</span> <span class="hljs-keyword">GLOBAL</span> sql_mode<span class="hljs-operator">=</span><span class="hljs-string">&#x27;ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION&#x27;</span>;<br></code></pre></td></tr></table></figure><h3 id="10-慢查询可视化帮助文档"><a href="#10-慢查询可视化帮助文档" class="headerlink" title="10. 慢查询可视化帮助文档"></a>10. 慢查询可视化帮助文档</h3><p> <a href="https://www.jianshu.com/p/092fd6359e43">文章来源</a></p><p>该系统使用pt-query-digest搜集慢查询日志，目前策略是每10分钟搜集分析一次。</p><p>将数据存储在两张表中：该系统使用pt-query-digest搜集慢查询日志，目前策略是每10分钟搜集分析一次。将数据存储在两张表中：<code>global_query_review</code> 和 <code>global_query_review_history</code>。将数据展现出来，方便查询分析。</p><br><p>表结构</p><p><code>global_query_review</code> 表结构：</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-35.png" alt="表结构1"></p><p><br><br></p><p><strong>主要字段说明</strong>：</p><ul><li>checksum : 主键，是按fingerprint算出来的hash值</li><li>finger : 是每条sql语句的指纹，去掉了一些变化的值同一类型的sql语句，条件值不一样在该表中只会存在一条记录</li><li>sample: 符合finger的一条sql示例</li></ul><br><br><p><code>global_query_review_history</code> 表结构</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-36.png" alt="表结构2"></p><p><strong>主要字段说明</strong>：</p><ul><li><strong>hostname_max</strong> :  MySQL服务所在主机名称</li><li><strong>db_max</strong>: 数据库名称</li><li><strong>checksum</strong> :     同global_query_review表中的checksum，两张表通过该值关联</li><li><strong>sample</strong> : sql示例</li><li><strong>ts_min</strong> :     本次统计(每10分钟一次)该类型sql语句出现的最小时间</li><li><strong>ts_max</strong>:     本次统计(每10分钟一次)该类型sql语句出现的最大时间</li><li><strong>ts_cnt</strong> :     本次统计该sql语句出现的次数</li><li><strong>Query_time_sum</strong> :     本次统计该类型sql语句花费的总时间</li><li><strong>Query_time_min</strong> :     本次统计该类型sql语句执行最快的那个sql语句花费的时间</li><li><strong>Query_time_max</strong>:     本次统计该类型sql语句执行最慢的那个sql语句花费的时间</li><li><strong>Query_time_pct_95</strong>:     本次统计该类型sql语句执行时间位于95%分位的sql执行时间</li><li><strong>Query_time_stddev</strong>:     本次统计该类型sql语句执行时间标准差（统计学概念）</li><li><strong>Query_time_median</strong>:     本次统计该类型sql语句执行时间位于中位数位置的sql执行时间</li><li><strong>index_ratio</strong>：表示的是扫描的行数/返回的结果行数</li></ul><p><br><br></p><p><strong>Anemometer</strong> 应用</p><p><strong>1.主页面说明如下</strong></p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-37.png" alt="界面1"><br><br></p><p><strong>2.点击checksum值进入分析页面</strong></p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-38.png" alt="界面2"></p><br><p><strong>下面图形是该页面的中间部分</strong></p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-39.png" alt="界面3"></p>]]></content>
    
    
    <categories>
      
      <category>DBA</category>
      
    </categories>
    
    
    <tags>
      
      <tag>DBA</tag>
      
      <tag>RDBMS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>慢日志分析</title>
    <link href="/2020/07/17/dba06-2/"/>
    <url>/2020/07/17/dba06-2/</url>
    
    <content type="html"><![CDATA[<h1 id="慢日志分析"><a href="#慢日志分析" class="headerlink" title="慢日志分析"></a>慢日志分析</h1><p>[[toc]]</p><br><p><strong>作用</strong>：<strong>slow-log</strong> 记录运行较慢的语句,优化过程中常用的工具日志。</p><br><h2 id="1-慢日志配置"><a href="#1-慢日志配置" class="headerlink" title="1. 慢日志配置"></a>1. 慢日志配置</h2><br><p><strong>开关</strong></p><p><code>slow_query_log=1</code> </p><p><strong>文件位置及名字</strong> </p><p><code>slow_query_log_file=/data/mysql/slow.log</code></p><p><strong>设定慢查询时间</strong></p><p><code>long_query_time=0.1</code></p><p><strong>没走索引的语句也记录</strong></p><p><code>log_queries_not_using_indexes</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">vim /etc/my.cnf<br>slow_query_log=1 <br>slow_query_log_file=/data/mysql/slow.log<br>long_query_time=0.1<br>log_queries_not_using_indexes<br></code></pre></td></tr></table></figure><p>默认定义慢语句的时间 十秒</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-23.png" alt="GTID恢复报错"></p><br><br><h2 id="2-模拟慢查询分析日志"><a href="#2-模拟慢查询分析日志" class="headerlink" title="2. 模拟慢查询分析日志"></a>2. 模拟慢查询分析日志</h2><br><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-24.png" alt="慢日志分析"></p><br><p><strong>分析慢日志</strong></p><p><code>mysqldumpslow -s c -t 10 /data/mysql/slow.log</code>  优化前十个 自动以时间为第二维度<br><code>-s</code>  排序<br><code>-c</code> 次数<br><code>-t</code> 前十个记录</p><ul><li>不显示重复的 最慢的优先处理</li><li>优先处理优化使用次数最多的语句</li></ul><br><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-25.png" alt="慢日志分析"></p><br><p><strong>超过01秒的和不走索引的语句</strong></p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-26.png" alt="慢日志分析"></p><p><strong>结论</strong>：以查询时间和运行次数为分析结论</p><p>1.运行次数<br>2.时间</p><h2 id="3-第三方工具"><a href="#3-第三方工具" class="headerlink" title="3.  第三方工具"></a>3.  第三方工具</h2><br><p><a href="https://www.percona.com/downloads/percona-toolkit/LATEST/">Percona Toolkit 3.2.0</a> </p><p>Pt-query-digest是用于分析MySQL慢查询的一个工具，它也可以分析binlog、General log、slowlog，也可以通过SHOWPROCESSLIST或者通过tcpdump抓取的MySQL协议数据来进行分析。可以把分析结果输出到文件中，分析过程是先对查询语句的条件进行参数化，然后对参数化以后的查询进行分组统计，统计出各查询的执行时间、次数、占比等，可以借助分析结果找出问题进行优化。</p><br><br><h3 id="3-1-下载安装"><a href="#3-1-下载安装" class="headerlink" title="3.1 下载安装"></a>3.1 下载安装</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">wget https://www.percona.com/downloads/percona-toolkit/3.2.0/binary/redhat/7/x86_64/percona-toolkit-3.2.0-1.el7.x86_64.rpm<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">安装依赖<br>yum install -y perl-DBI perl-DBD-MySQL perl-Time-HiRes perl-IO-Socket-SSL perl-Digest-MD5<br>rpm -ivh percona-toolkit-3.2.0-1.el7.x86_64.rpm <br></code></pre></td></tr></table></figure><br><h3 id="3-2-使用说明"><a href="#3-2-使用说明" class="headerlink" title="3.2 使用说明"></a>3.2 使用说明</h3><br><p><code>shell&gt; pt-query-digest [OPTIONS] [DSN]</code></p><p><strong>详情可参考</strong></p><p> <code>shell&gt;pt-query-digest --help</code></p><h3 id="3-3-常用参数"><a href="#3-3-常用参数" class="headerlink" title="3.3 常用参数"></a>3.3 常用参数</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">--create-review-table ：当使用--review参数把分析结果输出到表中时，如果没有表就自动创建。<br>--create-history-table：当使用--<span class="hljs-built_in">history</span>参数把分析结果输出到表中时，如果没有表就自动创建。<br>--filter ： 对输入的慢查询按指定的字符串进行匹配过滤后再进行分析<br>--<span class="hljs-built_in">limit</span>：限制输出结果百分比或数量，默认值是20,即将最慢的20条语句输出，如果是95%则按总响应时间占比从大到小排序，输出到总和达到95%位置截止。<br>--<span class="hljs-built_in">log</span>=s ：指定输出的日志文件<br>--<span class="hljs-built_in">history</span> 将分析结果保存到表中，分析结果比较详细，下次再使用--<span class="hljs-built_in">history</span>时，如果存在相同的语句，且查询所在的时间区间和历史表中的不同，则会记录到数据表中，可以通过查询同一CHECKSUM来比较某类型查询的历史变化。<br>--review：将分析结果保存到表中，这个分析只是对查询条件进行参数化，一个类型的查询一条记录，比较简单。当下次使用--review时，如果存在相同的语句分析，就不会记录到数据表中。<br>--output 分析结果输出类型，值可以是report(标准分析报告)、slowlog(Mysql slow <span class="hljs-built_in">log</span>)、json、json-anon，一般使用report，以便于阅读。<br>--since：从该指定日期开始分析。<br>--until：截止时间，配合—since可以分析一段时间内的慢查询。<br></code></pre></td></tr></table></figure><br><br><h3 id="3-4-使用示例"><a href="#3-4-使用示例" class="headerlink" title="3.4 使用示例"></a>3.4 使用示例</h3><br><p><strong>Toolkit工具包中的命令:</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs shell">pt-query-diagest  /data/mysql/slow.log<br><span class="hljs-meta">#</span><span class="bash">pt-query-digest分析慢查询日志</span><br><span class="hljs-meta">shell&gt;</span><span class="bash"> pt-query-digest --report slow.log</span><br><span class="hljs-meta">#</span><span class="bash">报告最近半个小时的慢查询：</span><br><span class="hljs-meta">shell&gt;</span><span class="bash"> pt-query-digest --report --since 1800s slow.log</span><br><span class="hljs-meta">#</span><span class="bash">报告一个时间段的慢查询：</span><br><span class="hljs-meta">shell&gt;</span><span class="bash"> pt-query-digest --report --since <span class="hljs-string">&#x27;2013-02-10 21:48:59&#x27;</span> --until <span class="hljs-string">&#x27;2013-02-16 02:33:50&#x27;</span> slow.log</span><br><span class="hljs-meta">#</span><span class="bash">报告只含select语句的慢查询:</span><br><span class="hljs-meta">shell&gt;</span><span class="bash"> pt-query-digest --filter <span class="hljs-string">&#x27;$event-&gt;&#123;fingerprint&#125; =~ m/^select/i&#x27;</span> slow.log</span><br><span class="hljs-meta">#</span><span class="bash">报告针对某个用户的慢查询:</span><br><span class="hljs-meta">shell&gt;</span><span class="bash"> pt-query-digest --filter <span class="hljs-string">&#x27;($event-&gt;&#123;user&#125; || &quot;&quot;) =~ m/^root/i&#x27;</span> slow.log</span><br><span class="hljs-meta">#</span><span class="bash">报告所有的全表扫描或full join的慢查询:</span><br><span class="hljs-meta">shell&gt;</span><span class="bash"> pt-query-digest --filter <span class="hljs-string">&#x27;(($event-&gt;&#123;Full_scan&#125; || &quot;&quot;) eq &quot;yes&quot;) || (($event-&gt;&#123;Full_join&#125; || &quot;&quot;) eq &quot;yes&quot;)&#x27;</span> slow.log</span><br><span class="hljs-meta">#</span><span class="bash">把查询保存到query_review表</span><br><span class="hljs-meta">shell&gt;</span><span class="bash"> pt-query-digest --user=root –password=abc123 --review h=localhost,D=<span class="hljs-built_in">test</span>,t=query_review --create-review-table  slow.log</span><br><span class="hljs-meta">#</span><span class="bash">把查询保存到query_history表</span><br><span class="hljs-meta">shell&gt;</span><span class="bash"> pt-query-digest --user=root –password=abc123 --<span class="hljs-built_in">history</span>  h=localhost,D=<span class="hljs-built_in">test</span>,t=query_history --create-history-table  slow.log</span><br><span class="hljs-meta">#</span><span class="bash">通过tcpdump抓取mysql的tcp协议数据，然后再分析</span><br><span class="hljs-meta">shell&gt;</span><span class="bash"> tcpdump -s 65535 -x -nn -q -tttt -i any -c 1000 port 3306 &gt; mysql.tcp.txt</span><br><span class="hljs-meta">shell&gt;</span><span class="bash"> pt-query-digest --<span class="hljs-built_in">type</span> tcpdump mysql.tcp.txt&gt; slow_report.log</span><br><span class="hljs-meta">#</span><span class="bash">分析binlog</span><br><span class="hljs-meta">shell&gt;</span><span class="bash"> mysqlbinlog mysql-bin.000093 &gt; mysql-bin000093.sql</span><br><span class="hljs-meta">shell&gt;</span><span class="bash"> pt-query-digest --<span class="hljs-built_in">type</span>=binlog mysql-bin000093.sql &gt; slow_report.log</span><br><span class="hljs-meta">#</span><span class="bash">分析general <span class="hljs-built_in">log</span></span><br><span class="hljs-meta">shell&gt;</span><span class="bash"> pt-query-digest --<span class="hljs-built_in">type</span>=genlog localhost.log &gt; slow_report.log</span><br></code></pre></td></tr></table></figure><br><br><p>如下为输入结果示例：</p><br><br><h2 id="4-分析结果可视化"><a href="#4-分析结果可视化" class="headerlink" title="4. 分析结果可视化"></a>4. 分析结果可视化</h2><br><h3 id="4-1-原理介绍"><a href="#4-1-原理介绍" class="headerlink" title="4.1 原理介绍"></a>4.1 原理介绍</h3><p>使用pt-query-digest分析慢查询日志并将查询分析数据保存到MySQL数据库表中，然后使用应用程序来展示分析结果.</p><p>目前有基于LAMP的Query-Digest-UI、Anemometer开源项目支持。</p><br><br><p><a href="https://github.com/box/Anemometer">Anemometer</a> 是一个图形化显示MySQL慢日志的工具。</p><p>结合Percona-toolkit中pt-query-digest，Anemometer可以很轻松的帮你去分析慢查询日志，让你很容易就能找到哪些SQL需要优化。</p><br><p><strong>需要安装的步骤如下：</strong></p><ol><li>percona-toolkit工具的安装</li><li>php web环境的搭建</li><li>安装Anemometer并配置</li><li>导入慢查询日志</li><li>访问界面，查看慢查询</li><li>其他相关和问题解决</li></ol><br><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-34.png" alt="Anemomete构架图"></p><br><h3 id="4-2-环境搭建"><a href="#4-2-环境搭建" class="headerlink" title="4.2 环境搭建"></a>4.2 环境搭建</h3><p> <strong>LAMP环境的安装</strong></p><br><p><strong>安装apache</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">yum install httpd httpd-devel -y<br></code></pre></td></tr></table></figure><br><p><strong>安装php</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">yum install php php-mysql php-common php-bcmath php-dba php-cli php-gd php-mbstring php-mcrypt php-devel php-xml php-pdo -y<br></code></pre></td></tr></table></figure><br><p><strong>修改时区</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">vim /etc/php.ini，<br><span class="hljs-comment">#修改为 </span><br>date.timezone = PRC<br></code></pre></td></tr></table></figure><br><p><strong>LAMP环境启动</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">systemctl start httpd<br>systemctl stop httpd<br>systemctl restart httpd<br>systemctl status httpd<br></code></pre></td></tr></table></figure><br><br><h3 id="4-3-安装Anemometer"><a href="#4-3-安装Anemometer" class="headerlink" title="4.3 安装Anemometer"></a>4.3 安装Anemometer</h3><p><strong>1.下载安装</strong></p><p><strong>下载地址</strong>：<a href="https://github.com/box/Anemometer">https://github.com/box/Anemometer</a></p><br><p><strong>下载后上传到服务器并解压</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">unzip Anemometer.master.zip<br></code></pre></td></tr></table></figure><br><p><strong>移动到web根目录</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">mv Anemometer /var/www/html/anemometer<br></code></pre></td></tr></table></figure><br><p><strong>2.授予权限</strong></p><p>目标慢查询数据库上需要授予Anemometer主机对应的权限，用于分析目标慢查询数据库<strong>explain</strong>执行计划</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">grant</span> <span class="hljs-keyword">select</span> <span class="hljs-keyword">on</span> <span class="hljs-operator">*</span>.<span class="hljs-operator">*</span> <span class="hljs-keyword">to</span> <span class="hljs-string">&#x27;anemometer&#x27;</span>@<span class="hljs-string">&#x27;$ip&#x27;</span> identified <span class="hljs-keyword">by</span> <span class="hljs-string">&#x27;123456&#x27;</span>;<br>flush privileges;  <span class="hljs-comment">--（$ip为Anemometer主机对应ip地址）</span><br></code></pre></td></tr></table></figure><br><br><p><strong>3.修改配置文件</strong></p><p>增加<strong>explain</strong>读取用户密码信息</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">cp conf/sample.config.inc.php conf/config.inc.php<br>vim conf/config.inc.php<br></code></pre></td></tr></table></figure><br><br><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-28.png" alt="修改配置文件2"></p><br><p>修改配置文件指向数据源文件</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-41.png" alt="修改配置文件2"></p><p>初始化数据源的数据库表的配置</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-40.png" alt="修改配置文件3"></p><br><p><strong>4.推送慢语句分析</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sh">pt-query-digest --user=slowlog --password=1 <br>--review h=10.0.0.51,D=slow_query_log,t=global_query_review<br>--<span class="hljs-built_in">history</span> h=10.0.0.51,D=slow_query_log,t=global_query_review_history --no-report <br>--<span class="hljs-built_in">limit</span>=0% --filter=<span class="hljs-string">&quot; \$event-&gt;&#123;Bytes&#125; = length(\$event-&gt;&#123;arg&#125;) and \$event-&gt;&#123;hostname&#125;=\&quot;<span class="hljs-variable">$HOSTNAME</span>\&quot;&quot;</span> <br>slow.log<br></code></pre></td></tr></table></figure><br><br><p><strong>5.访问网页，查看慢语句可视化分析</strong></p><p><a href="http://127.0.0.1/anemometer">http://127.0.0.1/anemometer</a></p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-32.png" alt="web界面1"></p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-33.png" alt="web界面2&quot;"></p><p><strong>Query-Digest-UI</strong> 应用</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-31.png" alt="Query-Digest-UI"></p><br><h3 id="4-4-踩坑问题解决"><a href="#4-4-踩坑问题解决" class="headerlink" title="4.4 踩坑问题解决"></a>4.4 踩坑问题解决</h3><p><strong>MySQL 5.7 时间格式问题</strong></p><p>MySQL升级5.7后，出现异常<code>Invalid default value for &#39;create_time&#39;</code> <br></p><p>5.7之后版本 datetime 默认值设置 ‘0000-00-00’<br></p><br><p><strong>解决方案</strong>：</p><p>打开MySQL安装位置，找到<code>my.ini</code>配置文件，添加或修改如下配置：<br></p><p>在 <code>[mysqld]</code> 中添加<br></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">sql-mode=ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,ERROR_FOR_DIVISION_BY_ZERO,<br>NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION<br></code></pre></td></tr></table></figure> <br><p><strong>临时解决方案</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">set</span> session sql_mode<span class="hljs-operator">=</span><span class="hljs-string">&#x27;ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION&#x27;</span>;<br></code></pre></td></tr></table></figure><p> <br>  <br></p><p><code>Expression #1 of SELECT list is not in GROUP BY clause and contains nonaggre</code> 问题解决</p><p><strong>问题出现的原因：</strong> </p><p><strong>MySQL 5.7.5及以上功能依赖检测功能。如果启用了ONLY_FULL_GROUP_BY SQL模式（默认情况下），MySQL将拒绝选择列表，HAVING条件或ORDER BY列表的查询引用在GROUP BY子句中既未命名的非集合列，也不在功能上依赖于它们。（5.7.5之前，MySQL没有检测到功能依赖关系，默认情况下不启用ONLY_FULL_GROUP_BY。有关5.7.5之前的行为的说明，请参见“MySQL 5.6参考手册”。）</strong></p><p><strong>解决方法一：</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> @<span class="hljs-variable">@global</span>.sql_mode<br></code></pre></td></tr></table></figure><p>查询出来的值为：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-string">&#x27;ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION&#x27;</span><br></code></pre></td></tr></table></figure><p> 去掉 <strong>ONLY_FULL_GROUP_BY</strong>，重新设置值。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">set</span> @<span class="hljs-variable">@global</span>.sql_mode <span class="hljs-operator">=</span><span class="hljs-string">&#x27;STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION&#x27;</span>;<br></code></pre></td></tr></table></figure><p><strong>解决方法二：</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">vim /etc/mysql/conf.d/mysql.cnf<br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">[mysqld] <br>sql_mode=STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION<br>service mysqld restart<br></code></pre></td></tr></table></figure><br><br><p><strong>3.时间不同步问题</strong></p><p><strong>问题描述</strong>：MySQL 5.7 开启慢日志后发现日志的时间与系统时间相差8小时</p><br><p><strong>Time</strong>: <strong>2020-08-05T05:35:50.667976K</strong>，实际时间应该是<strong>12:24:30</strong><br></p><p>这是由于<strong>log_timestamps</strong>这个参数设置造成的，查询当前设置<br></p><br> <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">show</span> variables <span class="hljs-keyword">like</span> <span class="hljs-string">&#x27;%log_time%&#x27;</span>;<br><span class="hljs-operator">+</span><span class="hljs-comment">----------------+-------+</span><br><span class="hljs-operator">|</span> Variable_name <span class="hljs-operator">|</span> <span class="hljs-keyword">Value</span>  <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">----------------+-------+</span><br><span class="hljs-operator">|</span> log_timestamps <span class="hljs-operator">|</span> UTC   <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">----------------+-------+</span><br><span class="hljs-number">1</span> <span class="hljs-type">row</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">set</span> (<span class="hljs-number">0.01</span> sec)<br></code></pre></td></tr></table></figure><p><strong>UTC</strong>是世界统一时间，而现在的系统为北京时间是东八区，比<strong>UTC</strong>早了8个小时，所以这里设置为<strong>SYSTEM</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">set</span> <span class="hljs-keyword">global</span> log_timestamps<span class="hljs-operator">=</span><span class="hljs-keyword">SYSTEM</span>;<br><br>Query OK, <span class="hljs-number">0</span> <span class="hljs-keyword">rows</span> affected (<span class="hljs-number">0.00</span> sec)<br><br> mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">show</span> variables <span class="hljs-keyword">like</span> <span class="hljs-string">&#x27;%log_time%&#x27;</span>;<br><span class="hljs-operator">+</span><span class="hljs-comment">----------------+--------+</span><br><span class="hljs-operator">|</span> Variable_name <span class="hljs-operator">|</span> <span class="hljs-keyword">Value</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">----------------+--------+</span><br><span class="hljs-operator">|</span> log_timestamps <span class="hljs-operator">|</span> <span class="hljs-keyword">SYSTEM</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">----------------+--------+</span><br><span class="hljs-number">1</span> <span class="hljs-type">row</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">set</span> (<span class="hljs-number">0.01</span> sec)<br></code></pre></td></tr></table></figure>  <br><br> <p>Mysql 5.7 时间字段不得为空或0000-00-00 00:00:00</p><p><strong>问题原因：</strong></p><p><code>NO_ZERO_IN_DATE</code>,<code>NO_ZERO_DATE</code> 限制无法默认为 <code>0000-00-00 00:00:</code>00</p><p><code>NO_ZERO_IN_DATE</code>：在严格模式下，不接受月或日部分为0的日期</p><p><code>NO_ZERO_DATE</code>：在严格模式，<code>0000-00-00</code>报错</p> <br><br><p><strong>解决方法：</strong></p><p>1、使用root登陆数据库，命令界面执行 ，查看sql_mode</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> @<span class="hljs-variable">@sql</span>_mode;<br></code></pre></td></tr></table></figure><p>返回结果如下：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-string">&#x27;ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION&#x27;</span><br></code></pre></td></tr></table></figure><p> 修改 <code>sql_mode</code></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SET</span> <span class="hljs-keyword">GLOBAL</span> sql_mode<span class="hljs-operator">=</span><span class="hljs-string">&#x27;ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION&#x27;</span>;<br></code></pre></td></tr></table></figure><h3 id="4-5-慢查询可视化帮助文档"><a href="#4-5-慢查询可视化帮助文档" class="headerlink" title="4.5 慢查询可视化帮助文档"></a>4.5 慢查询可视化帮助文档</h3><p> <a href="https://www.jianshu.com/p/092fd6359e43">文章来源</a></p><p>该系统使用pt-query-digest搜集慢查询日志，目前策略是每10分钟搜集分析一次。</p><p>将数据存储在两张表中：该系统使用pt-query-digest搜集慢查询日志，目前策略是每10分钟搜集分析一次。将数据存储在两张表中：<code>global_query_review</code> 和 <code>global_query_review_history</code>。将数据展现出来，方便查询分析。</p><br><p>表结构</p><p><code>global_query_review</code> 表结构：</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-35.png" alt="表结构1"></p><p><br><br></p><p><strong>主要字段说明</strong>：</p><ul><li>checksum : 主键，是按fingerprint算出来的hash值</li><li>finger : 是每条sql语句的指纹，去掉了一些变化的值同一类型的sql语句，条件值不一样在该表中只会存在一条记录</li><li>sample: 符合finger的一条sql示例</li></ul><br><br><p><code>global_query_review_history</code> 表结构</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-36.png" alt="表结构2"></p><p><strong>主要字段说明</strong>：</p><ul><li><strong>hostname_max</strong> :  MySQL服务所在主机名称</li><li><strong>db_max</strong>: 数据库名称</li><li><strong>checksum</strong> :     同global_query_review表中的checksum，两张表通过该值关联</li><li><strong>sample</strong> : sql示例</li><li><strong>ts_min</strong> :     本次统计(每10分钟一次)该类型sql语句出现的最小时间</li><li><strong>ts_max</strong>:     本次统计(每10分钟一次)该类型sql语句出现的最大时间</li><li><strong>ts_cnt</strong> :     本次统计该sql语句出现的次数</li><li><strong>Query_time_sum</strong> :     本次统计该类型sql语句花费的总时间</li><li><strong>Query_time_min</strong> :     本次统计该类型sql语句执行最快的那个sql语句花费的时间</li><li><strong>Query_time_max</strong>:     本次统计该类型sql语句执行最慢的那个sql语句花费的时间</li><li><strong>Query_time_pct_95</strong>:     本次统计该类型sql语句执行时间位于95%分位的sql执行时间</li><li><strong>Query_time_stddev</strong>:     本次统计该类型sql语句执行时间标准差（统计学概念）</li><li><strong>Query_time_median</strong>:     本次统计该类型sql语句执行时间位于中位数位置的sql执行时间</li><li><strong>index_ratio</strong>：表示的是扫描的行数/返回的结果行数</li></ul><p><br><br></p><p><strong>Anemometer</strong> 应用</p><p><strong>1.主页面说明如下</strong></p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-37.png" alt="界面1"></p><br><br><p><strong>2.点击checksum值进入分析页面</strong></p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-38.png" alt="界面2"></p><br><p><strong>下面图形是该页面的中间部分</strong></p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-39.png" alt="Section6-1-39.png"></p><p>test Jenkin:artificial_satellite:</p>]]></content>
    
    
    <categories>
      
      <category>DBA</category>
      
    </categories>
    
    
    <tags>
      
      <tag>DBA</tag>
      
      <tag>RDBMS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>InnoDB 存储引擎物理存储结构</title>
    <link href="/2020/07/16/dba05-1/"/>
    <url>/2020/07/16/dba05-1/</url>
    
    <content type="html"><![CDATA[<h1 id="InnoDB-存储引擎物理存储结构"><a href="#InnoDB-存储引擎物理存储结构" class="headerlink" title="InnoDB 存储引擎物理存储结构"></a><strong>InnoDB 存储引擎物理存储结构</strong></h1><p>[[toc]]</p><p><strong>最直观的存储方式</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">ll /data/mysql/data<br>ibdata1：<span class="hljs-comment">#系统数据字典信息(统计信息)，UNDO表空间等数据 </span><br>ib_logfile0 ~ ib_logfile1: <span class="hljs-comment">#REDO日志文件，事务日志文件。</span><br>ibtmp1： <span class="hljs-comment">#临时表空间磁盘位置，存储临时表</span><br>frm：<span class="hljs-comment">#存储表的列信息</span><br>ibd：<span class="hljs-comment">#表的数据行和索引</span><br></code></pre></td></tr></table></figure><br><br><h2 id="1-表空间-Tablespace"><a href="#1-表空间-Tablespace" class="headerlink" title="1. 表空间 Tablespace"></a>1. 表空间 Tablespace</h2><br><p>源于 Oracle</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section5-2-1.png" alt="表空间1"></p><p><strong>表空间数据问题</strong></p><ul><li><p><strong>ibdata1</strong> : 存储整个库的统计信息+Undo 日志信息 </p></li><li><p><strong>ibd</strong>  : 存储数据行和索引</p><br><br></li></ul><h3 id="1-1-共享表空间-ibdata1-N"><a href="#1-1-共享表空间-ibdata1-N" class="headerlink" title="1.1 共享表空间 (ibdata1~N)"></a>1.1 共享表空间 (ibdata1~N)</h3><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section5-2-2.png" alt="表空间2"></p><p>5.5 版本的默认模式, 5.6 中转换为了独立表空间 <br></p><p>需要将所有数据存储到同一个表空间中 ，文件比较大 管理混乱<br></p><br><ul><li>5.5版本出现的管理模式，也是默认的管理模式。</li><li>5.6版本以，共享表空间保留，只用来存储:数据字典信息,undo,临时表。</li><li>5.7 版本,临时表被独立出来了</li><li>8.0版本,undo也被独立出去了</li></ul> <br><p><strong>具体变化参考官方文档:</strong></p><ul><li><a href="https://dev.mysql.com/doc/refman/5.6/en/innodb-architecture.html">https://dev.mysql.com/doc/refman/5.6/en/innodb-architecture.html</a></li><li><a href="https://dev.mysql.com/doc/refman/5.7/en/innodb-architecture.html">https://dev.mysql.com/doc/refman/5.7/en/innodb-architecture.html</a></li><li><a href="https://dev.mysql.com/doc/refman/5.8/en/innodb-architecture.html">https://dev.mysql.com/doc/refman/5.8/en/innodb-architecture.html</a></li></ul><h3 id="1-2-共享表空间设置"><a href="#1-2-共享表空间设置" class="headerlink" title="1.2 共享表空间设置"></a>1.2 共享表空间设置</h3><p>在搭建MySQL时，初始化数据之前设置到参数文件中。<br> <br></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql">[(<span class="hljs-keyword">none</span>)]<span class="hljs-operator">&gt;</span><span class="hljs-keyword">select</span> @<span class="hljs-variable">@innodb</span>_data_file_path;<br>[(<span class="hljs-keyword">none</span>)]<span class="hljs-operator">&gt;</span><span class="hljs-keyword">show</span> variables <span class="hljs-keyword">like</span> <span class="hljs-string">&#x27;%extend%&#x27;</span>;<br>innodb_data_file_path<span class="hljs-operator">=</span>ibdata1:<span class="hljs-number">512</span>M:ibdata2:<span class="hljs-number">512</span>M:autoextend<br>innodb_autoextend_increment<span class="hljs-operator">=</span><span class="hljs-number">64</span><br></code></pre></td></tr></table></figure> <br><p><strong>例如:</strong> </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">mysqld --initialize-insecure --user=mysql --basedir=xxxxxx......<br>innodb_data_file_path=ibdata1:512M:ibdata2:512M:autoextend<br></code></pre></td></tr></table></figure><p><strong>共享表空间重点了解</strong></p><ul><li>知道共享表空间存储的什么东西</li><li>初始化之前在配置文件提前定义大小 </li></ul><p> <br> <br></p><h3 id="1-3-独立表空间"><a href="#1-3-独立表空间" class="headerlink" title="1.3 独立表空间"></a>1.3 独立表空间</h3> <br><p><strong>独立每一个表</strong> </p>  <br><p><strong>从 5.6版本之后，默认表空间不再使用共享表空间，替换为独立表空间。</strong></p><p><strong>存储特点为</strong>：一个表一个ibd文件，存储数据行和索引信息。</p><p>一张 InnoDB 表是由  <strong>frm （表结构列）</strong>+ <strong>idb（数据行索引）</strong>+ <strong>ibdata1（统计信息元数据）</strong> 组成</p><br>  <br><p><strong>MySQL的存储引擎日志</strong></p><p><strong>Redo Log</strong>: <code>ib_logfile0</code> <code>ib_logfile1</code>，重做日志<br></p><p><strong>Undo Log</strong>: <code>ibdata1</code> <code>ibdata2</code> (存储在共享表空间中)，回滚日志<br></p><br><p><strong>临时表: ibtmp1，在做多表联合查询 join union 操作产生临时数据，用完就自动清理</strong></p><br><p> <strong>独立表空间设置</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql">db01 [(<span class="hljs-keyword">none</span>)]<span class="hljs-operator">&gt;</span><span class="hljs-keyword">select</span> @<span class="hljs-variable">@innodb</span>_file_per_table; <span class="hljs-comment">--每张表一个文件 改成0就变成共享表空间了，不会影响之前表的空间设置</span><br><span class="hljs-operator">+</span><span class="hljs-comment">-------------------------+</span><br><span class="hljs-operator">|</span> @<span class="hljs-variable">@innodb</span>_file_per_table <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">-------------------------+</span><br><span class="hljs-operator">|</span>           <span class="hljs-number">1</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">-------------------------+</span><br></code></pre></td></tr></table></figure><br><p><strong>独立表空间迁移</strong> </p><br><p><strong>目标</strong>：把一个100万行的数据表迁移到另一个数据库实例内。</p><p><strong>设想</strong>：把data目录下test数据库下面的 t100w.frm t100w.ibd文件直接拷贝过去使用。</p><p><strong>结论</strong>： 原因没有表的元数据，无法识别表。生成元数据需要找到原表的建表语句</p><br><p>(1) 创建和原表结构一致的空表</p><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> t100w (<br><span class="hljs-operator">-</span><span class="hljs-operator">&gt;</span> id <span class="hljs-type">int</span>,<br><span class="hljs-operator">-</span><span class="hljs-operator">&gt;</span> num <span class="hljs-type">int</span>,<br><span class="hljs-operator">-</span><span class="hljs-operator">&gt;</span> k1 <span class="hljs-type">char</span> (<span class="hljs-number">2</span>),<br><span class="hljs-operator">-</span><span class="hljs-operator">&gt;</span> k2 <span class="hljs-type">char</span> (<span class="hljs-number">4</span>),<br><span class="hljs-operator">-</span><span class="hljs-operator">&gt;</span> dt <span class="hljs-type">timestamp</span><br><span class="hljs-operator">-</span><span class="hljs-operator">&gt;</span> ) charset utf8mb4 <span class="hljs-keyword">collate</span> utf8mb4_bin;<br></code></pre></td></tr></table></figure><p>(2) 将空表的ibd文件删除</p><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> t100w discard tablespace;<br></code></pre></td></tr></table></figure><br><ol start="3"><li>将原表的ibd拷贝过来,并且修改权限</li></ol><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql">cp <span class="hljs-operator">-</span>a t100w.ibd <span class="hljs-operator">/</span>data<span class="hljs-operator">/</span><span class="hljs-number">3307</span><span class="hljs-operator">/</span>data<span class="hljs-operator">/</span>test<br>chown <span class="hljs-operator">-</span>R mysql.mysql <span class="hljs-operator">*</span><br></code></pre></td></tr></table></figure><p>(4) 将原表ibd进行导入</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> city import tablespace; <br></code></pre></td></tr></table></figure><p>查询表数据</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> count（<span class="hljs-operator">*</span>） <span class="hljs-keyword">from</span> t100w;<br><span class="hljs-number">1030346</span><br><span class="hljs-number">1</span> <span class="hljs-type">row</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">set</span> (<span class="hljs-number">0.99</span> sec)<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>DBA</category>
      
    </categories>
    
    
    <tags>
      
      <tag>DBA</tag>
      
      <tag>RDBMS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>GTID 记录模式管理</title>
    <link href="/2020/07/16/dba06-1/"/>
    <url>/2020/07/16/dba06-1/</url>
    
    <content type="html"><![CDATA[<h1 id="GTID-记录模式管理"><a href="#GTID-记录模式管理" class="headerlink" title="GTID 记录模式管理"></a>GTID 记录模式管理</h1><p>[[toc]]</p><h2 id="1-GTID-介绍"><a href="#1-GTID-介绍" class="headerlink" title="1. GTID 介绍"></a>1. GTID 介绍</h2><ul><li><p>对于binlog中的每一个事务,都会生成一个GTID号码</p></li><li><p>DDL ,DCL 一个event就是一个事务,就会有一个GTID号.</p></li><li><p>DML语句来讲,begin到commit,是一个事务,就是一个GTID号</p></li></ul><br><h2 id="2-GTID-组成"><a href="#2-GTID-组成" class="headerlink" title="2. GTID 组成"></a>2. GTID 组成</h2><p>由两部分组成<br><strong>severi_uuid:TID</strong> 事务的号码</p><p><strong>severi_uuid</strong> 在 <code>auto.cnf</code> 中查看</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">[root@db01 data]<span class="hljs-comment"># cat auto.cnf </span><br>[auto]<br>server-uuid=d60b549f-9e10-11e9-ab04-000c294a1b3b<br></code></pre></td></tr></table></figure><p>**TID **是一个自增长的数据,从1开始  如：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">d60b549f-9e10-11e9-ab04-000c294a1b3b:1-15<br></code></pre></td></tr></table></figure><br><br><h2 id="3-GTID-幂等性"><a href="#3-GTID-幂等性" class="headerlink" title="3. GTID 幂等性"></a>3. GTID 幂等性</h2><p>如果拿有GTID的日志去恢复时,检查当前系统中是否有相同GTID号,有相同的就自动跳过  </p><p>同Ansible剧本跳过同理会影响到binlog恢复和主从复制。</p><br><br><h2 id="4-GTID-开启和配置"><a href="#4-GTID-开启和配置" class="headerlink" title="4. GTID 开启和配置"></a>4. GTID 开启和配置</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">vim /etc/my.cnf<br>gtid-mode=on<br>enforce-gtid-consistency=<span class="hljs-literal">true</span> 强制gtid一致性<br></code></pre></td></tr></table></figure><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-17.png" alt="GTID"></p><p><strong>注意</strong>：开启后止影响以后的事务 以前的管不着</p><br><br><h3 id="4-1-查看GTID信息"><a href="#4-1-查看GTID信息" class="headerlink" title="4.1 查看GTID信息"></a>4.1 查看GTID信息</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">create</span> database gtid charset utf8mb4; 创建一个库<br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">show</span> master status; 查看gtid号码 已经产生gtid<br>mysql<span class="hljs-operator">&gt;</span> use gtid;<br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> t1(id <span class="hljs-type">int</span>); 创建一个表<br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">show</span> master status;  查看gtid号码 已经产生gtid <span class="hljs-number">1</span><span class="hljs-number">-2</span><br></code></pre></td></tr></table></figure><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-18.png" alt="GTID2"></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> t1 <span class="hljs-keyword">values</span>(<span class="hljs-number">1</span>);<br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">commit</span>;<br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">show</span> master status; <br></code></pre></td></tr></table></figure><p><strong>提交之后才算一个事务</strong>  </p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-19.png" alt="GTID3"></p><br><p><strong>开了GTID 后的日志信息</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">show</span> binlog events <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;mysql-bin.000005&#x27;</span> <br></code></pre></td></tr></table></figure><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-20.png" alt="GTID3"></p><br><br><h3 id="4-2-基于GTID-恢复数据"><a href="#4-2-基于GTID-恢复数据" class="headerlink" title="4.2 基于GTID 恢复数据"></a>4.2 基于GTID 恢复数据</h3><p>开启GTID 后只需截取GTID日志就可以了，GTID是全局事务唯一标号。</p><br><h4 id="截取日志"><a href="#截取日志" class="headerlink" title="截取日志"></a>截取日志</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">[root@db01 data]<span class="hljs-comment"># cd /data/binlog/</span><br>[root@db01 binlog]<span class="hljs-comment"># mysqlbinlog --include-gtids=&#x27;d60b549f-9e10-11e9-ab04-000c294a1b3b:1-3&#x27; mysql-bin.000005 &gt;/tmp/gtid.sql</span><br></code></pre></td></tr></table></figure><br><br><h4 id="恢复数据"><a href="#恢复数据" class="headerlink" title="恢复数据"></a>恢复数据</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">set</span> sql_log_bin<span class="hljs-operator">=</span><span class="hljs-number">0</span>; 暂时关闭日志<br>mysql<span class="hljs-operator">&gt;</span> source <span class="hljs-operator">/</span>tmp<span class="hljs-operator">/</span>gtid.sql 恢复<br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">set</span> sql_log_bin<span class="hljs-operator">=</span><span class="hljs-number">1</span>; 开启日志<br></code></pre></td></tr></table></figure><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-21.png" alt="GTID恢复"></p><br><h4 id="报错"><a href="#报错" class="headerlink" title="报错"></a>报错</h4><h4 id=""><a href="#" class="headerlink" title=""></a></h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql">ERROR <span class="hljs-number">1049</span> (<span class="hljs-number">42000</span>): <span class="hljs-literal">Unknown</span> database <span class="hljs-string">&#x27;gtid&#x27;</span><br>Query OK, <span class="hljs-number">0</span> <span class="hljs-keyword">rows</span> affected (<span class="hljs-number">0.00</span> sec)<br>ERROR <span class="hljs-number">1046</span> (<span class="hljs-number">3</span>D000): <span class="hljs-keyword">No</span> database selected<br></code></pre></td></tr></table></figure><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section6-1-22.png" alt="GTID恢复报错"></p><br><p><strong>为什么报错?</strong></p><p>因为幂等性的检查,1-3事务已经做过了。</p><p><strong>正确的做法</strong>：</p><p>在导出的时候应该忽略GTID的幂等性。 当成新的事务来对待 1-4  跳过并记录新ID号</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">mysqlbinlog --skip-gtids --include-gtids=<span class="hljs-string">&#x27;d60b549f-9e10-11e9-ab04-000c294a1b3b:1-3&#x27;</span> mysql-bin.000005 &gt;/tmp/gtid.sql<br>--skip-gtids <br></code></pre></td></tr></table></figure><p><strong>作用</strong>:在导出时,忽略原有的gtid信息,恢复时生成最新的 GTID 信息</p><p><strong>恢复数据</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">set</span> sql_log_bin<span class="hljs-operator">=</span><span class="hljs-number">0</span>;<br>source <span class="hljs-operator">/</span>tmp<span class="hljs-operator">/</span>gtid.sql<br><span class="hljs-keyword">set</span> sql_log_bin<span class="hljs-operator">=</span><span class="hljs-number">1</span>;<br></code></pre></td></tr></table></figure><br><p><strong>GTID相关的参数</strong>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">--skip-gtids <span class="hljs-comment">#忽略原有的GTID 信息,恢复时生成最新的 GTID 信息</span><br>--include-gtids=<span class="hljs-string">&#x27;d60b549f-9e10-11e9-ab04-000c294a1b3b:6&#x27;</span>,<span class="hljs-string">&#x27;d60b549f-9e10-11e9-ab04-000c294a1b3b:8&#x27;</span> <span class="hljs-comment">#只截取6和8</span><br>--exclude-gtids=<span class="hljs-string">&#x27;d60b549f-9e10-11e9-ab04-000c294a1b3b:6&#x27;</span>,<span class="hljs-string">&#x27;d60b549f-9e10-11e9-ab04-000c294a1b3b:8&#x27;</span> <span class="hljs-comment">#排除</span><br></code></pre></td></tr></table></figure><br><br>]]></content>
    
    
    <categories>
      
      <category>DBA</category>
      
    </categories>
    
    
    <tags>
      
      <tag>DBA</tag>
      
      <tag>RDBMS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>InnoDB 核心参数介绍</title>
    <link href="/2020/07/15/dba05-3/"/>
    <url>/2020/07/15/dba05-3/</url>
    
    <content type="html"><![CDATA[<h1 id="InnoDB-核心参数介绍"><a href="#InnoDB-核心参数介绍" class="headerlink" title="InnoDB 核心参数介绍"></a>InnoDB 核心参数介绍</h1><p>[[toc]]</p><h2 id="1-上节知识点回顾"><a href="#1-上节知识点回顾" class="headerlink" title="1.上节知识点回顾"></a>1.上节知识点回顾</h2><h3 id="1-1-表空间说明"><a href="#1-1-表空间说明" class="headerlink" title="1.1 表空间说明"></a>1.1 表空间说明</h3><ul><li>独立表空间 : 5.6 开始的默认表空间,一个表一个ibd文件,存储数据行和索引</li><li>共享表空间 : 5.5 默认的模式, 所有表的行和索引都存储到ibdata1</li></ul><br><p><strong>说明</strong>: </p><ul><li>从5.6 开始,不再使用共享表空间模式</li><li>5.6版本  数据字典信息 :heavy_plus_sign: UNDO :heavy_plus_sign: TMP<br>5.7版本  把 TMP 独立了<br>8.0版本  把 UNDO 独立</li></ul><br><h3 id="1-2-表空间迁移"><a href="#1-2-表空间迁移" class="headerlink" title="1.2 表空间迁移"></a>1.2 表空间迁移</h3><br><p>创建和原表结构相同的表</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> t1 discard tablespace ;<span class="hljs-comment">-- 把新建表的 ibd 删除</span><br></code></pre></td></tr></table></figure><p>拷贝原表ibd到新位置</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> t1 import tablespace; <span class="hljs-comment">---导入ibd到新表</span><br></code></pre></td></tr></table></figure><br><br><h3 id="1-3-有关表扩容问题"><a href="#1-3-有关表扩容问题" class="headerlink" title="1.3 有关表扩容问题"></a>1.3 有关表扩容问题</h3> <br><p>​             共享表空间是可以扩容的，但是独立表空间一个表就是一个文件，表的可用大小就要看放置磁盘的容量了。磁盘一旦满了说明数据量级已经很大了 在 MySQL中更加推荐使用进行分布式存储，进行分库分表。数据量级在很大的状态下使用 MySQL单实例解决问题是不太现实的。</p><p>​           我们的处理逻辑就要把一个大表拆分到不同的数据库实例的进行读写，多实例处理并发访问。而不是说继续找几块磁盘扩容，这样操作实际上还是单实例运行没有任何意义。MySQL 更善于从架构方面来解决数据量级大的问题，所以说它不在使用共享表空间。</p><br><br><h3 id="1-4-事务-ACID"><a href="#1-4-事务-ACID" class="headerlink" title="1.4 事务 ACID"></a>1.4 事务 ACID</h3><br><ul><li><p><strong>Atomic（原子性）</strong>   undo回滚 未提交的事务要取消掉<br>所有语句作为一个单元全部成功执行或全部取消。不能出现中间状态。</p></li><li><p><strong>Consistent（一致性）</strong>   redo undo 保证一致性 开始是10块钱 结束也是10块钱<br>如果数据库在事务开始时处于一致状态，则在执行该事务期间将保留一致状态。</p></li><li><p><strong>Isolated（隔离性）</strong>    行级锁 隔离级别 事务之间不相互影响。</p></li><li><p><strong>Durable（持久性）</strong> rudo  日志优先性写  优先记录而不是数据直接写入磁盘<br>事务成功完成后，所做的所有更改都会准确地记录在数据库中。所做的更改不会丢失。</p></li></ul><br><br><h3 id="1-5-Redo"><a href="#1-5-Redo" class="headerlink" title="1.5 Redo"></a>1.5 Redo</h3><br><p>(1) 记录 内存数据页变化日志<br><br>(2) 提供 快速的事务的提交(commit)<br><br>(3) CSR  redo提供的前滚的功能<br></p><br><br><h3 id="1-6-Undo"><a href="#1-6-Undo" class="headerlink" title="1.6 Undo"></a>1.6 Undo</h3><br><p>(1) 记录 数据修改之前的状态<br><br>(2) 提供 事务工作过过程中回滚操作(rollback)<br><br>(3) CSR 中将未提交的事务进行回滚<br></p><br><br><h3 id="1-7-隔离级别"><a href="#1-7-隔离级别" class="headerlink" title="1.7 隔离级别"></a>1.7 隔离级别</h3><br><p>RU  读未提交,会有脏读 , 幻读 ,不可重复读<br><br>RC  读已提交,会有 幻读,不可重复读. 在大部分互联网企业中是可以容忍的.<br><br>RR  可重复读:(MVCC ,undo快照)防止不可重复读, 有可能出现幻读,通过GAP+Next LOCK来防止幻读(索引).<br><br>SR  可串行化:  串行执行事务 一般不会使用    一个事务执行完了才能执行下一个.<br></p><br><br><h2 id="2-InnoDB-核心参数介绍"><a href="#2-InnoDB-核心参数介绍" class="headerlink" title="2. InnoDB 核心参数介绍"></a>2. InnoDB 核心参数介绍</h2><br><p><strong>设置存储引擎默认设置</strong></p><p><code>default_storage_engine=innodb</code></p><p><strong>设置表空间模式</strong></p><p><code>innodb_file_per_table=1</code> 使用独立表空间,动态参数。</p><p><strong>设置共享表空间文件个数和大小</strong></p><p><code>innodb_data_file_path=ibdata1:512M:ibdata2:512M:autoextend</code></p><p><strong>“双一” 标准的其中一个 （重要知识点）</strong> :star::star::star::star::star:</p><p><strong>控制刷写rudo日志到磁盘的策略</strong></p><p><code>innodb_flush_log_at_trx_commit=1</code> 在事务提交时刷写redo 到磁盘策略</p><p><strong>查询当前策略</strong> </p><p><code>select @@innodb_flush_log_at_trx_commit;</code></p><br><p><strong>redo 日志写入磁盘过程</strong>：数据库内存数据 :arrow_right: 刷写文件系统缓存 :arrow_right: 写入磁盘</p><br><p>例：<code>innodb_flush_log_at_trx_commit=1</code></p><ul><li>为1 时 每次事务提交时立即将mysql内存中数据刷到os文件系统并立即写入磁盘，保证每次事务提交都会写到磁盘。</li><li>为0 时 事务每秒刷写到磁盘不管提交没提交，但是每秒发生无数事务 断电可能导致事务丢失。 </li><li>为2 时 每次事务提交 只保证提交到os文件系统缓存，然后每秒刷一次事务到磁盘。主机断电也可能丢失数据。</li></ul><br><p><strong>小结</strong>：如果追求性能 设置为 <code>0</code> 安全则设置为<code>1</code></p><p>:::tip Discribe</p><p>The default setting of 1 is required for full ACID compliance. Logs are written and flushed to disk at each transaction commit.</p><p>With a setting of 0, logs are written and flushed to disk once per second. Transactions for which logs have not been flushed can be lost in a crash.</p><p>With a setting of 2, logs are written after each transaction commit and flushed to disk once per second. Transactions for which logs have not been flushed can be lost in a crash.</p><p>:::</p><br><br><p><strong>Innodb_flush_method=(O_DIRECT, fsync)（重要知识点）</strong> :star::star::star::star:</p><p><strong>作用</strong>: 控制的是 Redo buffer 和 buffer pool</p><br><p><strong>默认参数</strong> <strong>fsync</strong>  :  常规层级刷写都会经过中间层</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section5-3-13.png" alt="fsync默认模式"><br><br></p><p><strong>O_DIRECT :</strong> 建议模式   redo buffer不变 buffter pool 直接写入硬盘</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section5-3-14.png" alt="fsync默认模式"></p><br><p><strong>O_DSYNC</strong> : buffter pool不变  redo日志时间写入磁盘</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section5-3-15.png" alt="fsync默认模式"></p><br><p><strong>小结</strong>：</p><p><strong>最高安全模式</strong></p><p><code>innodb_flush_log_at_trx_commit=1</code><br><code>Innodb_flush_method=O_DIRECT</code> </p><p>防止经过os 文件系统缓存 导致数据写入磁盘不全，减少操作系统文件系统缓存内存占用</p><p><strong>最高性能模式</strong></p><p><code>innodb_flush_log_at_trx_commit=0</code><br><code>Innodb_flush_method=fsync</code>           </p><p>先把部分数据写入内存在写入磁盘 经过缓存速度快但是比较占内存</p><br><p><strong>Redo日志设置有关的参数</strong></p><p><code>innodb_log_buffer_size=16777216</code> 缓存区大小</p><p><code>innodb_log_file_size=50331648</code>   日志大小默认 50M</p><p><code>innodb_log_files_in_group = 3</code>    redo 文件3个</p><p>按照要求调整日志文件大小或数量并写入到my.cnf文件中</p><br><br><p><strong>脏页刷写策略参数</strong></p><p><code>innodb_max_dirty_pages_pct=75</code> 在buffter 中如果脏页占用超过75% 时会立即写入磁盘</p><br><p><strong>还有哪些机制会直接触发写入磁盘?</strong></p><ol><li>CSR </li><li>redo 空间满了 </li></ol>]]></content>
    
    
    <categories>
      
      <category>DBA</category>
      
    </categories>
    
    
    <tags>
      
      <tag>DBA</tag>
      
      <tag>RDBMS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>InnoDB 核心特性</title>
    <link href="/2020/07/15/dba05-2/"/>
    <url>/2020/07/15/dba05-2/</url>
    
    <content type="html"><![CDATA[<h1 id="InnoDB-核心特性"><a href="#InnoDB-核心特性" class="headerlink" title="InnoDB 核心特性"></a>InnoDB 核心特性</h1><p>[[toc]]</p><h2 id="1-事务"><a href="#1-事务" class="headerlink" title="1. 事务"></a>1. 事务</h2><br><p>事务保证金融交易类服务的安全性完整性和公平性。</p><br><h3 id="1-1-事务的-ACID-特性"><a href="#1-1-事务的-ACID-特性" class="headerlink" title="1.1 事务的 ACID 特性"></a>1.1 事务的 ACID 特性</h3><br><ul><li><strong>Atomic（原子性）</strong></li></ul><p>所有语句作为一个单元全部成功执行或全部取消。不能出现中间状态。</p><ul><li><strong>Consistent（一致性）</strong></li></ul><p>如果数据库在事务开始时处于一致状态，则在执行该事务期间将保留一致状态。</p><ul><li><strong>Isolated（隔离性）</strong></li></ul><p>事务之间不相互影响。</p><ul><li><strong>Durable（持久性）</strong></li></ul><p>事务成功完成后，所做的所有更改都会准确地记录在数据库中。所做的更改不会丢失。</p><p>断电时，也会在磁盘上永久保存，事务的完整性</p><br><h3 id="1-2-事务控制语句"><a href="#1-2-事务控制语句" class="headerlink" title="1.2 事务控制语句"></a>1.2 事务控制语句</h3><br><p><strong>(1)</strong> <strong>如何开启事务</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">begin</span> ;<br><span class="hljs-keyword">start</span> transaction；<br></code></pre></td></tr></table></figure><p><strong>(2)</strong> <strong>标准的事务语句</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sql">DML : <br><span class="hljs-keyword">insert</span> <br>update <br><span class="hljs-keyword">delete</span><br>mysql<span class="hljs-operator">&gt;</span> use world;<br>mysql<span class="hljs-operator">&gt;</span> update city <span class="hljs-keyword">set</span> countrycode<span class="hljs-operator">=</span><span class="hljs-string">&#x27;CHN&#x27;</span> <span class="hljs-keyword">where</span> id<span class="hljs-operator">=</span><span class="hljs-number">1</span>;<br>mysql<span class="hljs-operator">&gt;</span> update city <span class="hljs-keyword">set</span> countrycode<span class="hljs-operator">=</span><span class="hljs-string">&#x27;CHN&#x27;</span> <span class="hljs-keyword">where</span> id<span class="hljs-operator">=</span><span class="hljs-number">2</span>;<br>mysql<span class="hljs-operator">&gt;</span> update city <span class="hljs-keyword">set</span> countrycode<span class="hljs-operator">=</span><span class="hljs-string">&#x27;CHN&#x27;</span> <span class="hljs-keyword">where</span> id<span class="hljs-operator">=</span><span class="hljs-number">3</span>;<br></code></pre></td></tr></table></figure><p><strong>(3) 事务的结束</strong> </p><p> 正常的结束有两种，只能回滚未提交的事务</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">--提交:</span><br><span class="hljs-keyword">commit</span>;<br><br><span class="hljs-comment">--回滚:</span><br><span class="hljs-keyword">rollback</span>;<br></code></pre></td></tr></table></figure><br><h3 id="1-3-事务自动提交机制-（autocommit）"><a href="#1-3-事务自动提交机制-（autocommit）" class="headerlink" title="1.3 事务自动提交机制 （autocommit）"></a>1.3 事务自动提交机制 （autocommit）</h3><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> @<span class="hljs-variable">@autocommit</span>;<br><span class="hljs-operator">+</span><span class="hljs-comment">--------------+</span><br><span class="hljs-operator">|</span> @<span class="hljs-variable">@autocommit</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">--------------+</span><br><span class="hljs-operator">|</span>      <span class="hljs-number">1</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">--------------+ </span><br></code></pre></td></tr></table></figure><p><strong>在线修改参数:</strong></p><p><strong>(1) 会话级别:</strong> </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">set</span> autocommit<span class="hljs-operator">=</span><span class="hljs-number">0</span>;<br><span class="hljs-comment">--及时生效,只影响当前登录会话</span><br></code></pre></td></tr></table></figure><p><strong>(2)全局级别:</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">set</span> <span class="hljs-keyword">global</span> autocommit<span class="hljs-operator">=</span><span class="hljs-number">0</span>; <br><span class="hljs-comment">--断开窗口重连后生效,影响到所有新开的会话</span><br></code></pre></td></tr></table></figure><p><strong>(3)永久修改(重启生效)</strong> </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql">vim <span class="hljs-operator">/</span>etc<span class="hljs-operator">/</span>my.cnf  <span class="hljs-comment">--修改配置文件</span><br>autocommit<span class="hljs-operator">=</span><span class="hljs-number">0</span><br></code></pre></td></tr></table></figure><br><h3 id="1-4-隐式提交的情况"><a href="#1-4-隐式提交的情况" class="headerlink" title="1.4  隐式提交的情况"></a>1.4  <strong>隐式提交的情况</strong></h3><p><strong>触发隐式提交的语句</strong></p><p><strong>导致提交的非事务语句：</strong></p><p>DDL语句： （ALTER、CREATE 和 DROP）</p><p>DCL语句： （GRANT、REVOKE 和 SET PASSWORD）</p><p>锁定语句：（LOCK TABLES 和 UNLOCK TABLES）</p><p><strong>导致隐式提交的语句示例：</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">TRUNCATE</span> <span class="hljs-keyword">TABLE</span>   <span class="hljs-comment">--清除表数据</span><br>LOAD DATA INFILE <span class="hljs-comment">--导入</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">FOR</span> UPDATE <span class="hljs-comment">--查询更新</span><br></code></pre></td></tr></table></figure><br><h2 id="2-事务的ACID-特性如何保证"><a href="#2-事务的ACID-特性如何保证" class="headerlink" title="2. 事务的ACID 特性如何保证"></a>2. 事务的ACID 特性如何保证</h2><br><h3 id="2-1-相关概念名词-（初步了解）"><a href="#2-1-相关概念名词-（初步了解）" class="headerlink" title="2.1 相关概念名词 （初步了解）"></a>2.1 相关概念名词 （初步了解）</h3><br><table><thead><tr><th>相关名词</th><th>作用注释</th></tr></thead><tbody><tr><td>Redo log</td><td>重做日志，默认设置两个文件 ib_logfile0~1 默认大小50M，轮询使用</td></tr><tr><td>Redo log buffer</td><td>Redo log 的内存区域</td></tr><tr><td>IBD</td><td>用于存储 数据行和索引</td></tr><tr><td>Data butter pool</td><td>对应IBD 文件，缓冲区池，数据行和索引的缓存区</td></tr><tr><td>LSN</td><td>日志的序列号，类似Git 版本号。数据库启动,会比较<strong>磁盘数据页和redo log的LSN,两者一致才能正常启动</strong></td></tr><tr><td>WAL</td><td>日志优先写，Write Ahead Log 日志优先写的方式实现持久化,<strong>日志是优先于数据写入磁盘的</strong></td></tr><tr><td>脏页</td><td>内存中发生了修改,<strong>没写入到磁盘之前</strong>,我们把内存页称之为脏页</td></tr><tr><td>CKPT</td><td>Check Point 检查点,就是将<strong>脏页刷写到磁盘的动作</strong></td></tr><tr><td>TXID</td><td>事务号,InnoDB会为每一个事务生成一个事务号,伴随着整个事务</td></tr></tbody></table><br><h3 id="2-2-事务日志——-Redo-重做日志"><a href="#2-2-事务日志——-Redo-重做日志" class="headerlink" title="2.2 事务日志—— Redo 重做日志"></a>2.2 事务日志—— Redo 重做日志</h3><br><h4 id="2-2-1-重做日志的作用"><a href="#2-2-1-重做日志的作用" class="headerlink" title="2.2.1 重做日志的作用:"></a>2.2.1 <strong>重做日志的作用:</strong></h4><p>保证事务的 “D” 持久性 , A 原子性和C 一致性也有一定得作用</p><p><strong>（1） 记录了内存数据页的变化</strong></p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section5-3-1.png" alt="rodo1"></p><br><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section5-3-2.png" alt="rodo2"></p><br><br><br><p><strong>一次 update语句 的事务处理过程：</strong></p><br><ul><li>首先把数据从硬盘调到内存中  （ 因为默认使用<strong>innodb</strong>存储引擎有段区页的概念 ，不能只向内存调用修改的1行数据，而是把16kb的数据页调到内存中。）    带着原本A=1数据 ，在执行 update语句后 在内存中改成了被 A=2  。</li><li>按照正常思路数据修改完就要从内存写回到硬盘，但是MySQL 觉着这样操作过于低效就研发了 redo日志 ，执行 update 语句的变化的同时记录 redo日志 。（redo 负责记录内存中数据页发生的变化）记录 A从1变成 2的过程日志。</li><li>commit 命令 事务提交完成时把 redo 日志写入到磁盘中，并在内存占用到达一定阈值后刷写内存中的数据到硬盘。</li></ul><br><br><p><strong>把日志提交到磁盘</strong></p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section5-3-3.png" alt="rodo1"></p><br><p><strong>(2) 提供快速的持久化功能(WAL)</strong></p><br><p>日志优先写机制，可以间接的保证已经提交过的事务不会在丢失。根据日志构造或重做出来（前滚）。</p><br><p>::: tip Redo 的工作理念</p><p><strong>Redo log 最核心的功能</strong> 就是保证数据持久化时性能更高、更快速，只需要把 Redo log 写入磁盘就能保证事务不丢失。</p><p><strong>前滚操作</strong>：服务器断电时内存数据丢失 ，会把硬盘数据重新调入到内存根据redo log重做一遍还原之前的内存中的数据</p><p><strong>触发阈值</strong>：比如内存使用率达到75% 数据写入磁盘</p><p>:::</p><br><p><strong>Redo log 缺陷</strong>：断电后数据库下次启动时如何知道 Redo log 是否是新的？</p><br><p><strong>A=1 —-&gt; A=2 101——&gt; 102</strong> </p><p>在数据页 、redo日志、 内存数据 、redo buffer 均有LSN号码。例如：数据原始LSN号为101 ，带到内存中变化后LSN号码就变成102。  redo buffer 也是102  redo log 中LSN号也是102 。</p><br><br><p><strong>(3) CSR过程中实现前滚的操作</strong> </p><p>磁盘数据页和 redo日志 LSN 号要一致数据库服务才能启动，原始LSN号为101 ，带到内存中变化后LSN号码就变成102。  redo buffer 也是102  redo log 中LSN号也是102 。</p><br><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section5-3-4.png" alt="CSR1"></p><br><p><strong>前滚操作：</strong></p> <br><ol><li>重启发现 redo log LSN号比 数据 LSN号  不一样  ， redo 的 LSN 号较新</li><li>这时原始数据 和 redo日志被加载到内存通过日志记录变化构造脏页</li><li> InnoDB 存储引擎立即触发 CKPT 立即把内存中的数据写入到磁盘</li><li>此时 两个LSN号就一样了可以正常启动</li></ol><p><strong>在启动时必须保证 redo日志文件和数据文件 LSN号 必须一致, 如果不一致就会触发 CSR最终保证一致。</strong></p><br><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/section5-3-5.png" alt="前滚操作示意图"></p><br><br><h4 id="2-2-2-Redo-日志位置"><a href="#2-2-2-Redo-日志位置" class="headerlink" title="2.2.2 Redo 日志位置"></a>2.2.2 Redo 日志位置</h4><br><p><strong>Redo的日志文件名</strong>：iblogfile0 iblogfile1… 可以设置多个文件轮询记录</p><p><strong>Redo buffer</strong>: 数据页的变化信息+数据页当时的LSN号</p><br><br><h4 id="2-2-3-Redo的刷写策略"><a href="#2-2-3-Redo的刷写策略" class="headerlink" title="2.2.3 Redo的刷写策略"></a>2.2.3 Redo的刷写策略</h4><br><p>commit 提交事务后刷新当前事务的 redo buffer到磁盘</p><p>还会顺便将一部分 redo buffer中没有提交的事务日志也刷新到磁盘</p><p>MySQL 在启动时,必须保证redo日志文件和数据文件LSN必须一致, 如果不一致就会触发CSR,最终保证一致</p><br><br><p><strong>情况一：</strong></p><p>我们做了一个完整的事务过程 begin; update; commit。</p><br><ol><li>在begin开始一个事务后 ,会立即分配一个TXID=tx_01</li><li>update时,会将需要修改的数据页(dp_01,LSN=101),加载到data buffer中</li><li>DBWR线程,会进行dp_01数据页修改更新,并更新LSN=102</li><li>LOGBWR日志写线程,会将dp_01数据页的变化+LSN+TXID存储到redobuffer</li><li>执行 commit时,LGWR日志写线程会将redobuffer信息写入redolog日志文件中,基于WAL原则,</li><li>在日志完全写入磁盘后,commit命令才执行成功,(会将此日志打上commit标记)</li><li>假如此时宕机,内存脏页没有来得及写入磁盘,内存数据全部丢失</li><li>MySQL再次重启时,必须要redolog和磁盘数据页的LSN是一致的.但是,此时dp_01,TXID=tx_01磁盘是LSN=101,dp_01,TXID=tx_01,redolog中LSN=102</li><li>MySQL此时无法正常启动,MySQL触发CSR.在内存追平LSN号,触发ckpt,将内存数据页更新到磁盘,从而保证磁盘数据页和redolog LSN一值.这时MySQL正长启动</li></ol><br><p><strong>以上的工作过程,我们把它称之为基于 REDO 的”前滚操作”</strong></p><br><br><h3 id="2-3-Undo-日志说明"><a href="#2-3-Undo-日志说明" class="headerlink" title="2.3 Undo 日志说明"></a>2.3 Undo 日志说明</h3><br><p>Undo 回滚日志主要作用于<strong>事务在未提交时断电的情况</strong>。</p><br><h4 id="2-3-1-Undo-日志作用"><a href="#2-3-1-Undo-日志作用" class="headerlink" title="2.3.1 Undo 日志作用"></a><strong>2.3.1 Undo 日志作用</strong></h4><p>在 ACID特性中,主要保证A 原子性 的特性,同时对C一致性 I  隔离性 也有一定功效</p><br><p><strong>(1) 记录了数据修改之前的状态    在数据调用到内存中的同时。</strong><br><br><strong>(2) rollback 将内存的数据修改恢复到修改之前。</strong></p><br><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/section5-3-6.png" alt="回滚操作示意图"></p><p><strong>(3) 在CSR中实现未提交数据的回滚操作</strong></p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/section5-3-7.png" alt="回滚操作示意图2"></p><p><strong>(4) 实现一致性快照,配合隔离级别保证多版本并发控制 MVCC ,实现读和写的操作不会互相阻塞。</strong></p><br><br><h4 id="2-3-2-回滚操作过程"><a href="#2-3-2-回滚操作过程" class="headerlink" title="2.3.2 回滚操作过程"></a>2.3.2 回滚操作过程</h4><p>硬盘数据调用到内存 同时 记录记录了数据修改之前的状态到undo log a=1 txid=t1 ，数据在内存中发生改变后记录到redo buffer。</p><br><p><strong>这时有两种情况</strong>：</p><p><strong>第一种情况：</strong></p><p>内存中发生了更改但是未提交 Redo log 还未写到硬盘就断电了</p><p>此时，Redo log 的LSN号 为101 txid=t0</p><p>数据库重启扫描到 Undo 日志LSN号却为 t1，这时直接丢掉 Undo 日志进行回滚，事务还原到未做更改之前。</p><br><p><strong>第二种情况</strong>：</p><p>Redo log  被其他事务顺带写入磁盘中，此时 LSN号变为102 TXID=T1  但是事务标记未提交状态。</p><p>数据库服务重启会对比 ibd文件和 redo 文件 构建脏页 进行前滚操作</p><p>由于事务标记处于未提交状态 ，触发CSR 第二阶段</p><p>Redo T1的事务编号找到 undo log 加载之前的状态，回滚恢复到事务未提交之前的状态 ，最终保证所有的LSN号都一样</p><p>并丢失当前的变更。</p><h3 id="2-4-锁"><a href="#2-4-锁" class="headerlink" title="2.4 锁"></a>2.4 锁</h3><br><p>实现了事务之间的隔离功能, InnoDB存储引擎中实现的是行级锁。</p><p>这里以厕所举例，InnoDB就相当于你去厕所只锁你蹲坑的那个门，而老版本 <strong>MyISAM</strong> 就相当于你去厕所把厕所大门给锁上了。</p> <br><p><strong>row-level lock</strong> 行级锁定，默认超时时间为50秒达到时间回滚事务，作用是控制同一行数据的操作等待事务提交后才能修改默认超时时间50秒。</p> <br><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/section5-3-8.png" alt="锁"></p> <br><ul><li><strong>GAP</strong>      间隙锁</li><li><strong>Next-lock</strong> 下一级锁 锁定范围 防止幻读情况 隔离性</li></ul> <br><h3 id="2-5-隔离级别"><a href="#2-5-隔离级别" class="headerlink" title="2.5 隔离级别"></a>2.5 隔离级别</h3> <br><h4 id="2-5-1-四种隔离级别"><a href="#2-5-1-四种隔离级别" class="headerlink" title="2.5.1 四种隔离级别"></a>2.5.1 四种隔离级别</h4> <br><p><strong>（1）RU  : 读未提交,可脏读,一般部议叙出现</strong></p><p>没提交就被看见结果了 可脏读</p> <br><p><strong>RC  : 读已提交,可能出现幻读,可以防止脏读.</strong> </p><p>每次读取的都是最新的数据，让人迷惑到底哪个结果是正确的  在金融类业务中是不允许的 幻读 ，银行在截止统计时间内的事务的结果不能是来回变动的。需要准确度极高 </p><p> 例如：统计时间点截止23：59：59秒这个点进行统计 查询需要持续10分钟 ，在这查询的10分钟内 不能在查询过程中出现新的变化导致数值变化。</p> <br><p><strong>RR  : 可重复读</strong></p><p>功能是防止”幻读”现象 ,利用的是undo的快照技术+GAP(间隙锁)+NextLock(下键锁)  使用  MVCC   —&gt;   undo 快照 </p><p>使用  MVCC   —&gt;   undo 快照  读数据的时候 mysql窗口 打开的那一刻的数据，不管其他窗口改多少次也不会变，保证不会出现在截止时间点之后的数据</p> <br><p><strong>SR  :</strong> 可串行化,可以防止死锁,但是并发事务性能较差</p> <br><p><strong>补充</strong>: 在RC级别下,可以减轻GAP+NextLock锁的问题,但是会出现幻读现象,一般在为了读一致性会在正常select后添加for update语句.但是,请记住执行完一定要commit 否则容易出现所等待比较严重.</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> @<span class="hljs-variable">@tx</span>_isolation; <span class="hljs-comment">--查当前隔离级别</span><br></code></pre></td></tr></table></figure> <br><p><strong>更改隔离级别：</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#客户端配置</span><br>transaction_isolation=read-uncommitted<br>transaction_isolation=read-committed<br>transaction_isolation=REPEATABLE-READ<br>transaction_isolation=Serializable<br></code></pre></td></tr></table></figure> <br><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section5-3-9.png" alt="隔离级别"></p><p><strong>小结</strong>：</p><ul><li>RU 会出现脏读 , </li><li>RC 会出现不可重复读每次读结果不一样 ,也会出现幻读. </li><li>RR 通过MVCC基础解决了不可重复读,但是有可能会出现幻读现象，可以通过 锁GAP和NEXT-lock 进行避免</li><li>在RR模式下,GAP和Next-lock进行避免幻读现象,必须索引支持</li></ul> <br><p><strong>如何避免出现幻读 ?</strong></p><p>RR级别 + 锁</p><p>例如：在数据插入时限制大于2的范围锁定不允许插入 （GAP锁和Next-lock锁 不会锁定数据行  只会锁定那一列的索引键值）</p><p>锁定5-8 的范围称之为 GAP锁又叫间隙锁。</p><p>锁定 2-最大值的范围称之为  Next-lock   8 以后 9 10 ……  的数据都不能插入，称为下一级锁。</p> <br><p><strong>建立索引</strong></p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section5-3-9.png" alt="锁级别"></p> <br><p><strong>正在更新数据</strong></p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section5-3-10.png" alt="锁级别2"></p> <br><p><strong>这时另一终端插入数据，进行锁等待，只能在 第二个终端提交后才能插入</strong></p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section5-3-11.png" alt="锁级别3"></p>]]></content>
    
    
    <categories>
      
      <category>DBA</category>
      
    </categories>
    
    
    <tags>
      
      <tag>DBA</tag>
      
      <tag>RDBMS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>索引原理介绍创建与执行计划分析</title>
    <link href="/2020/07/15/dba04-2/"/>
    <url>/2020/07/15/dba04-2/</url>
    
    <content type="html"><![CDATA[<h1 id="索引原理介绍创建与执行计划分析"><a href="#索引原理介绍创建与执行计划分析" class="headerlink" title="索引原理介绍创建与执行计划分析"></a>索引原理介绍创建与执行计划分析</h1><p>[[toc]]</p><h2 id="1-索引的作用"><a href="#1-索引的作用" class="headerlink" title="1.索引的作用"></a>1.索引的作用</h2><p>类似书的目录,起到优化查询的作用</p><h2 id="2-索引的分类-算法"><a href="#2-索引的分类-算法" class="headerlink" title="2. 索引的分类(算法)"></a><strong>2.</strong> 索引的分类(算法)</h2><ul><li><p>B树  默认使用的索引类型</p></li><li><p>R树 基本不用</p></li><li><p>Hash 自适应 自动优化不需要设置</p></li><li><p>FullText  全文索引 类似ES数据库</p></li><li><p>GIS 索引 5.7版本 用于存储地理位置信息</p></li></ul><h2 id="3-BTREE索引算法演变"><a href="#3-BTREE索引算法演变" class="headerlink" title="3. BTREE索引算法演变"></a>3. BTREE索引算法演变</h2><h3 id="3-1-顺序查找法"><a href="#3-1-顺序查找法" class="headerlink" title="3.1 顺序查找法"></a>3.1 顺序查找法</h3><p>顺序查找，顾名思义，就是从头到尾遍历的查找，直到找到要找的元素x为止，所以这种方法对于有n个元素的线性表而言，在最坏情况下需要n次比较。</p><h3 id="3-2-二分查找法"><a href="#3-2-二分查找法" class="headerlink" title="3.2 二分查找法"></a>3.2 二分查找法</h3><p>使用二分查找法的前提是要查找的序列是已经排序好的，所以若序列不是顺序的，应先对其进行排序，或者从小到大，或者从大到小。这种方法的特点是无论怎样查找，每次都只是在一半的数据中查找。</p><h3 id="3-3-二叉排序树查找"><a href="#3-3-二叉排序树查找" class="headerlink" title="3.3 二叉排序树查找"></a>3.3 二叉排序树查找</h3><p>二叉树是一种很有用的非线性结构。在二叉树中，每一个结点的度最大为2，二叉树中的每个结点的子树被分为左子树和右子树。在二叉树中，一个结点可以只有左子树而没有右子树，也可以只有右子树而没有左子树。当一个结点既没有左子树也没有右子树时，该结点即为叶子结点。</p><h3 id="3-4-平衡二叉树"><a href="#3-4-平衡二叉树" class="headerlink" title="3.4 平衡二叉树"></a>3.4 平衡二叉树</h3><p>平衡二叉树 是在 二叉树上 进一步限制,在向树种添加节点时,牺牲一定的时间和空间,通过若干次旋转,达到一定的平衡;以提高查询的性能。</p><h3 id="3-5-Btree"><a href="#3-5-Btree" class="headerlink" title="3.5 Btree"></a>3.5 Btree</h3><p>英文名字叫做B-tree，中间的短线是英文连接符，只是翻译的时候将短线翻译成了减号。<strong>全称Balance-tree(平衡多路查找树)<strong>，</strong>平衡</strong>的意思是左边和右边分布均匀。<strong>多路</strong>的意思是相对于二叉树而言的，二叉树就是二路查找树，查找时只有两条路，而B-tree有多条路，即父节点有多个子节点。使用B-tree结构可以<strong>显著减少定位</strong>记录时所经历的中间<strong>过程</strong>，从而加快存取速度。这个数据结构一般用于<strong>数据库的索引</strong>，综合效率较高。</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/day04-10.png" alt="Btree "></p><p>:::tip Btree 演变</p><p><strong>b-树</strong> 上层节点保存的下层节点的最小值。</p><p><strong>b+树</strong> （ 对范围查询优化） 有可能在相邻的叶子节点 ，查询完第一个叶子节点直接查询相邻的叶子节点避免了重新遍历根节点省去IO资源。</p><p><strong>b*树</strong> 在普通b数上增加了 叶子节点和支节点的双向指针机制，进一步对范围查询优化如： <code>like</code>  <code>&gt;</code> <code>&lt;</code> 等语句。</p><p>目前版本数据库使用<strong>b*树</strong> </p><p>:::</p><h2 id="4-Btree索引功能上的分类"><a href="#4-Btree索引功能上的分类" class="headerlink" title="4. Btree索引功能上的分类"></a>4. Btree索引功能上的分类</h2><br><br><br><h3 id="4-1辅助索引-（二级索引）"><a href="#4-1辅助索引-（二级索引）" class="headerlink" title="4.1辅助索引 （二级索引）"></a>4.1辅助索引 （二级索引）</h3><br><p>(1) 提取索引列的所有值,进行排序</p><p>(2) 将排好序的值,均匀的存放在叶子节点,  进一步生成枝节点和根节点</p><p>(3) 在叶子节点中的值,都会对应存储主键ID</p><br><br><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/day04-11.png" alt="day04-11.png"></p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/day04-12.png" alt="day04-12.png"><br><br></p><br><p>这时如果书的页码不按顺序写页码是乱的，辅助索引会也会性能降低。</p><br><h3 id="4-2-聚集索引"><a href="#4-2-聚集索引" class="headerlink" title="4.2 聚集索引"></a>4.2 聚集索引</h3><br><p>(1) MySQL 会自动选择主键作为聚集索引列,没有主键会选择唯一键,如果都没有会生成隐藏的.主键</p><p>(2) MySQL进行存储数据时,会按照聚集索引列值得顺序,有序存储数据行</p><p>(3) 聚集索引直接将原表数据页,作为叶子节点,然后提取聚集索引列向上生成枝和根</p><br><p>:::tip 聚集索引</p><p><strong>聚集索引一般是主键列</strong> ，创建表的时候创建主键。比如写书时就已经框定了页码 、章节的书写顺序规则，这样有顺序找页码的时候就更加好找。</p><p>在用户输入数据时，按照<strong>主键的顺序</strong>在磁盘上规划和存储数据行。</p><p><strong>聚集索引是自动维护的，数据在写入的时候就已经有序了</strong></p><p><strong>聚集索引</strong> 直接将整行数据按照顺序存储到了叶子节点当中，上层节点依旧取下层节点的最小值。</p><p>:::</p><h3 id="4-3-聚集索引和辅助索引共同使用"><a href="#4-3-聚集索引和辅助索引共同使用" class="headerlink" title="4.3 聚集索引和辅助索引共同使用"></a>4.3 聚集索引和辅助索引共同使用</h3><br><p>:::tip 例如：查询一个 name列 张三 的流程：</p><p>1.管理员设置 name 列为索引</p><p>2.数据库自动将系列值取出来</p><p>3.将排好序的值,均匀的存放在叶子节点</p><p>4.进一步生成枝节点和根节点</p><p>5.在叶子节点中的值,都会对应存储主键ID</p><p>6.MySQL 会自动选择主键作为聚集索引列,没有主键会选择唯一键,如果都没有会生成隐藏的主键</p><p>7.聚集索引直接将原表数据页,作为叶子节点,然后提取聚集索引列向上生成枝和根</p><p>8.聚集索引中遍历对应的存储主键ID</p><p>9.找到包含张三的数据行输出</p><p>:::</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/day04-13.png" alt="day04-13.png"></p><h3 id="4-4-聚集索引和辅助索引的区别"><a href="#4-4-聚集索引和辅助索引的区别" class="headerlink" title="4.4 聚集索引和辅助索引的区别"></a><strong>4.4</strong> <strong>聚集索引和辅助索引的区别</strong></h3><br><p><strong>辅助索引是自己创建的</strong> <strong>where name</strong>  有序值、ID的主键值</p><p><strong>聚集索引是自动生成的</strong>  <strong>where id</strong> ID</p><br><ul><li><p> 表中任何一个列都可以创建辅助索引,在你有需要的时候可以有多个辅助索引,只要名字不同即可</p></li><li><p> 在一张表中,聚集索引只能有一个,一般是主键</p></li><li><p>辅助索引,叶子节点只存储索引列的有序值+聚集索（ID的主键值）引列值</p></li><li><p>聚集索引,叶子节点存储的是有序的整行数据.</p></li><li><p>MySQL 的表数据存储是聚集索引组织表</p></li></ul><h2 id="5-辅助索引细分"><a href="#5-辅助索引细分" class="headerlink" title="5. 辅助索引细分"></a><strong>5.</strong> <strong>辅助索引细分</strong></h2><br><p>单列辅助索引 随便选一列</p><p>联合索引(覆盖索引) </p><p>唯一索引 索引列的值都是唯一的</p><br><h2 id="6-索引树高度"><a href="#6-索引树高度" class="headerlink" title="6. 索引树高度"></a><strong>6.</strong> <strong>索引树高度</strong></h2><br><p>索引树高度应当越低越好,一般维持在3-4最佳</p><p>:::tip 影响索引树高度的因素：</p><p>数据行数较多： 解决方法 分表 : parttion 用的比较少了（分片,分布式架构）</p><p>字段长度：解决方法 业务允许,尽量选择字符长度短的列作为索引列；业务不允许,采用前缀索引</p><p>数据类型： <code>char</code> 和 <code>varchar</code>  <code>char</code>比<code>varchar</code> 叶子节点消耗大，使用enum  作为索引列 （类似 12345） 索引树更简洁扫描起来更高效。</p><p>:::</p><p>​         </p><h2 id="7-索引的命令操作"><a href="#7-索引的命令操作" class="headerlink" title="7. 索引的命令操作"></a><strong>7.</strong> <strong>索引的命令操作</strong></h2> <br><h3 id="7-1-查询索引"><a href="#7-1-查询索引" class="headerlink" title="7.1 查询索引"></a>7.1 查询索引</h3> <br><p>PRI  主键索引 聚集索引 </p><p>MUL   辅助索引</p><p>UNI  唯一索引</p><br><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/day04-14.png" alt="day04-14.png"><br><br></p><p>查看索引信息：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">show</span> index <span class="hljs-keyword">from</span> city\G <br></code></pre></td></tr></table></figure><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/day04-15.png" alt="day04-15.png"></p><br><h3 id="7-2-创建索引"><a href="#7-2-创建索引" class="headerlink" title="7.2 创建索引"></a><strong>7.2 创建索引</strong></h3><br><p><strong>单列的辅助索引:</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> city <span class="hljs-keyword">add</span> index idx_name(name);  <span class="hljs-comment">--（DDL操作 锁表）</span><br></code></pre></td></tr></table></figure><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/day04-16.png" alt="day04-16.png"><br><br></p><p><strong>多列的联合索引:</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> city <span class="hljs-keyword">add</span> index idx_c_p(countrycode,population);<br></code></pre></td></tr></table></figure><br><p><strong>唯一索引:</strong> </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> city <span class="hljs-keyword">add</span> <span class="hljs-keyword">unique</span> index uidx_dis(district);<br></code></pre></td></tr></table></figure><br><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/day04-17.png" alt="day04-17.png"><br>:::  danger 有重复报错<br>唯一索引数据行中不能有重复<br>:::</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql">去除重复<br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> <span class="hljs-built_in">count</span>(district) <span class="hljs-keyword">from</span> city;<br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> <span class="hljs-built_in">count</span>(<span class="hljs-keyword">distinct</span> district) <span class="hljs-keyword">from</span> city;<br></code></pre></td></tr></table></figure><br><p><strong>前缀索引</strong>：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql">只能建在 字符串列<br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> city <span class="hljs-keyword">add</span> index idx_dis(district(<span class="hljs-number">5</span>)); <span class="hljs-comment">--只取前五个字符</span><br></code></pre></td></tr></table></figure><br><h3 id="7-3-删除索引"><a href="#7-3-删除索引" class="headerlink" title="7.3 删除索引"></a>7.3 删除索引</h3><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">show</span> index <span class="hljs-keyword">from</span> city<br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> city <span class="hljs-keyword">drop</span> index idx_name;<br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> city <span class="hljs-keyword">drop</span> index idx_c_p;<br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> city <span class="hljs-keyword">drop</span> index idx_dis;<br></code></pre></td></tr></table></figure><br><h2 id="8-索引压力测试-（对比索引前后效果）"><a href="#8-索引压力测试-（对比索引前后效果）" class="headerlink" title="8. 索引压力测试 （对比索引前后效果）"></a><strong>8.</strong> 索引压力测试 （对比索引前后效果）</h2><br><p>压力测试准备：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> use test <span class="hljs-comment">--导入数据</span><br><br>mysql<span class="hljs-operator">&gt;</span> source <span class="hljs-operator">/</span>tmp<span class="hljs-operator">/</span>t100w.sql<br><br><span class="hljs-keyword">select</span> count（<span class="hljs-operator">*</span>） <span class="hljs-keyword">from</span> t100w； <span class="hljs-comment">--查询数据行数量</span><br><br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> t100w limit <span class="hljs-number">10</span>；<span class="hljs-comment">--查询前10行数据</span><br></code></pre></td></tr></table></figure><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/day04-18.png" alt="day04-18.png"></p><br><br><h3 id="8-1-未做优化之前测试"><a href="#8-1-未做优化之前测试" class="headerlink" title="8.1 未做优化之前测试"></a>8.1 未做优化之前测试</h3><br><p>模拟<strong>100个用户</strong>进行了<strong>2000次查询</strong></p><p>选k2列中的一个数据进行查询。</p><p><strong>测试命令</strong>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">mysqlslap --defaults-file=/etc/my.cnf \<br>--concurrency=100 --iterations=1 --create-schema=<span class="hljs-string">&#x27;test&#x27;</span> \<br>--query=<span class="hljs-string">&quot;select * from test.t100w where k2=&#x27;MN89&#x27;&quot;</span> engine=innodb \<br>--number-of-queries=2000 -uroot -p123 -verbose<br></code></pre></td></tr></table></figure><br><br><p><strong>未设置索引测试结果：755.861 秒</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@db01 ~]<span class="hljs-comment"># mysqlslap --defaults-file=/etc/my.cnf \</span><br>&gt; --concurrency=100 --iterations=1 --create-schema=<span class="hljs-string">&#x27;test&#x27;</span> \<br>&gt; --query=<span class="hljs-string">&quot;select * from test.t100w where k2=&#x27;MN89&#x27;&quot;</span> engine=innodb \<br>&gt; --number-of-queries=2000 -uroot -p123 -verbose<br>mysqlslap: [Warning] Using a password on the <span class="hljs-built_in">command</span> line interface can be insecure.<br>Benchmark<br>Running <span class="hljs-keyword">for</span> engine rbose<br>Average number of seconds to run all queries: 755.861 seconds<br>Minimum number of seconds to run all queries: 755.861 seconds<br>Maximum number of seconds to run all queries: 755.861 seconds<br>Number of clients running queries: 100<br>Average number of queries per client: 20<br></code></pre></td></tr></table></figure><h3 id="8-2索引优化后"><a href="#8-2索引优化后" class="headerlink" title="8.2索引优化后"></a>8.2索引优化后</h3><br><p><strong>创建辅助索引</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> t100w <span class="hljs-keyword">add</span> index idx_k2(k2)<br></code></pre></td></tr></table></figure><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/day04-19.png" alt="day04-19.png"></p><br><br><p><strong>未设置索引测试结果：1.678 秒</strong>  相差700倍</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@db01 ~]<span class="hljs-comment"># mysqlslap --defaults-file=/etc/my.cnf \</span><br>&gt; --concurrency=100 --iterations=1 --create-schema=<span class="hljs-string">&#x27;test&#x27;</span> \<br>&gt; --query=<span class="hljs-string">&quot;select * from test.t100w where k2=&#x27;MN89&#x27;&quot;</span> engine=innodb \<br>&gt; --number-of-queries=2000 -uroot -p123 -verbose<br>mysqlslap: [Warning] Using a password on the <span class="hljs-built_in">command</span> line interface can be insecure.<br>Benchmark<br>Running <span class="hljs-keyword">for</span> engine rbose<br>Average number of seconds to run all queries: 1.678 seconds<br>Minimum number of seconds to run all queries: 1.678 seconds<br>Maximum number of seconds to run all queries: 1.678 seconds<br>Number of clients running queries: 100<br>Average number of queries per client: 20<br></code></pre></td></tr></table></figure><br><h2 id="9-执行计划分析"><a href="#9-执行计划分析" class="headerlink" title="9. 执行计划分析"></a><strong>9.</strong> <strong>执行计划分析</strong></h2><br><h3 id="9-1-执行计划的作用"><a href="#9-1-执行计划的作用" class="headerlink" title="9.1 执行计划的作用"></a><strong>9.1</strong> <strong>执行计划的作用</strong></h3><br><p>将优化器 选择后的执行计划 截取出来.便于管理管理员判断语句得执行效率。</p><br><h3 id="9-2-获取执行"><a href="#9-2-获取执行" class="headerlink" title="9.2 获取执行"></a><strong>9.2</strong> <strong>获取执行</strong></h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">desc</span>  <span class="hljs-comment">--SQL语句</span><br>explain <span class="hljs-comment">--SQL 语句</span><br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">desc</span> <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> test.t100w <span class="hljs-keyword">where</span> k2<span class="hljs-operator">=</span><span class="hljs-string">&#x27;MN89&#x27;</span>; <span class="hljs-comment">--获取语句的计划</span><br></code></pre></td></tr></table></figure><p>获取语句的计划：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">desc</span> <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> test.t100w <span class="hljs-keyword">where</span> k2<span class="hljs-operator">=</span><span class="hljs-string">&#x27;MN89&#x27;</span>; <span class="hljs-comment">--获取语句的计划</span><br><span class="hljs-operator">+</span><span class="hljs-comment">----+-------------+-------+------------+------+---------------+------+---------+------+---------+----------+-------------+</span><br><span class="hljs-operator">|</span> id <span class="hljs-operator">|</span> select_type <span class="hljs-operator">|</span> <span class="hljs-keyword">table</span> <span class="hljs-operator">|</span> partitions <span class="hljs-operator">|</span> type <span class="hljs-operator">|</span> possible_keys <span class="hljs-operator">|</span> key <span class="hljs-operator">|</span> key_len <span class="hljs-operator">|</span> <span class="hljs-keyword">ref</span> <span class="hljs-operator">|</span> <span class="hljs-keyword">rows</span>  <span class="hljs-operator">|</span> filtered <span class="hljs-operator">|</span> Extra    <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">----+-------------+-------+------------+------+---------------+------+---------+------+---------+----------+-------------+</span><br><span class="hljs-operator">|</span> <span class="hljs-number">1</span> <span class="hljs-operator">|</span> SIMPLE   <span class="hljs-operator">|</span> t100w <span class="hljs-operator">|</span> <span class="hljs-keyword">NULL</span>    <span class="hljs-operator">|</span> <span class="hljs-keyword">ALL</span> <span class="hljs-operator">|</span> <span class="hljs-keyword">NULL</span>     <span class="hljs-operator">|</span> <span class="hljs-keyword">NULL</span> <span class="hljs-operator">|</span> <span class="hljs-keyword">NULL</span>  <span class="hljs-operator">|</span> <span class="hljs-keyword">NULL</span> <span class="hljs-operator">|</span> <span class="hljs-number">1027638</span> <span class="hljs-operator">|</span>  <span class="hljs-number">10.00</span> <span class="hljs-operator">|</span> <span class="hljs-keyword">Using</span> <span class="hljs-keyword">where</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">----+-------------+-------+------------+------+---------------+------+---------+------+---------+----------+-------------+</span><br></code></pre></td></tr></table></figure><br><h3 id="9-3-分析执行计划"><a href="#9-3-分析执行计划" class="headerlink" title="9.3 分析执行计划"></a><strong>9.3</strong> <strong>分析执行计划</strong></h3><h4 id="9-3-1-table-列"><a href="#9-3-1-table-列" class="headerlink" title="9.3.1 table 列"></a><strong>9.3.1 table</strong> 列</h4><p>table 表名  </p><h4 id="9-3-2-type列"><a href="#9-3-2-type列" class="headerlink" title="9.3.2 type列"></a><strong>9.3.2 type</strong>列</h4><p>查询的类型:</p><p>全表扫描  : ALL<br>索引扫描 级别 : index,range,ref,eq_ref,const(system),NULL  <strong>从左到右性能越好</strong>。</p> <br><br><p><strong>索引扫描级别分类说明：</strong></p><p><strong>index:</strong> <strong>全索引扫描</strong> ，需要遍历整个索引树才能获取到数据 ,<strong>性能比全表扫描ALL好</strong>。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">desc</span> <span class="hljs-keyword">select</span> countrycode <span class="hljs-keyword">from</span> city;<br></code></pre></td></tr></table></figure><br><br><p><strong>range:</strong> <strong>索引范围扫描</strong>  <code>&gt; &lt; &gt;= &lt;= , between and ,or,in,like</code>  （<strong>范围查询</strong>）</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">desc</span> <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> city <span class="hljs-keyword">where</span> id<span class="hljs-operator">&gt;</span><span class="hljs-number">2000</span>;<br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">desc</span> <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> city <span class="hljs-keyword">where</span> countrycode <span class="hljs-keyword">like</span> <span class="hljs-string">&#x27;CH%&#x27;</span>;<br></code></pre></td></tr></table></figure><br><p><strong>B树 对连续数据查询有优化，可以享受到B树 叶子节点双向指针的优化 。</strong> </p><p>所以 <code>or in range</code>性能 比 <code>&gt; &lt; &gt;= &lt;= , between and like </code>要低</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">desc</span> <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> city <span class="hljs-keyword">where</span> countrycode<span class="hljs-operator">=</span><span class="hljs-string">&#x27;CHN&#x27;</span> <span class="hljs-keyword">or</span> countrycode<span class="hljs-operator">=</span><span class="hljs-string">&#x27;USA&#x27;</span>;<br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">desc</span> <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> city <span class="hljs-keyword">where</span> countrycode <span class="hljs-keyword">in</span> (<span class="hljs-string">&#x27;CHN&#x27;</span>,<span class="hljs-string">&#x27;USA&#x27;</span>);<br></code></pre></td></tr></table></figure><br><p><strong>对于辅助索引来讲,<code>!=</code>（不等于） 和<code>not in</code>等语句是不走索引的</strong></p><p><strong>对于主键索引列来讲,<code>!=</code> 和<code>not in</code>等语句是走 range索引</strong></p><p><strong><code>in or</code> 一般改写为 <code>union all</code>  进行语句优化：</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">desc</span> <span class="hljs-keyword">select</span>  <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> city <span class="hljs-keyword">where</span> countrycode<span class="hljs-operator">=</span><span class="hljs-string">&#x27;CHN&#x27;</span> <span class="hljs-keyword">or</span> countrycode<span class="hljs-operator">=</span><span class="hljs-string">&#x27;USA&#x27;</span>;<span class="hljs-comment">--改写为：</span><br><span class="hljs-keyword">desc</span> <br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> city <span class="hljs-keyword">where</span> countrycode<span class="hljs-operator">=</span><span class="hljs-string">&#x27;CHN&#x27;</span> <br><span class="hljs-keyword">union</span> <span class="hljs-keyword">all</span> <br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> city <span class="hljs-keyword">where</span> countrycode<span class="hljs-operator">=</span><span class="hljs-string">&#x27;USA&#x27;</span>;<br></code></pre></td></tr></table></figure><br><br><p><strong>ref: 辅助索引等值查询</strong></p><p><code>in or</code>  改写后的  <code>union all</code>  语句 变成了等值查询 ref 。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">desc</span> <br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> city <span class="hljs-keyword">where</span> countrycode<span class="hljs-operator">=</span><span class="hljs-string">&#x27;CHN&#x27;</span> <br><span class="hljs-keyword">union</span> <span class="hljs-keyword">all</span> <br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> city <span class="hljs-keyword">where</span> countrycode<span class="hljs-operator">=</span><span class="hljs-string">&#x27;USA&#x27;</span>;<br></code></pre></td></tr></table></figure><br><br><p><strong>eq_ref : 多表连接时,子表使用主键列或唯一列作为连接条件</strong></p><p>A join B   时 <strong>B就是子表</strong></p><p>on a.x = B.y   <strong>B.y 列是主键或唯一键时 走eq_ref</strong></p><p>::: tip 优化多表连接要求</p><p>在优化多表连接查询时，第一保证驱动表（左边）的数据量级是最小的因为它不能走索引，它是全表数据和别的表进行对比第二张表开始可以走索引。</p><p>建议被连接的表它的连接列<code>on</code> 的条件<code>B.y</code>最好是主键或唯一键，实在不行是辅助索引。</p><p>在表的设计阶段就应该设计好的。</p><p>:::</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">desc</span> <span class="hljs-keyword">select</span> b.name,a.name ,a.population <br><span class="hljs-keyword">from</span> city <span class="hljs-keyword">as</span> a <br><span class="hljs-keyword">join</span> country <span class="hljs-keyword">as</span> b <br><span class="hljs-keyword">on</span> a.countrycode<span class="hljs-operator">=</span>b.code <br><span class="hljs-keyword">where</span> a.population<span class="hljs-operator">&lt;</span><span class="hljs-number">100</span>;<br></code></pre></td></tr></table></figure><p><br>city 是条件列</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/day04-20.png" alt="day04-20.png"></p><br><br><p><strong>const(system) : 主键或者唯一键的等值查询</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">desc</span> <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> city <span class="hljs-keyword">where</span> id<span class="hljs-operator">=</span><span class="hljs-number">100</span>;<br></code></pre></td></tr></table></figure><br><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/day04-21.png" alt="day04-21.png"></p><br><p><strong>NULL 性能最高因为没有这个数据行查不到。</strong></p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/day04-22.png" alt="day04-22.png"></p>]]></content>
    
    
    <categories>
      
      <category>DBA</category>
      
    </categories>
    
    
    <tags>
      
      <tag>DBA</tag>
      
      <tag>RDBMS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>第三章回顾 补充元数据查询部分</title>
    <link href="/2020/07/15/dba04/"/>
    <url>/2020/07/15/dba04/</url>
    
    <content type="html"><![CDATA[<h1 id="第三章回顾-补充元数据查询部分"><a href="#第三章回顾-补充元数据查询部分" class="headerlink" title="第三章回顾 补充元数据查询部分"></a>第三章回顾 补充元数据查询部分</h1><p>[[toc]]</p><h2 id="1-上节回顾"><a href="#1-上节回顾" class="headerlink" title="1.上节回顾"></a>1.上节回顾</h2><h3 id="1-1-group-by-name-分组-排序-对比-去重"><a href="#1-1-group-by-name-分组-排序-对比-去重" class="headerlink" title="1.1 group by name  分组   排序 对比 去重"></a>1.1 group by name  分组   排序 对比 去重</h3><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/day04-1.png" alt="day04-1.png"></p><h3 id="1-2-关于group-by-的sql-mode"><a href="#1-2-关于group-by-的sql-mode" class="headerlink" title="1.2 关于group by 的sql_mode"></a>1.2 关于group by 的sql_mode</h3><p>:::tip 说明</p><p><code>only_full_group_by </code> 参数</p><ul><li>在5.7版本中MySQL sql_mode参数中自带，5.6和8.0都没有</li><li>在带有group by 字句的select中，select 后的条件列（非主键列），</li><li>要么是group by后的列，要么需要在函数中包裹</li></ul><p>:::</p><p><strong>关掉限制：</strong> 编辑配置文件时去掉 <code>ONLY_FULL_GROUP_BY</code></p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/day04-2.png" alt="day04-2.png"></p><h3 id="1-3-group-concat-多列-转为一行"><a href="#1-3-group-concat-多列-转为一行" class="headerlink" title="1.3 group_concat 多列 转为一行"></a>1.3 group_concat 多列 转为一行</h3><br><p><strong>列转行聚合函数</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plsql">mysql&gt; select user,group_concat(host) from mysql.user group by user;<br></code></pre></td></tr></table></figure><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/day04-3.png" alt="day04-3.png"></p><br><h3 id="1-4-concat-拼接语句-列值拼接"><a href="#1-4-concat-拼接语句-列值拼接" class="headerlink" title="1.4 concat  拼接语句 列值拼接"></a><strong>1.4 concat</strong>  <strong>拼接语句</strong> 列值拼接</h3><br><p><strong>做列值拼接</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> concat(<span class="hljs-keyword">user</span>,&quot;@&quot;,host) <span class="hljs-keyword">from</span> mysql.user;<br></code></pre></td></tr></table></figure><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/day04-4.png" alt="day04-4.png"></p><h3 id="1-5-关于多表连接语法规则"><a href="#1-5-关于多表连接语法规则" class="headerlink" title="1.5 关于多表连接语法规则"></a><strong>1.5</strong> 关于多表连接语法规则</h3><p>:::tip 多表连接语法规则</p><ul><li><p>1.首先找涉及到的所有表</p></li><li><p>2.找到表和表之间的关联列</p></li><li><p>3.关联条件写在 <code>on</code> 后面 <code>A join B on</code> 关联列</p></li><li><p>4.所有需要查询的信息放在select后 </p></li><li><p>5.其他的过滤条件 <code>where group by having order by limit</code> 往最后放</p></li><li><p>注意：对多表连接中，驱动表选择数据行少的表。后续所有表的关联列尽量是主键或唯一键（表设计），至少建立一个索引。</p></li></ul><p> :::</p><p>:::warning 注意 ❗</p><p>数据行较少的放在左边（驱动表） 因为他要拿整表的数据和右边的表进行关联</p><p>:::</p><h3 id="1-6-创建别名"><a href="#1-6-创建别名" class="headerlink" title="1.6 创建别名"></a><strong>1.6</strong> 创建别名</h3><p><strong>表别名</strong></p><p><strong>列别名</strong></p><p>count</p><p>oldguo  linux  a,b,c,d </p><p>oldguo  python x，y,z </p><p>oldboy  linux  10 </p><p>hsw   python 11</p><h3 id="1-7-distinct-去重复"><a href="#1-7-distinct-去重复" class="headerlink" title="1.7 distinct 去重复"></a><strong>1.7 distinct</strong> <strong>去重复</strong></h3><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> <span class="hljs-built_in">count</span>(<span class="hljs-keyword">distinct</span> countrycode) <span class="hljs-keyword">from</span> city; <br><span class="hljs-operator">/</span><span class="hljs-operator">/</span>在城市表中 查看所有国家代号 去重复<br></code></pre></td></tr></table></figure><br><br><h3 id="1-8-select-执行顺序"><a href="#1-8-select-执行顺序" class="headerlink" title="1.8 select 执行顺序"></a><strong>1.8 select</strong> <strong>执行顺序</strong></h3><br><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span> ,<span class="hljs-built_in">count</span>(name) <span class="hljs-keyword">from</span> 表  <span class="hljs-keyword">where</span> 列  <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">having</span> 列  <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> 列 ;<br></code></pre></td></tr></table></figure><p>:::tip 查询语句执行顺序</p><p>没有索引的情况下会把整表数据加载到内存中，进行过滤过滤后在内存中只留下满足条件的数据。 针对满足条件的数据进行分组 （group by ），在根据select 的条件列取列产生新的结果集，having会对结果集再进行一次过滤。order by 对列数据进行比较大小排列顺序 最后显示。</p><p>:::</p><br><h2 id="2-扩展类内容-元数据获取"><a href="#2-扩展类内容-元数据获取" class="headerlink" title="2. 扩展类内容 元数据获取"></a><strong>2.</strong> 扩展类内容 元数据获取</h2><br><h3 id="2-1-元数据介绍及获取介绍"><a href="#2-1-元数据介绍及获取介绍" class="headerlink" title="2.1 元数据介绍及获取介绍"></a><strong>2.1</strong> <strong>元数据介绍及获取介绍</strong></h3><br><p>::: tip 元数据</p><p>元数据是存储在”基表”中。</p><p>通过专用的DDL语句，DCL语句进行修改</p><p>通过专用视图和命令进行元数据的查询</p><p><code>information_schema</code>中保存了大量元数据查询的试图</p><p><code>show</code>  命令是封装好功能，提供元数据查询基础功能</p><p>:::</p><br><p><strong>创建视图：</strong></p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/day04-5.png" alt="day04-5.png"></p><br><br><p><strong>查询视图：</strong></p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/day04-6.png" alt="day04-6.png"></p><p><strong>2.1 information_schema 的基本应用</strong></p><p><strong>tables 视图的应用:</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> use information_schema;<br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">desc</span> tables;<br></code></pre></td></tr></table></figure><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/day04-7.png" alt="day04-7.png"></p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/day04-8.png" alt="day04-8.png"></p><br><p><strong>TABLES 和表有关的元数据</strong></p><br><table><thead><tr><th><img width=100/>TABLE_SCHEMA<img width=100/></th><th align="center"><img width=100/>表所在的库名<img width=100/></th></tr></thead><tbody><tr><td>TABLE_NAME</td><td align="center">表名</td></tr><tr><td>ENGINE</td><td align="center">存储引擎</td></tr><tr><td>TABLE_ROWS</td><td align="center">数据行</td></tr><tr><td>AVG_ROW_LENGTH</td><td align="center">平均行长度</td></tr><tr><td>INDEX_LENGTH</td><td align="center">索引长度</td></tr></tbody></table><p><strong>举例说明：</strong></p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs abnf">USE information_schema<span class="hljs-comment">; </span><br>DESC TABLES<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure><ul><li><strong>显示所有的库和表的信息</strong></li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> table_schema,table_name <span class="hljs-keyword">FROM</span> information_schema.tables;<br></code></pre></td></tr></table></figure><ul><li><strong>显示所有的库和表的信息（结果集多行转成一行）</strong>  </li></ul><p>world 库下  <code>city,country,country,language</code></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> table_schema,GROUP_CONCAT(table_name) <br><span class="hljs-keyword">FROM</span> information_schema.tables<br><span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> table_schema;<br></code></pre></td></tr></table></figure><ul><li>查询所有<strong>innodb</strong>引擎的表</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> table_schema,table_name ,ENGINE<br><span class="hljs-keyword">FROM</span> information_schema.tables <br><span class="hljs-keyword">WHERE</span> ENGINE<span class="hljs-operator">=</span><span class="hljs-string">&#x27;innodb&#x27;</span>;<br></code></pre></td></tr></table></figure><ul><li><strong>统计world下的city表占用空间大小</strong></li></ul><p>$$<br>公式：表的数据量=平均行长度*行数+索引长度<br>$$</p><p> <code>AVG_ROW_LENGTH*TABLE_ROWS+INDEX_LENGTH</code>  统计整个city 表的真实数据量大小</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> table_name,(AVG_ROW_LENGTH<span class="hljs-operator">*</span>TABLE_ROWS<span class="hljs-operator">+</span>INDEX_LENGTH)<span class="hljs-operator">/</span><span class="hljs-number">1024</span> <span class="hljs-operator">/</span><span class="hljs-operator">/</span>kb显示<br><span class="hljs-keyword">FROM</span> information_schema.TABLES<br><span class="hljs-keyword">WHERE</span> table_schema<span class="hljs-operator">=</span><span class="hljs-string">&#x27;world&#x27;</span> <span class="hljs-keyword">AND</span> table_name<span class="hljs-operator">=</span><span class="hljs-string">&#x27;city&#x27;</span>;<br></code></pre></td></tr></table></figure><p><strong>统计每个库的数据量大小，并按数据量从大到小排序</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> table_schema,<span class="hljs-built_in">SUM</span>((AVG_ROW_LENGTH<span class="hljs-operator">*</span>TABLE_ROWS<span class="hljs-operator">+</span>INDEX_LENGTH))<span class="hljs-operator">/</span><span class="hljs-number">1024</span> <span class="hljs-keyword">AS</span> total_KB    ( 库中有多个表 所以需要加一起 使用 SUM 函数)<br><span class="hljs-keyword">FROM</span> information_schema.TABLES<br><span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> table_schema 库名排队<br><span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> <span class="hljs-keyword">AS</span> total_KB <span class="hljs-keyword">DESC</span> ; 排序<br></code></pre></td></tr></table></figure><h3 id="2-2-配合concat-函数拼接语句或命令"><a href="#2-2-配合concat-函数拼接语句或命令" class="headerlink" title="2.2. 配合concat( )函数拼接语句或命令"></a><strong>2.2.</strong> <strong>配合concat( )函数拼接语句或命令</strong></h3><p><strong>举例说明：</strong></p><ul><li>模仿以下语句,进行数据库的分库分表备份。</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysqldump <span class="hljs-operator">-</span>uroot <span class="hljs-operator">-</span>p123 world city <span class="hljs-operator">&gt;</span><span class="hljs-operator">/</span>bak<span class="hljs-operator">/</span>world_city.sql  <span class="hljs-operator">/</span><span class="hljs-operator">/</span>分库分表备份<br></code></pre></td></tr></table></figure><p><strong>拼接语句：</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span><br>CONCAT(&quot;mysqldump -uroot -p123 &quot;,table_schema,&quot; &quot;,table_name<br>,&quot; &gt;/bak/&quot;,table_schema,&quot;_&quot;,table_name,&quot;.sql&quot;)<br><span class="hljs-keyword">FROM</span> information_schema.tables;<br></code></pre></td></tr></table></figure><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/day04-9.png" alt="day04-9.png"></p><ul><li><strong>模仿以下语句,进行批量生成对world库下所有表进行操作</strong></li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> world.city DISCARD TABLESPACE;<br></code></pre></td></tr></table></figure><p><strong>拼接语句：</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <br>CONCAT(&quot;ALTER TABLE &quot;,table_schema,&quot;.&quot;,table_name,&quot; DISCARD TABLESPACE;&quot;)<br><span class="hljs-keyword">FROM</span> information_schema.tables<br><span class="hljs-keyword">WHERE</span> table_schema<span class="hljs-operator">=</span><span class="hljs-string">&#x27;world&#x27;</span>;<br></code></pre></td></tr></table></figure><h3 id="2-3-show-常用命令介绍"><a href="#2-3-show-常用命令介绍" class="headerlink" title="2.3 show 常用命令介绍"></a><strong>2.3 show 常用命令介绍</strong></h3><table><thead><tr><th align="left"><img width=136/>主要命令<img width=136/></th><th><img width=136/>作用说明<img width=136/></th></tr></thead><tbody><tr><td align="left">show databases;</td><td>查看数据库名</td></tr><tr><td align="left">show tables;</td><td>查看表名</td></tr><tr><td align="left">show create database xx;</td><td>查看建库语句</td></tr><tr><td align="left">show create table xx;</td><td>查看建表语句</td></tr><tr><td align="left">show processlist;</td><td>查看所有用户连接情况</td></tr><tr><td align="left">show charset;</td><td>查看支持的字符集</td></tr><tr><td align="left">show collation;</td><td>查看所有支持的校对规则</td></tr><tr><td align="left">show grants for xx;</td><td>查看用户的权限信息</td></tr><tr><td align="left">show variables like ‘%xx%’</td><td>查看参数信息</td></tr><tr><td align="left">show engines;</td><td>查看所有支持的存储引擎类型</td></tr><tr><td align="left">show index from xxx</td><td>查看表的索引信息</td></tr><tr><td align="left">show engine innodb status\G</td><td>查看innoDB引擎详细状态信息</td></tr><tr><td align="left">show binary logs</td><td>查看二进制日志的列表信息</td></tr><tr><td align="left">show binlog events in ‘二进制文件名’</td><td>查看二进制日志的事件信息</td></tr><tr><td align="left">show master status ;</td><td>查看mysql当前使用二进制日志信息</td></tr><tr><td align="left">show slave status\G</td><td>查看从库状态信息</td></tr><tr><td align="left">show status like ‘’</td><td>查看数据库整体状态信息</td></tr><tr><td align="left">help show ;</td><td>查看更多</td></tr><tr><td align="left">show relaylog events in ‘’</td><td>查看中继日志的事件信息</td></tr></tbody></table>]]></content>
    
    
    <categories>
      
      <category>DBA</category>
      
    </categories>
    
    
    <tags>
      
      <tag>DBA</tag>
      
      <tag>RDBMS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>存储引擎介绍与企业案例</title>
    <link href="/2020/07/15/dba05/"/>
    <url>/2020/07/15/dba05/</url>
    
    <content type="html"><![CDATA[<h1 id="存储引擎介绍与企业案例"><a href="#存储引擎介绍与企业案例" class="headerlink" title="存储引擎介绍与企业案例"></a>存储引擎介绍与企业案例</h1><p>[[toc]]</p><h2 id="1-前情回顾案例补充"><a href="#1-前情回顾案例补充" class="headerlink" title="1. 前情回顾案例补充"></a>1. 前情回顾案例补充</h2><p><strong>explain (desc) 使用场景</strong></p><p>相关问题：</p><ul><li><p>你做过哪些优化?</p></li><li><p>你用过什么优化工具? <strong>explain</strong></p></li><li><p>你对索引这块怎么优化的?</p><br></li></ul><p><strong>题目意思: 我们公司业务慢,请你从数据库的角度分析原因</strong></p><ul><li><strong>mysql出现性能问题,有两种情况:</strong></li></ul><br><p>第一种情况：应急性的慢：突然夯住  <strong>突然慢</strong></p><p>应急情况:数据库卡了,资源耗尽</p><p><strong>处理过程:</strong></p><ol><li><p><code>show processlist;</code> （把当前会话所做的操作列出来） 获取到导致数据库卡住的语句</p></li><li><p>使用 <code>explain</code> 分析SQL的执行计划,可能有没有走索引的,索引的类型情况。</p></li><li><p>建索引,改语句</p></li></ol><p>第二种情况：一段时间慢(持续性的):<strong>每天都慢</strong> 9-11点</p><p> <strong>处理过程:</strong></p><ol><li>记录慢日志 <code>slowlog</code>,分析<code>slowlog</code></li><li>explain 分析SQL的执行计划,有没有走索引,索引的类型情况</li><li>建索引,改语句</li></ol><br><br><h3 id="1-1-索引应用规范"><a href="#1-1-索引应用规范" class="headerlink" title="1.1 索引应用规范"></a>1.1 索引应用规范</h3><p>::: tip 建立索引的原则（DBA运维规范）</p><ul><li><p>建表必须要有主键,一般是无关列,自增长</p></li><li><p> 经常做为 <code>where</code> 条件列 <code>order by</code> <code>group by</code> <code>join on</code>, <code>distinct</code> 的条件</p></li><li><p> 最好使用唯一值多的列作为联合索引前导列,其他的按照联合索引优化细节来做</p></li><li><p>列值长度较长的索引列,我们建议使用前缀索引.</p></li><li><p>降低索引条目,一方面不要创建没用索引,不常使用的索引清理,<code>percona</code> <code>toolkit</code></p></li><li><p>索引维护要避开业务繁忙期</p></li><li><p>小表不建索引</p></li></ul><p>:::</p><br><br><p>使用 <strong>SQLyog</strong> 工具自动找出<strong>使用率不高的索引</strong></p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/dba05-1.png" alt="dba05-1.png"></p><br><br><p><br><br></p><h3 id="1-2-不走索引的情况"><a href="#1-2-不走索引的情况" class="headerlink" title="1.2 不走索引的情况"></a><strong>1.2</strong> 不走索引的情况</h3><p> ::: tip  不走索引的情况（开发规范）</p><ul><li>没有查询条件，或者查询条件没有建立索引</li></ul><p><code>select * from city;</code></p><p><code>select * from city where 1=1;</code></p><ul><li><p>查询结果集是原表中的大部分数据，应该是25％以上。</p></li><li><p>索引本身失效，统计数据不真实</p></li></ul><p><strong>面试题: 同一个语句突然变慢?</strong></p><p>可能是因为统计信息过旧,导致的索引失效。</p><ul><li> 查询条件使用函数在索引列上，或者对索引列进行运算，运算包括(<code>+，-，*，/，!</code> 等)</li></ul><p><code>mysql&gt; desc select * from city where id-99=1;</code></p><ul><li><p> 隐式转换导致索引失效.</p></li><li><p><code>! = ，not in</code> 不走索引（辅助索引）</p></li><li><p>like “%aa”` 百分号在最前面不走</p></li><li><p>联合索引</p></li></ul><p> :::</p><h2 id="2-存储引擎简介"><a href="#2-存储引擎简介" class="headerlink" title="2. 存储引擎简介"></a><strong>2. 存储引擎简介</strong></h2><br><p>相当于Linux文件系统，只不过比文件系统强大</p><br><p><strong>存储引擎功能</strong></p><ul><li>数据读写</li><li>数据安全和一致性</li><li>提高性能</li><li>热备份</li><li>自动故障恢复</li><li>高可用方面支持</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">show</span> engies; <span class="hljs-comment">--查看存储引擎支持种类</span><br>CSV        <br>MRG_MYISAM    <br>MyISAM      <br>BLACKHOLE     <br>PERFORMANCE_SCHEMA<br>MEMORY      <br>ARCHIVE      <br>InnoDB      <br>FEDERATED  <br></code></pre></td></tr></table></figure><br><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/dba05-2.png" alt="dba05-2.png"></p><br><p><strong>笔试题</strong>：<strong>例举你了解的存储引擎</strong></p><p><strong>答：InnoDB（新版本） ,MyISAM（老版本） ,MEMORY, CSV</strong></p> <br><ul><li><p><strong>Mysql 5.7 默认的存储引擎:InnoDB</strong></p></li><li><p> <strong>PerconaDB:默认是XtraDB</strong></p></li><li><p><strong>MariaDB:默认是InnoDB</strong></p></li></ul> <br><p><strong>插件式 第三方的存储引擎:</strong></p><ul><li> RocksDB </li><li>MyRocks </li><li>TokuDB</li></ul><p><strong>区别</strong>：压缩比较高,数据的插入性能高.其他功能和 InnoDB 没差。</p><br><br><h3 id="2-1-存储引擎的查看"><a href="#2-1-存储引擎的查看" class="headerlink" title="2.1 存储引擎的查看"></a>2.1 存储引擎的查看</h3><br> <p><strong>查看存储引擎设置</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"> <br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">show</span> engines; <span class="hljs-comment">--查看支持的存储引擎</span><br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">SELECT</span> @<span class="hljs-variable">@default</span>_storage_engine;<br></code></pre></td></tr></table></figure><p> <strong>修改默认存储引擎</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell"> <br>vim /etc/my.cnf   --修改配置文件<br>[mysqld]<br>default_storage_engine=InnoDB<br></code></pre></td></tr></table></figure><p><strong>查看表存储引擎状态</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql"> <br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">show</span> <span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> t1; <br> <br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">SHOW</span> <span class="hljs-keyword">TABLE</span> STATUS <span class="hljs-keyword">LIKE</span> <span class="hljs-string">&#x27;CountryLanguage&#x27;</span>\G<br> <br>mysql<span class="hljs-operator">&gt;</span><span class="hljs-keyword">select</span> table_schema,table_name ,engine <span class="hljs-keyword">from</span> information_schema.tables <span class="hljs-keyword">where</span> table_schema <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> (<span class="hljs-string">&#x27;sys&#x27;</span>,<span class="hljs-string">&#x27;mysql&#x27;</span>,<span class="hljs-string">&#x27;information_schema&#x27;</span>,<span class="hljs-string">&#x27;performance_schema&#x27;</span>);<br></code></pre></td></tr></table></figure><br><br><br><h3 id="2-2-存储引擎的修改"><a href="#2-2-存储引擎的修改" class="headerlink" title="2.2 存储引擎的修改"></a><strong>2.2 存储引擎的修改</strong></h3><br><p><strong>修改存储引擎为innodb</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"> <br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> t1<span class="hljs-operator">=</span> engine<span class="hljs-operator">=</span>innodb;<br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">show</span> <span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> t1; <br></code></pre></td></tr></table></figure><p> <br><br></p><p><strong>整理碎片</strong></p><p>在执行删除操作后原来占用的空间不会被立即释放掉会产生碎片，就需要通过命令进行碎片整理。</p><br><p><strong>有两种方法：</strong></p><ol><li><code>mysql&gt; alter table t111 engine=innodb; innodb</code> 命令 再执行一遍更改存储引擎命令 对业务影响小。</li><li>把原表导入 把表<code>drop</code>掉在重新导入回来 干净 但有风险。</li></ol> <br><h3 id="2-3-企业真实碎片处理案例"><a href="#2-3-企业真实碎片处理案例" class="headerlink" title="2.3 企业真实碎片处理案例"></a><strong>2.3 企业真实碎片处理案例</strong></h3><p><br><strong>环境:</strong> centos7.4,MySQL 5.7.20,InnoDB存储引擎</p><p><strong>业务特点</strong>：数据量级较大,经常需要按月删除历史数据.</p><p><strong>问题:</strong> 磁盘空间占用很大,不释放</p> <br><p><strong>处理方法:</strong></p><p><br><strong>以前:</strong> 将数据逻辑导出,手工 <code>truncate</code> 表,然后导入进去。</p><br><p><strong>现在:</strong></p><p>对表进行按月进行分表(<strong>partition,中间件</strong>)。</p><p>业务替换为 <strong>truncate</strong> 方式。</p><p>定期进行碎片整理。</p> <br><br><p><strong>批量替换 Zabbix 100 多张存储引擎 <code>innodb</code> 的表为 <code>tokudb</code>引擎</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"> <br><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> zabbix.a engine<span class="hljs-operator">=</span>tokudb; <span class="hljs-comment">-- 改一张表的命令</span><br><br><span class="hljs-keyword">select</span> concat(&quot;alter table &quot;,table_schema,&quot;.&quot;,table_name,&quot; engine=tokudb;&quot;) <span class="hljs-keyword">from</span> information_schema.tables <br><span class="hljs-keyword">where</span> table_schema<span class="hljs-operator">=</span><span class="hljs-string">&#x27;zabbix&#x27;</span>; <span class="hljs-comment">--使用拼接语句</span><br></code></pre></td></tr></table></figure><br><br><br><h2 id="3-企业真实案例更换存储引擎"><a href="#3-企业真实案例更换存储引擎" class="headerlink" title="3. 企业真实案例更换存储引擎"></a>3. 企业真实案例更换存储引擎</h2> <br> <br><h3 id="3-1-Zabbix-监控系统架构整改"><a href="#3-1-Zabbix-监控系统架构整改" class="headerlink" title="3.1   Zabbix  监控系统架构整改"></a>3.1   Zabbix  监控系统架构整改</h3><p><strong>环境:</strong> zabbix 3.2  mariaDB 5.5 centos 7.3</p><p><strong>现象 :</strong> zabbix卡的要死 , 每隔3-4个月,都要重新搭建一遍 zabbix,存储空间经常爆满.</p><br><p><strong>分析得出问题 :</strong></p><ul><li><p>Zabbix 版本 </p></li><li><p><strong>数据库版本</strong></p></li><li><p>Zabbix数据库500G,全部存在一个文件里</p></li></ul> <br><br><p><strong>优化建议:</strong></p><p>1.数据库版本升级到mariaDB最新版本,Zabbix升级更高版本</p><p>2.存储引擎改为 <strong>tokudb</strong></p><p>3.监控数据按月份进行切割(二次开发Zabbix 数据保留机制功能重写,数据库分表)</p><p>4.关闭binlog和双1</p><p>5.参数调整</p><br><p><strong>优化结果</strong>: 解决卡顿问题，监控状态良好</p> <br><br><p><strong>解决思路 ?</strong></p><ol><li><p>原生态支持 TokuDB,另外经过测试环境,<strong>10版本要比5.5 版本性能 高 2-3倍</strong></p></li><li><p><strong>TokuDB:insert 数据比 Innodb 快的多，数据压缩比要 Innodb 高</strong></p></li><li><p>监控数据按月份进行切割,为了能够truncate每个分区表,立即释放空间</p></li><li><p><strong>关闭 binlog  减少无关日志的记录。</strong></p></li><li><p>参数调整  安全性参数关闭,提高性能。</p></li></ol><br><br><h3 id="3-2-存储引擎的替换"><a href="#3-2-存储引擎的替换" class="headerlink" title="3.2 存储引擎的替换"></a><strong>3.2 存储引擎的替换</strong></h3><p><strong>环境:</strong> centos 5.8 ,MySQL 5.0版本,MyISAM存储引擎,网站业务(LNMP),数据量50G左右</p><p><strong>现象问题:</strong> 业务压力大的时候,非常卡;经历过宕机,会有部分数据丢失.</p><p><strong>问题分析:</strong></p><p>1.MyISAM存储引擎表级锁,在高并发时,会有很高锁等待</p><p>2.MyISAM存储引擎不支持事务,在断电时,会有可能丢失数据</p><p><strong>实际问题：</strong> </p><p>1.监控锁的情况:有很多的表锁等待</p><p>2.存储引擎查看:所有表默认是MyISAM</p><p><strong>解决方案:</strong></p><ol><li><p>升级MySQL 5.6.10版本</p></li><li><p>迁移所有表到新环境</p></li><li><p>开启双1安全参数</p></li></ol><h2 id="4-InnoDB-存储引擎核心特性说明"><a href="#4-InnoDB-存储引擎核心特性说明" class="headerlink" title="4. InnoDB 存储引擎核心特性说明"></a><strong>4. InnoDB 存储引擎核心特性说明</strong></h2><br><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/dba05-3.png" alt="dba05-3.png"></p><ol><li>支持事务</li><li>行级锁定</li><li>MVCC   并发控制</li><li>外键</li><li> ACSR自动故障恢复</li><li>热备 复制方面提供 (多线程,GTID,MTS)</li></ol>]]></content>
    
    
    <categories>
      
      <category>DBA</category>
      
    </categories>
    
    
    <tags>
      
      <tag>DBA</tag>
      
      <tag>RDBMS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>DQL 查询语句与元数据</title>
    <link href="/2020/07/14/dba03-2/"/>
    <url>/2020/07/14/dba03-2/</url>
    
    <content type="html"><![CDATA[<h1 id="DQL-查询语句与元数据"><a href="#DQL-查询语句与元数据" class="headerlink" title="DQL 查询语句与元数据"></a>DQL 查询语句与元数据</h1><p>[[toc]]</p><h2 id="1-DQL-介绍"><a href="#1-DQL-介绍" class="headerlink" title="1. DQL 介绍"></a><strong>1. DQL 介绍</strong></h2><br><p>主要对应操作：</p><ul><li><strong>select 语句</strong></li><li><strong>show 元数据属性</strong></li></ul> <br><h2 id="2-Select-语句的应用"><a href="#2-Select-语句的应用" class="headerlink" title="2. Select 语句的应用"></a>2. Select 语句的应用</h2><br><h3 id="2-1-select-单独使用的情况"><a href="#2-1-select-单独使用的情况" class="headerlink" title="2.1 select 单独使用的情况"></a>2.1 select 单独使用的情况</h3><br><p><strong>查看系统参数</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> @<span class="hljs-variable">@basedir</span>;<br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> @<span class="hljs-variable">@port</span>;<br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> @<span class="hljs-variable">@innodb</span>_flush_log_at_trx_commit;<br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">show</span> variables <span class="hljs-keyword">like</span> <span class="hljs-string">&#x27;innodb%&#x27;</span>;<br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> database();<br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> now();<br></code></pre></td></tr></table></figure> <br><br><h3 id="2-2-select查询语句通用语法-单表操作"><a href="#2-2-select查询语句通用语法-单表操作" class="headerlink" title="2.2 select查询语句通用语法 (单表操作)"></a>2.2 select查询语句通用语法 (单表操作)</h3> <br><p><strong>查询语句 顺序不能打乱</strong></p><ol><li>select 列 </li><li>from 表  </li><li>where 条件 </li><li>group by 条件</li><li>having  条件</li><li>order by 条件</li><li>limit</li></ol><br><br><h3 id="2-3-学习环境所用的数据库文件"><a href="#2-3-学习环境所用的数据库文件" class="headerlink" title="2.3 学习环境所用的数据库文件"></a>2.3 学习环境所用的数据库文件</h3> <br><ul><li>world   数据库</li><li>city          城市表</li><li>country     国家表 </li><li>countrylanguage 国家的语言</li></ul><br><p><strong>city 表的结构</strong></p><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">desc</span> city;<br><span class="hljs-operator">+</span><span class="hljs-comment">-------------+----------+------+-----+---------+----------------+</span><br><span class="hljs-operator">|</span> Field    <span class="hljs-operator">|</span> Type   <span class="hljs-operator">|</span> <span class="hljs-keyword">Null</span> <span class="hljs-operator">|</span> Key <span class="hljs-operator">|</span> <span class="hljs-keyword">Default</span> <span class="hljs-operator">|</span> Extra     <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">-------------+----------+------+-----+---------+----------------+</span><br><span class="hljs-operator">|</span> ID     <span class="hljs-operator">|</span> <span class="hljs-type">int</span>(<span class="hljs-number">11</span>) <span class="hljs-operator">|</span> <span class="hljs-keyword">NO</span>  <span class="hljs-operator">|</span> PRI <span class="hljs-operator">|</span> <span class="hljs-keyword">NULL</span>  <span class="hljs-operator">|</span> auto_increment <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> Name    <span class="hljs-operator">|</span> <span class="hljs-type">char</span>(<span class="hljs-number">35</span>) <span class="hljs-operator">|</span> <span class="hljs-keyword">NO</span>  <span class="hljs-operator">|</span>   <span class="hljs-operator">|</span>     <span class="hljs-operator">|</span>        <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> CountryCode <span class="hljs-operator">|</span> <span class="hljs-type">char</span>(<span class="hljs-number">3</span>) <span class="hljs-operator">|</span> <span class="hljs-keyword">NO</span>  <span class="hljs-operator">|</span> MUL <span class="hljs-operator">|</span>     <span class="hljs-operator">|</span>        <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> District  <span class="hljs-operator">|</span> <span class="hljs-type">char</span>(<span class="hljs-number">20</span>) <span class="hljs-operator">|</span> <span class="hljs-keyword">NO</span>  <span class="hljs-operator">|</span>   <span class="hljs-operator">|</span>     <span class="hljs-operator">|</span>        <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> Population <span class="hljs-operator">|</span> <span class="hljs-type">int</span>(<span class="hljs-number">11</span>) <span class="hljs-operator">|</span> <span class="hljs-keyword">NO</span>  <span class="hljs-operator">|</span>   <span class="hljs-operator">|</span> <span class="hljs-number">0</span>    <span class="hljs-operator">|</span>        <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">-------------+----------+------+-----+---------+----------------+</span><br><span class="hljs-number">5</span> <span class="hljs-keyword">rows</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)<br></code></pre></td></tr></table></figure><br><br><p> <strong>相关列名字</strong></p><br><ul><li>ID         : 城市序号(1-…)</li><li>name        : 城市名字</li><li>countrycode    : 国家代码,例如:CHN,USA</li><li>district  :         区域  中国 省 美国 洲</li><li>population :    人口数</li></ul><br><br><p>:::tip 工作中如何熟悉数据库业务?</p><ul><li><p>快速和研发人员打好关系</p></li><li><p>找到领导要ER图</p></li><li><p>查看建表语句<code>DESC ,show create table</code></p></li><li><p>查询表的全部数据前五行数据 <code>select * from city limit 5;</code></p><p>:::</p></li></ul><br><br><h3 id="2-4-SELECT-配合-FROM-子句使用"><a href="#2-4-SELECT-配合-FROM-子句使用" class="headerlink" title="2.4 SELECT 配合 FROM 子句使用"></a>2.4 SELECT <strong>配合</strong> <strong>FROM</strong> 子句使用</h3><br><p><strong>语法：</strong> <strong>select 条件列 from 表</strong></p><p>例子:</p><ol><li><strong>查询表中所有的信息(生产中几乎是没有这种需求的)</strong></li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql">USE world ;<br><span class="hljs-keyword">SELECT</span> id,NAME ,countrycode ,district,population  <span class="hljs-keyword">FROM</span> city;<br></code></pre></td></tr></table></figure><p>或者:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span>  <span class="hljs-keyword">FROM</span> city;<br></code></pre></td></tr></table></figure> <br><br><ol start="2"><li><strong>查询表中 name 和population 列的值</strong></li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> NAME ,population  <span class="hljs-keyword">FROM</span> city;<br></code></pre></td></tr></table></figure> <br><br><h3 id="2-5-SELECT-配合-WHERE-子句使用"><a href="#2-5-SELECT-配合-WHERE-子句使用" class="headerlink" title="2.5 SELECT 配合 WHERE 子句使用"></a>2.5 SELECT <strong>配合</strong> WHERE 子句使用</h3><br><p><strong>语法：</strong> <strong>select 条件列 from 表 where 过滤条件</strong></p> <br><p><strong>使用情况一：where等值条件查询类似 grep 过滤具体字符串</strong></p><p><strong>例子:</strong></p><p><strong>1.查询中国所有的城市名和人口数</strong> </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> NAME,population <span class="hljs-keyword">FROM</span> city <br><span class="hljs-keyword">WHERE</span> countrycode<span class="hljs-operator">=</span><span class="hljs-string">&#x27;CHN&#x27;</span>;<br></code></pre></td></tr></table></figure>  <br> <br><p><strong>使用情况二： where 配合比较判断查询(&gt; &lt; &gt;= &lt;=)</strong></p><p><strong>例子:</strong></p><ol><li><strong>世界上小于100人的城市名和人口数</strong></li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> NAME,population <span class="hljs-keyword">FROM</span> city <br><span class="hljs-keyword">WHERE</span> population<span class="hljs-operator">&lt;</span><span class="hljs-number">100</span>;<br></code></pre></td></tr></table></figure>  <br> <br><p><strong>使用情况三：  where 配合 逻辑连接符 (and or)   与或非</strong></p><p> <strong>例子:</strong> </p><p><strong>1.</strong> <strong>查询中国人口数量大于1000w的城市名和人口</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> NAME,population <span class="hljs-keyword">FROM</span> city <br><span class="hljs-keyword">WHERE</span> countrycode<span class="hljs-operator">=</span><span class="hljs-string">&#x27;CHN&#x27;</span> <span class="hljs-keyword">AND</span> population<span class="hljs-operator">&gt;</span><span class="hljs-number">8000000</span>;<br></code></pre></td></tr></table></figure>  <br><p><strong>2.</strong> <strong>查询中国或美国的城市名和人口数</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> NAME,population <span class="hljs-keyword">FROM</span> city <br><span class="hljs-keyword">WHERE</span> countrycode<span class="hljs-operator">=</span><span class="hljs-string">&#x27;CHN&#x27;</span> <span class="hljs-keyword">OR</span> countrycode<span class="hljs-operator">=</span><span class="hljs-string">&#x27;USA&#x27;</span>;<br></code></pre></td></tr></table></figure><p><strong>3.</strong> <strong>查询人口数量在500w到600w之间的城市名和人口数</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> NAME,population <span class="hljs-keyword">FROM</span> city <br><span class="hljs-keyword">WHERE</span> population<span class="hljs-operator">&gt;</span><span class="hljs-number">5000000</span> <span class="hljs-keyword">AND</span> population<span class="hljs-operator">&lt;</span><span class="hljs-number">6000000</span>; <br>或者:<br><span class="hljs-keyword">SELECT</span> NAME,population <span class="hljs-keyword">FROM</span> city <br><span class="hljs-keyword">WHERE</span> population <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">5000000</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">6000000</span>;<br></code></pre></td></tr></table></figure>  <br> <br><p><strong>使用情况三：where 配合 like子句 模糊查询</strong></p><p><strong>例子:</strong></p><p><strong>1. 查询一下contrycode中带有CH开头,城市信息</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> city <br><span class="hljs-keyword">WHERE</span> countrycode <span class="hljs-keyword">LIKE</span> <span class="hljs-string">&#x27;CH%&#x27;</span>;<br></code></pre></td></tr></table></figure><p> <br><br></p><p><strong>注意:不要出现类似于 %CH%,前后都有百分号的语句,因为不走索引,性能极差<br></strong></p><p><strong>如果业务中有大量需求,我们用”ES”来替代</strong></p> <br><p><strong>使用情况四：where 配合 in语句</strong></p><p> <strong>例子:</strong>  </p><p><strong>1. 查询中国或美国的城市信息</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> NAME,population <span class="hljs-keyword">FROM</span> city <br><span class="hljs-keyword">WHERE</span> countrycode<span class="hljs-operator">=</span><span class="hljs-string">&#x27;CHN&#x27;</span> <span class="hljs-keyword">OR</span> countrycode<span class="hljs-operator">=</span><span class="hljs-string">&#x27;USA&#x27;</span>;<br></code></pre></td></tr></table></figure><p> <strong>或者:</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> NAME,population <span class="hljs-keyword">FROM</span> city <br><span class="hljs-keyword">WHERE</span> countrycode <span class="hljs-keyword">IN</span> (<span class="hljs-string">&#x27;CHN&#x27;</span> ,<span class="hljs-string">&#x27;USA&#x27;</span>);<br></code></pre></td></tr></table></figure><br><br><h3 id="2-6-SELECT-配合-GROUP-BY-聚合参数应用"><a href="#2-6-SELECT-配合-GROUP-BY-聚合参数应用" class="headerlink" title="2.6 SELECT 配合 GROUP BY + 聚合参数应用"></a><strong>2.6 SELECT 配合 GROUP BY + 聚合参数应用</strong></h3><br><p><strong>2.6.1 常用聚合函数介绍</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-built_in">MAX</span>( ),<span class="hljs-built_in">MIN</span>( ),<span class="hljs-built_in">AVG</span>( ),<span class="hljs-built_in">COUNT</span>( ),<span class="hljs-built_in">SUM</span> () GROUP_CONCAT( )<br></code></pre></td></tr></table></figure><br><p><strong>2.6.2 GROUP BY  生产中使用较多</strong></p><p><strong>将某列中有共同条件的数据行,分成一组,然后在进行聚合函数操作.类似AWK中的数组</strong></p><br><p>例子:</p><p><strong>1. 统计每个国家,城市的个数</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> countrycode ,<span class="hljs-built_in">COUNT</span>(id) <span class="hljs-keyword">FROM</span> city<br><span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> countrycode;<br></code></pre></td></tr></table></figure><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section3-3-1.png" alt="统计每个国家,城市的个数"></p><br><br><p><strong>2. 统计每个国家的总人口数.</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> countrycode,<span class="hljs-built_in">SUM</span>(population) <span class="hljs-keyword">FROM</span> city <br><span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> countrycode;<br></code></pre></td></tr></table></figure><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section3-3-2.png" alt="统计每个国家的总人口数"></p><br><br><p><strong>3. 统计每个国家省的个数</strong></p><br><p><strong>DISTINCT 去重 把重复省名字去重</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> countrycode,<span class="hljs-built_in">COUNT</span>(<span class="hljs-keyword">DISTINCT</span> district)   <span class="hljs-keyword">FROM</span> city<br><span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> countrycode;<br></code></pre></td></tr></table></figure><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section3-3-3.png" alt="DISTINCT 去重"></p><br><br><p><strong>4.</strong> <strong>统计中国 每个省的总人口数</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> district, <span class="hljs-built_in">SUM</span>(population)   <span class="hljs-keyword">FROM</span> city <br><span class="hljs-keyword">WHERE</span> countrycode<span class="hljs-operator">=</span><span class="hljs-string">&#x27;CHN&#x27;</span><br><span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> district ;<br></code></pre></td></tr></table></figure><br><br><p><strong>5.</strong> <strong>统计中国 每个省城市的个数</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> district, <span class="hljs-built_in">COUNT</span>(NAME)   <span class="hljs-keyword">FROM</span> city <br><span class="hljs-keyword">WHERE</span> countrycode<span class="hljs-operator">=</span><span class="hljs-string">&#x27;CHN&#x27;</span><br><span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> district ;<br></code></pre></td></tr></table></figure> <br><br><p><strong>6.</strong> <strong>统计中国 每个省城市的名字列表</strong> </p><p>语法：<strong>GROUP_CONCAT()</strong></p><p>如：guangdong  guangzhou,shenzhen,foshan…. 不统计  把列转成一行显示</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> district, GROUP_CONCAT(NAME)   <span class="hljs-keyword">FROM</span> city <br><span class="hljs-keyword">WHERE</span> countrycode<span class="hljs-operator">=</span><span class="hljs-string">&#x27;CHN&#x27;</span><br><span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> district ;<br></code></pre></td></tr></table></figure><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section3-3-4.png" alt="把列转成一行显示"></p> <br><br><p><strong>7.</strong> <strong>小扩展</strong></p><p><strong>把结果拼成一行</strong> <br></p><p><strong>格式：</strong> anhui : hefei,huaian ….<br><br>concat 拼接</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> CONCAT(district,&quot;:&quot; ,GROUP_CONCAT(NAME))   <span class="hljs-keyword">FROM</span> city <br><span class="hljs-keyword">WHERE</span> countrycode<span class="hljs-operator">=</span><span class="hljs-string">&#x27;CHN&#x27;</span><br><span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> district ;<br></code></pre></td></tr></table></figure><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section3-3-5.png" alt="把结果拼成一行"></p> <br><br><h3 id="2-7-SELECT-配合HAVING应用"><a href="#2-7-SELECT-配合HAVING应用" class="headerlink" title="2.7 SELECT 配合HAVING应用"></a><strong>2.7 SELECT 配合HAVING应用</strong></h3><p><strong>例子：</strong></p><ol><li><strong>统计所有国家的总人口数量，将总人口数量大于1亿的过滤出来</strong></li></ol><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section3-3-6.png" alt="把结果拼成一行"></p><p>SUM函数操作 在Group by 之后操作，所以不能使用where </p><p>所以只能在Group by 做完分组聚合 后再做条件查询、判断、过滤时需要使用 HAVING 子句（HAVING不走索引的对性能有影响）</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section3-3-7.png" alt="把结果拼成一行"></p><br><br><h3 id="2-8-SELECT-配合-ORDER-BY-子句"><a href="#2-8-SELECT-配合-ORDER-BY-子句" class="headerlink" title="2.8 SELECT 配合 ORDER BY 子句"></a>2.8 SELECT 配合 ORDER BY 子句</h3> <br><p><strong>例子:</strong></p><p><strong>1.</strong> <strong>统计所有国家的总人口数量,将总人口数大于5000w的过滤出来,并且按照从大到小顺序排列</strong></p><p><code>GROUP BY</code> 执行完 <code>SUM ORDER BY SUM</code> 才能执行</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> countrycode,<span class="hljs-built_in">SUM</span>(population) <span class="hljs-keyword">FROM</span> city<br><span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> countrycode<br><span class="hljs-keyword">HAVING</span> <span class="hljs-built_in">SUM</span>(population)<span class="hljs-operator">&gt;</span><span class="hljs-number">50000000</span><br><span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> <span class="hljs-built_in">SUM</span>(population) <span class="hljs-keyword">DESC</span> ;<br></code></pre></td></tr></table></figure> <br> <br><h3 id="2-9-SELECT-配合-LIMIT-子句"><a href="#2-9-SELECT-配合-LIMIT-子句" class="headerlink" title="2.9 SELECT 配合 LIMIT 子句"></a>2.9 SELECT 配合 LIMIT 子句</h3> <br><p><strong>例子:</strong></p><p><strong>1.</strong> 统计所有国家的总人口数量</p><p><strong>将总人口数大于5000w的过滤出来</strong></p><p><strong>并且按照从大到小顺序排列只显示前三名</strong> <strong>（分页显示）</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> countrycode,<span class="hljs-built_in">SUM</span>(population) <span class="hljs-keyword">FROM</span> city<br><span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> countrycode<br><span class="hljs-keyword">HAVING</span> <span class="hljs-built_in">SUM</span>(population)<span class="hljs-operator">&gt;</span><span class="hljs-number">50000000</span><br><span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> <span class="hljs-built_in">SUM</span>(population) <span class="hljs-keyword">DESC</span> <br>LIMIT <span class="hljs-number">3</span> <span class="hljs-keyword">OFFSET</span> <span class="hljs-number">0</span>;<br> <br><span class="hljs-comment">--显示4-6行</span><br> <br><span class="hljs-keyword">SELECT</span> countrycode,<span class="hljs-built_in">SUM</span>(population) <span class="hljs-keyword">FROM</span> city<br><span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> countrycode<br><span class="hljs-keyword">HAVING</span> <span class="hljs-built_in">SUM</span>(population)<span class="hljs-operator">&gt;</span><span class="hljs-number">50000000</span><br><span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> <span class="hljs-built_in">SUM</span>(population) <span class="hljs-keyword">DESC</span> <br>LIMIT <span class="hljs-number">3</span> <span class="hljs-keyword">OFFSET</span> <span class="hljs-number">3</span> <br></code></pre></td></tr></table></figure><p><strong>LIMIT M,N   :跳过M行,显示一共N行</strong></p><p><strong>LIMIT Y OFFSET X:跳过X行,显示一共Y行</strong></p> <br> <br><h3 id="2-10-练习题"><a href="#2-10-练习题" class="headerlink" title="2.10 练习题"></a><strong>2.10 练习题</strong></h3> <br><p><strong>1.统计中国每个省的总人口数，只打印总人口数小于100w的</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span>  district ,<span class="hljs-built_in">SUM</span>(population) <span class="hljs-keyword">FROM</span> city <br><span class="hljs-keyword">WHERE</span> countrycode<span class="hljs-operator">=</span><span class="hljs-string">&#x27;CHN&#x27;</span><br><span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> district<br><span class="hljs-keyword">HAVING</span> <span class="hljs-built_in">SUM</span>(population)<span class="hljs-operator">&lt;</span><span class="hljs-number">1000000</span>;<br></code></pre></td></tr></table></figure><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section3-3-8.png" alt="LX1"></p> <br> <br><p><strong>2.</strong> <strong>查看中国所有的城市，并按人口数进行排序(从大到小)</strong></p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs n1ql"><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> city <span class="hljs-keyword">WHERE</span> countrycode=<span class="hljs-string">&#x27;CHN&#x27;</span> <br><span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> population <span class="hljs-keyword">DESC</span>;<br></code></pre></td></tr></table></figure><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section3-3-9.png" alt="LX1"></p> <br><p><strong>3.</strong> <strong>统计中国各个省的总人口数量，按照总人口从大到小排序</strong></p>  <br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs SQL"><span class="hljs-keyword">SELECT</span>  district ,<span class="hljs-built_in">SUM</span>(population) <span class="hljs-keyword">FROM</span> city <br><span class="hljs-keyword">WHERE</span> countrycode<span class="hljs-operator">=</span><span class="hljs-string">&#x27;CHN&#x27;</span><br><span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> district<br><span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> <span class="hljs-built_in">SUM</span>(population) <span class="hljs-keyword">DESC</span> ;<br></code></pre></td></tr></table></figure>  <br><p><strong>4.</strong> <strong>统计中国,每个省的总人口,找出总人口大于500w的,</strong></p><p>并按总人口从大到小排序,只显示前三名</p>  <br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span>  district ,<span class="hljs-built_in">SUM</span>(population) <span class="hljs-keyword">FROM</span> city <br><span class="hljs-keyword">WHERE</span> countrycode<span class="hljs-operator">=</span><span class="hljs-string">&#x27;CHN&#x27;</span><br><span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> district<br><span class="hljs-keyword">HAVING</span> <span class="hljs-built_in">SUM</span>(population)<span class="hljs-operator">&gt;</span><span class="hljs-number">5000000</span><br><span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> <span class="hljs-built_in">SUM</span>(population) <span class="hljs-keyword">DESC</span> <br>LIMIT <span class="hljs-number">3</span>;<br></code></pre></td></tr></table></figure>  <br> <br><h3 id="2-11-小结-子句执行逻辑"><a href="#2-11-小结-子句执行逻辑" class="headerlink" title="2.11 小结 子句执行逻辑"></a><strong>2.11</strong> <strong>小结 子句执行逻辑</strong></h3>  <br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs SQL"><span class="hljs-keyword">select</span> 列， <span class="hljs-keyword">from</span> t1 <br><span class="hljs-keyword">select</span> disctrict , <span class="hljs-built_in">count</span>(name) <span class="hljs-keyword">from</span>  city   先调用表<br><span class="hljs-keyword">where</span> countrycode<span class="hljs-operator">=</span><span class="hljs-string">&#x27;CHN&#x27;</span>  根据<span class="hljs-keyword">where</span>条件过滤 CHN的国家<br><span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> district      数组数省份出现次数<br><span class="hljs-keyword">having</span> <span class="hljs-built_in">count</span>(name) <span class="hljs-operator">&gt;</span><span class="hljs-number">10</span> 对结果集进行过滤<br><span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> <span class="hljs-built_in">count</span>(name) <span class="hljs-keyword">desc</span>  对以上结果进行排序<br>limit <span class="hljs-number">3</span>; 只显示排名靠前的三位<br></code></pre></td></tr></table></figure>  <br> <br> <p>中国前三个 拥有超过十个城市的省份</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section3-3-10.png" alt="中国前三个 拥有超过十个城市的省份"></p> <br> <br><h3 id="2-12-union-和-union-all-SQL改写"><a href="#2-12-union-和-union-all-SQL改写" class="headerlink" title="2.12 union 和 union all  SQL改写"></a><strong>2.12 union 和 union all  SQL改写</strong></h3><p><strong>作用: 多个结果集合并查询的功能</strong></p><p><strong>多个语句结果进行拼接</strong></p>  <br><p>需求: 查询中国或者美国的城市信息</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> city <span class="hljs-keyword">WHERE</span> countrycode<span class="hljs-operator">=</span><span class="hljs-string">&#x27;CHN&#x27;</span> <span class="hljs-keyword">OR</span> countrycode<span class="hljs-operator">=</span><span class="hljs-string">&#x27;USA&#x27;</span>;<br></code></pre></td></tr></table></figure>  <br><p>改写为: 性能比改写前性能高</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> city <span class="hljs-keyword">WHERE</span> countrycode<span class="hljs-operator">=</span><span class="hljs-string">&#x27;CHN&#x27;</span><br><span class="hljs-keyword">UNION</span> <span class="hljs-keyword">ALL</span> <br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> city <span class="hljs-keyword">WHERE</span> countrycode<span class="hljs-operator">=</span><span class="hljs-string">&#x27;USA&#x27;</span>;<br></code></pre></td></tr></table></figure> <br> <br><p><strong>面试题: union 和 union all 的区别</strong> <strong>?</strong></p><ul><li>union all  不做去重复</li><li>union       会做去重操作</li></ul> <br> <br><h2 id="3-多表连接查询-内连接"><a href="#3-多表连接查询-内连接" class="headerlink" title="3.多表连接查询(内连接)"></a>3.多表连接查询(内连接)</h2> <br><h3 id="3-1-作用引入"><a href="#3-1-作用引入" class="headerlink" title="3.1 作用引入"></a>3.1 作用引入</h3><p> 单表数据不能满足查询需求时</p> <br><p> <strong>例子 查询世界上小于100人的城市,所在的国家名,国土面积，城市名,人口数</strong></p><p> 需要查询 city:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> countrycode,NAME,population <span class="hljs-keyword">FROM</span> city <span class="hljs-keyword">WHERE</span> population<span class="hljs-operator">&lt;</span><span class="hljs-number">100</span>; <span class="hljs-comment">--city表中只能查到国家名、人口数、国家代号</span><br>PCN   Adamstown  <span class="hljs-number">42</span> <br></code></pre></td></tr></table></figure><p>需要关联查询 country：<br><code>DESC country;</code>  查看表结构</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs sql">需要关联查询 country<br><span class="hljs-keyword">DESC</span> country; 查看表结构<br>第二张表：<br> <br>CODE <br>NAME 国家名字<br>SurfaceArea 国土面积<br> <br><span class="hljs-keyword">SELECT</span> NAME ,SurfaceArea <span class="hljs-keyword">FROM</span> country <span class="hljs-keyword">WHERE</span> CODE<span class="hljs-operator">=</span><span class="hljs-string">&#x27;PCN&#x27;</span>; country表中查询<br> <br>Pitcairn<br><span class="hljs-number">49.00</span><br></code></pre></td></tr></table></figure>  <br> <br><h3 id="3-2-多表连接基本语法要求"><a href="#3-2-多表连接基本语法要求" class="headerlink" title="3.2 多表连接基本语法要求"></a>3.2 多表连接基本语法要求</h3> <br> <ol><li><p>最核心的是找到多张表之间的关联条件列</p></li><li><p>列书写时，必须是：表名字.列</p></li><li><p>所有涉及到的查询列，都放在selec后 </p></li><li><p>将所有的过滤，分组，排序等条件按顺序写在on的后面</p></li><li><p>JOIN B ON A.X=B.Y  A和B的关联</p><p>JOIN C ON B.m=C.n B和C 的关联</p></li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <br>country.name ,<br>country.SurfaceArea,<br>city.name,<br>city.Population<br><span class="hljs-keyword">FROM</span> city<br><span class="hljs-keyword">JOIN</span> country<br><span class="hljs-keyword">ON</span> city.CountryCode <span class="hljs-operator">=</span> country.code <span class="hljs-comment">--关联列</span><br><span class="hljs-keyword">WHERE</span> city.population<span class="hljs-operator">&lt;</span><span class="hljs-number">100</span>;<br></code></pre></td></tr></table></figure>  <br> <br><h3 id="3-3-多表连接查询例题-（学生管理系统）"><a href="#3-3-多表连接查询例题-（学生管理系统）" class="headerlink" title="3.3  多表连接查询例题 （学生管理系统）"></a>3.3  多表连接查询例题 （学生管理系统）</h3> <br><p>数据库结构如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs txt">student ：学生表<br>===============<br>sno：  学号<br>sname：学生姓名<br>sage： 学生年龄<br>ssex： 学生性别<br> <br>teacher ：教师表<br>================<br>tno： 教师编号<br>tname：教师名字<br> <br>course ：课程表<br>===============<br>cno： 课程编号<br>cname：课程名字<br>tno： 教师编号<br> <br>score ：成绩表<br>==============<br>sno： 学号<br>cno： 课程编号<br>score：成绩<br></code></pre></td></tr></table></figure> <br><p>数据库 ER 关系图：</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section3-3-11.png" alt="数据库 ER 关系图"></p> <br><h3 id="3-4-多表连接举例说明"><a href="#3-4-多表连接举例说明" class="headerlink" title="3.4 多表连接举例说明"></a>3.4 多表连接举例说明</h3>  <br><p><strong>1. 统计zhang3,学习了几门课</strong></p><p><strong>先把涉及到的表列出来</strong></p><ul><li><p><strong>student</strong></p></li><li><p><strong>course</strong></p> <br></li></ul><p><strong>由于sc里面有课程编号所有只需要用到两张表就行了</strong></p><p>​    <br></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> student.sname,<span class="hljs-built_in">COUNT</span>(sc.cno)<br><span class="hljs-keyword">FROM</span> student <span class="hljs-keyword">JOIN</span> sc       <span class="hljs-comment">--连接sc表进行查询</span><br><span class="hljs-keyword">ON</span> student.sno<span class="hljs-operator">=</span>sc.sno<br><span class="hljs-keyword">WHERE</span> student.sname<span class="hljs-operator">=</span><span class="hljs-string">&#x27;zhang3&#x27;</span>;<br></code></pre></td></tr></table></figure><p>​    <br></p><p>​    <br></p><p><strong>2. 查询zhang3,学习的课程名称有哪些?</strong></p><p><strong>把涉及到的表列出来</strong></p><ul><li><strong>student</strong></li><li><strong>sc</strong></li><li><strong>course</strong></li></ul> <br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> student.sname,GROUP_CONCAT(course.cname)<br><span class="hljs-keyword">FROM</span> student<br><span class="hljs-keyword">JOIN</span> sc<br><span class="hljs-keyword">ON</span> student.sno<span class="hljs-operator">=</span>sc.sno <br><span class="hljs-keyword">JOIN</span> course<br><span class="hljs-keyword">ON</span> sc.cno<span class="hljs-operator">=</span>course.cno<br><span class="hljs-keyword">WHERE</span> student.sname<span class="hljs-operator">=</span><span class="hljs-string">&#x27;zhang3&#x27;</span><br><span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> student.sname; <span class="hljs-comment">--课程数组</span><br></code></pre></td></tr></table></figure><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section3-3-12.png" alt="查询zhang3,学习的课程名称有哪些?"></p><p>结果使用一行输出 使用 <code>GROUP_CONCAT</code></p> <br><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section3-3-13.png" alt="使用 `GROUP_CONCAT`"><br> <br></p><p>3.<strong>查询 xin 老师教的学生名和个数</strong>.</p><ul><li>teacher</li><li>corse</li><li>sc</li><li>student</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> teacher.tname,GROUP_CONCAT(student.sname),<span class="hljs-built_in">COUNT</span>(student.sname)<br><span class="hljs-keyword">FROM</span> teacher <br><span class="hljs-keyword">JOIN</span> course <br><span class="hljs-keyword">ON</span> teacher.tno<span class="hljs-operator">=</span>course.tno<br><span class="hljs-keyword">JOIN</span> sc<br><span class="hljs-keyword">ON</span> course.cno<span class="hljs-operator">=</span>sc.cno<br><span class="hljs-keyword">JOIN</span> student<br><span class="hljs-keyword">ON</span> sc.sno<span class="hljs-operator">=</span>student.sno<br><span class="hljs-keyword">WHERE</span> teacher.tname<span class="hljs-operator">=</span><span class="hljs-string">&#x27;xin&#x27;</span> <span class="hljs-comment">--条件</span><br><span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> teacher.tname; <span class="hljs-comment">--老师数组</span><br></code></pre></td></tr></table></figure> <br> <br><p><strong>5.</strong> <strong>每位老师所教课程的平均分,并按平均分排序</strong></p> <br><ul><li><strong>teacker</strong></li><li><strong>course</strong></li><li><strong>sc</strong></li></ul> <br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> teacher.tname,course.cname，<span class="hljs-built_in">AVG</span>(sc.score)<br><span class="hljs-keyword">from</span> teacker<br><span class="hljs-keyword">join</span> course <br><span class="hljs-keyword">on</span> teacher.tno<span class="hljs-operator">=</span>course.tno<br><span class="hljs-keyword">JOIN</span> sc<br><span class="hljs-keyword">ON</span> course.con<span class="hljs-operator">=</span>sc.con<br><span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> teacher.tname,course.cname <span class="hljs-comment">--把老师进行分组 ，在把课程进行分组 </span><br><span class="hljs-comment">--如果不分那么 一个老师如果教两门课的成绩就会混在一起</span><br><span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> <span class="hljs-built_in">AVG</span>(sc.score) ;<br></code></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> teacher.tname,course.cname,<span class="hljs-built_in">AVG</span>(sc.score)<br><span class="hljs-keyword">FROM</span> teacher <br><span class="hljs-keyword">JOIN</span> course<br><span class="hljs-keyword">ON</span> teacher.tno<span class="hljs-operator">=</span>course.tno<br><span class="hljs-keyword">JOIN</span> sc<br><span class="hljs-keyword">ON</span> course.cno<span class="hljs-operator">=</span>sc.cno<br><span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> teacher.tname,course.cname<br><span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> <span class="hljs-built_in">AVG</span>(sc.score)<br></code></pre></td></tr></table></figure> <br> <br><p> <strong>6.查询oldguo所教的不及格的学生姓名</strong></p>  <br><ul><li><p><strong>teacher</strong></p></li><li><p><strong>sc</strong></p></li><li><p><strong>student</strong></p><br></li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> teacher.tname,student.sname,sc.score<br><span class="hljs-keyword">FROM</span> teacher<br><span class="hljs-keyword">JOIN</span> course<br><span class="hljs-keyword">ON</span> teacher.tno<span class="hljs-operator">=</span>course.tno<br><span class="hljs-keyword">JOIN</span> sc<br><span class="hljs-keyword">ON</span> course.cno<span class="hljs-operator">=</span>sc.cno<br><span class="hljs-keyword">JOIN</span> student<br><span class="hljs-keyword">ON</span> sc.sno<span class="hljs-operator">=</span>student.sno<br><span class="hljs-keyword">WHERE</span> teacher.tname<span class="hljs-operator">=</span><span class="hljs-string">&#x27;xin&#x27;</span> <span class="hljs-keyword">AND</span> sc.score<span class="hljs-operator">&lt;</span><span class="hljs-number">60</span><br></code></pre></td></tr></table></figure> <br> <br><p><strong>7.查询所有老师所教学生不及格的信息(扩展)</strong></p> <br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> teacher.tname,GROUP_CONCAT(CONCAT(student.sname,&quot;:&quot;,sc.score)) <br><span class="hljs-keyword">FROM</span> teacher<br><span class="hljs-keyword">JOIN</span> course<br><span class="hljs-keyword">ON</span> teacher.tno<span class="hljs-operator">=</span>course.tno<br><span class="hljs-keyword">JOIN</span> sc<br><span class="hljs-keyword">ON</span> course.cno<span class="hljs-operator">=</span>sc.cno<br><span class="hljs-keyword">JOIN</span> student<br><span class="hljs-keyword">ON</span> sc.sno<span class="hljs-operator">=</span>student.sno<br><span class="hljs-keyword">WHERE</span> sc.score<span class="hljs-operator">&lt;</span><span class="hljs-number">60</span><br><span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> teacher.tno <span class="hljs-comment">--按老师编号分组</span><br></code></pre></td></tr></table></figure> <br> <br><p><strong>8.别名应用</strong></p>  <br><p><strong>表别名</strong> <strong>:</strong> <strong>给表起个别名省略了表长名字语句更好读</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> t.tname,GROUP_CONCAT(CONCAT(st.sname,&quot;:&quot;,sc.score)) <br><span class="hljs-keyword">FROM</span> teacher <span class="hljs-keyword">as</span> t<br><span class="hljs-keyword">JOIN</span> course <span class="hljs-keyword">as</span> c<br><span class="hljs-keyword">ON</span> t.tno<span class="hljs-operator">=</span>c.tno<br><span class="hljs-keyword">JOIN</span> sc <br><span class="hljs-keyword">ON</span> c.cno<span class="hljs-operator">=</span>sc.cno<br><span class="hljs-keyword">JOIN</span> student <span class="hljs-keyword">as</span> st<br><span class="hljs-keyword">ON</span> sc.sno<span class="hljs-operator">=</span>st.sno<br><span class="hljs-keyword">WHERE</span> sc.score<span class="hljs-operator">&lt;</span><span class="hljs-number">60</span><br><span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> t.tno<br></code></pre></td></tr></table></figure>   <br><p><strong>表别名是全局调用的</strong></p><p><strong>列别名:</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> t.tname <span class="hljs-keyword">as</span> 讲师名 ,GROUP_CONCAT(CONCAT(st.sname,&quot;:&quot;,sc.score)) <span class="hljs-keyword">as</span> 不及格的<br><span class="hljs-keyword">FROM</span> teacher <span class="hljs-keyword">as</span> t<br><span class="hljs-keyword">JOIN</span> course <span class="hljs-keyword">as</span> c<br><span class="hljs-keyword">ON</span> t.tno<span class="hljs-operator">=</span>c.tno<br><span class="hljs-keyword">JOIN</span> sc <br><span class="hljs-keyword">ON</span> c.cno<span class="hljs-operator">=</span>sc.cno<br><span class="hljs-keyword">JOIN</span> student <span class="hljs-keyword">as</span> st<br><span class="hljs-keyword">ON</span> sc.sno<span class="hljs-operator">=</span>st.sno<br><span class="hljs-keyword">WHERE</span> sc.score<span class="hljs-operator">&lt;</span><span class="hljs-number">60</span><br><span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> t.tno<br></code></pre></td></tr></table></figure><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section3-3-14.png" alt="列别名"></p>   <br><p>列别名可以被 having 和 order by 调用</p><p><strong>表别名是全局调用的</strong></p>]]></content>
    
    
    <categories>
      
      <category>DBA</category>
      
    </categories>
    
    
    <tags>
      
      <tag>DBA</tag>
      
      <tag>RDBMS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>DDL 语句的应用</title>
    <link href="/2020/07/13/dba03-1/"/>
    <url>/2020/07/13/dba03-1/</url>
    
    <content type="html"><![CDATA[<h1 id="DDL-语句的应用"><a href="#DDL-语句的应用" class="headerlink" title="DDL 语句的应用"></a>DDL 语句的应用</h1><p>[[toc]]</p><h2 id="1-对库的定义"><a href="#1-对库的定义" class="headerlink" title="1. 对库的定义"></a>1. 对库的定义</h2> <br><p><strong>作用：</strong> 对数据库 逻辑对象库或表的定义操作 </p>  <br>  <br><p><strong>创建数据库</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> DATABASE zabbix CHARSET utf8mb4 <span class="hljs-keyword">COLLATE</span> utf8mb4_bin;<br></code></pre></td></tr></table></figure><p><strong>查看库信息</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SHOW</span> DATABASES;<br><span class="hljs-keyword">SHOW</span> <span class="hljs-keyword">CREATE</span> DATABASE zabbix;<br></code></pre></td></tr></table></figure> <br><p><strong>删除数据库</strong></p><p>生产中危险操作 :warning: </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">DROP</span> DATABASE xin;<br></code></pre></td></tr></table></figure>  <br> <br> <br><p><strong>修改数据库字符集</strong></p><p><strong>注意</strong>: 字符集一定是 <strong>从小往大了改</strong>，比如utf8修改成utf8mb4</p><p>目标字符集一定是源字符集的超集。</p>  <br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> DATABASE xin;<br><span class="hljs-keyword">SHOW</span> <span class="hljs-keyword">CREATE</span> DATABASE xin;<br><span class="hljs-keyword">ALTER</span> DATABASE xin CHARSET utf8mb4;    <span class="hljs-comment">--更改字符集</span><br></code></pre></td></tr></table></figure>   <br>  <br><h3 id="1-1-关于库定义规范"><a href="#1-1-关于库定义规范" class="headerlink" title="1.1 关于库定义规范"></a>1.1 关于库定义规范</h3>   <br><p>:::tip 库定义规范 </p><ul><li><p>库名使用小写字符</p></li><li><p>库名不能以数字开头</p></li><li><p>不能是数据库内部的关键字</p></li><li><p>必须设置字符集</p></li></ul><p> :::</p>   <br>  <br><h2 id="2-对表的定义"><a href="#2-对表的定义" class="headerlink" title="2. 对表的定义"></a>2. 对表的定义</h2>  <br><p><strong>建表需要定义以下属性：</strong></p><ul><li><p>表名</p></li><li><p>列名</p></li><li><p>列属性</p></li><li><p>表属性</p> <br></li></ul><p><strong>使用数据库工具建表</strong></p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section3-2-1.png" alt="使用数据库工具建表"></p><p><strong>建表语句建表</strong></p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section3-2-2.png" alt="使用数据库工具建表2"></p>   <br>   <br><h3 id="2-1-列属性"><a href="#2-1-列属性" class="headerlink" title="2.1 列属性"></a>2.1 列属性</h3>   <br><p><code>PRIMARY KEY</code> : 主键 约束,功能：表中只能有一个主键,主键列非空且唯一   <br><br><code>NOT NULL</code>  : 非空 约束,不允许空值   <br><br><code>UNIQUE KEY</code> : 唯一键约束,不允许重复值 （常用手机号，微信号唯一） 可以为空   <br></p>   <br><p><strong>以上三个最常用</strong><br>  <br></p><p><code>DEFAULT</code>   : 一般配合 NOT NULL 一起使用. 生成定义好的默认值   <br><br><code>UNSIGNED</code>  : 无符号,一般是配合数字列,非负数   <br><br><code>COMMENT</code>   : 注释   <br><br><code>AUTO_INCREMENT</code> : 自增长的列，无需插入数据   <br></p>  <br><p><strong>例子：建表语句设置列属性</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> stu (<br>id <span class="hljs-type">INT</span> <span class="hljs-keyword">PRIMARY</span> KEY <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="hljs-string">&#x27;学号&#x27;</span>,<br>sname <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">255</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">&#x27;姓名&#x27;</span>,<br>age TINYINT UNSIGNED <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-number">0</span> COMMENT <span class="hljs-string">&#x27;年龄&#x27;</span>,<br>gender ENUM(<span class="hljs-string">&#x27;m&#x27;</span>,<span class="hljs-string">&#x27;f&#x27;</span>,<span class="hljs-string">&#x27;n&#x27;</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">&#x27;n&#x27;</span> COMMENT <span class="hljs-string">&#x27;性别&#x27;</span>,<br>intime DATETIME <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> NOW() COMMENT <span class="hljs-string">&#x27;入学时间&#x27;</span><br>)ENGINE INNODB CHARSET utf8mb4;<br></code></pre></td></tr></table></figure>   <br>  <br><h3 id="2-2-建表规范"><a href="#2-2-建表规范" class="headerlink" title="2.2 建表规范"></a><strong>2.2 建表规范</strong></h3>  <br><p><strong>知识点等级</strong>​ :star2::star2::star2::star2::star2:</p><p> :::tip 注意​ </p><ul><li>表名小写字母,不能数字开头,</li><li>不能是保留字符,使用和业务有关的表名</li><li>选择合适的数据类型及长度</li><li>每个列设置 NOT NULL + DEFAULT .对于数字0填充,对于字符使用有效字符串填充</li><li>每个列设置注释</li><li>表必须设置存储引擎和字符集</li><li>主键列尽量是无关列数字列,最好是自增长</li><li>enum类型不要保存数字,只能是字符串类型</li></ul><p>:::</p>  <br> <br><h3 id="2-3-表的常规操作"><a href="#2-3-表的常规操作" class="headerlink" title="2.3 表的常规操作"></a>2.3 表的常规操作</h3> <br><p><strong>查询建表信息</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SHOW</span> TABLES;<br><span class="hljs-keyword">SHOW</span> <span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> stu;<br><span class="hljs-keyword">DESC</span> stu;<br></code></pre></td></tr></table></figure>  <br><p><strong>创建一个表结构一样的表</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> test <span class="hljs-keyword">LIKE</span> stu;<br></code></pre></td></tr></table></figure>   <br><p><strong>删表</strong>  生产中危险操作 :warning:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> test;<br></code></pre></td></tr></table></figure><p>​    <br></p><p><strong>修改添加新列</strong></p><p> 例如：在stu 表中添加QQ号信息列</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">DESC</span> stu;<br><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> stu <span class="hljs-keyword">ADD</span> qq <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">20</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">&#x27;qq号&#x27;</span>;<br></code></pre></td></tr></table></figure><p>​    <br></p><p>:::tip 表操作要注意</p><ul><li>在线的DDL操作要尽量避免业务繁忙期</li><li>表数据量大的话会长时间锁表 </li><li>解决锁表情况可以使用pt-osc 工具 在线DDL或者 percona-toolkits Online 等第三方工具</li></ul><p>:::</p><p><strong>在sname列后加微信列</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> stu <span class="hljs-keyword">ADD</span> wechat <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">64</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">UNIQUE</span> COMMENT <span class="hljs-string">&#x27;微信号&#x27;</span> AFTER sname;<br></code></pre></td></tr></table></figure><p>​     <br></p><p><strong>在id列前加一个新列num</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> stu <span class="hljs-keyword">ADD</span> num <span class="hljs-type">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">UNIQUE</span> COMMENT <span class="hljs-string">&#x27;身份证&#x27;</span> <span class="hljs-keyword">FIRST</span> ;<br><span class="hljs-keyword">DESC</span> stu;<br></code></pre></td></tr></table></figure><p>​     <br></p><p><strong>把刚才添加的列都删掉</strong> （危险操作）</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> stu <span class="hljs-keyword">DROP</span> num;<br><span class="hljs-keyword">DESC</span> stu;<br><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> stu <span class="hljs-keyword">DROP</span> qq;<br><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> stu <span class="hljs-keyword">DROP</span> wechat;<br></code></pre></td></tr></table></figure><p>​      <br></p><p><strong>修改snam数据类型的属性</strong> </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">DESC</span> stu;<br><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> stu MODIFY sname <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">64</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">&#x27;姓名&#x27;</span>;<br></code></pre></td></tr></table></figure> <br><p><strong>将gender改为 sex 数据类型改为 CHAR类型</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> stu CHANGE gender sex <span class="hljs-type">CHAR</span>(<span class="hljs-number">4</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">&#x27;性别&#x27;</span>;<br></code></pre></td></tr></table></figure><h2 id="3-DCL-语句应用"><a href="#3-DCL-语句应用" class="headerlink" title="3. DCL 语句应用"></a>3. DCL 语句应用</h2><p><strong>DCL</strong>(Data Control Language)语句：数据控制语句，用于控制不同数据段直接的许可和访问级别的语句。这些语句定义了数据库、表、字段、用户的访问权限和安全级别。</p><p>DCL语句主要作用：<strong>用户权限控制</strong></p> <br><p><code>grant</code>  授权</p><p><code>revoke </code> 回收权限</p>  <br><h3 id="3-1-查看用户权限"><a href="#3-1-查看用户权限" class="headerlink" title="3.1 查看用户权限"></a>3.1 查看用户权限</h3> <br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">SHOW</span> GRANTS <span class="hljs-keyword">FOR</span> xin;<br><span class="hljs-operator">+</span><span class="hljs-comment">-------------------------------------------+</span><br><span class="hljs-operator">|</span> Grants <span class="hljs-keyword">for</span> xin@<span class="hljs-operator">%</span>                         <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">-------------------------------------------+</span><br><span class="hljs-operator">|</span> <span class="hljs-keyword">GRANT</span> <span class="hljs-keyword">ALL</span> PRIVILEGES <span class="hljs-keyword">ON</span> <span class="hljs-operator">*</span>.<span class="hljs-operator">*</span> <span class="hljs-keyword">TO</span> <span class="hljs-string">&#x27;xin&#x27;</span>@<span class="hljs-string">&#x27;%&#x27;</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">-------------------------------------------+ </span><br><span class="hljs-number">1</span> <span class="hljs-type">row</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)<br></code></pre></td></tr></table></figure> <br><h3 id="3-2-用户授权"><a href="#3-2-用户授权" class="headerlink" title="3.2 用户授权"></a>3.2 用户授权</h3> <br><p>对于新建的MySQL用户，必须给它授权，可以用<code>GRANT</code>语句来实现对新建用户的授权。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 授予数据库db1的所有权限给指定账户 </span><br><span class="hljs-keyword">GRANT</span> <span class="hljs-keyword">ALL</span> <span class="hljs-keyword">ON</span> db1.<span class="hljs-operator">*</span> <span class="hljs-keyword">TO</span> <span class="hljs-string">&#x27;user1&#x27;</span>@<span class="hljs-string">&#x27;localhost&#x27;</span>; <br><span class="hljs-comment">-- 授予角色给指定的账户 </span><br><span class="hljs-keyword">GRANT</span> <span class="hljs-string">&#x27;role1&#x27;</span>, <span class="hljs-string">&#x27;role2&#x27;</span> <span class="hljs-keyword">TO</span> <span class="hljs-string">&#x27;user1&#x27;</span>@<span class="hljs-string">&#x27;localhost&#x27;</span>, <span class="hljs-string">&#x27;user2&#x27;</span>@<span class="hljs-string">&#x27;localhost&#x27;</span>;<br></code></pre></td></tr></table></figure> <br><p>:::tip 数据库权限类型</p><ul><li><code>SELECT</code>：表示授予用户可以使用 SELECT 语句访问特定数据库中所有表和视图的权限。</li><li><code>INSERT</code>：表示授予用户可以使用 INSERT 语句向特定数据库中所有表添加数据行的权限。</li><li><code>DELETE</code>：表示授予用户可以使用 DELETE 语句删除特定数据库中所有表的数据行的权限。</li><li><code>UPDATE</code>：表示授予用户可以使用 UPDATE 语句更新特定数据库中所有数据表的值的权限。</li><li><code>REFERENCES</code>：表示授予用户可以创建指向特定的数据库中的表外键的权限。</li><li><code>CREATE</code>：表示授权用户可以使用 CREATE TABLE 语句在特定数据库中创建新表的权限。</li><li><code>ALTER</code>：表示授予用户可以使用 ALTER TABLE 语句修改特定数据库中所有数据表的权限。</li><li><code>SHOW VIEW</code>：表示授予用户可以查看特定数据库中已有视图的视图定义的权限。</li><li><code>CREATE ROUTINE</code>：表示授予用户可以为特定的数据库创建存储过程和存储函数的权限。</li><li><code>ALTER ROUTINE</code>：表示授予用户可以更新和删除数据库中已有的存储过程和存储函数的权限。</li><li><code>INDEX</code>：表示授予用户可以在特定数据库中的所有数据表上定义和删除索引的权限。</li><li><code>DROP</code>：表示授予用户可以删除特定数据库中所有表和视图的权限。</li><li><code>CREATE TEMPORARY TABLES</code>：表示授予用户可以在特定数据库中创建临时表的权限。</li><li><code>CREATE VIEW</code>：表示授予用户可以在特定数据库中创建新的视图的权限。</li><li><code>EXECUTE ROUTINE</code>：表示授予用户可以调用特定数据库的存储过程和存储函数的权限。</li><li><code>LOCK TABLES</code>：表示授予用户可以锁定特定数据库的已有数据表的权限。</li><li><code>SHOW DATABASES</code>：表示授权可以使用<code>SHOW DATABASES</code>查看所有已有的数据库的定义权限。</li><li><code>ALL</code>或<code>ALL PRIVILEGES</code>：表示以上所有权限。</li></ul><p>:::</p> <br><p>:::tip 表权限类型</p><ul><li><code>SELECT</code>：授予用户可以使用 SELECT 语句进行访问特定表的权限。</li><li><code>INSERT</code>：授予用户可以使用 INSERT 语句向一个特定表中添加数据行的权限。</li><li><code>DELETE</code>：授予用户可以使用 DELETE 语句从一个特定表中删除数据行的权限。</li><li><code>DROP</code>：授予用户可以删除数据表的权限。</li><li><code>UPDATE</code>：授予用户可以使用 UPDATE 语句更新特定数据表的权限。</li><li><code>ALTER</code>：授予用户可以使用 ALTER TABLE 语句修改数据表的权限。</li><li><code>REFERENCES</code>：授予用户可以创建一个外键来参照特定数据表的权限。</li><li><code>CREATE</code>：授予用户可以使用特定的名字创建一个数据表的权限。</li><li><code>INDEX</code>：授予用户可以在表上定义索引的权限。</li><li><code>ALL</code>或<code>ALL PRIVILEGES</code>：所有的权限名。</li></ul><p>:::</p> <br> <br><h3 id="3-3-权限回收"><a href="#3-3-权限回收" class="headerlink" title="3.3 权限回收"></a><strong>3.3 权限回收</strong></h3> <br><p><code>REVOKE</code>语句主要用于撤销权限。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">revoke</span> <span class="hljs-keyword">all</span> <span class="hljs-keyword">on</span> <span class="hljs-operator">*</span>.<span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> wang@<span class="hljs-string">&#x27;192.168.1.150&#x27;</span>;         <br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">revoke</span> <span class="hljs-keyword">all</span> privileges <span class="hljs-keyword">on</span> <span class="hljs-operator">*</span>.<span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> wang@<span class="hljs-string">&#x27;192.168.1.%&#x27;</span>;       <br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">revoke</span> <span class="hljs-keyword">insert</span>,<span class="hljs-keyword">select</span>,update,<span class="hljs-keyword">delete</span>,<span class="hljs-keyword">drop</span>，<span class="hljs-keyword">create</span>，<span class="hljs-keyword">alter</span> <span class="hljs-keyword">on</span> huanqiu.<span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> wang@<span class="hljs-string">&#x27;%&#x27;</span>;<br>mysql<span class="hljs-operator">&gt;</span> flush privileges<br></code></pre></td></tr></table></figure> <br> <br><h2 id="4-DML语句应用"><a href="#4-DML语句应用" class="headerlink" title="4. DML语句应用"></a>4. DML语句应用</h2> <br> <p><strong>主要作用：对数据行增删改</strong></p>  <br><h3 id="4-1-数据录入"><a href="#4-1-数据录入" class="headerlink" title="4.1 数据录入"></a>4.1 数据录入</h3>  <br><p><strong>INSERT 语句 两种方法：</strong></p><p><strong>最偷懒</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">INSERT</span> stu <span class="hljs-keyword">VALUES</span>(<span class="hljs-number">1</span>,<span class="hljs-string">&#x27;zs&#x27;</span>,<span class="hljs-number">18</span>,<span class="hljs-string">&#x27;m&#x27;</span>,NOW());<br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> stu;<br></code></pre></td></tr></table></figure><p><strong>最规范</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> stu(id,sname,age,sex,intime)<br><span class="hljs-keyword">VALUES</span> (<span class="hljs-number">2</span>,<span class="hljs-string">&#x27;ls&#x27;</span>,<span class="hljs-number">19</span>,<span class="hljs-string">&#x27;f&#x27;</span>,NOW());<br></code></pre></td></tr></table></figure>   <br><h4 id="4-1-1-针对性的录入数据"><a href="#4-1-1-针对性的录入数据" class="headerlink" title="4.1.1 针对性的录入数据"></a>4.1.1 针对性的录入数据</h4>  <br><p><strong>默认值的列不写</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> stu(sname,age,sex)<br><span class="hljs-keyword">VALUES</span> (<span class="hljs-string">&#x27;w5&#x27;</span>,<span class="hljs-number">11</span>,<span class="hljs-string">&#x27;m&#x27;</span>);<br></code></pre></td></tr></table></figure>   <br> <h4 id="4-1-2-一次性录入多行"><a href="#4-1-2-一次性录入多行" class="headerlink" title="4.1.2 一次性录入多行"></a>4.1.2 一次性录入多行</h4>  <br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> stu(sname,age,sex)<br><span class="hljs-keyword">VALUES</span> <br>(<span class="hljs-string">&#x27;aa&#x27;</span>,<span class="hljs-number">11</span>,<span class="hljs-string">&#x27;m&#x27;</span>),<br>(<span class="hljs-string">&#x27;bb&#x27;</span>,<span class="hljs-number">12</span>,<span class="hljs-string">&#x27;f&#x27;</span>),<br>(<span class="hljs-string">&#x27;cc&#x27;</span>,<span class="hljs-number">13</span>,<span class="hljs-string">&#x27;m&#x27;</span>);<br></code></pre></td></tr></table></figure>   <br>  <br><br><h3 id="4-2-数据行更新数据"><a href="#4-2-数据行更新数据" class="headerlink" title="4.2 数据行更新数据"></a>4.2 数据行更新数据</h3>  <br><p><strong>update 语句 (一定要加where条件)</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql">UPDATE stu <span class="hljs-keyword">SET</span> sname<span class="hljs-operator">=</span><span class="hljs-string">&#x27;aaa&#x27;</span>;<br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> stu;<br>UPDATE stu <span class="hljs-keyword">SET</span> sname<span class="hljs-operator">=</span><span class="hljs-string">&#x27;bb&#x27;</span> <span class="hljs-keyword">WHERE</span> id<span class="hljs-operator">=</span><span class="hljs-number">6</span>;<br></code></pre></td></tr></table></figure><br><p><strong>delete 语句删除数据行数据 (一定要有where条件)</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">FROM</span> stu;<br><span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">FROM</span> stu <span class="hljs-keyword">WHERE</span> id<span class="hljs-operator">=</span><span class="hljs-number">9</span>;<br></code></pre></td></tr></table></figure> <br><br><p><strong>生产中屏蔽delete功能，使用update 语句替代delete 语句操作</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> stu <span class="hljs-keyword">ADD</span> is_del TINYINT <span class="hljs-keyword">DEFAULT</span> <span class="hljs-number">0</span> ;<br>UPDATE stu <span class="hljs-keyword">SET</span> is_del<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">WHERE</span> id<span class="hljs-operator">=</span><span class="hljs-number">7</span>;<br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> stu <span class="hljs-keyword">WHERE</span> is_del<span class="hljs-operator">=</span><span class="hljs-number">0</span>;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>DBA</category>
      
    </categories>
    
    
    <tags>
      
      <tag>DBA</tag>
      
      <tag>RDBMS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SQL 基本概念引入</title>
    <link href="/2020/07/13/dba03/"/>
    <url>/2020/07/13/dba03/</url>
    
    <content type="html"><![CDATA[<h1 id="SQL-基本概念引入"><a href="#SQL-基本概念引入" class="headerlink" title="SQL 基本概念引入"></a>SQL 基本概念引入</h1><p>[[toc]]</p><h2 id="1-MySQL数据库的内置功能"><a href="#1-MySQL数据库的内置功能" class="headerlink" title="1. MySQL数据库的内置功能"></a>1. MySQL数据库的内置功能</h2><br><br><h3 id="1-1-连接数据库"><a href="#1-1-连接数据库" class="headerlink" title="1.1 连接数据库"></a>1.1 连接数据库</h3><p><strong>参数介绍</strong></p><p><strong>-u</strong>  &emsp;&emsp;指定登录用户</p><p><strong>-p</strong>  &emsp; &emsp;指定密码</p><p><strong>-S</strong>  &emsp;&emsp;使用Socket文件方式登录</p><p><strong>-h</strong>  &emsp;&emsp;指定远程主机登录地址</p><p><strong>-P</strong>  &emsp;&emsp;指定连接数据库的端口</p><p><strong>-e</strong>  &emsp;&emsp;免交互执行SQL语句</p><p><strong>&lt;</strong>  &emsp;&emsp; 恢复数据  后面加要导入的数据库数据</p><br><p><strong>例子:</strong></p><ol><li><p><code>mysql -uroot -p -S /tmp/mysql.sock</code></p></li><li><p><code>mysql -uroot -p -h10.0.0.51 -P3306</code></p></li><li><p><code>mysql -uroot -p -e &quot;show databases;&quot;</code> <strong>-e</strong> 参数  免交互执行sql语句</p></li><li><p><code>mysql -uroot -p123     &lt;  /root/world.sql</code>      <strong>恢复数据</strong>  后面加要导入的数据库数据</p></li></ol><br><h3 id="1-2-数据库内置命令"><a href="#1-2-数据库内置命令" class="headerlink" title="1.2 数据库内置命令"></a>1.2 数据库内置命令</h3><br><p><strong>help</strong>                    &emsp; &emsp; &emsp;     打印mysql帮助</p><p><strong>\c</strong>                &emsp;&emsp;&emsp;                ctrl+c    结束上个命令运行</p><p><strong>\q</strong>                  &emsp;&emsp;&emsp;              quit; exit;   ctrl+d   退出mysql</p><p><strong>\G</strong>                     &emsp;&emsp;&emsp;           将数据竖起来显示</p><p><strong>source</strong>          &emsp;&emsp;&emsp;              恢复备份文件    </p><br><br> <h2 id="2-SQL基础应用"><a href="#2-SQL基础应用" class="headerlink" title="2.  SQL基础应用"></a>2.  SQL基础应用</h2><br><h3 id="2-1-SQL介绍"><a href="#2-1-SQL介绍" class="headerlink" title="2.1 SQL介绍"></a>2.1 SQL介绍</h3><p>结构化的查询语言</p><p>关系型数据库通用的命令</p><p>遵循SQL92的标准(SQL_MODE)</p><br><h3 id="2-2-SQL常用种类"><a href="#2-2-SQL常用种类" class="headerlink" title="2.2 SQL常用种类"></a>2.2 SQL常用种类</h3><br><p><strong>DDL</strong> 数据定义语言</p><p><strong>DCL</strong> 数据控制语言</p><p><strong>DML</strong> 数据操作语言</p><p><strong>DQL</strong> 数据查询语言</p> <br><h2 id="3-SQL引入-数据库的逻辑结构"><a href="#3-SQL引入-数据库的逻辑结构" class="headerlink" title="3. SQL引入-数据库的逻辑结构"></a>3. SQL引入-数据库的逻辑结构</h2><br><ul><li><strong>库的逻辑结构</strong></li></ul><p>库名字</p><p>库属性:字符集,排序规则</p> <br><br><ul><li><strong>表的逻辑结构</strong></li></ul><p>表名</p><p>表属性:存储引擎类型,字符集,排序规则</p><p>列名</p><p>列属性:数据类型,约束,其他属性</p><p>数据行</p>  <br><br><h2 id="4-字符集-charset"><a href="#4-字符集-charset" class="headerlink" title="4. 字符集 (charset)"></a>4. 字符集 (charset)</h2>  <br> <p><strong>Charset</strong>   &emsp; 字符集</p><p><strong>字符集</strong>相当于MySQL数据库的密码本(编码表) 负责把SQL英文语句，转换成<strong>16进制存储</strong>。</p>  <br><p><strong>常用的字符集：</strong> </p><p><code>show charset;</code> 查询字符集</p><p><strong>utf8</strong>         : 占用3个字节</p><p><strong>utf8mb4</strong>  (:triangular_flag_on_post:建议) : 占用 4个字节,支持emoji和一些特殊字符。 </p>   <br>  <br><h2 id="5-排序规则"><a href="#5-排序规则" class="headerlink" title="5. 排序规则"></a>5. 排序规则</h2>  <br><p><strong>collation</strong>   &emsp; 排序规则  :baby_chick:</p><p>查看数据库支持的排序规则。</p><p><code>mysql&gt; show collation;</code>  </p><p>每一种字符集对应多个排序规则</p>   <br><p><strong>utf8mb4 常见的字符规则：</strong></p><p>用于需求 对于英文字符串的,大小写的敏感的数据库  wW ü</p><p><strong>utf8mb4_general_ci</strong>             大小写不敏感</p><p><strong>utf8mb4_bin</strong>                 大小写敏感(存拼音,日文)</p><p>​    <br></p>  <br><h2 id="6-数据类型介绍"><a href="#6-数据类型介绍" class="headerlink" title="6. 数据类型介绍"></a>6. 数据类型介绍</h2>   <br><h3 id="6-1-数字类型"><a href="#6-1-数字类型" class="headerlink" title="6.1 数字类型"></a>6.1 数字类型</h3><p>常用整数类型，如 <strong>TINYINT,INT</strong> 浮点数不太常用。</p><br><p> <img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section3-1-1.png" alt="数据类型介绍"></p><p>​    <br></p>  <br><h3 id="6-2-字符串类型"><a href="#6-2-字符串类型" class="headerlink" title="6.2 字符串类型"></a>6.2 字符串类型</h3><ul><li><p><strong>char</strong>(100)       </p></li><li><p>最多存储 <strong>255</strong> 个字符长度</p> <br></li></ul><p>定长字符串类型,不管字符串长度多长,都<strong>立即分配</strong>100个字符长度的存储空间,未占满的空间使用”空格”填充</p>   <br><ul><li><p><strong>varchar</strong>(100)  </p></li><li><p>最多存储 <strong>65535</strong> 个字符长度</p> <br></li></ul><p>变长字符串类型,每次存储数据之前,都要<strong>先判断</strong>一下长度,<strong>按需分配</strong>此盘空间.</p><p>会单独申请一个字符长度的空间存储字符长度 (:star:少于255,如果超过255以上,会占用两个存储空间):</p>   <br><p><strong>如何选择这两个数据类型?</strong></p>   <br><ul><li><p>少于255个字符串长度,定长的列值,选择 <strong>char</strong></p></li><li><p>多于255字符长度,变长的字符串,可以选择 <strong>varchar</strong></p> <br><br></li></ul><p><strong>Enum</strong> <strong>枚举数据类型</strong></p><p><strong>作用：将某一列可能的字符串定义枚举，进行下标</strong></p> <br><p><strong>例如：</strong> address enum(‘sz’,’sh’,’bj’…..)</p><p>下标成 1  2  3  顺序依次排列下去。</p><p><strong>悬念: 以上数据类型可能会影响到索引的性能​ :question:</strong></p>   <br>  <br><h3 id="6-3-时间类型"><a href="#6-3-时间类型" class="headerlink" title="6.3 时间类型"></a>6.3 时间类型</h3> <br><ul><li><strong>datetime</strong> </li></ul><p>范围为从 1000-01-01 00:00:00.000000 至 9999-12-31 23:59:59.999999。</p><ul><li><strong>timestamp</strong></li></ul><p>范围为从 1970-01-01 00:00:00.000000 至 2038-01-19 03:14:07.999999。</p>   <br><p><strong>timestamp</strong> 时区功能跟着时区自动变更时间</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section3-1-2.png" alt="时间类型介绍"></p><h3 id="6-4-二进制类型"><a href="#6-4-二进制类型" class="headerlink" title="6.4 二进制类型"></a><strong>6.4 二进制类型</strong></h3><br><p>关系型数据库不太擅长存储二进制类型数据。如：图片 、视频 、音频、文件。</p>]]></content>
    
    
    <categories>
      
      <category>DBA</category>
      
    </categories>
    
    
    <tags>
      
      <tag>DBA</tag>
      
      <tag>RDBMS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>体系结构及管理</title>
    <link href="/2020/07/12/dba02/"/>
    <url>/2020/07/12/dba02/</url>
    
    <content type="html"><![CDATA[<h1 id="体系结构及管理"><a href="#体系结构及管理" class="headerlink" title="体系结构及管理"></a>体系结构及管理</h1><p>[[toc]]</p><h2 id="1-MySQL-C-S结构介绍"><a href="#1-MySQL-C-S结构介绍" class="headerlink" title="1. MySQL C/S结构介绍"></a>1. MySQL C/S结构介绍</h2><br><p><strong>两种连接方式：</strong></p><p><strong>TCP/IP：</strong><code>mysql -uroot -xin123 -h 10.0.0.51 -P3306</code></p><p><strong>Socket：</strong><code>mysql -uroot -xin123 -S /tmp/mysql.sock</code></p><br><br><h2 id="2-MySQL实例的构成"><a href="#2-MySQL实例的构成" class="headerlink" title="2. MySQL实例的构成"></a>2. MySQL实例的构成</h2><br><p><strong>举例说明：</strong></p><p><strong>公司：</strong> 老板 + 经理 + 员工 + 办公区</p><p><strong>实例：</strong> mysqld + master thread + 干活的Thread + 预分配的内存</p><br><h2 id="3-MySQL中-mysqld-进程结构"><a href="#3-MySQL中-mysqld-进程结构" class="headerlink" title="3. MySQL中 mysqld 进程结构"></a>3. MySQL中 mysqld 进程结构</h2><br><h3 id="3-1-SQL语句引入"><a href="#3-1-SQL语句引入" class="headerlink" title="3.1 SQL语句引入"></a><strong>3.1 SQL语句引入</strong></h3><p><strong>结构化的查询语言:</strong></p><ul><li>DQL 数据查询语言</li><li>DDL 数据定义语言</li><li>DML 数据操作语言</li><li>DCL 数据控制语言</li></ul><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span>,host <span class="hljs-keyword">from</span> mysql.user;<br></code></pre></td></tr></table></figure><br><h3 id="3-2-连接层"><a href="#3-2-连接层" class="headerlink" title="3.2 连接层"></a><strong>3.2</strong> <strong>连接层</strong></h3><br><ol><li><strong>提供连接协议</strong> (两种方式)</li></ol><p>​      Socket</p><p>​      TCPIP</p><ol start="2"><li><p>验证用户名（<code>root@localhost</code>）密码合法性，进行匹配专门的授权表。</p></li><li><p>派生一个专用连接线程（接收SQL，返回结果）</p></li></ol><p>​      使用命令  <code>mysql&gt; show processlist;</code> 查看</p><br><p><strong>思考：</strong></p><p><strong>忘记密码的参数在哪做的手脚？</strong></p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ada"><span class="hljs-comment">--skip-grant-tables</span><br><span class="hljs-comment">--skip-networking</span><br></code></pre></td></tr></table></figure><br><h3 id="3-3-SQL层（在优化方面至关重要）"><a href="#3-3-SQL层（在优化方面至关重要）" class="headerlink" title="3.3 SQL层（在优化方面至关重要）"></a>3.3 SQL层（在优化方面至关重要）</h3><br><ul><li>验证SQL语法和SQL_MODE</li><li>验证语义</li><li>验证权限</li><li>解析器进行语句解析，生成执行计划（解析树）</li><li>优化器（各种算法，基于执行代价），根据算法，找到代价最低的执行计划。代价是指：CPU 磁盘 IO</li><li>执行器按照优化器选择执行计划，执行SQL语句，得出获取数据的方法。</li><li>提供query cache(默认不开)，一般不开，会用redis</li><li>记录操作日志（binlog），默认没开</li></ul><br><h3 id="3-4-存储引擎层"><a href="#3-4-存储引擎层" class="headerlink" title="3.4 存储引擎层"></a><strong>3.4</strong> <strong>存储引擎层</strong></h3><p><strong>真正和磁盘打交道的一个层次</strong></p><p>根据SQL层提供的取数据的方法，拿到数据，返回给SQL，结构化成表，再又连接层线程返回给用户。</p><br><h3 id="3-5-MySQL逻辑存储结构"><a href="#3-5-MySQL逻辑存储结构" class="headerlink" title="3.5 MySQL逻辑存储结构"></a><strong>3.5 MySQL逻辑存储结构</strong></h3><br><p>数据库逻辑结构与操作系统结构对照表：</p><table><thead><tr><th><img width=115/>数据库逻辑结构<img width=115/></th><th align="center"><img width=115/>操作系统<img width=115/></th></tr></thead><tbody><tr><td>库</td><td align="center">Linux 目录</td></tr><tr><td>create database wordpress charset utf8mb4;</td><td align="center">mkdir /wordpress</td></tr><tr><td>show databases;</td><td align="center">ls /</td></tr><tr><td>use wordpress;</td><td align="center">cd /wordpress</td></tr><tr><td>表</td><td align="center">Linux 的文件</td></tr><tr><td>列（字段）</td><td align="center">无</td></tr><tr><td>列属性</td><td align="center">无</td></tr><tr><td>数据行（记录）</td><td align="center">Linux数据行</td></tr><tr><td>表属性（元数据）</td><td align="center">Linux 文件属性</td></tr></tbody></table><br><br><h3 id="3-6-MySQL物理存储结构"><a href="#3-6-MySQL物理存储结构" class="headerlink" title="3.6 MySQL物理存储结构"></a><strong>3.6 MySQL物理存储结构</strong></h3><br><br><p><strong>库：</strong> 使用文件系统上的目录来表示</p><br><p><strong>表：</strong></p><ul><li><strong>MyISAM(类似ext2)</strong><br><br>user.frm ： 存储的表结构（列，列属性）<br><br>user.MYD : 存储的数据记录<br><br>user.MYI ： 存储索引<br></li></ul><br><ul><li><strong>InnoDB(类似XFS)<br></strong><br>time_zone.frm ： 存储的表结构（列，列属性）<br><br>time_zone.ibd ： 存储的数据记录和索引<br><br>ibdata1 : 数据字典信息<br></li></ul><br><h3 id="3-7-innodb-段-区-页概念"><a href="#3-7-innodb-段-区-页概念" class="headerlink" title="3.7 innodb 段 区 页概念"></a><strong>3.7 innodb</strong> 段 区 页概念</h3><br><ul><li>一般情况下（非分区表）</li><li>一个表就是一个段</li><li>一个段由多个区构成</li><li>一个区在（16k），64个连续的页，1M大小</li></ul><br><h2 id="4-用户和权限管理"><a href="#4-用户和权限管理" class="headerlink" title="4. 用户和权限管理"></a>4. 用户和权限管理</h2><h3 id="4-1作用"><a href="#4-1作用" class="headerlink" title="4.1作用"></a>4.1作用</h3><br><ul><li><p>登录MySQL</p></li><li><p>管理MySQL</p><br></li></ul><h3 id="4-2-用户的定义"><a href="#4-2-用户的定义" class="headerlink" title="4.2 用户的定义"></a><strong>4.2</strong> 用户的定义</h3><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">--用户名@&#x27;白名单&#x27;</span><br>wordpress@<span class="hljs-string">&#x27;%&#x27;</span><br>wordpress@<span class="hljs-string">&#x27;localhost&#x27;</span><br>wordpress@<span class="hljs-string">&#x27;127.0.0.1&#x27;</span><br>wordpress@<span class="hljs-string">&#x27;10.0.0.%&#x27;</span><br>wordpress@<span class="hljs-string">&#x27;10.0.0.5%&#x27;</span><br>wordpress@<span class="hljs-string">&#x27;10.0.0.0/255.255.254.0&#x27;</span><br>wordpress@<span class="hljs-string">&#x27;10.0.%&#x27;</span><br></code></pre></td></tr></table></figure><br><h3 id="4-3-用户的操作"><a href="#4-3-用户的操作" class="headerlink" title="4.3 用户的操作"></a>4.3 用户的操作</h3><h4 id="4-3-1-创建用户"><a href="#4-3-1-创建用户" class="headerlink" title="4.3.1 创建用户"></a>4.3.1 创建用户</h4><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">create</span> <span class="hljs-keyword">user</span> oldboy@<span class="hljs-string">&#x27;10.0.0.%&#x27;</span> identified <span class="hljs-keyword">by</span> <span class="hljs-string">&#x27;123&#x27;</span>;<br>Query OK, <span class="hljs-number">0</span> <span class="hljs-keyword">rows</span> affected (<span class="hljs-number">0.00</span> sec)<br></code></pre></td></tr></table></figure><p><strong>说明：</strong></p><p>8.0以前，可以自动创建用户并授权</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">grant</span> <span class="hljs-keyword">all</span> <span class="hljs-keyword">on</span> <span class="hljs-operator">*</span>.<span class="hljs-operator">*</span> <span class="hljs-keyword">to</span> oldguo@<span class="hljs-string">&#x27;10.0.0.%&#x27;</span> identified <span class="hljs-keyword">by</span> <span class="hljs-string">&#x27;123&#x27;</span>;<br></code></pre></td></tr></table></figure><br><h4 id="4-3-2-查询用户"><a href="#4-3-2-查询用户" class="headerlink" title="4.3.2 查询用户"></a>4.3.2 查询用户</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span>,host <span class="hljs-keyword">from</span> mysql.user;<br></code></pre></td></tr></table></figure><br><h4 id="4-3-3-修改用户密码"><a href="#4-3-3-修改用户密码" class="headerlink" title="4.3.3 修改用户密码"></a>4.3.3 修改用户密码</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">alter</span> <span class="hljs-keyword">user</span> oldguo@<span class="hljs-string">&#x27;10.0.0.%&#x27;</span> identified <span class="hljs-keyword">by</span> <span class="hljs-string">&#x27;123456&#x27;</span>;<br></code></pre></td></tr></table></figure><br><h4 id="4-3-4-删除用户"><a href="#4-3-4-删除用户" class="headerlink" title="4.3.4 删除用户"></a>4.3.4 删除用户</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">drop</span> <span class="hljs-keyword">user</span> oldguo@<span class="hljs-string">&#x27;10.0.0.%&#x27;</span> ;<br></code></pre></td></tr></table></figure><br><h3 id="4-4-权限管理"><a href="#4-4-权限管理" class="headerlink" title="4.4 权限管理"></a>4.4 权限管理</h3><h4 id="4-4-1-权限列表"><a href="#4-4-1-权限列表" class="headerlink" title="4.4.1 权限列表"></a>4.4.1 权限列表</h4><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">ALL</span> <br><span class="hljs-keyword">SELECT</span>,<span class="hljs-keyword">INSERT</span>, UPDATE, <span class="hljs-keyword">DELETE</span>, <span class="hljs-keyword">CREATE</span>, <span class="hljs-keyword">DROP</span>, RELOAD, SHUTDOWN, PROCESS, FILE, <span class="hljs-keyword">REFERENCES</span>, INDEX, <span class="hljs-keyword">ALTER</span>, <span class="hljs-keyword">SHOW</span> DATABASES, SUPER, <span class="hljs-keyword">CREATE</span> TEMPORARY TABLES, LOCK TABLES, <span class="hljs-keyword">EXECUTE</span>, REPLICATION SLAVE, REPLICATION CLIENT, <span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">VIEW</span>, <span class="hljs-keyword">SHOW</span> <span class="hljs-keyword">VIEW</span>, <span class="hljs-keyword">CREATE</span> ROUTINE, <span class="hljs-keyword">ALTER</span> ROUTINE, <span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">USER</span>, EVENT, <span class="hljs-keyword">TRIGGER</span>, <span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span>SPACE<br><span class="hljs-keyword">with</span> <span class="hljs-keyword">grant</span> option <span class="hljs-comment">--授权管理权限</span><br></code></pre></td></tr></table></figure><br> <h4 id="4-4-2-授权命令"><a href="#4-4-2-授权命令" class="headerlink" title="4.4.2 授权命令"></a>4.4.2 授权命令</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">grant</span> <span class="hljs-keyword">all</span> <span class="hljs-keyword">on</span> <span class="hljs-operator">*</span>.<span class="hljs-operator">*</span> <span class="hljs-keyword">to</span> oldguo@<span class="hljs-string">&#x27;10.0.0.%&#x27;</span> identified <span class="hljs-keyword">by</span> <span class="hljs-string">&#x27;123&#x27;</span> <span class="hljs-keyword">with</span> <span class="hljs-keyword">grant</span> option;<br> <br><span class="hljs-keyword">grant</span> 权限 <span class="hljs-keyword">on</span> 作用目标 <span class="hljs-keyword">to</span> 用户 identified <span class="hljs-keyword">by</span> 密码 <span class="hljs-keyword">with</span> <span class="hljs-keyword">grant</span> option;<br> <br><span class="hljs-keyword">grant</span> <span class="hljs-keyword">SELECT</span>,<span class="hljs-keyword">INSERT</span>, UPDATE, <span class="hljs-keyword">DELETE</span>, <span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">on</span> wordpress.<span class="hljs-operator">*</span> <span class="hljs-keyword">to</span> <br> <br><span class="hljs-comment">-- 作用目标:</span><br><span class="hljs-operator">*</span>.<span class="hljs-operator">*</span><br>wordpress.<span class="hljs-operator">*</span> <br>worpress.t1 <br></code></pre></td></tr></table></figure><br><h4 id="4-4-3-授权需求"><a href="#4-4-3-授权需求" class="headerlink" title="4.4.3 授权需求"></a>4.4.3 授权需求</h4><br><ol><li>创建一个管理员用户root，可以通过10网段，管理数据库.</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">grant</span> <span class="hljs-keyword">all</span> <span class="hljs-keyword">on</span> <span class="hljs-operator">*</span>.<span class="hljs-operator">*</span> <span class="hljs-keyword">to</span> root@<span class="hljs-string">&#x27;10.0.0.%&#x27;</span> identified <span class="hljs-keyword">by</span> <span class="hljs-string">&#x27;123&#x27;</span> <span class="hljs-keyword">with</span> <span class="hljs-keyword">grant</span> option;<br></code></pre></td></tr></table></figure><ol start="2"><li>创建一个应用用户wordpress，可以通过10网段，wordpress库下的所有表进行 <code>SELECT,INSERT, UPDATE, DELETE</code> 操作</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">grant</span> <span class="hljs-keyword">SELECT</span>,<span class="hljs-keyword">INSERT</span>, UPDATE, <span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">on</span> wordpress.<span class="hljs-operator">*</span> <span class="hljs-keyword">to</span> wordpress@<span class="hljs-string">&#x27;10.0.0.%&#x27;</span> identified <span class="hljs-keyword">by</span> <span class="hljs-string">&#x27;123&#x27;</span>;<br></code></pre></td></tr></table></figure><br><h4 id="4-4-4-回收权限"><a href="#4-4-4-回收权限" class="headerlink" title="4.4.4 回收权限"></a>4.4.4 回收权限</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">show</span> grants <span class="hljs-keyword">for</span> wordpress@<span class="hljs-string">&#x27;10.0.0.%&#x27;</span>;<br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">revoke</span> <span class="hljs-keyword">delete</span> <span class="hljs-keyword">on</span> wordpress.<span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;wordpress&#x27;</span>@<span class="hljs-string">&#x27;10.0.0.%&#x27;</span>;<br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">show</span> grants <span class="hljs-keyword">for</span> wordpress@<span class="hljs-string">&#x27;10.0.0.%&#x27;</span>;<br></code></pre></td></tr></table></figure><br><br><h4 id="4-4-5-关于生产中开用户"><a href="#4-4-5-关于生产中开用户" class="headerlink" title="4.4.5 关于生产中开用户"></a>4.4.5 关于生产中开用户</h4><br><p><font color=red><strong>如何沟通开用户</strong></font></p><ul><li>是否有邮件批复</li><li>对哪些库和表做操作</li><li>做什么操作</li><li>从什么地址来登录</li></ul><br><p><strong><font color=red>开发人员找你要root用户密码？</font></strong></p><ul><li>走流程拒绝他</li><li>如果是金融类的公司</li></ul><br><br><ul><li><strong><font color=red>原则上是不允许任何非DBA人员持有或申请root</font></strong></li><li><font color=red><strong>如果有人私下索要root密码，及时举报。</strong></font></li></ul><br><br><h2 id="5-MySQL的启动和关闭"><a href="#5-MySQL的启动和关闭" class="headerlink" title="5. MySQL的启动和关闭"></a>5. MySQL的启动和关闭</h2><br><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section2-2-1.png" alt="MySQL的启动和关闭"></p><p><strong>把 mysql.server 拷贝到了 init.d下</strong></p><br><br><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section2-2-2.png" alt="把 mysql.server 拷贝到了 init.d"></p><br><h3 id="5-1-日常启停"><a href="#5-1-日常启停" class="headerlink" title="5.1 日常启停"></a>5.1 日常启停</h3><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql">sys <span class="hljs-operator">-</span>v 启动方式 mysql.server <span class="hljs-keyword">start</span> 脚本   启动过程：调用<span class="hljs-comment">---&gt; mysqld_safe ---&gt;启动实例 mysqld </span><br>mysql.service   <span class="hljs-comment">---&gt; mysqld 直接调用 mysqld 指定配置文件</span><br></code></pre></td></tr></table></figure><br><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section2-2-3.png" alt="调用mysqld&quot;"></p><p>需要依赖于 <strong>/etc/my.cnf</strong></p><br><h3 id="5-2-维护性的任务方式启动"><a href="#5-2-维护性的任务方式启动" class="headerlink" title="5.2 维护性的任务方式启动"></a>5.2 维护性的任务方式启动</h3><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysqld_safe <span class="hljs-comment">--skip-grant-tables --skip-networking &amp;</span><br></code></pre></td></tr></table></figure><br><ul><li><p>启动时在命令行临时加入命令。</p></li><li><p>我们一般会将我们需要的参数临时加到命令行。也会读取<code>/etc/my.cnf</code> 的内容,但是如果冲突,命令行优先级最高。</p><br></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">mysqld_safe &amp;<br>mysqladmin -uroot -p123 shutdown <br></code></pre></td></tr></table></figure><br><br><h3 id="5-3-初始化配置"><a href="#5-3-初始化配置" class="headerlink" title="5.3 初始化配置"></a>5.3 初始化配置</h3><br><h4 id="5-3-1-作用"><a href="#5-3-1-作用" class="headerlink" title="5.3.1 作用"></a>5.3.1 作用</h4><ul><li>影响数据库的启动</li><li>影响到客户端的功能</li></ul><br><h4 id="5-3-2-初始化配置的方法"><a href="#5-3-2-初始化配置的方法" class="headerlink" title="5.3.2 初始化配置的方法"></a>5.3.2 初始化配置的方法</h4><br><ul><li>初始化配置文件(例如<code>/etc/my.cnf</code>)</li><li>启动命令行上进行设置(例如:<code>mysqld_safe mysqld</code>)</li><li>预编译时设置(仅限于编译安装时设置)<br></li></ul><h4 id="5-2-3-初始化配置文件的书写格式"><a href="#5-2-3-初始化配置文件的书写格式" class="headerlink" title="5.2.3 初始化配置文件的书写格式"></a>5.2.3 初始化配置文件的书写格式</h4><br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh">[标签]<br>xxx=xxx<br>[标签]<br>xxx=xxx<br></code></pre></td></tr></table></figure><br><h4 id="5-2-4-配置文件标签的归类"><a href="#5-2-4-配置文件标签的归类" class="headerlink" title="5.2.4 配置文件标签的归类"></a>5.2.4 配置文件标签的归类</h4><br><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-string">服务器端:</span><br>[<span class="hljs-string">mysqld</span>]<br>[<span class="hljs-string">mysqld_safe</span>]<br>[<span class="hljs-string">server</span>]<br> <br><span class="hljs-string">客户端:</span> <br>[<span class="hljs-string">mysql</span>]<br>[<span class="hljs-string">mysqladmin</span>]<br>[<span class="hljs-string">mysqldump</span>]<br>[<span class="hljs-string">client</span>]<br></code></pre></td></tr></table></figure><br><h4 id="5-2-5-配置文件设置样板（5-7版本"><a href="#5-2-5-配置文件设置样板（5-7版本" class="headerlink" title="5.2.5 配置文件设置样板（5.7版本)"></a>5.2.5 配置文件设置样板（5.7版本)</h4><br><p><strong>服务器端配置</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs shell">[mysqld]<br><span class="hljs-meta">#</span><span class="bash">用户</span><br>user=mysql  <br><span class="hljs-meta">#</span><span class="bash">软件安装目录</span>        <br>basedir=/application/mysql <br><span class="hljs-meta">#</span><span class="bash">数据路径</span><br>datadir=/data/mysql/data <br><span class="hljs-meta">#</span><span class="bash">socket文件位置</span><br>socket=/tmp/mysql.sock<br><span class="hljs-meta">#</span><span class="bash">服务器id号 用于主备</span><br>server_id=6<br><span class="hljs-meta">#</span><span class="bash">端口号</span><br>port=3306<br></code></pre></td></tr></table></figure><br><p><strong>客户端配置</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">[mysql]<br><span class="hljs-comment">#socket文件位置</span><br>socket=/tmp/mysql.sock<br></code></pre></td></tr></table></figure><br><h3 id="5-4-配置文件读取顺序"><a href="#5-4-配置文件读取顺序" class="headerlink" title="5.4 配置文件读取顺序"></a>5.4 配置文件读取顺序</h3><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysqld <span class="hljs-comment">--help --verbose |grep my.cnf</span><br><span class="hljs-operator">/</span>etc<span class="hljs-operator">/</span>my.cnf <span class="hljs-operator">/</span>etc<span class="hljs-operator">/</span>mysql<span class="hljs-operator">/</span>my.cnf <span class="hljs-operator">/</span>usr<span class="hljs-operator">/</span><span class="hljs-keyword">local</span><span class="hljs-operator">/</span>mysql<span class="hljs-operator">/</span>etc<span class="hljs-operator">/</span>my.cnf <span class="hljs-operator">~</span><span class="hljs-operator">/</span>.my.cnf <br></code></pre></td></tr></table></figure><br><p><strong>强制使用自定义配置文件</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">--defautls-file </span><br>mysqld_safe <span class="hljs-comment">--defaults-file=/tmp/aa.txt &amp;</span><br></code></pre></td></tr></table></figure><br><h3 id="5-5-MySQL的连接管理"><a href="#5-5-MySQL的连接管理" class="headerlink" title="5.5 MySQL的连接管理"></a>5.5 MySQL的连接管理</h3><br><h4 id="5-5-1-mysql-命令"><a href="#5-5-1-mysql-命令" class="headerlink" title="5.5.1 mysql 命令"></a>5.5.1 mysql 命令</h4><br><p><strong>注意:提前应该将用户授权做好</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">grant</span> <span class="hljs-keyword">all</span> <span class="hljs-keyword">on</span> <span class="hljs-operator">*</span>.<span class="hljs-operator">*</span> <span class="hljs-keyword">to</span> root@<span class="hljs-string">&#x27;10.0.0.%&#x27;</span> identified <span class="hljs-keyword">by</span> <span class="hljs-string">&#x27;123&#x27;</span>;<br>TCPIP :<br>mysql <span class="hljs-operator">-</span>uroot <span class="hljs-operator">-</span>p <span class="hljs-operator">-</span>h <span class="hljs-number">10.0</span><span class="hljs-number">.0</span><span class="hljs-number">.51</span> <span class="hljs-operator">-</span>P3306 <br>Socket <br>mysql <span class="hljs-operator">-</span>uroot <span class="hljs-operator">-</span>p <span class="hljs-operator">-</span>S <span class="hljs-operator">/</span>tmp<span class="hljs-operator">/</span>mysql.sock<br><span class="hljs-keyword">show</span> processlist; 查看登录情况<br></code></pre></td></tr></table></figure><br><h4 id="5-5-2-客户端工具"><a href="#5-5-2-客户端工具" class="headerlink" title="5.5.2 客户端工具"></a>5.5.2 客户端工具</h4><ul><li><strong>sqlyog</strong></li><li><strong>navicat</strong></li></ul><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/Section2-2-4.png" alt="客户端工具"><br><br></p><br><h2 id="6-多实例管理"><a href="#6-多实例管理" class="headerlink" title="6. 多实例管理"></a>6. 多实例管理</h2><br><h3 id="6-1-准备环境"><a href="#6-1-准备环境" class="headerlink" title="6.1 准备环境"></a>6.1 准备环境</h3><br><p><strong>准备多个目录</strong></p><br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">mkdir -p /data/330&#123;7,8,9&#125;/data<br></code></pre></td></tr></table></figure><br><p><strong>准备多个配置文件</strong></p><br><p><strong><font color=#E74C3C>实例一配置文件</font></strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs php">cat &gt; /data/<span class="hljs-number">3307</span>/my.cnf &lt;&lt;EOF<br><br>[mysqld]<br><br>basedir=/application/mysql<br><br>datadir=/data/<span class="hljs-number">3307</span>/data<br><br>socket=/data/<span class="hljs-number">3307</span>/mysql.sock<br><br>log_error=/data/<span class="hljs-number">3307</span>/mysql.log<br><br>port=<span class="hljs-number">3307</span><br><br>server_id=<span class="hljs-number">7</span><br><br>log_bin=/data/<span class="hljs-number">3307</span>/mysql-bin<br><br>EOF<br></code></pre></td></tr></table></figure><br><p><strong><font color=#3498DB>实例二配置文件</font></strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs php">cat &gt; /data/<span class="hljs-number">3308</span>/my.cnf &lt;&lt;EOF<br><br>[mysqld]<br><br>basedir=/application/mysql<br><br>datadir=/data/<span class="hljs-number">3308</span>/data<br><br>socket=/data/<span class="hljs-number">3308</span>/mysql.sock<br><br>log_error=/data/<span class="hljs-number">3308</span>/mysql.log<br><br>port=<span class="hljs-number">3308</span><br><br>server_id=<span class="hljs-number">8</span><br><br>log_bin=/data/<span class="hljs-number">3308</span>/mysql-bin<br><br>EOF<br></code></pre></td></tr></table></figure><br><p><font color=#27AE60><strong>实例三配置文件</strong></font></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs php">实例三配置文件 <br><br>cat &gt; /data/<span class="hljs-number">3309</span>/my.cnf &lt;&lt;EOF<br><br>[mysqld]<br><br>basedir=/application/mysql<br><br>datadir=/data/<span class="hljs-number">3309</span>/data<br><br>socket=/data/<span class="hljs-number">3309</span>/mysql.sock<br><br>log_error=/data/<span class="hljs-number">3309</span>/mysql.log<br><br>port=<span class="hljs-number">3309</span><br><br>server_id=<span class="hljs-number">9</span><br><br>log_bin=/data/<span class="hljs-number">3309</span>/mysql-bin<br><br>EOF<br></code></pre></td></tr></table></figure><br><br><h3 id="6-2-初始化三套数据"><a href="#6-2-初始化三套数据" class="headerlink" title="6.2 初始化三套数据"></a>6.2 初始化三套数据</h3><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">mv /etc/my.cnf /etc/my.cnf.bak<br>mysqld --initialize-insecure --user=mysql --datadir=/data/3307/data --basedir=/application/mysql<br>mysqld --initialize-insecure --user=mysql --datadir=/data/3308/data --basedir=/application/mysql<br>mysqld --initialize-insecure --user=mysql --datadir=/data/3309/data --basedir=/application/mysql<br></code></pre></td></tr></table></figure><br><h3 id="6-3-Systemd-命令管理多实例"><a href="#6-3-Systemd-命令管理多实例" class="headerlink" title="6.3 Systemd 命令管理多实例"></a>6.3 Systemd 命令管理多实例</h3><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> /etc/systemd/system<br><br>cp mysqld.service mysqld3307.service<br><br>cp mysqld.service mysqld3308.service<br><br>cp mysqld.service mysqld3309.service<br><br> <br><br>vim mysqld3307.service<br><br><span class="hljs-comment"># 修改为:</span><br><br>ExecStart=/application/mysql/bin/mysqld --defaults-file=/data/3307/my.cnf<br><br>vim mysqld3308.service<br><br><span class="hljs-comment"># 修改为:</span><br><br>ExecStart=/application/mysql/bin/mysqld --defaults-file=/data/3308/my.cnf<br><br>vim mysqld3309.service<br><br><span class="hljs-comment"># 修改为:</span><br><br>ExecStart=/application/mysql/bin/mysqld --defaults-file=/data/3309/my.cnf<br><br><br>[root@db01 system]<span class="hljs-comment"># grep &quot;ExecStart&quot; mysqld3309.service</span><br><br>ExecStart=/application/mysql/bin/mysqld --defaults-file=/data/3309/my.cnf<br><br>[root@db01 system]<span class="hljs-comment"># grep &quot;ExecStart&quot; mysqld3308.service</span><br><br>ExecStart=/application/mysql/bin/mysqld --defaults-file=/data/3308/my.cnf<br><br>[root@db01 system]<span class="hljs-comment"># grep &quot;ExecStart&quot; mysqld3307.service</span><br><br>ExecStart=/application/mysql/bin/mysqld --defaults-file=/data/3307/my.cnf<br></code></pre></td></tr></table></figure><br><p><strong>对目录授权</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">chown -R mysql.mysql /data/<br></code></pre></td></tr></table></figure><br><h3 id="6-4-启动多实例"><a href="#6-4-启动多实例" class="headerlink" title="6.4 启动多实例"></a>6.4 启动多实例</h3><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">systemctl start mysqld3307.service<br>systemctl start mysqld3308.service<br>systemctl start mysqld3309.service<br></code></pre></td></tr></table></figure><br><br><p><strong>验证多实例</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">netstat -lnp|grep 330<br><br>mysql -S /data/3307/mysql.sock -e <span class="hljs-string">&quot;select @@server_id&quot;</span><br>mysql -S /data/3308/mysql.sock -e <span class="hljs-string">&quot;select @@server_id&quot;</span><br>mysql -S /data/3309/mysql.sock -e <span class="hljs-string">&quot;select @@server_id&quot;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>DBA</category>
      
    </categories>
    
    
    <tags>
      
      <tag>DBA</tag>
      
      <tag>RDBMS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>数据库版本介绍与安装</title>
    <link href="/2020/07/11/dba01/"/>
    <url>/2020/07/11/dba01/</url>
    
    <content type="html"><![CDATA[<p>:::tip</p><p>   数据库是数据管理的有效技术，是由一批数据构成的有序集合，这些数据被存放在结构化的数据表里。数据表之间相互关联，反映客观事物间的本质联系。数据库能有效地帮助一个组织或企业科学地管理各类信息资源。数据是数据库中存储的基本对象，是按一定顺序排列组合的物理符号。</p><p>   数据有多种表现形式，可以是数字、文字、图像，甚至是音频或视频，它们都可以经过数字化后存入计算机。数据库是数据的集合，具有统一的结构形式并存放于统一的存储介质内，是多种应用数据的集成，并可被各个应用程序所共享。<br>:::</p><span id="more"></span><h2 id="1-DBA-职业素养"><a href="#1-DBA-职业素养" class="headerlink" title="1. DBA 职业素养"></a>1. DBA 职业素养</h2><p>::: tip   职业素养</p><p><strong>人品</strong>:  权利越大责任越大，要禁得住诱惑，严禁私自偷卖企业数据或向他人泄露秘钥信息。</p><p><strong>严谨</strong>:  操作数据库执行修改、删除类的命令时再三考虑，同事安排工作落实到笔头上，要有理论或者实践的支撑没测试过的参数绝对不能上生产环境。</p><p><strong>细心</strong>：请收起好奇心，做到敏感内容不听、不看、不问学会保护自己，把最简单的事情做的最漂亮，最专业。</p><p><strong>心态</strong>：在压力较大环境下做到不慌不乱，别惹事，出事别怕事。操作失误第一时间上报领导，不要自作主张操作。</p><p>:::</p><br><h3 id="1-1-职业技能"><a href="#1-1-职业技能" class="headerlink" title="1.1 职业技能"></a><strong>1.1 职业技能</strong></h3><ul><li>熟悉操作系统</li><li>熟悉公司业务</li><li>产品的功能</li><li>用户的行为(热功能,热数据）</li></ul><h3 id="1-2-熟悉行业"><a href="#1-2-熟悉行业" class="headerlink" title="1.2 熟悉行业"></a><strong>1.2 熟悉行业</strong></h3><ul><li>熟悉行业发展趋势</li><li>了解版本新特性及使用率</li><li>数据库产品类型</li><li>定期参加 <a href="https://db-engines.com/en/ranking">数据库大会</a></li></ul><br><p><strong>喜欢数据库</strong>：体验很重要 </p><br><p><strong>其实成功的门槛并不拥挤，因为大部分人在路上就放弃了。</strong>—— <a href="https://www.jianshu.com/u/44068ed972c7">Oldguo</a> </p><br><br><h2 id="2-数据库产品"><a href="#2-数据库产品" class="headerlink" title="2. 数据库产品"></a>2. 数据库产品</h2><p>4.1 什么是数据？</p><p>4.2 DBMS 数据库管理系统</p><p>RDBMS ： Oracle ，MySQL ，PG，MSSQL</p><p>NoSQL ： MongoDB ，Redis ，ES</p><p>NEWSQL （分布式）： TiDB，Spanner ，AliSQL(RDS+DRDS) ，OB ，PolarDB</p><h3 id="2-1-MySQL-版本选择"><a href="#2-1-MySQL-版本选择" class="headerlink" title="2.1 MySQL 版本选择"></a>2.1 MySQL 版本选择</h3><table><thead><tr><th>现阶段企业生产主要版本</th><th>更新版本</th></tr></thead><tbody><tr><td>5.6</td><td>5.6.34 ， 5.6.36 ，<strong>5.6.38</strong>（2017913） ，5.6.40</td></tr><tr><td>5.7</td><td>5.7.18 ，<strong>5.7.20</strong>（2017913） ，5.7.24 ，<strong>5.7.26</strong></td></tr><tr><td>8.0</td><td>8.0.14， 8.0.15 ，<strong>8.0.16</strong></td></tr></tbody></table><p><a href="https://downloads.mysql.com/archives/community/">官网下载地址</a></p><br><br><h3 id="2-2-MySQL安装方式"><a href="#2-2-MySQL安装方式" class="headerlink" title="2.2 MySQL安装方式"></a><strong>2.2 MySQL安装方式</strong></h3><ol><li><strong>二进制文件安装：</strong> 💗 <code>较多使用</code></li></ol><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/day01-1.png" alt="二进制文件安装"></p><ol><li><strong>RHEL RPM 包安装：</strong> </li></ol><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/day01-2.png" alt="二进制文件安装"></p><ol><li><strong>源代码编译</strong></li></ol><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/day01-3.png" alt="源代码编译"><br><br></p><br><h2 id="3-MySQL-二进制版本安装"><a href="#3-MySQL-二进制版本安装" class="headerlink" title="3. MySQL 二进制版本安装"></a>3. MySQL 二进制版本安装</h2><br><h3 id="3-1-下载并上传软件至目录"><a href="#3-1-下载并上传软件至目录" class="headerlink" title="3.1 下载并上传软件至目录"></a>3.1 <strong>下载并上传软件至目录</strong></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@m01 ~]<span class="hljs-comment"># mkdir -p /server/tools</span><br><br>[root@m01 ~]<span class="hljs-comment"># cd /server/tools/</span><br><br>[root@m01 /server/tools]<span class="hljs-comment"># yum install -y lrzsz</span><br><br>[root@m01 /server/tools]<span class="hljs-comment"># ls</span><br><br>mysql-5.7.26-linux-glibc2.12-x86_64.tar.gz<br></code></pre></td></tr></table></figure><p><strong>解压软件移动软件目录</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@m01 /server/tools]<span class="hljs-comment"># tar xf mysql-5.7.26-linux-glibc2.12-x86_64.tar.gz </span><br><br>[root@m01 ~]<span class="hljs-comment"># mkdir /application</span><br><br>[root@m01 /server/tools]<span class="hljs-comment"># mv mysql-5.7.26-linux-glibc2.12-x86_64 /application/mysql</span><br></code></pre></td></tr></table></figure><p><strong>用户的创建处理原始环境</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@m01 ~]# yum remove mariadb-libs-5.5.64-1.el7.x86_64  #卸载mariadb软件包<br><br>[root@m01 ~]# rpm -qa |grep mariadb<br><br>[root@m01 ~]# useradd -s /sbin/nologin mysql<br></code></pre></td></tr></table></figure><p><strong>数据和软件部分独立开 (贴近生产)</strong></p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/day01-4.png" alt="数据和软件部分独立开"></p><h3 id="3-2-设置环境变量"><a href="#3-2-设置环境变量" class="headerlink" title="3.2 设置环境变量"></a><strong>3.2 设置环境变量</strong></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell">vim /etc/profile<br>export PATH=/application/mysql/bin:$PATH<br><br>[root@m01 ~]# source /etc/profile<br>[root@m01 ~]# mysql -V   #测试安装成功<br>mysql Ver 14.14 Distrib 5.7.26, for linux-glibc2.12 (x86_64) using EditLine wrapper<br></code></pre></td></tr></table></figure><h3 id="3-3-创建数据路径并授权"><a href="#3-3-创建数据路径并授权" class="headerlink" title="3.3 创建数据路径并授权"></a><strong>3.3 创建数据路径并授权</strong></h3><p><strong>添加一块新磁盘模拟数据盘，格式化并挂载磁盘。</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@m01 ~]# mkfs.xfs /dev/sdc<br>[root@m01 ~]# mkdir /data<br>[root@m01 ~]# blkid  #查看硬盘UUID<br>[root@m01 ~]# vim /etc/fstab <br>[root@m01 ~]# UUID=&quot;b7fde522-aa37-412a-9584-8313a673c5cc&quot; /data xfs defaults 0 0<br>[root@m01 ~]# mount -a<br>[root@m01 ~]# df -h<br></code></pre></td></tr></table></figure><p><strong>对目录授权</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">chown -R mysql.mysql /application/*<br>chown -R mysql.mysql /data<br></code></pre></td></tr></table></figure><h3 id="3-4-初始化数据（创建系统数据）"><a href="#3-4-初始化数据（创建系统数据）" class="headerlink" title="3.4 初始化数据（创建系统数据）"></a><strong>3.4 初始化数据（创建系统数据）</strong></h3><p>5.6 版本 数据库初始化命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">/application/mysql/scripts/mysql_install_db <br></code></pre></td></tr></table></figure><p>5.7 版本及之后版本数据库初始化命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@m01 ~]# mkdir /data/mysql/data -p <br>[root@m01 ~]# chown -R mysql.mysql /data<br>[root@m01 ~]# mysqld --initialize --user=mysql --basedir=/application/mysql --datadir=/data/mysql/data <br></code></pre></td></tr></table></figure><br><p>:::tip 5.7 版本说明</p><p><strong>–initialize 参数：</strong> <strong>做了什么？</strong></p><p><strong>对于密码复杂度进行定制：12位，4种</strong> </p><p><strong>密码过期时间：180天</strong></p><p><strong>给root@localhost用户设置临时密码</strong></p><p>:::</p><br><br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">报错:mysqld: error while loading shared libraries: libaio.so.1: cannot open shared object file: No such file or directory<br><br>解决：[root@m01 ~]# yum install -y libaio-devel<br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@m01 ~]# mysqld --initialize --user=mysql --basedir=/application/mysql --datadir=/data/mysql/data<br>2020-02-13T05:22:37.726244Z 1 [Note] A temporary password is generated for root@localhost: =srV_)56)s4s<br></code></pre></td></tr></table></figure><br><br><p><strong>无临时密码方式 初始化方式</strong>：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@m01 /data/mysql/data]# \rm -rf /data/mysql/data/*<br>[root@m01 ~]# mysqld --initialize-insecure --user=mysql --basedir=/application/mysql --datadir=/data/mysql/data<br></code></pre></td></tr></table></figure><p> <strong>数据库配置文件的编写</strong></p><br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs shell">vim /etc/my.cnf <br>[mysqld]<br>user=mysql<br>basedir=/application/mysql<br>datadir=/data/mysql/data<br>socket=/tmp/mysql.sock<br>server_id=6 <br>port=3306<br>[mysql]<br>socket=/tmp/mysql.sock<br></code></pre></td></tr></table></figure><br><h3 id="3-5-启动数据库："><a href="#3-5-启动数据库：" class="headerlink" title="3.5 启动数据库："></a><strong>3.5 启动数据库</strong>：</h3><p>两种方式启动：</p><p><strong>1. sys-v</strong> </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@db01 /etc/init.d]# cp /application/mysql/support-files/mysql.server /etc/init.d/mysqld <br>[root@db01 /etc/init.d]# service mysqld restart<br></code></pre></td></tr></table></figure><p><strong>2. systemd</strong> </p><p>注意： sysv方式启动过的话，需要先提前关闭，才能以下方式登录</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs shell">cat &gt;/etc/systemd/system/mysqld.service &lt;&lt;EOF<br>[Unit]<br>Description=MySQL Server<br>Documentation=man:mysqld(8)<br>Documentation=http://dev.mysql.com/doc/refman/en/using-systemd.html<br>After=network.target<br>After=syslog.target<br>[Install]<br>WantedBy=multi-user.target<br>[Service]<br>User=mysql<br>Group=mysql<br>ExecStart=/application/mysql/bin/mysqld --defaults-file=/etc/my.cnf<br>LimitNOFILE = 5000<br>EOF<br></code></pre></td></tr></table></figure><br><br><h3 id="3-6-如何分析处理无法启动问题"><a href="#3-6-如何分析处理无法启动问题" class="headerlink" title="3.6 如何分析处理无法启动问题"></a><strong>3.6 如何分析处理无法启动问题</strong></h3><p>without updating PID 类似错误 </p><p><strong>查看日志：</strong></p><p><code>/data/mysql/data/主机名.err</code> </p><p><strong>[ERROR] 上下文</strong></p><p><strong>可能情况：</strong></p><p><code>/etc/my.cnf</code>  路径不对等</p><p><code>/tmp/mysql.sock </code>文件修改过 或 删除过 </p><p>数据目录权限不是 mysql</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-DBA/day01-5.png" alt="数据目录权限不是 mysql"></p><p><strong>第二种排错方法：</strong></p><p>数据库启动不了直接使用命令行启动 ，会把启动过程打印到屏幕</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">/application/mysql/bin/mysql --defaults-file=/etc/my.cnf<br></code></pre></td></tr></table></figure><h3 id="3-7-本地管理员密码的设定"><a href="#3-7-本地管理员密码的设定" class="headerlink" title="3.7 本地管理员密码的设定"></a><strong>3.7 本地管理员密码的设定</strong></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@db01 ~]# mysqladmin -uroot -p password xin123<br>Enter password: <br></code></pre></td></tr></table></figure><p><strong>管理员用户密码忘记了？</strong></p><p>临时性方法</p><p><code>--skip-grant-tables 跳过授权表</code></p><p><code>--skip-networking  跳过远程登录</code></p><p><strong>关闭数据库</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@db01 ~]# /etc/init.d/mysqld stop<br>Shutting down MySQL.. SUCCESS! <br></code></pre></td></tr></table></figure><p><strong>启动数据库到维护模式</strong></p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autoit">[root<span class="hljs-symbol">@db01</span> ~]<span class="hljs-meta"># mysqld_safe --skip-grant-tables --skip-networking &amp;</span><br></code></pre></td></tr></table></figure><p><strong>登录数据库内并修改密码</strong></p><p><strong>第一种方法</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span>,host,authentication_string <span class="hljs-keyword">from</span> mysql.user；<br>mysql.userflush privileges;<br><span class="hljs-keyword">grant</span> <span class="hljs-keyword">all</span> <span class="hljs-keyword">on</span> <span class="hljs-operator">*</span>.<span class="hljs-operator">*</span> <span class="hljs-keyword">to</span> root@<span class="hljs-string">&#x27;localhost&#x27;</span> identified <span class="hljs-keyword">by</span> <span class="hljs-string">&#x27;1&#x27;</span>;<br></code></pre></td></tr></table></figure><p><strong>第二种方法：</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">alter</span> <span class="hljs-keyword">user</span> root@<span class="hljs-string">&#x27;localhost&#x27;</span> identified <span class="hljs-keyword">by</span> <span class="hljs-string">&#x27;1&#x27;</span>;<br>ERROR <span class="hljs-number">1290</span> (HY000): The MySQL server <span class="hljs-keyword">is</span> <span class="hljs-keyword">running</span> <span class="hljs-keyword">with</span> the <span class="hljs-comment">--skip-grant-tables option so it cannot execute this statement</span><br>mysql<span class="hljs-operator">&gt;</span> flush privileges;<br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">alter</span> <span class="hljs-keyword">user</span> root@<span class="hljs-string">&#x27;localhost&#x27;</span> identified <span class="hljs-keyword">by</span> <span class="hljs-string">&#x27;1&#x27;</span>;<br><br>Query OK, <span class="hljs-number">0</span> <span class="hljs-keyword">rows</span> affected (<span class="hljs-number">0.01</span> sec)<br></code></pre></td></tr></table></figure> <br><br><p><strong>关闭数据库，正常启动验证</strong></p>]]></content>
    
    
    <categories>
      
      <category>DBA</category>
      
    </categories>
    
    
    <tags>
      
      <tag>DBA</tag>
      
      <tag>RDBMS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTTP 协议与网站原理介绍</title>
    <link href="/2019/11/22/webserver/"/>
    <url>/2019/11/22/webserver/</url>
    
    <content type="html"><![CDATA[<p><strong>当用户访问一个网站时，都发生了事情？</strong></p><p>用户在浏览器输入网址信息点击回车 <a href="www.ryanxin.com">ryanxin.com</a><br>客户端计算机完成域名的解析过程(DNS)后直接访问相应网站服务器建立TCP三次握手过程多次发送HTTP请求报文，服务端响应客户端请求多次回复HTTP响应报文，这时用户使用浏览器可以看到网站页面，用户关掉网页结束访问网站的过程，客户端计算机完成TCP四次挥手过程，客户端与服务端断开连接。</p><br><h2 id="1-DNS迭代查询"><a href="#1-DNS迭代查询" class="headerlink" title="1. DNS迭代查询"></a>1. DNS迭代查询</h2><p>利用DNS服务，将输入的域名解析为相应的IP地址。</p><p>① 本地主机输入域名后，会查询本地缓存信息和本地 hosts。<br>② 本地主机会向远程LDNS服务器，发送递归查询请求。<br>③ LDNS是网卡配置的DNS服务（223.5.5.5 114.114.114.114）。<br>④ LDNS服务器会向根域名服务器发出请求，将请求响应给LDNS服务器。<br>⑤ LDNS服务器会向顶级域名服务器发出请求，将请求响应给LDNS服务器。<br>⑥ LDNS服务器会向二级域名服务器发出请求，将请求响应给LDNS服务器。<br>⑦ LDNS服务器收到二级域名服务器响应过来的信息（解析记录），进行本地缓存将解析记录发送给本地主机。<br>⑧ 本地主机收到LDNS服务器的响应信息，也会将解析记录进行缓存，利用IP地址访问网站服务器。</p><br><h2 id="2-HTTP通讯原理说明"><a href="#2-HTTP通讯原理说明" class="headerlink" title="2. HTTP通讯原理说明"></a>2. HTTP通讯原理说明</h2><p>① 客户端与服务端建立连接<br>② 利用已知的IP地址，进行网络三次握手连接建立<br>③ 本地主机客户端向网站服务端，发出请求 http请求数据包（http请求报文）<br>④ 网站服务端向本地主机客户端，回复响应 http响应数据包（http响应报文）<br>⑤ 完成网络四次挥手断开过程</p><h2 id="3-HTTP协议的数据包"><a href="#3-HTTP协议的数据包" class="headerlink" title="3.HTTP协议的数据包"></a>3.HTTP协议的数据包</h2><p>HTTP请求报文</p><p><strong>1. 请求行</strong>     </p><p>①请求方法:     Get        –读/看    —获取/拿过来  post    – 写/提交<br>②请求信息:     index.html(首页文件)  oldboy.jpg<br>③请求协议:  http 1.1     </p><p>HTTP: 1.0    TCP短连接<br>HTTP: 1.1   TCP长连接<br>HTTP: 2.0   TCP长连接优化  提高用户并发(同时)访问的效率 </p><ol start="2"><li><strong>请求头</strong><br>请求主机信息</li></ol><ol start="3"><li>空行<br>用于区分头部和主体</li></ol><ol start="4"><li><strong>请求主体</strong><br>使用get方法时, 没有请求主体信息<br>使用post方法时,具有请求主体内容</li></ol><br><h3 id="3-2-HTTP响应报文"><a href="#3-2-HTTP响应报文" class="headerlink" title="3.2 HTTP响应报文"></a>3.2 HTTP响应报文</h3><br><ol><li><strong>起始行</strong> </li></ol><p>使用的什么服务 ?<br>状态码信息  访问请求是成功响应还是失败响应？<br>面试时可能问的问题: 写出几种常见的状态码? 例如： 301 302 404 500 403 200  </p><br><ol start="2"><li><strong>响应头部</strong></li></ol><p>字符集 UTF-8<br>文件类型<br>时间信息</p><br><ol start="3"><li><p> <strong>空行</strong></p></li><li><p> <strong>响应主体</strong></p></li></ol><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linuxlinux05-1.png" alt="linux05-1"></p><br><h2 id="4-常见的状态码"><a href="#4-常见的状态码" class="headerlink" title="4.常见的状态码"></a>4.常见的状态码</h2><br><table><thead><tr><th>状态代码</th><th>详细描述说明</th></tr></thead><tbody><tr><td>200  -  OK</td><td>服务器成功返回网页，这是成功的 HTTP 请求返回的标准状态码</td></tr><tr><td>301 - Moved Permanently</td><td>永久跳转，所请求的网页将永久跳转到被设定的新位置</td></tr><tr><td>403 - Forbidden</td><td>禁止访问，虽然这个请求是合法的，但是服务器端因为匹配了预先设置的规则而拒绝响应客户端的请求，此类问题一般为服务器或服务权限配置不当所致。</td></tr><tr><td>404 - Not Found</td><td>服务器找不到客户端请求的指定页面，可能是客户端请求了服务器上不存在的资源所致。</td></tr><tr><td>500  Internal Server Error</td><td>内部服务器错误，服务器遇到了意料不到的情况，不能完成客户端的请求。这是一个笼统的报错，一般为服务器的设置或内部程序问题导致。例如：SElinux 开启，而又没有为 HTTP 设置规则许可，此时客户端访问得到状态码就是500</td></tr><tr><td>502 - Bad Gateway （重点）</td><td>坏的网关，一般是代理服务器请求后端服务时，后端服务器不可用或没有完成响应网关服务器。这通常为反向代理服务器下面的节点出现问题所致。反向代理服务器无法与后面的 Web 服务节点服务器建立关系</td></tr><tr><td>503 - Service Unavailable</td><td>服务当前不可用，可能是服务器超载或停机维护导致的。或者是反向代理服务器后面没有可以提供服务的节点</td></tr><tr><td>504 - Gateway Timeout</td><td>网关超时，一般是网关代理服务器请求后端服务时，后端服务没有在特定的时间内完成处理请求。多数是服务器过载导致没有在指定的时间内返回数据给前端代理服务器</td></tr></tbody></table><br><h2 id="5-HTTP协议资源信息"><a href="#5-HTTP协议资源信息" class="headerlink" title="5. HTTP协议资源信息"></a>5. HTTP协议资源信息</h2><br><p>URL:  全称为<strong>Uniform Resource Location</strong>，中文翻译为统一资源定位符。</p><p>URI:  全称为<strong>Uniform Resource Identifier</strong>，中文翻译为统一资源标识符。</p><p>​    </p><p><strong>举例：</strong>  </p><p>URL : <a href="">docs.ansible.com</a>  </p><p>URI : <a href="/ansible/latest/user_guide/playbooks_reuse_roles.html">/ansible/latest/user_guide/playbooks_reuse_roles.html</a></p><p>​      <br></p><br><h3 id="5-1-网站页面静态资源"><a href="#5-1-网站页面静态资源" class="headerlink" title="5.1 网站页面静态资源"></a>5.1 网站页面静态资源</h3><br><p>::: tip 特点说明</p><p>要什么给我什么,  <code>xin.jpg  index.html</code> 标准文件后缀</p><ul><li><p>网页内容是固定不变的，因此，容易被搜索引擎收录（容易被用户找到）</p></li><li><p>因为网页没有数据库的支持，所以在网站制作和维护方面的工作量较大，当网站信息量很大时，完全依靠静态网页比较困难</p></li><li><p>网页的交互性较差，在程序的功能实现方面有较大的限制</p></li><li><p>当客户端向服务器请求数据时，服务器会直接从磁盘文件系统上返回数据（不做任何解析）。</p></li></ul><p>:::</p><br><h3 id="5-2-网站页面动态资源"><a href="#5-2-网站页面动态资源" class="headerlink" title="5.2 网站页面动态资源"></a>5.2 网站页面动态资源</h3><br><p>::: tip 特点说明</p><p>要什么信息,需要进行查询数据库进行解析后发送给客户端。</p><p><strong>例如：查看班级人员信息表</strong></p><p>班级  人名  年龄  学历</p><p>sz-01  张三  18   高中  —&gt; 数据库中 xin=123 &lt;— post  提交就自动存到数据库中</p><p>sz-01  李四  20   大专    </p><ul><li><p>代码信息直接调用数据库的内容</p></li><li><p>采用动态网页技术的网站可以实现更多的功能，如用户注册、用户登录、在线调查、</p></li><li><p>投票、用户管理、订单处理、发博文等。</p></li><li><p>动态资源页面会出现 “<code>?</code>“ “<code>&amp;</code>“, 不便于被搜索引擎收录</p></li><li><p>接收到用户请求,需要让动态服务和数据库服务进行处理</p></li></ul><p>:::</p><br><h3 id="5-3-伪静态资源"><a href="#5-3-伪静态资源" class="headerlink" title="5.3 伪静态资源"></a>5.3 伪静态资源</h3> <br><p>实际上就是把动态页面伪装成静态页面</p><ul><li><p> 可以便于搜索引擎进行收录</p></li><li><p>有数据库服务支持,实现网页交互功能</p></li></ul>]]></content>
    
    
    <categories>
      
      <category>linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux 服务</tag>
      
      <tag>网络协议</tag>
      
      <tag>Http</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linux的目录结构特点</title>
    <link href="/2019/11/21/Linux%E7%9A%84%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84/"/>
    <url>/2019/11/21/Linux%E7%9A%84%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84/</url>
    
    <content type="html"><![CDATA[<h1 id="Linux的目录结构特点"><a href="#Linux的目录结构特点" class="headerlink" title="Linux的目录结构特点"></a>Linux的目录结构特点</h1><br><h2 id="目录结构特点"><a href="#目录结构特点" class="headerlink" title="目录结构特点"></a>目录结构特点</h2><br><ul><li><p>一切从根root 开始</p></li><li><p>Linux中每个设备可以挂在任何目录上面</p></li><li><p>Linux下面设备没有挂载无法使用</p></li><li><p>linux中一切皆文件</p></li></ul><br><h2 id="什么是挂载？"><a href="#什么是挂载？" class="headerlink" title="什么是挂载？"></a>什么是挂载？</h2><br>把苹果挂载到树上 `mount`给磁盘分区 开了一个入口 进入到光盘中 入口=挂载点=目录<br><p><strong>举例：在 linux 系统下面使用光盘</strong><br><br><br><br></p><ol><li><p>把光盘放入光驱中</p></li><li><p>查看光盘 <code>ll  /dev/cdrom</code></p></li><li><p>使用光盘  <code>cat</code> 乱码</p></li><li><p>把光盘挂载  <code>mount /dev/cdrom /mnt/  read-only</code>  只读 <code>df-h</code> 查看系统空间谁挂载路径</p></li><li><p>进入目录使用</p></li><li><p><code>cd /mnt</code> 实际上进入了光盘 可以看到光盘内容 </p></li></ol><br><p>如果硬盘设备不挂载是没有访问入口的,就像房子没有大门，挂载就像给设备找了一个入口。</p><br><p><code>mount /dev/cdrom /mnt</code>  </p><p>设备                   <strong>挂载点(mount point)</strong></p><br>Linux下面设备(磁盘)不挂载是看不到入口的，没有窗户门的屋子，如果要设备被访问就必须有一个入口<br>，这个入口就是挂载点挂载点实质就是目录。<br><br><h2 id="Linux-目录结构详解"><a href="#Linux-目录结构详解" class="headerlink" title="Linux 目录结构详解"></a>Linux 目录结构详解</h2><br><table><thead><tr><th>目录名称</th><th>目录介绍</th></tr></thead><tbody><tr><td>/etc</td><td>配置文件</td></tr><tr><td>/home</td><td>用户的家目录，每一个用户的家目录通常默认为/home/USERNAME</td></tr><tr><td>/root</td><td>管理员的家目录</td></tr><tr><td>/lib</td><td>库文件 静态库：单在程序中的库，其他程序不能使用该库文件动态库：在内存中，任何用到该库的程序都可以使用</td></tr><tr><td>/lib/modules</td><td>内核模块文件</td></tr><tr><td>/media</td><td>挂载点目录，移动设备。在windows中，插入一张光盘，系统会自动读取光盘，用户可以直接执行，但在linux中，插入光盘后需要在挂载点挂载这个设备之后才可以使用这个设备</td></tr><tr><td>/mnt</td><td>挂载点目录，额外的临时文件系统</td></tr><tr><td>/opt</td><td>可选目录，第三方程序的安装目录</td></tr><tr><td>/proc</td><td>伪文件系统，内核映射文件</td></tr><tr><td>/sys</td><td>伪文件系统，跟硬件设备相关的属性映射文件</td></tr><tr><td>/tmp</td><td>临时文件</td></tr><tr><td>/var</td><td>可变化的文件，经常发生变化的文件</td></tr><tr><td>/bin</td><td>可执行文件，用户命令；其中用到的库文件可能在/lib，配置文件可能在/etc</td></tr><tr><td>/sbin</td><td>可执行文件，管理命令；其中用到的库文件可能在/lib，配置文件可能在/etc</td></tr><tr><td>/usr</td><td>只读文件，shared read-only</td></tr><tr><td>/usr/local</td><td>第三方软件</td></tr><tr><td>/boot</td><td>系统启动相关的文件，如内核、initrd，以及grub（BootLoader）</td></tr></tbody></table><p><a href="http://www.cnblogs.com/forlive/p/8081515.html">详细原文</a></p>]]></content>
    
    
    <categories>
      
      <category>linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux 学习之旅</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LNMP网站架构实战</title>
    <link href="/2019/11/21/lnmp/"/>
    <url>/2019/11/21/lnmp/</url>
    
    <content type="html"><![CDATA[<h1 id="LNMP网站架构实战"><a href="#LNMP网站架构实战" class="headerlink" title="LNMP网站架构实战"></a>LNMP网站架构实战</h1><p>[[toc]]</p><h2 id="1-实施步骤说明"><a href="#1-实施步骤说明" class="headerlink" title="1. 实施步骤说明"></a>1. 实施步骤说明</h2><br><br><p>:::tip 服务实施步骤</p><ul><li>了解LNMP架构的组成作用</li><li>架构的部署</li><li>架构通讯原理</li><li>LNMP服务之间如何建立管理</li><li>运维人员代码上线 </li><li>NFS服务器和Web服务器建立联系</li><li>数据库、存储远端迁移</li></ul><p>:::</p><br><br><h3 id="1-1-Nginx-模块回顾"><a href="#1-1-Nginx-模块回顾" class="headerlink" title="1.1 Nginx 模块回顾"></a>1.1 Nginx 模块回顾</h3><br><p><strong>Nginx 服务的企业应用 (nginx模块)</strong></p><ul><li><p>实现网站页面目录索引功能  (yum仓库搭建)</p></li><li><p>实现网站访问别名功能     server_name</p></li></ul><br><br><p><strong>实现网站页面用户访问监控</strong> </p><p><code>keepalived_timeout 65s</code></p><ul><li><p> HTTP请求报文: 请求头—connection: keepalived…/closed 短连接</p></li><li><p> HTTP响应报文: 响应头—connection: closed 短连接</p></li><li><p>VPN—无法访问外网/xshell无法远程连接</p></li></ul><br>   <br><p><strong>实现网站服务日志功能配置</strong> </p><p>错误日志: 错误日志级别 </p><p>访问日志: 日志的格式信息 自动化分析日志(ELK 三个软件)</p>  <br>  <br><p><strong>根据用户访问uri进行匹配处理</strong></p><ul><li><p>   <code>location = xxx</code>    精确匹配            优先级01</p></li><li><p>   <code>location ^~ xxx</code>   优先匹配               优先级02</p></li><li><p>  <code>location ~</code>        区分大小写匹配     优先级03</p></li><li><p>​     <code>location ~*</code>         不区分大小写        优先级03</p></li><li><p>​     <code>location uri</code>        根据uri进行匹配    优先级03</p></li><li><p>​     <code>location /</code>        默认匹配                 优先级最低</p></li></ul><p>​    </p>  <br>  <br><h3 id="1-2-企业应用-网站-location应用案例"><a href="#1-2-企业应用-网站-location应用案例" class="headerlink" title="1.2 企业应用: 网站 location应用案例"></a>1.2 企业应用: 网站 location应用案例</h3><p>例如在活动时期打折促销，网站的页面信息和平常不一样。我们不可能把平常的页面为活动直接进行修改，这时我们就需要调用一个专门在活动时上线的页面作为主站广告。<br>       <br></p><p><strong>有两个站点目录:</strong></p><ul><li>平常网站的站点目录   <code>/html/jd-normal</code></li><li>节日网站的站点目录   <code>/html/jd-teshu</code></li><li>​    <code>location / &#123; root /html/jd-normal &#125;</code></li><li>   <code>  location / 特殊     &#123; root /html/jd-teshu &#125;</code></li></ul><br>  <br><h3 id="1-3-网站页面跳转功能"><a href="#1-3-网站页面跳转功能" class="headerlink" title="1.3 网站页面跳转功能"></a>1.3 网站页面跳转功能</h3><p>​     </p><p>第一种方法：</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-section">server</span><br>&#123;<br>    <span class="hljs-attribute">location</span> / &#123;<br>        <span class="hljs-attribute">rewrite</span><span class="hljs-regexp"> ^/(.*)$</span> https://www.ryanxin.com/<span class="hljs-variable">$1</span> <span class="hljs-literal">permanent</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><br><br><p>第二种方法：</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-section">server</span><br>&#123;<br>    <span class="hljs-attribute">location</span> / &#123;<br>        <span class="hljs-attribute">return</span> <span class="hljs-number">301</span> https://www.ryanxin.com;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><br><br><h2 id="2-LNMP-架构介绍"><a href="#2-LNMP-架构介绍" class="headerlink" title="2.  LNMP 架构介绍"></a>2.  LNMP 架构介绍</h2><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-LinuxLNMP-2.png" alt="LNMP-2"></p><br><br><p><strong>L  代表 Linux系统</strong></p><p><strong>注意:</strong>  </p><ul><li> <code>selinux</code>必须关闭  防火墙关闭</li><li><code>/tmp 1777 mysql</code> 服务无法启动</li></ul><br><p><strong>N 代表 Nginx服务</strong></p><p><strong>作用:</strong></p><p>处理用户的静态请求 <code>html</code> <code>jpg</code> <code>txt</code> <code>mp4/avi</code></p><br><p><strong>P  代表  php 服务</strong></p><p><strong>作用:</strong></p><ul><li><p>处理动态的页面请求</p></li><li><p>负责和数据库建立关系</p><br></li></ul><p><strong>M  代表  mysql服务部署</strong> </p><br><p><strong>作用:</strong></p><p>存储用户的字符串数据信息</p><br><br><h2 id="3-网站的-LNMP-架构部署"><a href="#3-网站的-LNMP-架构部署" class="headerlink" title="3. 网站的 LNMP 架构部署"></a>3. 网站的 LNMP 架构部署</h2><h3 id="3-1创建虚拟用户和根目录"><a href="#3-1创建虚拟用户和根目录" class="headerlink" title="3.1创建虚拟用户和根目录"></a>3.1创建虚拟用户和根目录</h3><p><strong>创建用户</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">useradd -M -s /sbin/nologin www -u 1002<br>id www<br>systemctl restart nginx<br></code></pre></td></tr></table></figure><br><p><strong>创建战点根目录</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">mkdir -p /html/bbs/<br>chown -R www.www /html/bbs/<br></code></pre></td></tr></table></figure><br><h3 id="3-2-编写-Nginx-配置文件"><a href="#3-2-编写-Nginx-配置文件" class="headerlink" title="3.2 编写 Nginx 配置文件"></a>3.2 编写 Nginx 配置文件</h3><br><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">vim</span> /etc/nginx/nginx.conf<br><br>server &#123;<br><span class="hljs-attribute">server_name</span>    ryanxin.com;<br><span class="hljs-attribute">rewrite</span><span class="hljs-regexp"> ^/(.*)</span> http://www.ryanxin.com/<span class="hljs-variable">$1</span> <span class="hljs-literal">permanent</span>;<br>&#125;<br><br><span class="hljs-section">server</span> &#123;<br>      <span class="hljs-attribute">listen</span>    <span class="hljs-number">80</span>;<br>      <span class="hljs-attribute">server_name</span>   www.ryanxin.com;<br>      <span class="hljs-attribute">error_page</span>    <span class="hljs-number">500</span> <span class="hljs-number">502</span> <span class="hljs-number">503</span> <span class="hljs-number">504</span> /50x.html;<br>      <span class="hljs-attribute">location</span> / &#123;<br>      <span class="hljs-attribute">root</span>  /html/bbs;<br>      <span class="hljs-attribute">index</span>   index.html;<br>      &#125;<br>&#125;<br></code></pre></td></tr></table></figure><br><br><h3 id="3-3-安装数据库软件"><a href="#3-3-安装数据库软件" class="headerlink" title="3.3 安装数据库软件"></a>3.3 安装数据库软件</h3><br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs shell">yum install mariadb-server mariadb -y<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">补充: 数据库初始化过程 mysql_install_db</span><br><br>--basedir=path       The path to the MariaDB installation directory.<br>                     #指定mysql程序目录<br>--datadir=path       The path to the MariaDB data directory.<br>                     #指定数据信息保存的目录<br>--user=mysql             #让mysql管理数据目录  700<br></code></pre></td></tr></table></figure><br><br><p><strong>创建数据库的密码信息:</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">/application/mysql/bin/mysqladmin -u root      password <span class="hljs-string">&#x27;new-password&#x27;</span>  <span class="hljs-comment"># 给本地数据库设置密码</span><br>/application/mysql/bin/mysqladmin -u root -h web01 password <span class="hljs-string">&#x27;new-password&#x27;</span>  <span class="hljs-comment"># 给远程数据库设置密码</span><br><br>mysqladmin -u root  password <span class="hljs-string">&#x27;xin123&#x27;</span>    --- 设置密码  <br>mysql -u root -pxin123<br></code></pre></td></tr></table></figure><br><p><strong>启动数据库服务</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">systemctl start mariadb.service <br>systemctl enable mariadb.service<br></code></pre></td></tr></table></figure><br><br><h2 id="4-PHP服务部署流程"><a href="#4-PHP服务部署流程" class="headerlink" title="4. PHP服务部署流程"></a>4. PHP服务部署流程</h2><br><h3 id="4-1-更新-源卸载系统自带的PHP软件"><a href="#4-1-更新-源卸载系统自带的PHP软件" class="headerlink" title="4.1 更新 源卸载系统自带的PHP软件"></a>4.1 更新 源卸载系统自带的PHP软件</h3><p>​    <br></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">yum remove php-mysql php php-fpm php-common<br>rpm -Uvh https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm<br>rpm -Uvh https://mirror.webtatic.com/yum/el7/webtatic-release.rpm<br></code></pre></td></tr></table></figure><br><br><h3 id="4-2-安装-PHP"><a href="#4-2-安装-PHP" class="headerlink" title="4.2 安装 PHP"></a>4.2 安装 PHP</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">yum install -y php71w php71w-cli php71w-common php71w-devel php71w-embedded php71w-gd php71w-mcrypt php71w-mbstring php71w-pdo php71w-xml php71w-fpm php71w-mysqlnd php71w-opcache php71w-pecl-memcached php71w-pecl-redis php71w-pecl-mongodb<br></code></pre></td></tr></table></figure><br><br><h3 id="4-3-编写配置文件"><a href="#4-3-编写配置文件" class="headerlink" title="4.3 编写配置文件"></a>4.3 编写配置文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs BASH">vim /etc/php-fpm.d/www.conf<br>user = www  <br>group = www<br><span class="hljs-comment">#保证nginx进程的管理用户和php服务进程的管理用户保持一致</span><br>systemctl start php-fpm <br></code></pre></td></tr></table></figure><br><br><p><strong>LNMP 服务间调用图</strong></p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-LinuxLNMP-1.png" alt="LNMP-1"></p><br><p>Nginx 通过location匹配以PHP结尾的文件，调用Fastcgi接口执行fastcgi_pass 命令发送给PHP的php-fam进程接收，wrapper进程进行处理，处理后在原路返回给nginx最后客户端可以看到动态页面，如果需要调用数据库在通过php解析器解析成sql语句与数据库进行调用数据操作。最后生成动态页面返回给nginx客户端可以看到页面。</p> <br><p><strong>调用流程</strong></p><p>用户访问网站 — &gt; nginx(fastcgi_pass) –  FastCGI–&gt;  (php-fpm – wrapper) php (php解析器) —&gt;  mysql(读取或写入)</p> <br> <br><h2 id="5-实现-LNMP-架构服务之间建立关系"><a href="#5-实现-LNMP-架构服务之间建立关系" class="headerlink" title="5. 实现 LNMP 架构服务之间建立关系"></a>5. 实现 LNMP 架构服务之间建立关系</h2> <br><p>Nginx无法直接 和 数据库建立联系，因此要先和PHP 建立关系。</p> <br><h3 id="5-1-实现-Nginx与-PHP-建立关系"><a href="#5-1-实现-Nginx与-PHP-建立关系" class="headerlink" title="5.1 实现 Nginx与 PHP 建立关系"></a>5.1 实现 Nginx与 PHP 建立关系</h3><p><strong>编写 nginx 配置文件</strong></p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">location</span> <span class="hljs-regexp">~ \.php$</span> &#123; <br><span class="hljs-attribute">root</span> /www; <br><span class="hljs-attribute">fastcgi_index</span> index.php;  <br><span class="hljs-attribute">fastcgi_param</span> SCRIPT_FILENAME $document_root$fastcgi_script_name; <br><span class="hljs-attribute">fastcgi_pass</span> <span class="hljs-number">127.0.0.1:9000</span>; <br><span class="hljs-attribute">include</span> fastcgi_params;  <span class="hljs-comment">#变量配置文件 </span><br> &#125; <br></code></pre></td></tr></table></figure> <br><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">systemctl</span> nginx restart <span class="hljs-comment">#重启服务</span><br><br>server &#123;<br><span class="hljs-attribute">server_name</span> ryanxin.com<br>rewrite<span class="hljs-regexp"> ^/(.*)</span> http://www.ryanxin.com/<span class="hljs-variable">$1</span> <span class="hljs-literal">permanent</span>;<br>&#125;<br><br><span class="hljs-section">server</span> &#123;<br>    <span class="hljs-attribute">listen</span>   <span class="hljs-number">80</span>;<br>    <span class="hljs-attribute">server_name</span> www.ryanxin.com;<br>    <span class="hljs-attribute">error_page</span>  <span class="hljs-number">500</span> <span class="hljs-number">502</span> <span class="hljs-number">503</span> <span class="hljs-number">504</span> /50x.html;<br>    <span class="hljs-attribute">location</span> /&#123;<br>        <span class="hljs-attribute">root</span> /html/bbs;<br>        <span class="hljs-attribute">index</span> index.html;<br>    &#125;<br>    <br>   <span class="hljs-attribute">location</span> <span class="hljs-regexp">~ \.php$</span> &#123; <br>               <span class="hljs-attribute">root</span> /bbs; <br>               <span class="hljs-attribute">fastcgi_index</span> index.php;  <br>               <span class="hljs-attribute">fastcgi_param</span> SCRIPT_FILENAME $document_root$fastcgi_script_name; <br>               <span class="hljs-attribute">fastcgi_pass</span> <span class="hljs-number">127.0.0.1:9000</span>; <br>               <span class="hljs-attribute">include</span> fastcgi_params;   <br>    &#125;   <br> &#125; <br></code></pre></td></tr></table></figure><p> <br> <br></p><h3 id="5-2-编写动态资源文件测试页面"><a href="#5-2-编写动态资源文件测试页面" class="headerlink" title="5.2 编写动态资源文件测试页面"></a>5.2 编写动态资源文件测试页面</h3> <br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php">vim /html/blog/test_php.php  <br><span class="hljs-meta">&lt;?php</span> <br>phpinfo(); <br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure> <br><p><strong>浏览器输入地址进行访问测试</strong></p><p><a href="https://www.ryanxin.com/">http://www.ryanxin.com/index.php</a></p><p><strong>注意</strong> ： 要在本地Host文件手动添加域名地址，才能实现本地域名解析访问。</p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-LinuxLNMP-3.png" alt="LNMP-3"></p> <br> <br><h2 id="6-实现-PHP-与数据库建立关系"><a href="#6-实现-PHP-与数据库建立关系" class="headerlink" title="6. 实现 PHP 与数据库建立关系"></a>6. 实现 PHP 与数据库建立关系</h2> <br><h3 id="6-1-编写-PHP-连接数据库测试文件"><a href="#6-1-编写-PHP-连接数据库测试文件" class="headerlink" title="6.1 编写 PHP 连接数据库测试文件"></a>6.1 编写 PHP 连接数据库测试文件</h3> <br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment"># vim test_mysql.php </span><br><br><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-variable">$servername</span> = <span class="hljs-string">&quot;localhost&quot;</span>; <br><span class="hljs-variable">$username</span> = <span class="hljs-string">&quot;root&quot;</span>; <br><span class="hljs-variable">$password</span> = <span class="hljs-string">&quot;oldboy123&quot;</span>; <br><span class="hljs-comment">//$link_id=mysql_connect(&#x27;主机名&#x27;,&#x27;用户&#x27;,&#x27;密码&#x27;); </span><br><span class="hljs-comment">//mysql -u用户 -p密码 -h 主机 </span><br><span class="hljs-variable">$conn</span> = mysqli_connect(<span class="hljs-variable">$servername</span>, <span class="hljs-variable">$username</span>, <span class="hljs-variable">$password</span>); <br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$conn</span>) &#123; <br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;mysql successful by root !\n&quot;</span>; <br>&#125;<span class="hljs-keyword">else</span>&#123; <br><span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Connection failed: &quot;</span> . mysqli_connect_error());  <br>&#125; <br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure> <br> <br><h3 id="6-2-访问测试"><a href="#6-2-访问测试" class="headerlink" title="6.2 访问测试"></a>6.2 访问测试</h3><p><a href="https://www.ryanxin.com/">http://www.ryanxin.com/test_mysql.php</a></p><p><strong>如果连接成功</strong> ：提示 Mysql successful by root！ </p><p>失败则提示报错信息</p><br> <br><h2 id="7-部署搭建网站页面-代码上线"><a href="#7-部署搭建网站页面-代码上线" class="headerlink" title="7. 部署搭建网站页面 代码上线"></a>7. 部署搭建网站页面 代码上线</h2> <br><h3 id="7-1-常用的开源源码网站"><a href="#7-1-常用的开源源码网站" class="headerlink" title="7.1 常用的开源源码网站"></a>7.1 常用的开源源码网站</h3> <br><ul><li>​    <strong>主站网站页面</strong>: <a href="http://www.dedecms.com/">http://www.dedecms.com/</a></li><li>​    <strong>论坛网站页面</strong>: <a href="http://www.discuz.net/forum.php">http://www.discuz.net/forum.php</a></li><li>​    <strong>博客网站页面</strong>: <a href="https://cn.wordpress.org/">https://cn.wordpress.org/</a></li><li>​    <strong>知乎类型网站页面</strong>: <a href="http://www.wecenter.com/?copyright">http://www.wecenter.com/?copyright</a></li></ul> <br><h3 id="7-3-将源码解压后放入到站点目录中"><a href="#7-3-将源码解压后放入到站点目录中" class="headerlink" title="7.3 将源码解压后放入到站点目录中"></a>7.3 将源码解压后放入到站点目录中</h3> <br><p>这里演示的是 <a href="https://cn.wordpress.org/">Wordpress</a> 博客系统</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">tar xf wordpress-5.2.1.tar.gz<br>mv ./* /html/bbs<br></code></pre></td></tr></table></figure> <br><p><strong>修改站点目录权限</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">chown -R www.www blog<br></code></pre></td></tr></table></figure> <br> <br><h3 id="7-4-进行网站页面初始化操作"><a href="#7-4-进行网站页面初始化操作" class="headerlink" title="7.4 进行网站页面初始化操作"></a>7.4 进行网站页面初始化操作</h3> <br><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-LinuxLNMP-4.png" alt="LNMP-4"></p><br><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-LinuxLNMP-5.png" alt="LNMP-5"><br><br></p><h3 id="7-5-对数据库服务进行配置"><a href="#7-5-对数据库服务进行配置" class="headerlink" title="7.5 对数据库服务进行配置"></a>7.5 对数据库服务进行配置</h3><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">--创建数据库</span><br><span class="hljs-keyword">create</span> databases wordpress;  <br><br><span class="hljs-comment">--检查</span><br><span class="hljs-keyword">show</span> databases;<br><br><span class="hljs-comment">--创建数据库管理用户: </span><br><span class="hljs-keyword">grant</span> <span class="hljs-keyword">all</span> <span class="hljs-keyword">on</span> wordpress.<span class="hljs-operator">*</span> <span class="hljs-keyword">to</span> <span class="hljs-string">&#x27;wordpress&#x27;</span>@<span class="hljs-string">&#x27;localhost&#x27;</span> identified <span class="hljs-keyword">by</span> <span class="hljs-string">&#x27;xin123&#x27;</span>;<br><br><span class="hljs-comment">--检查</span><br><span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span>,host <span class="hljs-keyword">from</span> mysql.user <br><br><span class="hljs-comment">--优化: 删除无用的用户信息</span><br><br><span class="hljs-keyword">delete</span> <span class="hljs-keyword">from</span> mysql.user <span class="hljs-keyword">where</span> <span class="hljs-keyword">user</span><span class="hljs-operator">=</span>&quot;&quot; <span class="hljs-keyword">and</span> host<span class="hljs-operator">=</span>&quot;localhost&quot;;<br><span class="hljs-keyword">delete</span> <span class="hljs-keyword">from</span> mysql.user <span class="hljs-keyword">where</span> <span class="hljs-keyword">user</span><span class="hljs-operator">=</span>&quot;&quot; <span class="hljs-keyword">and</span> host<span class="hljs-operator">=</span>&quot;web01&quot;;<br><br>flush privileges; <br><br><span class="hljs-comment">--刷新</span><br></code></pre></td></tr></table></figure><br><p><strong>利用blog网站发布博文</strong></p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-LinuxLNMP-6.png" alt="LNMP-6"></p><br><h2 id="8-常见问题解决"><a href="#8-常见问题解决" class="headerlink" title="8. 常见问题解决"></a>8. 常见问题解决</h2><p><strong>上传wordpress主题,报413错误,如何解决?</strong></p><p>1.修改nginx配置文件</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">vim blog.conf<br>server &#123;<br>client_max_body_size 50m;  #指定用户上传数据的大小限制(默认1M)<br>&#125;<br></code></pre></td></tr></table></figure><ol><li>修改php.ini配置文件</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">upload_max_filesize = 50M   #使PHP接收用户上传的更大的数据(默认2M)<br></code></pre></td></tr></table></figure> <br>]]></content>
    
    
    <categories>
      
      <category>linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux 服务</tag>
      
      <tag>课程实战</tag>
      
      <tag>LNMP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Keepalived 高可用服务部署</title>
    <link href="/2019/11/20/Keepalived%20%E9%AB%98%E5%8F%AF%E7%94%A8%E6%9C%8D%E5%8A%A1%E9%83%A8%E7%BD%B2/"/>
    <url>/2019/11/20/Keepalived%20%E9%AB%98%E5%8F%AF%E7%94%A8%E6%9C%8D%E5%8A%A1%E9%83%A8%E7%BD%B2/</url>
    
    <content type="html"><![CDATA[<h2 id="Keepalived-高可用服务部署"><a href="#Keepalived-高可用服务部署" class="headerlink" title="Keepalived 高可用服务部署"></a>Keepalived 高可用服务部署</h2><br>Keepalived 软件最早是配合 LVS 负载均衡软件而设计的，    用来管理并监控LVS集群系统中各个服务节点的状态，后来又加入了VRRP 协议可以实现高可用的功能。<p style="overflow-wrap: break-word;margin-top: 1.5em;margin-bottom: 1.5em;line-height: 2em;"><span style="color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; white-space: pre-wrap;">  Keepalived软件主要是通过 VRRP 协议实现高可用功能的。VRRP 是Virtual Router Redundancy Protocol（虚拟路由器冗余协议）的缩写，VRRP出现的目的就是为了解决静态路由单点故障问题的，它能够保证当个别节点宕机时，整个网络可以不间断地运行  <br><h2 id="Keepalived-软件工作原理"><a href="#Keepalived-软件工作原理" class="headerlink" title="Keepalived 软件工作原理"></a>Keepalived 软件工作原理</h2><br>        期初 VRRP 的出现是为了解决静态路由的单点故障。    VRRP 是用过IP多播的方式实现高可用对之间通信的。    工作时主服务器节点发包，备服务器节点接包，当备服务器节点接收不到主服务器节点发的数据包的时候，    就启动接管程序接管主服务器节点的资源。备服务器节点可以有多个，通过优先级竞选。优先级数值越大优先级越大。<br> <br><h2 id="Keepalived-高可用服务部署-1"><a href="#Keepalived-高可用服务部署-1" class="headerlink" title="Keepalived 高可用服务部署"></a>Keepalived 高可用服务部署</h2><p>  第一步：确认反向代理服务是否工作正常<br>  在kl1和kl02服务器上测试web服务器是否可以正常<br>  （最好有3台反向代理功能的Web服务器）</p>  <figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs stylus">curl -H host:www<span class="hljs-selector-class">.rxinxin</span><span class="hljs-selector-class">.org</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">10.10</span>/webserver<span class="hljs-selector-class">.html</span><br>curl -H host:www<span class="hljs-selector-class">.rxinxin</span><span class="hljs-selector-class">.org</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">10.11</span>/webserver<span class="hljs-selector-class">.html</span><br>curl -H host:www<span class="hljs-selector-class">.rxinxin</span><span class="hljs-selector-class">.org</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">10.11</span>/webserver<span class="hljs-selector-class">.html</span><br>systemctl enable mariadb<br></code></pre></td></tr></table></figure><p>  第二步：在浏览器上测试访问kl1和kl2 域名</p><p>解析hosts文件，将域名解析为192.168.10.20，进行测试访问<br>解析hosts文件，将域名解析为192.168.10.30，进行测试访问</p>  <figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">测试前同步kl1和kl2的 Nginx 配置文件<br>scp -rp <span class="hljs-regexp">/app/</span>nginx<span class="hljs-regexp">/conf/</span>nginx.conf <span class="hljs-number">192.168</span>.<span class="hljs-number">10.30</span>:<span class="hljs-regexp">/app/</span>nginx<span class="hljs-regexp">/conf/</span>  <br></code></pre></td></tr></table></figure> <br><h3 id="安装-Keepalived-服务软件"><a href="#安装-Keepalived-服务软件" class="headerlink" title="安装 Keepalived 服务软件"></a>安装 Keepalived 服务软件</h3><p>  第一步：安装软件<br>  <figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmake">yum <span class="hljs-keyword">install</span> -y keepalived<br></code></pre></td></tr></table></figure><br><br><br>第二步：编写keepalived配置文件</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">vim <span class="hljs-regexp">/etc/</span>keepalived/keepalived.conf<br>man keepalived.conf   <span class="hljs-regexp">//</span>查看文件说明信息<br></code></pre></td></tr></table></figure><p>配置文件结构：</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">GLOBAL</span> <span class="hljs-keyword">CONFIGURATION</span>  <span class="hljs-comment">--- 全局配置</span><br>VRRPD <span class="hljs-keyword">CONFIGURATION</span>   <span class="hljs-comment">--- vrrp配置</span><br>LVS <span class="hljs-keyword">CONFIGURATION</span>     <span class="hljs-comment">--- LVS服务相关配置 （可以删掉不用） </span><br></code></pre></td></tr></table></figure><p>kl1主 负载均衡器配置</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs awk">global_defs &#123;    <span class="hljs-regexp">//</span>全局配置<br>router_id kl1   <span class="hljs-regexp">//</span>定义路由标识信息，相同局域网唯一<br>       &#125;<br>       <br>vrrp_instance klg1 &#123;  <span class="hljs-regexp">//</span>Vrrp 配置<br>state MASTER    <span class="hljs-regexp">//</span>定义实例中主备状态的角色（MASTER/BACKUP）<br>interface eth0  <span class="hljs-regexp">//</span>设置主备服务器虚拟IP地址放置网卡位置<br>virtual_router_id <span class="hljs-number">31</span> <span class="hljs-regexp">//</span>虚拟路由ID标识，不同实例不同，主备相同<br>priority <span class="hljs-number">150</span>   <span class="hljs-regexp">//</span>设置抢占优先级，数值越大越优先<br>advert_int <span class="hljs-number">1</span>  <span class="hljs-regexp">//</span>主备间通讯时间间隔<br>authentication &#123;  <span class="hljs-regexp">//</span>主备间通过认证建立连接<br>auth_type PASS<br>auth_pass <span class="hljs-number">1111</span><br>&#125;<br>virtual_ipaddress &#123;   定义主备服务器之间使用的虚拟IP地址信息<br><span class="hljs-number">192.168</span>.<span class="hljs-number">10.60</span>/<span class="hljs-number">24</span> dev eth0 label eth0:<span class="hljs-number">1</span><br>           &#125;<br>&#125;<br><br><span class="hljs-regexp">/etc/i</span>nit.d<span class="hljs-regexp">/keepalived reload  /</span><span class="hljs-regexp">/平滑重启 Keeplived </span><br></code></pre></td></tr></table></figure>  <br><p>kl2备 负载均衡器配置</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">global_defs &#123;<br>router_id kl2<br>       &#125;<br>vrrp_instance klg1 &#123;<br>state BACKUP<br><span class="hljs-keyword">interface</span> <span class="hljs-symbol">eth0</span><br><span class="hljs-symbol">virtual_router_id</span> <span class="hljs-symbol">31</span><br><span class="hljs-symbol">priority</span> <span class="hljs-symbol">100</span><br><span class="hljs-symbol">advert_int</span> <span class="hljs-symbol">1</span><br><span class="hljs-symbol">authentication</span> &#123;<br>auth_type PASS<br>auth_pass <span class="hljs-number">1111</span><br>&#125;<br>virtual_ipaddress &#123;<br><span class="hljs-number">192.168</span><span class="hljs-number">.10</span><span class="hljs-number">.60</span>/<span class="hljs-number">24</span> dev eth0 label eth0:<span class="hljs-number">1</span><br>&#125;<br>&#125;<br>/etc/init.d/keepalived reload<br></code></pre></td></tr></table></figure><h3 id="部署高可用服务时遇到的问题"><a href="#部署高可用服务时遇到的问题" class="headerlink" title="部署高可用服务时遇到的问题"></a>部署高可用服务时遇到的问题</h3><p> 同时在keepalived高可用集群中，出现了两个虚拟IP地址信息，这种情况就称为脑裂</p><p>  脑裂情况出现原因：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs markdown"><span class="hljs-bullet">1.</span> 心跳线出现问题<br>   网卡配置有问题<br>   交换设备有问题<br>   线缆连接有问题<br><span class="hljs-bullet">2.</span> 有防火墙软件阻止问题<br><span class="hljs-bullet">3.</span> virtual<span class="hljs-emphasis">_router_</span>id<br>   配置数值不正确  <br></code></pre></td></tr></table></figure><p> 总之：只要备服务器收不到主服务器发出的组播包，就会成为主服务器，而主服务器资源没有释放，备服务器要篡位就会出现脑裂。</p><br>  <br><h3 id="利用shell脚本实现监控管理"><a href="#利用shell脚本实现监控管理" class="headerlink" title="利用shell脚本实现监控管理"></a>利用shell脚本实现监控管理</h3><pre><code>备设备有 VIP 就是表示不正常</code></pre><ol><li>真正实现主备切换    2. 出现脑裂情况了</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br>check_info=$(ip a|grep -c 192.168.10.60) //定义一个参数为VIP地址 .60<br><span class="hljs-keyword">if</span> [ <span class="hljs-variable">$check_info</span> -ne 0 ]  //如果等于 0 <br><span class="hljs-keyword">then</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;keepalived server error!!!&quot;</span> //打印告警提示 keepalived 服务出现错误<br><span class="hljs-keyword">fi</span><br></code></pre></td></tr></table></figure><br><h3 id="Nginx反向代理监听虚拟IP地址"><a href="#Nginx反向代理监听虚拟IP地址" class="headerlink" title="Nginx反向代理监听虚拟IP地址"></a>Nginx反向代理监听虚拟IP地址</h3><ol><li>编写nginx反向代理配置</li></ol>  <figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs awk">  server &#123;<br>  listen      <span class="hljs-number">192.168</span>.<span class="hljs-number">10.60</span>:<span class="hljs-number">80</span>;<br>  server_name  www.rxinxin.org;<br>  root   html;<br>  index  index.html index.htm;<br>  location / &#123;<br>  proxy_pass http:<span class="hljs-regexp">//</span>xinxin;<br>  proxy_set_header host <span class="hljs-variable">$host</span>;<br>  proxy_set_header X-Forwarded-For <span class="hljs-variable">$remote_addr</span>;<br>        &#125;<br>  &#125;<br>  server &#123;<br>  listen       <span class="hljs-number">192.168</span>.<span class="hljs-number">10.60</span>:<span class="hljs-number">80</span>;<br>  server_name  bbs.rxinxin.org;<br>  root   html;<br>  index  index.html index.htm;<br>  location / &#123;<br>  proxy_pass http:<span class="hljs-regexp">//</span>xinxin;<br>  proxy_set_header host <span class="hljs-variable">$host</span>;<br>  proxy_set_header X-Forwarded-For <span class="hljs-variable">$remote_addr</span>;<br>       &#125;<br>    &#125;<br><span class="hljs-regexp">/application/</span>nginx<span class="hljs-regexp">/sbin/</span>nginx -s stop <span class="hljs-regexp">//</span>Nginx 更改ip 一定要重启<br><span class="hljs-regexp">/application/</span>nginx<span class="hljs-regexp">/sbin/</span>nginx<br>netstat -lntup|grep nginx <span class="hljs-regexp">//</span>查看端口<br>  tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">10.60</span>:<span class="hljs-number">80</span>                 <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:*                   LISTEN      <span class="hljs-number">53334</span>/nginx  虚拟IP地址<br></code></pre></td></tr></table></figure><br><p>实现监听本地网卡上没有的IP地址</p><p>  <code>echo &#39;net.ipv4.ip_nonlocal_bind = 1&#39; &gt;&gt;/etc/sysctl.conf 更改内核</code> </p><p>  <code>sysctl -p</code></p><br><h3 id="将高可用和反向代理服务建立联系"><a href="#将高可用和反向代理服务建立联系" class="headerlink" title="将高可用和反向代理服务建立联系"></a>将高可用和反向代理服务建立联系</h3><p>  因为Nginx 反向代理服务处于异常状态下，keepalived服务并没有从主服务器切换到备服务器，所以客户访问网站时反向代理服务一直处于挂了的异常状态导致网站无法正常访问。<br><br></p><p>实现的目的：Nginx反向代理服务停止，Keepalived服务也停止 </p><ol><li>编写脚本</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br>web_info=$(ps -ef|grep [n]ginx|wc -l) //当Nginx进程小于2时<br><span class="hljs-keyword">if</span> [ <span class="hljs-variable">$web_info</span> -lt 2 ]<br><span class="hljs-keyword">then</span><br>/etc/init.d/keepalived stop   //关闭keepalived 服务<br><span class="hljs-keyword">fi</span><br></code></pre></td></tr></table></figure><p>2.运行脚本，实现监控nginx服务</p><p>  编辑keepalived服务配置文件</p>  <figure class="highlight plaintext"><figcaption><span>check_web &#123;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs vrrp_script">#定义一个监控脚本，脚本必须有执行权限<br>script &quot;/server/scripts/check_web.sh&quot;    <br>#指定脚本间隔时间<br>  interval 2   <br>  #脚本执行完成，让优先级值和权重值进行运算，从而实现主备切换<br>  weight 2                                                                            <br>  &#125;<br>  track_script &#123;<br>  check_web<br>  &#125;<br></code></pre></td></tr></table></figure><p>chmod +x check_kls.sh   给予脚本可执行权限</p><br><h3 id="实现高可用集群架构中双主配置（互为主备配置）"><a href="#实现高可用集群架构中双主配置（互为主备配置）" class="headerlink" title="实现高可用集群架构中双主配置（互为主备配置）"></a>实现高可用集群架构中双主配置（互为主备配置）</h3><p>  由于企业实际环境，很少等主服务器挂掉才调用备服务器，所以会将Web服务分配给两节点或多个集群并行使用节约成本。</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">kl1<br>vrrp_instance klg1 &#123;<br> state MASTER<br> <span class="hljs-keyword">interface</span> <span class="hljs-symbol">eth0</span><br> <span class="hljs-symbol">virtual_router_id</span> <span class="hljs-symbol">31</span><br> <span class="hljs-symbol">priority</span> <span class="hljs-symbol">150</span><br> <span class="hljs-symbol">advert_int</span> <span class="hljs-symbol">1</span><br> <span class="hljs-symbol">authentication</span> &#123;<br> auth_type PASS<br> auth_pass <span class="hljs-number">1111</span><br>    &#125;<br>virtual_ipaddress &#123;<br> <span class="hljs-number">192.168</span><span class="hljs-number">.10</span><span class="hljs-number">.60</span>/<span class="hljs-number">24</span> dev eth0 label eth0:<span class="hljs-number">1</span><br>    &#125;<br>    &#125;<br>vrrp_instance klg2 &#123;<br>  state BACKUP<br>  <span class="hljs-keyword">interface</span> <span class="hljs-symbol">eth0</span><br>  <span class="hljs-symbol">virtual_router_id</span> <span class="hljs-symbol">32</span><br>  <span class="hljs-symbol">priority</span> <span class="hljs-symbol">100</span><br>  <span class="hljs-symbol">advert_int</span> <span class="hljs-symbol">1</span><br>  <span class="hljs-symbol">authentication</span> &#123;<br>  auth_type PASS<br>  auth_pass <span class="hljs-number">1111</span><br>    &#125;<br>virtual_ipaddress &#123;<br>  <span class="hljs-number">192.168</span><span class="hljs-number">.10</span><span class="hljs-number">.80</span>/<span class="hljs-number">24</span> dev eth0 label eth0:<span class="hljs-number">1</span><br>    &#125;<br>    &#125;<br></code></pre></td></tr></table></figure><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">  kl2<br>vrrp_instance klg1 &#123;<br>  state BACKUP<br>  <span class="hljs-keyword">interface</span> <span class="hljs-symbol">eth0</span><br>  <span class="hljs-symbol">virtual_router_id</span> <span class="hljs-symbol">31</span><br>  <span class="hljs-symbol">priority</span> <span class="hljs-symbol">100</span><br>  <span class="hljs-symbol">advert_int</span> <span class="hljs-symbol">1</span><br>  <span class="hljs-symbol">authentication</span> &#123;<br>  auth_type PASS<br>  auth_pass <span class="hljs-number">1111</span><br>    &#125;<br>  virtual_ipaddress &#123;<br>  <span class="hljs-number">192.168</span><span class="hljs-number">.10</span><span class="hljs-number">.60</span>/<span class="hljs-number">24</span> dev eth0 label eth0:<span class="hljs-number">1</span><br>       &#125;<br>    &#125;<br>  vrrp_instance klg2 &#123;<br>    state MASTER<br>    <span class="hljs-keyword">interface</span> <span class="hljs-symbol">eth0</span><br>    <span class="hljs-symbol">virtual_router_id</span> <span class="hljs-symbol">32</span><br>    <span class="hljs-symbol">priority</span> <span class="hljs-symbol">150</span><br>    <span class="hljs-symbol">advert_int</span> <span class="hljs-symbol">1</span><br>    <span class="hljs-symbol">authentication</span> &#123;<br>    auth_type PASS<br>    auth_pass <span class="hljs-number">1111</span><br>    &#125;<br>    virtual_ipaddress &#123;<br>    <span class="hljs-number">192.168</span><span class="hljs-number">.10</span><span class="hljs-number">.80</span>/<span class="hljs-number">24</span> dev eth0 label eth0:<span class="hljs-number">1</span><br>    &#125;<br>    &#125; <br><br></code></pre></td></tr></table></figure><pre><code>最后修改 Nginx 反向代理服务配置文件的监听IP地址信息 完成对 Keepalived 互为主备节点的配置部署。</code></pre>]]></content>
    
    
    <categories>
      
      <category>linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux 学习之旅</tag>
      
      <tag>高可用</tag>
      
      <tag>Linux 服务</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Keepalived 高可用服务部署</title>
    <link href="/2019/11/20/linux3/"/>
    <url>/2019/11/20/linux3/</url>
    
    <content type="html"><![CDATA[<h1 id="Keepalived-高可用服务部署"><a href="#Keepalived-高可用服务部署" class="headerlink" title="Keepalived 高可用服务部署"></a>Keepalived 高可用服务部署</h1><p>​    Keepalived 软件最早是配合 LVS 负载均衡软件而设计的，用来管理并监控LVS集群系统中各个服务节点的状态，后来又加入了VRRP 协议可以实现高可用的功能。</p><p>软件主要是通过 VRRP 协议实现高可用功能的,VRRP 是Virtual Router Redundancy Protocol（虚拟路由器冗余协议）的缩写，VRRP出现的目的就是为了解决静态路由单点故障问题的，它能够保证当个别节点宕机时，整个网络可以不间断地运行</p><h2 id="一、Keepalived-软件工作原理"><a href="#一、Keepalived-软件工作原理" class="headerlink" title="一、Keepalived 软件工作原理"></a>一、Keepalived 软件工作原理</h2><p>​      </p><p>  启初 VRRP 的出现是为了解决静态路由的单点故障。VRRP 是用过IP多播的方式实现高可用对之间通信的。工作时主服务器节点发包，备服务器节点接包，当备服务器节点接收不到主服务器节点发的数据包的时候，就启动接管程序接管主服务器节点的资源。备服务器节点可以有多个，通过优先级竞选。优先级数值越大优先级越大。</p><h2 id="二、Keepalived-高可用服务部署"><a href="#二、Keepalived-高可用服务部署" class="headerlink" title="二、Keepalived 高可用服务部署"></a>二、Keepalived 高可用服务部署</h2><h3 id="1-确认反向代理服务是否工作正常"><a href="#1-确认反向代理服务是否工作正常" class="headerlink" title="1.确认反向代理服务是否工作正常"></a>1.确认反向代理服务是否工作正常</h3><p>在kl1和kl02服务器上测试web服务器是否可以正常（最好有3台反向代理功能的Web服务器）</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">curl -H host:www.rxinxin.org 192.168.10.10/webserver.html<br>curl -H host:www.rxinxin.org 192.168.10.11/webserver.html<br>curl -H host:www.rxinxin.org 192.168.10.11/webserver.html<br>systemctl <span class="hljs-built_in">enable</span> mariadb<br></code></pre></td></tr></table></figure><h3 id="2-在浏览器上测试访问kl1和kl2-域名"><a href="#2-在浏览器上测试访问kl1和kl2-域名" class="headerlink" title="2.在浏览器上测试访问kl1和kl2 域名"></a>2.在浏览器上测试访问kl1和kl2 域名</h3><p>解析hosts文件，将域名解析为192.168.10.20，进行测试访问</p><p>解析hosts文件，将域名解析为192.168.10.30，进行测试访问</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">测试前同步kl1和kl2的 Nginx 配置文件<br>scp -rp /app/nginx/conf/nginx.conf 192.168.10.30:/app/nginx/conf/  <br></code></pre></td></tr></table></figure><h2 id="三、安装-Keepalived-服务软件"><a href="#三、安装-Keepalived-服务软件" class="headerlink" title="三、安装 Keepalived 服务软件"></a>三、安装 Keepalived 服务软件</h2><p>  第一步：安装软件<br>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">yum install -y keepalived<br></code></pre></td></tr></table></figure></p><p>第二步：编写keepalived配置文件</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">vim <span class="hljs-regexp">/etc/</span>keepalived/keepalived.conf<br>man keepalived.conf   <span class="hljs-regexp">//</span>查看文件说明信息<br></code></pre></td></tr></table></figure><p>配置文件结构：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bashba">GLOBAL CONFIGURATION  --- 全局配置<br>VRRPD CONFIGURATION   --- vrrp配置<br>LVS CONFIGURATION     --- LVS服务相关配置 （可以删掉不用） <br></code></pre></td></tr></table></figure><p>kl1主 负载均衡器配置</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs bash">global_defs &#123;    //全局配置<br>router_id kl1   //定义路由标识信息，相同局域网唯一<br>       &#125;<br>       <br>vrrp_instance klg1 &#123;  //Vrrp 配置<br>state MASTER    //定义实例中主备状态的角色（MASTER/BACKUP）<br>interface eth0  //设置主备服务器虚拟IP地址放置网卡位置<br>virtual_router_id 31 //虚拟路由ID标识，不同实例不同，主备相同<br>priority 150   //设置抢占优先级，数值越大越优先<br>advert_int 1  //主备间通讯时间间隔<br>authentication &#123;  //主备间通过认证建立连接<br>auth_type PASS<br>auth_pass 1111<br>&#125;<br>virtual_ipaddress &#123;   定义主备服务器之间使用的虚拟IP地址信息<br>192.168.10.60/24 dev eth0 label eth0:1<br>           &#125;<br>&#125;<br><br>/etc/init.d/keepalived reload  //平滑重启 Keeplived <br></code></pre></td></tr></table></figure><p>kl2备 负载均衡器配置</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs sh">global_defs &#123;<br>router_id kl2<br>       &#125;<br>vrrp_instance klg1 &#123;<br>state BACKUP<br>interface eth0<br>virtual_router_id 31<br>priority 100<br>advert_int 1<br>authentication &#123;<br>auth_type PASS<br>auth_pass 1111<br>&#125;<br>virtual_ipaddress &#123;<br>192.168.10.60/24 dev eth0 label eth0:1<br>&#125;<br>&#125;<br>/etc/init.d/keepalived reload<br></code></pre></td></tr></table></figure><h2 id="四、部署高可用服务时遇到的问题"><a href="#四、部署高可用服务时遇到的问题" class="headerlink" title="四、部署高可用服务时遇到的问题"></a>四、部署高可用服务时遇到的问题</h2><p> 同时在keepalived高可用集群中，出现了两个虚拟IP地址信息，这种情况就称为脑裂</p><p>  脑裂情况出现原因：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs markdown"><span class="hljs-bullet">1.</span> 心跳线出现问题<br>   网卡配置有问题<br>   交换设备有问题<br>   线缆连接有问题<br><span class="hljs-bullet">2.</span> 有防火墙软件阻止问题<br><span class="hljs-bullet">3.</span> virtual<span class="hljs-emphasis">_router_</span>id<br>   配置数值不正确  <br></code></pre></td></tr></table></figure><p> 总之：只要备服务器收不到主服务器发出的组播包，就会成为主服务器，而主服务器资源没有释放，备服务器要篡位就会出现脑裂。</p><h2 id="五、利用shell脚本实现监控管理"><a href="#五、利用shell脚本实现监控管理" class="headerlink" title="五、利用shell脚本实现监控管理"></a>五、利用shell脚本实现监控管理</h2><pre><code>备设备有 VIP 就是表示不正常</code></pre><ol><li>真正实现主备切换    2. 出现脑裂情况了</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br>check_info=$(ip a|grep -c 192.168.10.60) //定义一个参数为VIP地址 .60<br><span class="hljs-keyword">if</span> [ <span class="hljs-variable">$check_info</span> -ne 0 ]  //如果等于 0 <br><span class="hljs-keyword">then</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;keepalived server error!!!&quot;</span> //打印告警提示 keepalived 服务出现错误<br><span class="hljs-keyword">fi</span><br></code></pre></td></tr></table></figure><h2 id="六、Nginx反向代理监听虚拟IP地址"><a href="#六、Nginx反向代理监听虚拟IP地址" class="headerlink" title="六、Nginx反向代理监听虚拟IP地址"></a>六、Nginx反向代理监听虚拟IP地址</h2><ol><li>编写nginx反向代理配置</li></ol>  <figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs awk">  server &#123;<br>  listen      <span class="hljs-number">192.168</span>.<span class="hljs-number">10.60</span>:<span class="hljs-number">80</span>;<br>  server_name  www.rxinxin.org;<br>  root   html;<br>  index  index.html index.htm;<br>  location / &#123;<br>  proxy_pass http:<span class="hljs-regexp">//</span>xinxin;<br>  proxy_set_header host <span class="hljs-variable">$host</span>;<br>  proxy_set_header X-Forwarded-For <span class="hljs-variable">$remote_addr</span>;<br>        &#125;<br>  &#125;<br>  server &#123;<br>  listen       <span class="hljs-number">192.168</span>.<span class="hljs-number">10.60</span>:<span class="hljs-number">80</span>;<br>  server_name  bbs.rxinxin.org;<br>  root   html;<br>  index  index.html index.htm;<br>  location / &#123;<br>  proxy_pass http:<span class="hljs-regexp">//</span>xinxin;<br>  proxy_set_header host <span class="hljs-variable">$host</span>;<br>  proxy_set_header X-Forwarded-For <span class="hljs-variable">$remote_addr</span>;<br>       &#125;<br>    &#125;<br><span class="hljs-regexp">/application/</span>nginx<span class="hljs-regexp">/sbin/</span>nginx -s stop <span class="hljs-regexp">//</span>Nginx 更改ip 一定要重启<br><span class="hljs-regexp">/application/</span>nginx<span class="hljs-regexp">/sbin/</span>nginx<br>netstat -lntup|grep nginx <span class="hljs-regexp">//</span>查看端口<br>  tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">10.60</span>:<span class="hljs-number">80</span>                 <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:*                   LISTEN      <span class="hljs-number">53334</span>/nginx  虚拟IP地址<br></code></pre></td></tr></table></figure><br><p>实现监听本地网卡上没有的IP地址</p><p>  <code>echo &#39;net.ipv4.ip_nonlocal_bind = 1&#39; &gt;&gt;/etc/sysctl.conf 更改内核</code> </p><p>  <code>sysctl -p</code></p><h2 id="七、将高可用和反向代理服务建立联系"><a href="#七、将高可用和反向代理服务建立联系" class="headerlink" title="七、将高可用和反向代理服务建立联系"></a>七、将高可用和反向代理服务建立联系</h2><p>  因为Nginx 反向代理服务处于异常状态下，keepalived服务并没有从主服务器切换到备服务器，所以客户访问网站时反向代理服务一直处于挂了的异常状态导致网站无法正常访问。</p><p>实现的目的：Nginx反向代理服务停止，Keepalived服务也停止 </p><ol><li>编写脚本</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br>web_info=$(ps -ef|grep [n]ginx|wc -l) //当Nginx进程小于2时<br><span class="hljs-keyword">if</span> [ <span class="hljs-variable">$web_info</span> -lt 2 ]<br><span class="hljs-keyword">then</span><br>/etc/init.d/keepalived stop   //关闭keepalived 服务<br><span class="hljs-keyword">fi</span><br></code></pre></td></tr></table></figure><p>2.运行脚本，实现监控nginx服务</p><p>  编辑keepalived服务配置文件</p>  <figure class="highlight plaintext"><figcaption><span>check_web &#123;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs vrrp_script">#定义一个监控脚本，脚本必须有执行权限<br>script &quot;/server/scripts/check_web.sh&quot;    <br>#指定脚本间隔时间<br>  interval 2   <br>  #脚本执行完成，让优先级值和权重值进行运算，从而实现主备切换<br>  weight 2                                                                            <br>  &#125;<br>  track_script &#123;<br>  check_web<br>  &#125;<br></code></pre></td></tr></table></figure><p>chmod +x check_kls.sh   给予脚本可执行权限</p><h2 id="八、实现高可用集群架构中双主配置"><a href="#八、实现高可用集群架构中双主配置" class="headerlink" title="八、实现高可用集群架构中双主配置"></a>八、实现高可用集群架构中双主配置</h2><p><strong>互为主备配置配置</strong>  </p><p>由于企业实际环境，很少等主服务器挂掉才调用备服务器，所以会将Web服务分配给两节点或多个集群并行使用节约成本。</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">kl1<br>vrrp_instance klg1 &#123;<br> state MASTER<br> <span class="hljs-keyword">interface</span> <span class="hljs-symbol">eth0</span><br> <span class="hljs-symbol">virtual_router_id</span> <span class="hljs-symbol">31</span><br> <span class="hljs-symbol">priority</span> <span class="hljs-symbol">150</span><br> <span class="hljs-symbol">advert_int</span> <span class="hljs-symbol">1</span><br> <span class="hljs-symbol">authentication</span> &#123;<br> auth_type PASS<br> auth_pass <span class="hljs-number">1111</span><br>    &#125;<br>virtual_ipaddress &#123;<br> <span class="hljs-number">192.168</span><span class="hljs-number">.10</span><span class="hljs-number">.60</span>/<span class="hljs-number">24</span> dev eth0 label eth0:<span class="hljs-number">1</span><br>    &#125;<br>    &#125;<br>vrrp_instance klg2 &#123;<br>  state BACKUP<br>  <span class="hljs-keyword">interface</span> <span class="hljs-symbol">eth0</span><br>  <span class="hljs-symbol">virtual_router_id</span> <span class="hljs-symbol">32</span><br>  <span class="hljs-symbol">priority</span> <span class="hljs-symbol">100</span><br>  <span class="hljs-symbol">advert_int</span> <span class="hljs-symbol">1</span><br>  <span class="hljs-symbol">authentication</span> &#123;<br>  auth_type PASS<br>  auth_pass <span class="hljs-number">1111</span><br>    &#125;<br>virtual_ipaddress &#123;<br>  <span class="hljs-number">192.168</span><span class="hljs-number">.10</span><span class="hljs-number">.80</span>/<span class="hljs-number">24</span> dev eth0 label eth0:<span class="hljs-number">1</span><br>    &#125;<br>    &#125;<br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs shell">  kl2<br>vrrp_instance klg1 &#123;<br>  state BACKUP<br>  interface eth0<br>  virtual_router_id 31<br>  priority 100<br>  advert_int 1<br>  authentication &#123;<br>  auth_type PASS<br>  auth_pass 1111<br>    &#125;<br>  virtual_ipaddress &#123;<br>  192.168.10.60/24 dev eth0 label eth0:1<br>       &#125;<br>    &#125;<br>  vrrp_instance klg2 &#123;<br>    state MASTER<br>    interface eth0<br>    virtual_router_id 32<br>    priority 150<br>    advert_int 1<br>    authentication &#123;<br>    auth_type PASS<br>    auth_pass 1111<br>    &#125;<br>    virtual_ipaddress &#123;<br>    192.168.10.80/24 dev eth0 label eth0:1<br>    &#125;<br>    &#125; <br><br></code></pre></td></tr></table></figure><p>最后修改 Nginx 反向代理服务配置文件的监听IP地址信息 完成对 Keepalived 互为主备节点的配置部署。</p>]]></content>
    
    
    <categories>
      
      <category>linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux 学习之旅</tag>
      
      <tag>高可用</tag>
      
      <tag>Linux 服务</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linux 基础知识</title>
    <link href="/2019/11/20/linux1/"/>
    <url>/2019/11/20/linux1/</url>
    
    <content type="html"><![CDATA[<h1 id="Linux-基础"><a href="#Linux-基础" class="headerlink" title="Linux 基础"></a>Linux 基础</h1><p>Linux，全称GNU/Linux，是一套免费使用和自由传播的<a href="https://baike.baidu.com/item/%E7%B1%BBUNIX/9032872">类UNIX</a>操作系统，其内核由<a href="https://baike.baidu.com/item/%E6%9E%97%E7%BA%B3%E6%96%AF%C2%B7%E6%9C%AC%E7%BA%B3%E7%AC%AC%E5%85%8B%E7%89%B9%C2%B7%E6%89%98%E7%93%A6%E5%85%B9/1034429">林纳斯·本纳第克特·托瓦兹</a>于1991年第一次释出，它主要受到Minix和Unix思想的启发，是一个基于<a href="https://baike.baidu.com/item/POSIX">POSIX</a>和Unix的多用户、<a href="https://baike.baidu.com/item/%E5%A4%9A%E4%BB%BB%E5%8A%A1/1011764">多任务</a>、支持<a href="https://baike.baidu.com/item/%E5%A4%9A%E7%BA%BF%E7%A8%8B/1190404">多线程</a>和多<a href="https://baike.baidu.com/item/CPU">CPU</a>的操作系统。它能运行主要的Unix工具软件、应用程序和网络协议。它支持<a href="https://baike.baidu.com/item/32%E4%BD%8D/5812218">32位</a>和<a href="https://baike.baidu.com/item/64%E4%BD%8D">64位</a>硬件。Linux继承了Unix以网络为核心的设计思想，是一个性能稳定的多用户网络操作系统。Linux有上百种不同的发行版，如基于社区开发的<a href="https://baike.baidu.com/item/debian/748667">debian</a>、<a href="https://baike.baidu.com/item/archlinux/10857530">archlinux</a>，和基于商业开发的[Red Hat Enterprise Linux](<a href="https://baike.baidu.com/item/Red">https://baike.baidu.com/item/Red</a> Hat Enterprise Linux/10770503)、<a href="https://baike.baidu.com/item/SUSE/60409">SUSE</a>、[oracle linux](<a href="https://baike.baidu.com/item/oracle">https://baike.baidu.com/item/oracle</a>  linux/6876458)等。</p><h2 id="一、操作系统的基本知识"><a href="#一、操作系统的基本知识" class="headerlink" title="一、操作系统的基本知识"></a>一、操作系统的基本知识</h2><p>一般而言，现代计算机计算机系统是一个复杂的系统，故若程序员需要掌握该系统的每一个细节例如如何通过代码去调用音响等这些事情，那可能不再编写代码了，这种情况会严重影响程序员的开发效率。</p><p>并且管理这些部件并加以优化使用，是一件极富挑战性的工作，于是，计算安装了一层软件（系统软件），称为操作系统。它的任务就是为用户程序提供一个更好、更简单、更清晰的计算机模型，并管理刚才提到的所有设备。</p><h3 id="1-linux-介绍"><a href="#1-linux-介绍" class="headerlink" title="1. linux 介绍"></a>1. linux 介绍</h3><p><strong>Linux</strong> 是一个多用户多任务的操作系统，也是一款自由软件，拥有良好的用户界面，支持多种处理器架构，移植方便。严格的来讲，Linux 并不算是一个操作系统，只是一个 Linux 系统中的<strong>内核</strong>，即计算机软件与硬件通讯之间的平台。</p><h4 id="1-1-GUN协议"><a href="#1-1-GUN协议" class="headerlink" title="1.1 GUN协议"></a>1.1 GUN协议</h4><p>Linux的全称是GNU/Linux，这才算是一个真正意义上的Linux系统。</p><p>设计原则：</p><pre><code>    1）所有的东西都是文件，所以管理简单    2）所有操作系统配置数据都存储在正文文件中    3）每个操作系统命令或应用程序很小，只完成单一功能    4）避免使用俘获用户的接口，很少交互命令，应用程序由vi编辑器等完成交互    5）多个程序串接在一起完成复杂任务</code></pre><h1 id="二、Linux-常用命令"><a href="#二、Linux-常用命令" class="headerlink" title="二、Linux 常用命令"></a>二、Linux 常用命令</h1><p>1、<strong>pwd</strong> 返回当前工作目录，直接输入 pwd 即可，后面不带参数。</p><p>2、<strong>ls</strong> 即英文单词list的缩写，列出指定目录的所有文件名或者文件夹名（默认为当前工作目录下），</p><p>其选项如下：</p><table><thead><tr><th align="left">参数</th><th align="left">含义</th></tr></thead><tbody><tr><td align="left">-a</td><td align="left">显示指定目录下所有子目录与文件，包括隐藏文件</td></tr><tr><td align="left">-i</td><td align="left">以列表方式显示文件的详细信息</td></tr><tr><td align="left">-h</td><td align="left">配合 -i 以人性化方式显示文件大小</td></tr></tbody></table><p>3、<strong>cd</strong>  切换工作目录；</p><p>在使用Unix/Linux的时候，经常需要更换工作目录。cd命令可以帮助用户切换工作目录。Linux所有的目录和文件名大小写敏感cd后面可跟绝对路径，也可以跟相对路径。如果省略目录，则默认切换到当前用户的主目录。</p><table><thead><tr><th>命令</th><th>含义</th></tr></thead><tbody><tr><td>cd</td><td>切换到当前用户的主目录，用户登录的使用，默认的目录就是用户的主目录。</td></tr><tr><td>cd ~</td><td>切换到当前用户的主目录</td></tr><tr><td>cd .</td><td>切换到当前目录</td></tr></tbody></table><p>![](C:\Users\xinxi\Desktop\期末考试 2020春\1328034-20180704191623328-304845393.png)</p><h2 id="三、文件权限"><a href="#三、文件权限" class="headerlink" title="三、文件权限"></a>三、文件权限</h2><p>在Linux操作系统上，有些文件很重要，这些文件只有系统或经过授权的用户才能使用，这样才能保护系统的安全。因为有一些文件是只有部分指定的人才能存取，以免不小心被他人删除或修改，因此文件的安全管理是非常重要的。为了防止未授权用户访问你的 文件，可以在文件和目录上设置权限位。还可以设定文件在创建时所具有的缺省权限。</p>]]></content>
    
    
    <categories>
      
      <category>linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux 学习之旅</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>远程管理服务知识介绍</title>
    <link href="/2019/11/20/linux2/"/>
    <url>/2019/11/20/linux2/</url>
    
    <content type="html"><![CDATA[<h1 id="远程管理服务知识介绍"><a href="#远程管理服务知识介绍" class="headerlink" title="远程管理服务知识介绍"></a>远程管理服务知识介绍</h1><h2 id="一、SSH远程登录服务介绍说明"><a href="#一、SSH远程登录服务介绍说明" class="headerlink" title="一、SSH远程登录服务介绍说明"></a>一、SSH远程登录服务介绍说明</h2><p>SSH是Secure Shell Protocol的简写，由 IETF 网络工作小组（Network Working Group）制定；在进行数据传输之前，SSH先对联机数据包通过加密技术进行加密处理，加密后在进行数据传输。确保了传递的数据安全。<br>​    </p><p> SSH是专为远程登录会话和其他网络服务提供的安全性协议。</p><p>利用SSH协议可以有效的防止远程管理过程中的信息泄露问题，在当前的生产环境运维工作中，绝大多数企业普遍采用SSH协议服务来代替传统的不安全的远程联机服务软件，如telnet(23端口，非加密的)等。</p><p><strong>在默认状态下，SSH服务主要提供两个服务功能：</strong></p><p>一是提供类似telnet远程联机服务器的服务，即上面提到的SSH服务；</p><p>另一个是类似FTP服务的sftp-server，借助SSH协议来传输数据的，提供更安全的SFTP服务(vsftp,proftp)。</p><p><strong>SSH远程登录服务排错思路</strong></p><p>检查链路是否通畅—ping(icmp)/tracert/traceroute</p><p>检查链路是否阻断—将防火墙功能关闭</p><p>检查服务是否开启—ss/netstat      -lntup（服务端检查） /telnet/nmap/nc（客户端检查）</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">[D:\~]$ telnet 10.0.0.41 22 <br><br>Connecting to 10.0.0.41:22 ... <br><br>Connection established. <br><br>To escape to <span class="hljs-built_in">local</span> shell, press <span class="hljs-string">&#x27;Ctrl+Alt+]&#x27;</span>. <br><br>SSH-2.0-OpenSSH_5.3 <br></code></pre></td></tr></table></figure><p><img src="data:image/jpeg;base64,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RjTv+eQo/wCEY07/AJ5CiwvrL7HnDztLjzJGfHTcc4pRcyAACZwBwAGNejf8Ixp3/PIUf8Ixp3/PIUWH9afY89TULiPdtuH+ZSvLE4B649KeuqXCQtEsgCsoUkDnA967/wD4RjTv+eQo/wCEY07/AJ5CiwvrL7HnkV9NAcxzMDggZPTPX8aal3LGHCTyKH+8A5G76+tei/8ACMad/wA8hR/wjGnf88hRYPrL7HnMtw87bppWkYDGXYk1GWGDzXpX/CMad/zyFH/CMad/zyFFh/Wpdil4J/5Bh+tdLVazsYbGPZAu1as0zlCiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAxtY0NLxHe2UJcOcl/WudufDOpw2s0n2j7iM3QdhXd1X1D/kG3f/AFxf/wBBNT7ODexLiuxxFh4c1S50+3nNzkyRq/QdxVj/AIRXU/8An4H5Cup0T/kBWH/Xun/oIq9RKnBN6IUUmlocR/wiup/8/A/IUf8ACK6n/wA/A/IV29FL2cOyK5V2OI/4RXU/+fj9BR/wiup/8/A/IV29FHs4dkHKuxxH/CK6n/z8foKa/hLUZEKPPlT1GBXc0Uezj2DlXYoaPZNp9gkDnJWr9FFWMKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiqOr6j/ZdibkR+Zhgu3OOtKUlFXY4xcnZF6qWr3MNtpk5nkCCRGjUnoWIOB+NYX/AAmrf8+Q/wC/n/1qr3/ihNRsJrWewBjlUqf3nT36dqwWLo31ZvLB1raI6Dw/cRTaNaxxuGaCJI5AP4WCjI+orSritL8SR6Vp0NnBYjZGMZMnLHuTx1q3/wAJq3/PiP8Av5/9anLGUW3Zihg66iro6qisvSdbj1OAs6rDJuKhN2c+9alaxkpLmRlKLi+V7hRRRVEhRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABWL4s/wCQG3/XRaKKyr/wpehth/4sfU5LS1DalCGAIz0P0rqJ40/tCNNi7dvTHHVaKK83D/D8z0sR8SJIoYv7Qx5aYyx+6OuOtcbdKFu5goAAc4AooqK/worD7sk0diNchAJx6V6QOgoor08N/CieZif4shaKKK3MAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/9k=" alt="SSH远程登录服务排错思路"></p><h2 id="二、SSH远程登录服务特点说明"><a href="#二、SSH远程登录服务特点说明" class="headerlink" title="二、SSH远程登录服务特点说明"></a>二、SSH远程登录服务特点说明</h2><p>SSH服务端口号为22</p><p>SSH服务采用密文方式传输数据</p><p>SSH服务默认支持root用户进行远程登录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@backup ~]<span class="hljs-comment"># netstat -lntp </span><br>Active Internet connections (only servers) <br>Proto Recv-Q Send-Q Local Address    Foreign Address    State   PID/Program name   <br>tcp    0   0 0.0.0.0:22         0.0.0.0:*          LISTEN   1227/sshd  <br></code></pre></td></tr></table></figure><h2 id="三、Telnet远程登录服务功能作用"><a href="#三、Telnet远程登录服务功能作用" class="headerlink" title="三、Telnet远程登录服务功能作用"></a>三、Telnet远程登录服务功能作用</h2><p>SSH服务端口号为23</p><p>SSH服务采用明文方式传输数据</p><p>SSH服务默认不支持root用户进行远程登录</p><p>Telnet需要单独安装 </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">yum install -y telnet-server telnet <br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># xinetd相当于一个超级守护进程服务，用xinetd服务为那些小进程，小服务提供管理 </span><br><span class="hljs-comment"># 首先小进程telnet要允许被管理，即disable=no,默认是yes </span><br>[root@backup ~]<span class="hljs-comment"># vim /etc/xinetd.d/telnet  </span><br><span class="hljs-comment"># default: on </span><br><span class="hljs-comment"># description: The telnet server serves telnet sessions; it uses \ </span><br><span class="hljs-comment">#    unencrypted username/password pairs for authentication. </span><br>service telnet <br>&#123; <br>    flags      = REUSE <br>    socket_type   = stream <br>    <span class="hljs-built_in">wait</span>      = no <br>    user      = root <br>    server     = /usr/sbin/**<span class="hljs-keyword">in</span>**.telnetd <br>    log_on_failure += USERID <br>    <span class="hljs-built_in">disable</span>     = no <br>&#125; <br>  <br><span class="hljs-comment"># 重启一下，xinetd（因为之前没有启动过，所以用的start） </span><br>[root@backup ~]<span class="hljs-comment"># netstat -lntup|grep 23 </span><br>tcp    0   0 :::23            :::*            LISTEN   1340/xinetd  <br><span class="hljs-comment"># 已经有了 </span><br><span class="hljs-comment">#现在可以测试了，使用telnet连接服务器（刚才是在backup主机上安装的） </span><br>[D:\~]$ telnet 10.0.0.41 <br> <br> <br>connecting to 10.0.0.41:23... <br>Connection established. <br>To escape to <span class="hljs-built_in">local</span> shell, press <span class="hljs-string">&#x27;Ctrl+Alt+]&#x27;</span>. <br>CentOS release 6.9 (Final) <br>Kernel 2.6.32-696.el6.x86_64 on an x86_64 <br>backup login: root <br>Password:  <br>Login incorrect <br> <br>backup login:  <br><span class="hljs-comment"># 因为telnet默认不支持root </span><br>backup login: xinxin <br>Password:  <br>[xinxin**@backup** ~]$ <span class="hljs-comment"># 连上了 </span><br><span class="hljs-comment"># 对于没有安装 telnet的主机，就连不上了 </span><br>[D:\~]$ telnet 10.0.0.31 <br> <br> <br>Connecting to 10.0.0.31:23... <br>Could not connect to <span class="hljs-string">&#x27;10.0.0.31&#x27;</span> (port 23): Connection failed. <br><span class="hljs-comment"># 使用ssh连接 </span><br>[D:\~]$ ssh 10.0.0.41 <br> <br> <br>Connecting to 10.0.0.41:22... <br>Connection established. <br>To escape to <span class="hljs-built_in">local</span> shell, press <span class="hljs-string">&#x27;Ctrl+Alt+]&#x27;</span>. <br> <br>WARNING! The remote SSH server rejected X11 forwarding request. <br>[root@backup ~]<span class="hljs-comment"># </span><br></code></pre></td></tr></table></figure><p>用wireshark 抓包查看发现 一个是明文，一个是密文</p><h2 id="四、远程管理服务概念详解"><a href="#四、远程管理服务概念详解" class="headerlink" title="四、远程管理服务概念详解"></a><strong>四、远程管理服务概念详解</strong></h2><p><strong>SSH远程管理服务加密技术</strong></p><p>采用公钥和私钥进行算法加密，口令登录</p><p><strong>ssh连接登录过程</strong></p><p>ssh客户端发出连接请求<br><code>\&gt;/root/.ssh/known_hosts</code> 清空文件 </p><p>ssh服务端会发出确认信息，询问客户端你是否真的要连接我<br><code>ssh 10.0.0.41</code> </p><p>ssh客户端输入完成yes，会等到一个公钥信息<br><code>cat /root/.ssh/known_hosts</code> </p><p>ssh服务端将公钥信息发送给ssh客户端 </p><p>ssh客户端利用密码进行登录 </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@web01 ~]<span class="hljs-comment"># cat .ssh/known_hosts  </span><br>10.0.0.41 ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEA47PsJW7rLbHv7mREm2<br>juOVznW7dJamrWQSSHyprcvfQvMQjg6f7P9XLEfLfqx67kQvpUdZ65S52DMp<br>cDlEmiiX8hseiM/8zIMBw3XH/F3BHPxlP54067QaRFRFPsZ4nFH4LCF<br>6u4uST1YBJfIvyKKpQb6s+ZplDIMwfZxeWTK9QSREKijQzf7CvLN+Ekt<br>9rYWqKFHrhv/Ae5Lxro0jKasgF3tIsvnq75cqYN57or+mZux5v<br>jnrs/PkRsLLNnAkIJfDMbUoG3WfAjJD18UPL3glmyzuMNfj5YHT4Vj<br>QKC9Eq+WmOsDKl/Q501xpCDXx/dunCXDy+MRXgs/hpRtInjw== <br><span class="hljs-comment"># 上面时客户端私钥 </span><br> <br>[root@web01 ~]<span class="hljs-comment"># cd /etc/ssh/ </span><br>[root@web01 ssh]<span class="hljs-comment"># ll\ </span><br><br>[root@web01 ssh]<span class="hljs-comment"># ll </span><br>total 160 <br>-rw-------. 1 root root 125811 Mar 22 2017 moduli <br>-rw-r--r--. 1 root root  2047 Mar 22 2017 ssh_config <br>-rw------  1 root root  3876 Feb 22 19:36 sshd_config <br>-rw------  1 root root  3876 Feb 22 17:22 sshd_config.bak <br>-rw-------. 1 root root  672 Jan 10 14:54 ssh_host_dsa_key <br>-rw-r--r--. 1 root root  590 Jan 10 14:54 ssh_host_dsa_key.pub <br>-rw-------. 1 root root  963 Jan 10 14:54 ssh_host_key <br>-rw-r--r--. 1 root root  627 Jan 10 14:54 ssh_host_key.pub <br>-rw-------. 1 root root  1675 Jan 10 14:54 ssh_host_rsa_key <br>-rw-r--r--. 1 root root  382 Jan 10 14:54 ssh_host_rsa_key.pub <span class="hljs-comment"># ssh </span><br> <br>[root@backup ssh]<span class="hljs-comment"># cat ssh_host_rsa_key.pub  </span><br>ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEA47PsJW7rLbHv7mREm2juOVznW7dJamr<br>WQSSHyprcvfQvMQjg6f7P9XLEfLfqx67kQvpUdZ65S52DMpcDlEmiiX8hseiM/8zIMB<br>w3XH/F3BHPxlP54067QaRFRFPsZ4nFH4LCF6u4uST1YBJfIvyKKpQb6s+ZplDIMwfZx<br>eWTK9QSREKijQzf7CvLN+Ekt9rYWqKFHrhv/Ae5Lxro0jKasgF3tIsvnq75cqYN57o<br>r+mZux5vjnrs/PkRsLLNnAkIJfDMbUoG3WfAjJD18UPL3glmyzuMNfj5YHT4VjQKC9E<br>q+WmOsDKl/Q501xpCDXx/dunCXDy+MRXgs/hpRtInjw== <br><span class="hljs-comment"># 上面是服务端私钥 </span><br><span class="hljs-comment"># 加密也是利用秘钥 </span><br><span class="hljs-comment"># 客户端有锁头，服务端有钥匙和锁头，每次客户端要连接的时候就带着锁头，</span><br><span class="hljs-comment"># 如果在服务端能用钥匙打开这个锁，就连接成功 </span><br></code></pre></td></tr></table></figure><p>SSH<strong>远程管理服务认证类型</strong></p><p>加密技术分为<strong>v1</strong>和<strong>v2</strong>两个版本     </p><p>sshv1版本不会经常更换锁头和钥匙，因此会有安全隐患</p><p>sshv2版本会经常更换锁头和钥匙，因此提高了远程连接安全性</p><p><strong>基于密钥方式实现远程登录</strong></p><ol><li><p>ssh管理服务器上创建密钥对信息（公钥 私钥） </p></li><li><p>ssh管理服务器上将公钥发送给被管理服务器 </p></li><li><p>ssh管理服务器向被管理服务器发送连接请求 </p></li><li><p>ssh被管理服务器向管理服务器发送公钥质询 </p></li><li><p>ssh管理服务器处理公钥质询请求，将公钥质询结果发送给被管理主机 </p></li><li><p>ssh被管理服务器接收公钥质询响应信息，从而确认认证成功 </p></li><li><p>ssh管理服务端可以和被管理服务端建立基于密钥连接登录 </p></li></ol><p><img src="data:image/jpeg;base64,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" alt="SSH基于秘钥认证全过程"></p><h2 id="五、基于密钥登录方式部署流程"><a href="#五、基于密钥登录方式部署流程" class="headerlink" title="五、基于密钥登录方式部署流程"></a>五、基于密钥登录方式部署流程</h2><p>（1）在管理主机上创建密钥对信息</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs bash">- ssh-keygen -t dsa  <span class="hljs-comment">#&lt;-  创建密钥对命令 -t dsa表示指定密钥对加密类型 </span><br>- Generating public/private dsa key pair. <br>- Enter file <span class="hljs-keyword">in</span> <span class="hljs-built_in">which</span> to save the key (/root/.ssh/id_dsa): <span class="hljs-comment">#&lt;-  确认私钥文件所保存的路径 </span><br>- Created directory <span class="hljs-string">&#x27;/root/.ssh&#x27;</span>. <br>- Enter passphrase (empty <span class="hljs-keyword">for</span> no passphrase):  <span class="hljs-comment">#&lt;-  确认是否给私钥设置密码信息（一般为空） </span><br>- Enter same passphrase again:  <br>- Your identification has been saved <span class="hljs-keyword">in</span> /root/.ssh/id_dsa. <br>- Your public key has been saved <span class="hljs-keyword">in</span> /root/.ssh/id_dsa.pub. <br>- The key fingerprint is: <br>  95:12:71:f9:ea:34:18:e8:a4:fa:0b:0b:f5:92:5c:1b root@m01 <br>- The key<span class="hljs-string">&#x27;s randomart image is: </span><br><span class="hljs-string">  +--[ DSA 1024]----+ </span><br><span class="hljs-string">  |    o...   | </span><br><span class="hljs-string">  |     o..   | </span><br><span class="hljs-string">  |    .. o.   | </span><br><span class="hljs-string">  |   o .o .  | </span><br><span class="hljs-string">  | . E+ So .   | </span><br><span class="hljs-string">  | o +.o. . +   | </span><br><span class="hljs-string">  |. =.o  o .   | </span><br><span class="hljs-string">  | ..+   .   | </span><br><span class="hljs-string">  | ..o.      | </span><br><span class="hljs-string">  +-----------------+ </span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">  [root@m01 ~]# ll /root/.ssh/ </span><br><span class="hljs-string">- total 8 </span><br><span class="hljs-string">  -rw------  1 root root 668 Sep 21 17:23 id_dsa </span><br><span class="hljs-string">  -rw-r--r-  1 root root 598 Sep 21 17:23 id_dsa.pub </span><br></code></pre></td></tr></table></figure><p>（2）将管理主机上公钥信息发送给被管理主机</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">- ssh-copy-id -i /root/.ssh/id_dsa.pub 172.16.1.31 <br>- root@172.16.1.31<span class="hljs-string">&#x27;s password:  </span><br><span class="hljs-string">- Now try logging into the machine, with &quot;ssh &#x27;</span>172.16.1.31<span class="hljs-string">&#x27;&quot;, **and** check **in**: </span><br><span class="hljs-string">  .ssh/authorized_keys </span><br><span class="hljs-string"></span><br><span class="hljs-string">- to make sure we haven&#x27;</span>t added extra keys that you weren<span class="hljs-string">&#x27;t expecting. </span><br></code></pre></td></tr></table></figure><p>管理服务器端</p><p><img src="data:image/jpeg;base64,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" alt="img"></p><p>被管理服务器端</p><p><img src="data:image/jpeg;base64,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xa28N9lP+r2/609eOOn3OPu/rQBVEuqC5jK2k3mPZ+SiqjZaLbt3D8PwqXT73UDqUbWFoqypb7Ig44jQD52ycDkbsn/aNWNO8UJA0ZuEkLRwrGGZvMXKnI+U4wPx6gGobnxXcXFw0xRlcrMoIlPAdAuB7DGce9AD9O1K6MlvHZ6VG7RoSFy+GAk3g9ezfn0p8euXNlPa3F7bBFELlABkTMVCAtk8YKL07r0qJfFA2wLLatJ5cQjcmUZbBUr/AA4AG30zz16VnahqKX1vbqIWSWMuXYvkMWYtwMcdfU0AjRtvE1w8cdrPZQ3FsoQNEqlWYLj+Ic5yoOTU1n4h1GMSPa2MbrzNIJAzhvmA3AE4HJ7ev5Zuk6vHpU6yJbu2Yyko83Ak+bI7cDgdOfcVcj8VyQx24SFhJCoQv5pBKhkO3gdMJjueetAiY6xdXlzp15qEW8IG+zmAbnYDqhGeBnnnnk03w+1/dTx22lW0EVzahpt7sQQ/C7+T1HpTNN8ULpU0E8Fr5ksYlyHcqoLsDxt54A7+tSeFNet9N1y6vdRdgJ42yVUtliwP+NY4iU40nKmrswxU6kKMpUleS2G6h4ju4rpbeS2gR7OTaUVmZAVBXCgnAHJ6deKzrXWGtktQIQWti211kdGIbnGVI71Bqk8d1q13PCSY5ZndSRjgkkVVrSDbim9zWDbgubextr4qvEeJo4oEMU7XCgLwGY/Nwex4HtjjvmaLxMv2iwaSLKQbWnO3JmI3DbjOApDEcetc9RVFm3J4qu5hEJY1IjfeCjsjZwR1B469qiPiCZrhpHt4SjySO8YyAwkUKw6+g69c1k0ULQDduvFMk00bxWsSCJw0eSxIC7vLB5x8u705wM1DHr0kuo2s90NqwzmZ/LXJctjdwTjnbz9TWRRQBur4neSXE0CeU0zOerFUbcCi8jAwx6Y7U648VynUJJreBBFuBRXJyAGJHIPB+br9KwKKAN8eL7tZRIsEO8cAsWbKd1OTznHJPNOk8a6i8bKsdsjEgh1j5UDHAz24PHua56igC3JqdxNqiX8pV51dX6YBK4xwPpVu28RXFtEFWKJmEhfc2c4LBivXuQOetZNFAGxF4hZLgyNaxMvmo6qGIKBV24B/3eMnPrVy88aXcxVIUj8uMKIyy4YANuwQDjrn8K5uigDUudcN1b3ETWsYEqoqnexMYXJHU88k9ay6KKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//2Q==" alt="img"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash"> <span class="hljs-comment"># 保存在了远程主机中用户的家目录下的.ssh目录下 </span><br> [root**@nfs01** ~]<span class="hljs-comment"># cd /root/.ssh/ </span><br> [root**@nfs01** .ssh]<span class="hljs-comment"># ll </span><br><br>- total 4 <br> -rw------  1 root root 598 Feb 25 11:09 authorized_keys<br> ssh-keygen -R 172.16.152.209 清空公钥记录<br></code></pre></td></tr></table></figure><p>（3）进行远程管理测试（基于密钥的方式进行远程管理）</p><p><code>ssh 172.16.1.31</code>    &lt;-  可以不用输入密码信息，就能登陆成功</p><p><code>ssh 172.16.1.31 uptime</code>  &lt;-  可以不用登陆到远程主机，就可以直接查看远程主机信息</p><p><img src="data:image/jpeg;base64,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" alt="img"></p><h2 id="六、SSH服务端配置文件信息说明"><a href="#六、SSH服务端配置文件信息说明" class="headerlink" title="六、SSH服务端配置文件信息说明"></a>六、SSH服务端配置文件信息说明</h2><p>配置文件路径：<code> /etc/ssh/sshd_config</code></p><p>修改SSH服务端端口号 为<code>52113</code></p><p><img src="data:image/jpeg;base64,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" alt="img"></p><p>配置监听地址</p><p><img src="data:image/jpeg;base64,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l3QqQP3a+ZvPz7stx2I685oQmY8+j31vqBsmtZjPkhVEbfOATyBjJHHWotRsZNN1CezmKmSFijFema6E+Kbecus/2tfMNwGlTBdQ7q645/2cHkdaxNcvo9T1u7vIVdY55C6h/vY9/el2GUaKKKYGzpRCeHdakCpv2xKGZASAW5xnp+FWYtF055LC3xdmee1+1SMHXBwrNsVdvU7Rg579DWJb31zawTwwSskdwoWVR0cdRmoxPKsiOsrh48bGDHK46YPagDqYvClpJNKpe6wxRYxkZg3RGTMnHIHTt/SoodL068sdGC2tzE03mGaYSAhtpJIA29Tjjnj3rnvttyGmb7RNumGJTvP7z/e9fxp1vqF3aeWLe5ljWOQSqqudocdGx0zTA7qTwZpD2trPIlxC85KlLaXKDBTBBcEnO/r044rKfS7WHRWUW8bbLZp/PKNu8wSbQN3TBxjb+NY2rXkwu1aN/KLIGIhURgn1wuBmqH2u48gw+fL5Rbf5e87d3rj196kDR8RwCK9t3W2W3822ikKIhVdxXnArOhtpJU83y5PIDqjyKhIUnoPrweKW5vbq9Km6uZpyowplctge2ajEsixGMOwjYhioPBI6HFMDqpfDWmR6hGPMufskkchjcvzIykABvkzH15ypxxyafPoVoNNa0ljmjuoGu2RwynHlqrYYgfN+GMfpXM/2nfGdJ/tlx5yDaknmtuUegOeBUX2mfk+dJzuz8x79fz70AdPp+mR65/YUE4AUxy+Y0YRGKq3ckrnjvnNZfijTrXStbktLPf5caLu3srHdjnlSR1qjLqN3MkCSTuVgQxxAHG1T1HFVmYsxZiSxOST3oA9R8ZgDwZJwP+Wf8xXl1epeNP8AkTJP+2f8xXlteVk/8B+r/Q8TIf8Adpf4n+SCiiivVPbCiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/9k=" alt="img"></p><p><img src="data:image/jpeg;base64,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2kRvbRT6fPLOJJxb7ZYREd56Y+Ygj8eKi028TT9ct7qUMUhmDsF64B7U6PV7mXU7W4vrm4uEglVwJJC5ABBOMn2rCftef3drf5/8DqNWsI2h3qXHkFIfMwxYC4jPlgdd53fJ1/ixUlnoNzdXF1DI0UElujMyySouSBkdWHB/vdKbaX8Cz3y3HmiG8QqXQAsvzBgcEgHkdM1ONWtn1eeaRZVtpbc24KgF1GwKGxkAngcZ/GolKtqvLt/wfUq0b/MqQ6PeXAlMMaOI2KkrKhDEDJC8/Occ/LmmRaZdS2huVRREM4LSKpbHXapOWx7A1o6fqtnZpCr/AGh/sdw08BCAeZkAYYbvl+6Ome9VZLuzutOgS4M6XFtG0aCNQUcFiwyScryx6A59qfPVvtp6ev8AwPS4WiQtpl1DaJdyw/uDtJw67gp6EjqAexIxUurWltbrZy2iyqlxB5pWVw5U7mXqAP7vpVi51a2msZdizfap4IoHVgNihNvzA5yc7RxgY55NVr27t7vTrJQZVubePyiuwbCNzNndnOfm6Y/GiMqjacl1/T/PqFl+BRQAsAzbR3OM0+aIRhGViyuMgkYPXFNi8vzV83ds77etPuHWSTcrMRjGCu3HsOTW+tyko+zbe/4/18iKiiiqMgooooAVHaNw8bMrKchlOCKSiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigB0v8ArX/3jTaKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/9k=" alt="img"></p><p>客户端测试：</p><p><img src="data:image/jpeg;base64,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" alt="img"></p><p>  监听地址说明图：</p><p><img src="data:image/gif;base64,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" alt="ssh 服务器监听地址对应关系图"></p><ul><li>SSH服务端配置文件信息说明 /etc/ssh/sshd_config</li></ul><ul><li><code>Port 52113</code>        &lt;- 修改ssh服务端口号信息      </li><li><code>ListenAddress 0.0.0.0 </code>   &lt;- 主要作用提升网络连接安全性 </li><li>PS：监听地址只能配置为服务器网卡上拥有的地址   </li><li><code>PermitRootLogin no</code>    &lt;- 是否允许root用户远程登录   </li><li><code>PermitEmptyPasswords no</code>   &lt;- 是否允许空密码 </li><li><code>UseDNS no </code>         &lt;- 是否进行DNS反向解析（提升ssh远程连接效率）            </li><li><code>GSSAPIAuthentication no</code>   &lt;- 是否进行远程GSSAPI认证（提升ssh远程连接效率） </li></ul><h2 id="七、SSH远程管理服务入侵防范"><a href="#七、SSH远程管理服务入侵防范" class="headerlink" title="七、SSH远程管理服务入侵防范"></a>七、SSH远程管理服务入侵防范</h2><p>  利用密钥登录提高安全性<br>  安全设备策略阻止访问，只放开少量服务端口<br>  开启SSH监听地址功能，只监听内网网卡地址<br>  利用服务器不配置外网IP提高安全性<br>  利用授权与系统安装最小化提高安全性<br>  利用指纹信息对系统重要文件进行加密处理<br>  利用系统重要文件加锁功能提高安全性 </p><h2 id="八、SFTP-常用操作命令总结"><a href="#八、SFTP-常用操作命令总结" class="headerlink" title="八、SFTP 常用操作命令总结"></a>八、SFTP 常用操作命令总结</h2><table><thead><tr><th>命令</th><th>帮助信息</th><th align="left">操作说明</th></tr></thead><tbody><tr><td>bye</td><td>Quit sftp</td><td align="left">表示退出  sftp  传输模式</td></tr><tr><td>cd path</td><td>Change remote directory to path</td><td align="left">改变远程目录信息</td></tr><tr><td>pwd</td><td>Display remote working directory</td><td align="left">显示远程主机当前目录信息</td></tr><tr><td>lcd path</td><td>Change local directory to ‘path’</td><td align="left">改变本地目录路径信息</td></tr><tr><td>lpwd</td><td>Print local working directory</td><td align="left">输出本地目录路径信息</td></tr><tr><td>get [-P] remote-path [local-path]</td><td>Download file</td><td align="left">下载文件命令</td></tr><tr><td>put [-P] local-path [remote-path]</td><td>Upload file</td><td align="left">上传文件命令</td></tr></tbody></table>]]></content>
    
    
    <categories>
      
      <category>linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux 学习之旅</tag>
      
      <tag>Linux 服务</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>伺服器集群架構之二</title>
    <link href="/2019/11/20/%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%9B%86%E7%BE%A4%E6%9E%B6%E6%9E%84%E4%B9%8B%E4%BA%8C/"/>
    <url>/2019/11/20/%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%9B%86%E7%BE%A4%E6%9E%B6%E6%9E%84%E4%B9%8B%E4%BA%8C/</url>
    
    <content type="html"><![CDATA[<h1 id="集群架构环境统一规划说明"><a href="#集群架构环境统一规划说明" class="headerlink" title="集群架构环境统一规划说明"></a>集群架构环境统一规划说明</h1><br>①. 服务器及服务规划说明<br><br>②. 主机地址及主机名规划<br><br>③. 安装及配置路径等规划<br><br><h5 id="虚拟软件主机虚拟网络配置"><a href="#虚拟软件主机虚拟网络配置" class="headerlink" title="虚拟软件主机虚拟网络配置"></a>虚拟软件主机虚拟网络配置</h5><p><strong>第一步：在虚拟软件中配置虚拟局域网</strong>    </p><pre><code>配置虚拟网段信息，以及虚拟网关信息</code></pre><br><p><strong>第二步：在虚拟软件中虚拟机添加网卡</strong></p><pre><code>虚拟主机中设置了两块网卡：eth0：nat模式网卡eth1：LAN区段网卡（区段名称为 172.16.1.0/24）</code></pre><br><p><strong>第三步：在虚拟软件中虚拟机网卡配置</strong><br></p><p><strong>第四步：在虚拟软件中虚拟机系统优化</strong></p><p><strong>①. 模板机优化配置—hosts文件配置</strong></p><pre><code>\cp /etc/hosts&#123;,.bak&#125;cat &gt;/etc/hosts&lt;&lt;EOF127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4::1         localhost localhost.localdomain localhost6 localhost6.localdomain6172.16.1.5      lb01172.16.1.6      lb02172.16.1.7      web01172.16.1.8      web02172.16.1.9      web03172.16.1.51     db01172.16.1.31     nfs01172.16.1.41     backup172.16.1.61     m01EOF</code></pre><p><strong>②. 模板机优化配置—更改yum源</strong></p><pre><code>    #更改yum源    wget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-6.repo    wget -O /etc/yum.repos.d/epel.repo http://mirrors.aliyun.com/repo/epel-6.repo    #PS：yum repolist 列出yum源信息；讲解什么是epel源</code></pre><p><strong>③. 模板机优化配置—关闭selinux</strong></p><pre><code>    #关闭selinux    sed -i.bak &#39;s/SELINUX=enforcing/SELINUX=disabled/&#39; /etc/selinux/config    grep SELINUX=disabled /etc/selinux/config     setenforce 0    getenforce</code></pre><p><strong>④. 模板机优化配置—关闭iptables</strong> </p><pre><code>    #关闭iptables             /etc/init.d/iptables stop    /etc/init.d/iptables stop    chkconfig iptables off</code></pre><p><strong>⑤. 模板机优化配置—精简开机自启动服务</strong></p><pre><code>    #精简开机自启动服务    export LANG=en    chkconfig|egrep -v &quot;crond|sshd|network|rsyslog|sysstat&quot;|awk &#39;&#123;print &quot;chkconfig&quot;,$1,&quot;off&quot;&#125;&#39;|bash    chkconfig --list|grep 3:on</code></pre><p><strong>⑥. 模板机优化配置—提权oldboy可以sudo</strong></p><pre><code>    #提权oldboy可以sudo(可选配置)    useradd oldboy    echo 123456|passwd --stdin oldboy    \cp /etc/sudoers /etc/sudoers.ori    echo &quot;oldboy  ALL=(ALL) NOPASSWD: ALL &quot; &gt;&gt;/etc/sudoers    tail -1 /etc/sudoers    visudo -c</code></pre><p><strong>⑦. 模板机优化配置—英文字符集</strong></p><pre><code>    #英文字符集    cp /etc/sysconfig/i18n /etc/sysconfig/i18n.ori    echo &#39;LANG=&quot;en_US.UTF-8&quot;&#39;  &gt;/etc/sysconfig/i18n     source /etc/sysconfig/i18n    echo $LANG</code></pre><p><strong>⑧. 模板机优化配置—时间同步</strong></p><pre><code>    #时间同步    echo &#39;#time sync by lidao at 2017-03-08&#39; &gt;&gt;/var/spool/cron/root    echo &#39;*/5 * * * * /usr/sbin/ntpdate pool.ntp.org &gt;/dev/null 2&gt;&amp;1&#39; &gt;&gt;/var/spool/cron/root    crontab -l</code></pre><p><strong>⑨. 模板机优化配置—加大文件描述</strong></p><pre><code>    #加大文件描述    echo &#39;*               -       nofile          65535 &#39; &gt;&gt;/etc/security/limits.conf     tail -1 /etc/security/limits.conf </code></pre><p><strong>⑩. 模板机优化配置—内核优化</strong></p><pre><code>    #内核优化cat &gt;&gt;/etc/sysctl.conf&lt;&lt;EOFnet.ipv4.tcp_fin_timeout = 2net.ipv4.tcp_tw_reuse = 1net.ipv4.tcp_tw_recycle = 1net.ipv4.tcp_syncookies = 1net.ipv4.tcp_keepalive_time = 600net.ipv4.ip_local_port_range = 4000    65000net.ipv4.tcp_max_syn_backlog = 16384net.ipv4.tcp_max_tw_buckets = 36000net.ipv4.route.gc_timeout = 100net.ipv4.tcp_syn_retries = 1net.ipv4.tcp_synack_retries = 1net.core.somaxconn = 16384net.core.netdev_max_backlog = 16384net.ipv4.tcp_max_orphans = 16384</code></pre><h1 id="以下参数是对iptables防火墙的优化"><a href="#以下参数是对iptables防火墙的优化" class="headerlink" title="以下参数是对iptables防火墙的优化"></a>以下参数是对iptables防火墙的优化</h1><p><strong>防火墙不开会提示，可以忽略不理</strong></p><pre><code>net.nf_conntrack_max = 25000000net.netfilter.nf_conntrack_max = 25000000net.netfilter.nf_conntrack_tcp_timeout_established = 180net.netfilter.nf_conntrack_tcp_timeout_time_wait = 120net.netfilter.nf_conntrack_tcp_timeout_close_wait = 60net.netfilter.nf_conntrack_tcp_timeout_fin_wait = 120EOFsysctl -p</code></pre><p><strong>⑾. 模板机优化配置—安装其他小软件</strong></p><pre><code>    #安装其他小软件    yum install lrzsz nmap tree dos2unix nc telnet sl -y</code></pre><p><strong>⑿. 模板机优化配置—ssh连接速度慢优化</strong></p><pre><code>    #ssh连接速度慢优化              sed -i.bak &#39;s@#UseDNS yes@UseDNS no@g;s@^GSSAPIAuthentication yes@GSSAPIAuthentication no@g&#39;  /etc/ssh/sshd_config    /etc/init.d/sshd reload</code></pre><br><h1 id="虚拟主机克隆操作"><a href="#虚拟主机克隆操作" class="headerlink" title="虚拟主机克隆操作"></a>虚拟主机克隆操作</h1><br>第一步：调整虚拟主机网络配置信息<br><br><p> 分为<strong>一清空</strong>和<strong>两删除</strong>两个操作</p><p><strong>两删除</strong>：删除网卡（eth0 eth1）中，UUID（硬件标识信息）和HWADDR（网络mac地址）进行删除</p><pre><code>    sed -ri &#39;/UUID|HWADDR/d&#39;  /etc/sysconfig/network-scripts/ifcfg-eth[01]</code></pre><p><strong>一清空</strong>：清空网络规则配置文件</p><pre><code>    echo &#39;&gt;/etc/udev/rules.d/70-persistent-net.rules&#39; &gt;&gt;/etc/rc.local </code></pre><br>            第二步：关闭虚拟模板机<pre><code>    shutdown -h now</code></pre><br>第三步：进行模板机的克隆操作        <p><strong>链接克隆</strong>：</p><pre><code>    优势：节省系统资源  克隆效率较高    劣势：模板主机不能出现问题，一旦模板主机失效，所有克隆主机也无法正常工作</code></pre><p><strong>完整克隆</strong>：</p><pre><code>    优势：模板主机和克隆主机相互独立，模板主机出现问题，克隆主机依旧可以正常使用    劣势：浪费系统资源  克隆效率较低</code></pre>]]></content>
    
    
    <categories>
      
      <category>linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux学习之旅</tag>
      
      <tag>集群架構</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>網卡文件配置文件詳解</title>
    <link href="/2019/11/20/%E7%B6%B2%E5%8D%A1%E6%96%87%E4%BB%B6%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%A9%B3%E8%A7%A3/"/>
    <url>/2019/11/20/%E7%B6%B2%E5%8D%A1%E6%96%87%E4%BB%B6%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%A9%B3%E8%A7%A3/</url>
    
    <content type="html"><![CDATA[<h1 id="网卡文件配置文件详解"><a href="#网卡文件配置文件详解" class="headerlink" title="网卡文件配置文件详解"></a>网卡文件配置文件详解</h1><h5 id="文件路径："><a href="#文件路径：" class="headerlink" title="文件路径："></a>文件路径：</h5><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">//</span>etc<span class="hljs-regexp">/sysconfig/</span>network-scripts/ifcfg-eth0  为网卡文件路径 <br></code></pre></td></tr></table></figure><br><table><thead><tr><th>配置参数</th><th>参数详解</th></tr></thead><tbody><tr><td>DEVICE=eth0</td><td>网卡名字</td></tr><tr><td><strong>HWADDR=00:0c:29:bc:1f:24</strong></td><td>Hardware address 硬件地址</td></tr><tr><td><strong>TYPE=Ethernet</strong></td><td>网络类型 因特网</td></tr><tr><td>UUID=1c340c4c-e0ec-4672-81e7-a5f4110dd1f9</td><td>UUID系统中唯一的标识</td></tr><tr><td>ONBOOT=yes</td><td>boot on 在重启时候是否开启网卡 自动运行</td></tr><tr><td>NM_CONTROLLED=yes</td><td>是否通过network软件进行管理</td></tr><tr><td>BOOTPROTO=none</td><td>网卡获取IP地址的方式 static ip地址固 dhcp 自动获取</td></tr><tr><td>IPADDR=10.0.0.200</td><td>IP地址</td></tr><tr><td>NETMASK=255.255.255.0</td><td>子网掩码</td></tr><tr><td>GATEWAY=10.0.0.2</td><td>网关 默认的出口</td></tr><tr><td>USERCTL=no</td><td>是否允许普通用户管理网卡  开 关 重启</td></tr><tr><td>PEERDNS=yes</td><td>DNS 优先性</td></tr><tr><td>IPV6INIT=no</td><td>IPv6</td></tr><tr><td>DNS1=223.5.5.5</td><td>DNS地址</td></tr><tr><td>DNS2=223.6.6.6</td><td>DNS地址</td></tr></tbody></table>]]></content>
    
    
    <categories>
      
      <category>linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux学习之旅</tag>
      
      <tag>集群架構</tag>
      
      <tag>Network</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>集群伺服器地址規劃一覽表</title>
    <link href="/2019/11/20/%E9%9B%86%E7%BE%A4%E4%B8%BB%E6%9C%BA%E5%90%8DIP%E5%9C%B0%E5%9D%80%E8%A7%84%E5%88%92/"/>
    <url>/2019/11/20/%E9%9B%86%E7%BE%A4%E4%B8%BB%E6%9C%BA%E5%90%8DIP%E5%9C%B0%E5%9D%80%E8%A7%84%E5%88%92/</url>
    
    <content type="html"><![CDATA[<center><br><h1 id="主机名和IP地址规划表"><a href="#主机名和IP地址规划表" class="headerlink" title="主机名和IP地址规划表"></a><strong>主机名和IP地址规划表</strong></h1><h2 id="前端服务器"><a href="#前端服务器" class="headerlink" title="前端服务器"></a><strong>前端服务器</strong></h2><br><br><center><table><thead><tr><th align="left">服务器说明</th><th align="center">外网IP</th><th align="center">内网IP</th><th align="center">主机名称</th></tr></thead><tbody><tr><td align="left">nginx负载均衡服务器</td><td align="center">10.0.0.5/24</td><td align="center">172.16.1.5/24</td><td align="center">lb01</td></tr><tr><td align="left">nginx负载均衡服务器</td><td align="center">10.0.0.6/24</td><td align="center">172.16.1.6/24</td><td align="center">lb02</td></tr><tr><td align="left">Nginx网站服务器</td><td align="center">10.0.0.7/24</td><td align="center">172.16.1.7/24</td><td align="center">web01</td></tr><tr><td align="left">Nginx网站服务器</td><td align="center">10.0.0.8/24</td><td align="center">172.16.1.8/24</td><td align="center">web02</td></tr><tr><td align="left">Nginx网站服务器</td><td align="center">10.0.0.9/24</td><td align="center">172.16.1.9/24</td><td align="center">web03</td></tr></tbody></table></center><br><br><br><h2 id="后端服务器"><a href="#后端服务器" class="headerlink" title="后端服务器"></a><strong>后端服务器</strong></h2><br><table><thead><tr><th align="left">服务器说明</th><th align="center">外网IP</th><th align="center">内网IP</th><th align="center">主机名称</th></tr></thead><tbody><tr><td align="left">MySQL数据库服务器</td><td align="center"><strong><font color=#00ffff size=2>10.0.0.51/24</font></strong></td><td align="center">172.16.1.51/24</td><td align="center">db01</td></tr><tr><td align="left">NFS存储服务器</td><td align="center"><strong><font color=#00ffff size=2>10.0.0.31/24</font></strong></td><td align="center">172.16.1.31/24</td><td align="center">nfs01</td></tr><tr><td align="left">Rsync备份服务器</td><td align="center"><strong><font color=#00ffff size=2>10.0.0.41/24</font></strong></td><td align="center">172.16.1.41/24</td><td align="center">backup</td></tr><tr><td align="left">管理服务器</td><td align="center"><strong><font color=#00ffff size=2>10.0.0.61/24</font></strong></td><td align="center">172.16.1.61/24</td><td align="center">m01</td></tr></tbody></table><br><p><strong>加重IP地址是为了实验方便，真实环境可不加外网地址</strong></p><br><h2 id="集群服务器对应数量与其作用说明"><a href="#集群服务器对应数量与其作用说明" class="headerlink" title="集群服务器对应数量与其作用说明"></a><strong>集群服务器对应数量与其作用说明</strong></h2><table><thead><tr><th align="left">构架组成</th><th align="center">数量</th><th align="left">作用说明</th></tr></thead><tbody><tr><td align="left">负载均衡服务器</td><td align="center">两台</td><td align="left">对访问网站的流量进行分流，减少流量对某一台服务器的压力</td></tr><tr><td align="left">Web服务器</td><td align="center">三台</td><td align="left">处理用户页面访问请求</td></tr><tr><td align="left">NFS存储服务器</td><td align="center">一台</td><td align="left">存储图片、附件、头像等用户上传的静态数据资源</td></tr><tr><td align="left">Rsync备份服务器</td><td align="center">一台</td><td align="left">对全网服务器数据进行实时与定时备份</td></tr><tr><td align="left">MySQL数据库服务器</td><td align="center">一台</td><td align="left">对动态变化数据进行存储（文本内容）</td></tr><tr><td align="left">管理服务器</td><td align="center">一台</td><td align="left">1、作为yum仓库服务器，提供全网服务器的软件下载</td></tr><tr><td align="left"></td><td align="center"></td><td align="left">2、跳板机、操作审计</td></tr><tr><td align="left"></td><td align="center"></td><td align="left">3、vpn（pptp）</td></tr><tr><td align="left"></td><td align="center"></td><td align="left">4、监控软件（nagios，zabbix）</td></tr><tr><td align="left"></td><td align="center"></td><td align="left">5、兼职批量分发和管理（ssh key+ansible）</td></tr></tbody></table>]]></content>
    
    
    <categories>
      
      <category>linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux学习之旅</tag>
      
      <tag>集群架構</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Rsync 数据镜像备份工具</title>
    <link href="/2019/11/19/Rsync%E6%9C%8D%E5%8A%A1%E9%85%8D%E7%BD%AE%E4%B8%8E%E9%83%A8%E7%BD%B2/"/>
    <url>/2019/11/19/Rsync%E6%9C%8D%E5%8A%A1%E9%85%8D%E7%BD%AE%E4%B8%8E%E9%83%A8%E7%BD%B2/</url>
    
    <content type="html"><![CDATA[<h1 id="Rsync-数据镜像备份工具"><a href="#Rsync-数据镜像备份工具" class="headerlink" title="Rsync 数据镜像备份工具"></a>Rsync 数据镜像备份工具</h1><br><p><strong><a href="https://mirrors.aliyun.com/centos/7.8.2003/os/x86_64/Packages/rsync-3.1.2-10.el7.x86_64.rpm?spm=a2c6h.13651111.0.0.5b472f70CV6308&file=rsync-3.1.2-10.el7.x86_64.rpm">Rsync</a> 是一款实现全量及增量复制同步的软件</strong></p><p>具有开源，快速，多功能，全量及增量本地同步和多平台的特性</p><p><strong>增量本地同步以 delta-transfer 算法闻名可减少内网带宽。（具体实现方法见下文）</strong></p><br><br><h2 id="什么是增量同步？"><a href="#什么是增量同步？" class="headerlink" title="什么是增量同步？"></a>什么是增量同步？</h2><br><p>​    假如一个存储服务器要备份的目录大小为10G，第一次备份到备份服务器使用<strong>全量备份</strong>及所有数据全部备份到备份服务器中。</p><p>这时由于用户使用存储服务器目录大小增至15G，普通备份软件还是默认采用全量备份方式，效率较低浪费内网带宽。而使用 Rsync 备份采用<strong>增量传输</strong>方式，只传输增加的5G数据效率上大大提高。 </p><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linuxlinux-04-2.png" alt="linux-04-2"></p><br><h2 id="服务命令简单应用"><a href="#服务命令简单应用" class="headerlink" title="服务命令简单应用"></a>服务命令简单应用</h2><br><p><strong>Rsync 一个命令可以替换4个命令的应用效果</strong><br><br></p><p><strong>1.rsync = cp 效果</strong><br><br></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs shell">rsync -a = cp -a<br>cp -a /etc/hosts /tmp/<br><br>[root@backup ~]# cp -a /etc/hosts /tmp/<br>[root@backup ~]# ll /tmp/<br><br>-rw-r--r--. 1 root root 352 Jan 17 21:25 hosts<br><br>[root@backup ~]# rsync -a /etc/sysconfig/network /tmp/<br>ll /tmp/<br><br>-rw-r--r--. 1 root root 352 Jan 27 01:15 hosts<br></code></pre></td></tr></table></figure><p><strong>2.rsync = scp</strong><br><br></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@backup ~]# scp -rp /tmp/ 172.16.1.31:/tmp/<br>-r 表示数据目录递归 -p 表示保持属性<br>[root@backup ~]# rsync -rp /tmp/ 172.16.1.31:/tmp/<br></code></pre></td></tr></table></figure><br><p><strong>说明：</strong></p><p>同步数据时，<code>/tmp/</code>目录后有<code>/</code>，表示将目录下面的数据内容进行备份同步。<br><br>同步数据时，<code>/tmp</code>目录后没有<code>/</code>，表示将目录及目录下面的数据内容进行备份同步。</p><br><br><p><strong>3.rsync = rm</strong><br><br></p><p><strong>说明：</strong></p><p>rsync实现删除目录中数据内容过程，就将一个空目录和一个有数据的目录进行同步<br>最终，会将有数据的目录中的文件进行清空。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">rsync -r --delete /null/ /tmp/<br></code></pre></td></tr></table></figure><p><strong>3.rsync == ls</strong></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">ls -l <span class="hljs-regexp">/etc/</span>hosts<br>rsync <span class="hljs-regexp">/etc/</span>hosts<br></code></pre></td></tr></table></figure><br><h2 id="七大特性总结"><a href="#七大特性总结" class="headerlink" title="七大特性总结"></a>七大特性总结</h2><br><p>:::tip 特性总结</p><ol><li><p>支持拷贝普通文件与特殊文件如链接文件、设备文件等。</p></li><li><p>支持排除指定文件目录，排除功能类似于tar打包命令中的排除。</p></li><li><p>支持保持源文件或目录属性信息不变。</p></li><li><p>支持增量同步，即只同步变化的数据，提升数据传输效率。</p></li><li><p>支持使用rcp、rsh、ssh等方式来配合进行隧道加密传输文件。</p></li><li><p>支持使用通过socket （守护进程方式）传输文件或目录数据信息。</p></li><li><p>支持用户认证方式传输数据提升数据同步安全性。</p><p>::: </p><br></li></ol><h2 id="数据同步原理"><a href="#数据同步原理" class="headerlink" title="数据同步原理"></a>数据同步原理</h2><br><p>​    <strong>Quick check</strong> 算法是根据文件或目录的权限、修改时间、发生变化的目录或文件、所有者、所有组等属性的变化进行的增量同步。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs sh">rsync 的参数说明<br><br>-v        详细模式输出，传输时显示信息<br>-z        传输时进行压缩，提高效率<br>-a        表示以递归方式传输文件，又包含了 rtopgDl参数<br>-r        递归<br>-t        保持文件时间信息<br>-o        保持文件属主信息<br>-p        保持文件权限<br>-g        保持文件属组信息<br>-D        设备文件信息<br>-l        保留软链接<br>-P        显示传输的进度信息        <br>-e        指定用什么隧道<br></code></pre></td></tr></table></figure><p>隧道模式传输：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell">rsync -avz -e &quot;ssh -p 22&quot; /etc/hosts 172.16.1.31:/backup<br><br>--exclude               指定排除不需要的传输文件信息<br>--exclude-from=文件      文件所在的目录文件，即可实现排除多个文件<br>--bwlimit=速率           设置速率<br>--delete                无差异同步<br></code></pre></td></tr></table></figure><br><p>指定相应的参数，可以实现只同步一个文件里有变化的内容部分。</p><p><strong>根据特定文件属性状态差异进行对比差异增量同步</strong> </p><br><br><br><br><h2 id="工作方式"><a href="#工作方式" class="headerlink" title="工作方式"></a>工作方式</h2><br><p><strong>本地数据同步（类似与cp）</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sql">格式:  rsync [OPTION...] SRC... [DEST]<br><br>rsync            <span class="hljs-comment">-- 数据同步命令</span><br><br>[OPTION...]      <span class="hljs-comment">-- 命令参数信息</span><br><br>SRC              <span class="hljs-comment">-- 要同步的数据信息（文件或目录）</span><br><br>[DEST]           <span class="hljs-comment">-- 将数据传输到什么位置（目标）</span><br></code></pre></td></tr></table></figure><br><p><strong>实际操作演示</strong> </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><br>[root@backup ~]# rsync /etc/hosts /tmp/&lt;br&gt;<br><br>[root@backup ~]# ls /tmp/hosts &lt;br&gt;<br><br>/tmp/hosts<br></code></pre></td></tr></table></figure><br><p><strong>远程数据同步方式（类似scp）</strong><br><br></p><p><strong>此类型又叫做隧道传输</strong></p><p>又分为拉和推两种方式</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs sql">Pull: rsync [OPTION...] [<span class="hljs-keyword">USER</span>@]HOST:SRC... [DEST]<br><br>Pull（拉）:<br>[<span class="hljs-keyword">USER</span>@]      <span class="hljs-comment">-- 表示以什么用户身份传输数据信息</span><br>HOST:        <span class="hljs-comment">-- 远程主机信息（IP地址信息 主机名称信息）</span><br>SRC...       <span class="hljs-comment">-- 表示远端要拉过来的数据信息</span><br>[DEST]       <span class="hljs-comment">-- 拉到本地什么位置</span><br>Push: rsync [OPTION...] SRC... [<span class="hljs-keyword">USER</span>@]HOST:DEST<br><br>Push（推）:<br>SRC...          <span class="hljs-comment">-- 本地要推过去的数据信息</span><br>[DEST]        <span class="hljs-comment">-- 推到什么位置</span><br>[<span class="hljs-keyword">USER</span>@]             <span class="hljs-comment">-- 表示以什么用户身份传输数据信息</span><br>HOST:        <span class="hljs-comment">-- 远程主机信息（IP地址信息 主机名称信息）</span><br></code></pre></td></tr></table></figure><br><p><strong>实际操作演示</strong> </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs shell"><br>rsync  /tmp/ root@10.0.0.1:/test 推<br><br>把本地的 /tmp/ 目录中的文件复制到10.0.0.1 的 /test 目录下<br><br><br>rsync  root@10.0.0.2:/tmp/ /test  拉<br><br>把10.0.0.2 的 /tmp/ 目录文件复制到本地的 /test目录中<br><br></code></pre></td></tr></table></figure><br><h2 id="守护进程部署——服务端"><a href="#守护进程部署——服务端" class="headerlink" title="守护进程部署——服务端"></a>守护进程部署——服务端</h2><br><ol><li>确认软件安装 &nbsp;<code>rpm -qa rsyan</code> 或 <code>rpm -qa | grep rsyn*</code></li><li>配置文件编写 &nbsp;<code>vim /etc/rsyncd.conf</code></li><li>创建用户     &nbsp;<code>useradd -s /sbin/nologin -M rsync</code> </li><li>创建备份目录 &nbsp;<code>mkdir /backup -p &amp;&amp; chown -R rsync.rsync /backup/</code></li><li>创建认证文件 &nbsp;<code>echo &quot;rsync_backup:123456&quot; &gt;/etc/rsync.password &amp;&amp; chmod 600 /etc/rsync.password</code></li><li>启动rsync服务&nbsp;命令：&nbsp;<code>rsync --daemon</code> 查看进程&nbsp;&nbsp;<code>ps -ef | grep rsync</code></li></ol><br><br><h2 id="守护进程配置文件信息说明"><a href="#守护进程配置文件信息说明" class="headerlink" title="守护进程配置文件信息说明"></a>守护进程配置文件信息说明</h2><br><p><img src="https://xin997.oss-cn-beijing.aliyuncs.com/xinblogs/webimg-Linuxlinux-04-1.png" alt="linux-04-1"></p><h2 id="守护进程部署——客户端"><a href="#守护进程部署——客户端" class="headerlink" title="守护进程部署——客户端"></a>守护进程部署——客户端</h2><br><p>1.确认软件安装   &nbsp;<code>rpm -qa rsyan</code> &nbsp;或&nbsp; <code>rpm -qa | grep rsyn*</code> <br><br>2.创建认证密码文件  &nbsp;<code>echo &quot;123456&quot; &gt;&gt;/etc/rsync.password</code> &nbsp;&amp;&amp;&nbsp; <code>chmod 600 /etc/rsync.password</code>&nbsp;<br><br>3.进行数据备份测试<br><br><br></p><p><strong>客户端采取守护进程推送的方式来传输数据：</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">rsync -avz /etc/hosts rsync_backup@10.0.0.2::backup --password-file=/etc/rsync.password<br></code></pre></td></tr></table></figure><br><br><h2 id="备份服务常见错误总结"><a href="#备份服务常见错误总结" class="headerlink" title="备份服务常见错误总结"></a>备份服务常见错误总结</h2><br><br><p><strong>1.开启了 iptables防火墙 ：</strong><code>No route to host （113）</code></p><p><strong>2.执行命令错误：</strong> <code>The remote path must start with a module</code> 模块名称错误</p><p><strong>3.认证用户失败：</strong> <code>auth failed no module user</code></p><p>①密码或用户名错误<br>②密码文件名不一致<br>③rsync_backup:123456&nbsp;不要有空格<br>④认证文件权限不是600<br>⑤客户端认证文件不用输入用户名</p><br><p><strong>4.权限阻止问题： <code>Permisson denied </code></strong><br><br></p><p>①属主、属组不是rsync<br>②备份目录权限不是755</p><br><p><strong>5.rsync服务位置模块错误</strong></p><p>【客户端的错误】</p><p><code>Unknown module &#39;backup&#39; </code> </p><p>【错误演示过程】</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@nfs01 tmp]# rsync -avz /etc/hosts rsync_backup@172.16.1.41::backup<br>@ERROR: Unknown module &#x27;backup&#x27;<br>rsync error: error starting client-server protocol (code 5) at main.c(1503) [sender=3.0.6] <br></code></pre></td></tr></table></figure><p>【异常问题解决】</p><p><code> /etc/rsyncd.conf</code>&nbsp;配置文件模块名称书写错误 </p><br><br><p><strong>6.rsync服务备份目录异常</strong></p><p>【客户端的错误】</p><p><code> chdir failed</code>    </p><p>【错误演示过程】 </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@nfs01 tmp]# rsync -avz /etc/hosts rsync_backup@172.16.1.41::backup<br>Password: <br>@ERROR: chdir failed<br>rsync error: error starting client-server protocol (code 5) at main.c(1503) [sender=3.0.6]<br></code></pre></td></tr></table></figure><p>【异常问题解决】</p><p>①备份存储目录没有建立<br>②建立的备份存储目录和配置文件定义不一致</p><br><br><p><strong>7.客户端执行慢</strong></p><p>连接慢问题&nbsp;&nbsp; IP   ===  域名    反向DNS解析</p><p>【错误日志信息】 </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">2017</span><span class="hljs-operator">/</span><span class="hljs-number">03</span><span class="hljs-operator">/</span><span class="hljs-number">08</span> <span class="hljs-number">20</span>:<span class="hljs-number">14</span>:<span class="hljs-number">43</span> [<span class="hljs-number">3422</span>] name lookup failed <span class="hljs-keyword">for</span> <span class="hljs-number">172.16</span><span class="hljs-number">.1</span><span class="hljs-number">.31</span>: Name <span class="hljs-keyword">or</span> service <span class="hljs-keyword">not</span> known<br><span class="hljs-number">2017</span><span class="hljs-operator">/</span><span class="hljs-number">03</span><span class="hljs-operator">/</span><span class="hljs-number">08</span> <span class="hljs-number">20</span>:<span class="hljs-number">14</span>:<span class="hljs-number">43</span> [<span class="hljs-number">3422</span>] <span class="hljs-keyword">connect</span> <span class="hljs-keyword">from</span> <span class="hljs-literal">UNKNOWN</span> (<span class="hljs-number">172.16</span><span class="hljs-number">.1</span><span class="hljs-number">.31</span>)<br></code></pre></td></tr></table></figure><p>【异常问题解决】</p><p>在服务端 hosts文件中加入host主机地址与域名解析</p><br><h2 id="备份扩展功能实践"><a href="#备份扩展功能实践" class="headerlink" title="备份扩展功能实践"></a>备份扩展功能实践</h2><br><br><p><strong>① 守护进程多模块功能配置</strong></p><p>第一步：修改配置文件</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell">vim /etc/rsyncd.conf<br>[backup01]<br>comment = &quot;backup dir by ryanxin&quot;<br>path = /backup<br>[backup02]<br>comment = &quot;backup dir by ryanxin&quot;<br>path = /backup02<br></code></pre></td></tr></table></figure><p>第二步：创建多模块目录</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">mkdir /backup02<br>chown -R rsync.rsync /backup02<br></code></pre></td></tr></table></figure><p>第三步：重启服务程序</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">killall rsync<br>rsync --daemon<br></code></pre></td></tr></table></figure><br><p>第四步：进行测试检查</p><br><p><strong>② 守护进程的排除功能</strong></p><br><p><strong>数据备份排除方式：<code>--exclude</code></strong></p><br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">rsync -avz /text_dir/ --exclude=b --exclude=d rsync_backup@10.0.0.1::back01 <br>--password-file=/etc/rsync.password<br></code></pre></td></tr></table></figure><br><p>也可以写成  <code>--exclude =&#123;b,d&#125;</code> 或者连续表示  <code>--exclude = &#123;b..d&#125;</code></p><br><p><strong>多个文件大量信息排除</strong></p><br><p>在要排除大量文件的时候你不可能一个一个排除就需要使用 <code>--exclude-from=file</code> </p><p>指定一个文件在文件然后在文件里面写入你要排除的文件</p><br><p><strong>注意：要写相对路径！</strong></p><br><p><strong>例如：我想排除 a 和 b 文件</strong></p><p><code>a</code>   每一行写一个文件的名字<br></p><p><code>b</code>   一个文件名字</p><p>文件名字为：<code>exclude_file.txt</code></p><p><strong>命令如下：</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">rsync -avz /test_dir/ --exclude-from=./exclude_file.txt rsync_backup@172.16.1.41::backup01 --password-file=/etc/rsync.password<br></code></pre></td></tr></table></figure><br><p><strong>③守护进程创建备份目录</strong></p><br><p>在配置文件模块后面加入/dba 目录 就可实现不同的目录机构</p><p><code>backup01/dba</code></p><br><p><strong>命令如下：</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sh">rsync -avz /etc/hosts --exclude-from=./exclude_file.txt rsync_backup@172.16.1.41::backup01/sa/ --password-file=/etc/rsync.password<br><br>rsync -avz /etc/hosts --exclude-from=./exclude_file.txt rsync_backup@172.16.1.41::backup01/dev/ --password-file=/etc/rsync.password<br><br>rsync -avz /etc/hosts --exclude-from=./exclude_file.txt rsync_backup@172.16.1.41::backup01/dba/ --password-file=/etc/rsync.password<br></code></pre></td></tr></table></figure><br><p><strong>④ 守护进程的访问控制配置</strong></p><br><p><strong>三种情况：</strong></p><ol><li><p>只有白名单，白名单网段或主机信息允许。其余阻止</p></li><li><p>只有黑名单，黑名单网段或主机信息阻止，其余允许</p></li><li><p>有黑名单也要白名单，白名单网段或主机信息允许，黑名单网段或主机信息阻止，其余允许</p><br></li></ol><p><strong>建议只选择前两种方式配置</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">hosts allow = 172.16.1.0/24<br><br>hosts deny = 0.0.0./32<br></code></pre></td></tr></table></figure><br><br><p> <strong>⑤ 守护进程无差异同步配置</strong></p><br><p> <strong>我有的，你也有；我没有的，你也不能有</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">rsync -avz /test_dir/ --delete rsync_backup@172.16.1.41::backup01 <br>--password-file=/etc/rsync.password<br></code></pre></td></tr></table></figure><br><p> <strong>说明：一定要谨慎使用，否则可能会清空备份目录；<br>  如果要快速清空目录数据，也可以使用无差异同步清空</strong></p><br><p><strong>⑥ 守护进程的列表功能配置</strong></p><p><code>list = false</code></p><p><strong>说明：表示是否列表显示rsync服务端所有模块信息</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@nfs01 test_dir]# rsync rsync_backup@172.16.1.41::<br>backup01       &quot;backup dir by oldboy&quot;<br>backup02       &quot;backup dir by oldboy&quot;<br>会降低服务端安全性不建议开启<br></code></pre></td></tr></table></figure><br><p><strong>文章来源：</strong></p><p><a href="https://www.luffycity.com/">路飞学城</a></p><p><a href="https://www.cnblogs.com/dadonggg/p/8608612.html">西门大官人</a></p><p>::: warning 申明<br>本页资源来源于互联网及公开渠道，仅供学习参考，版权归原创者所有! 如侵犯到您的权益，请及时通知我们！我们将在第一时间内删除。<br>:::</p> <br>]]></content>
    
    
    <categories>
      
      <category>linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux 服务</tag>
      
      <tag>课程实战</tag>
      
      <tag>Rsync</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>伺服器集群架構之一</title>
    <link href="/2019/11/19/%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%9B%86%E7%BE%A4%E6%9E%B6%E6%9E%84%E4%B9%8B%E4%B8%80/"/>
    <url>/2019/11/19/%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%9B%86%E7%BE%A4%E6%9E%B6%E6%9E%84%E4%B9%8B%E4%B8%80/</url>
    
    <content type="html"><![CDATA[<h1 id="集群架构服务器组成"><a href="#集群架构服务器组成" class="headerlink" title="集群架构服务器组成"></a>集群架构服务器组成</h1><br><h5 id="基本架构组成：（用于让用户进行访问）"><a href="#基本架构组成：（用于让用户进行访问）" class="headerlink" title="基本架构组成：（用于让用户进行访问）"></a>基本架构组成：（用于让用户进行访问）</h5><br>通过给集群中物理设备起別名更容易理解和学习。<br><br><br><p><font color=#85C1E9 size=5>前端服务部分</font></p><br> 1）<font color=#8E44AD size=4>顾客</font>-<font color=#28B463 size=4>用户</font><br><br>是一个访问者，请求访问网站页面<br><br><p>2）<font color=#8E44AD size=4>保安</font>-<font color=#28B463 size=4>防火墙设备</font><br></p><p>对访问架构用户进行策略控制，正常访问网站用户，可以放行进入；非法人员（黑客）访问网站，禁止进入。<br></p><p>3）<font color=#8E44AD size=4>对讲机</font>-<font color=#28B463 size=4>交换机（外网）</font><br></p><p> 提供架构中服务器相互通讯交流的需求（提供外部人员访问）<br></p><p>4）<font color=#8E44AD size=4>迎宾人员</font>-<font color=#28B463 size=4>负载均衡服务器</font><br><br>       对用户的访问请求进行调度处理<br></p><p>5）<font color=#8E44AD size=4>服务员</font>-<font color=#28B463 size=4>网站web服务器</font><br><br>       对用户的请求进行响应处理<br></p><br><p><strong>后端服务部分：</strong><br><br></p><p>1）对讲机-交互机（内网）<br>       提供架构中服务器相互通讯交流的需求（提供内部局域网服务器通讯交流）<br><br><br>2）厨师-数据库服务器<br>       主要用于存储用户提交文字（字符串）数据信息<br><br><br>3）厨师-存储服务器<br>       主要用于存储用户上传视频 音频 图片 附件等数据资料<br><br><br>4）厨师-备份服务器<br>       主要用于对用户存储（上传）数据信息进行统一备份管理<br><br><br>5）厨师-缓存服务器<br>       主要用于存储用户经常访问的数据信息，提升请求数据信息的响应效率</p><br><br><br><p><strong>扩展构架组成：</strong>（用于让运维人员远程管理架构中的服务器）</p><p>1）员工-运维人员<br>       可以远程管理架构中服务器</p><p>2）审计-跳板机服务器<br>       用于监管内部运维人员操作记录信息，一旦出现架构问题，可以快速定位问题原因，进行相应人员失误问责</p><p>3）经理-批量管理服务器<br>       通过批量管理服务器可以批量管理架构中多台服务器，提升工作效率</p><p>4）监控-监控服务器<br>       用于监控管理架构中的服务器运行情况，一旦出现问题进行发送告警给相关运维管理人员</p>]]></content>
    
    
    <categories>
      
      <category>linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux学习之旅</tag>
      
      <tag>集群架構</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>基于 Linux 系统的服务课程笔记</title>
    <link href="/2019/11/11/%E5%9F%BA%E4%BA%8ELinux%20%E7%B3%BB%E7%BB%9F%E7%9A%84%E6%9C%8D%E5%8A%A1%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/"/>
    <url>/2019/11/11/%E5%9F%BA%E4%BA%8ELinux%20%E7%B3%BB%E7%BB%9F%E7%9A%84%E6%9C%8D%E5%8A%A1%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<h1 id="基于-Linux-系统的服务课程笔记"><a href="#基于-Linux-系统的服务课程笔记" class="headerlink" title="基于 Linux 系统的服务课程笔记"></a>基于 Linux 系统的服务课程笔记</h1><br><br><p>​           互联网运维是一个融合多学科（网络、系统、开发、安全、应用架构、存储等）的综合性技术岗位，给运维工程师提供了一个很好的个人能力与技术的发展空间。运维工作的相关经验将会变得非常重要，而且也将成为个人的核心竞争力，优秀的运维工程师具备很好的各层面问题的解决能力及方案提供、全局思考的能力等。由于运维岗位所接触的知识面非常广阔，更容易培养或发挥出个人某些方面的特长或爱好，如内核、网络、开发、数据库等方面，可以做得非常深入精通、成为这方面的专家。</p><br><br><br><h2 id="Linux-运维工程师技术图谱"><a href="#Linux-运维工程师技术图谱" class="headerlink" title="Linux 运维工程师技术图谱"></a>Linux 运维工程师技术图谱</h2><table><thead><tr><th align="center">运维架构技术类型</th><th align="center"><img width=213/>主要技术关键词  <img width=213/></th></tr></thead><tbody><tr><td align="center">脚本编程</td><td align="center"><strong>AWK、Sed、Grep、Shell、Python</strong></td></tr><tr><td align="center">Web服务</td><td align="center">Apache、<strong>Nginx</strong>、<strong>Tomcat</strong>、JBoss、Resin</td></tr><tr><td align="center">数据传输</td><td align="center">Rsync、Scp、Inodify/Sersync</td></tr><tr><td align="center">性能分析</td><td align="center">top、free、df、iftop、iostat、vmstat、dstat、sar、sysdig</td></tr><tr><td align="center">进程管理</td><td align="center">Supervisor</td></tr><tr><td align="center">网络服务</td><td align="center">vsftp、nfs、samba、bind、dhcp、postfifix</td></tr><tr><td align="center">数据库</td><td align="center"><strong>MySQL</strong>、MariaDB、PostgreSQL，Oracle</td></tr><tr><td align="center">NoSQL</td><td align="center">Redis、MongoDB</td></tr><tr><td align="center">消息中间件</td><td align="center">RabbitMQ、ActiveMQ</td></tr><tr><td align="center">版本管理</td><td align="center">SVN、<strong>Git</strong></td></tr><tr><td align="center">静态缓存</td><td align="center">Squid、Varnish、<strong>Nginx</strong></td></tr><tr><td align="center">负载均衡</td><td align="center"><strong>LVS</strong>、HAProxy、<strong>Nginx</strong></td></tr><tr><td align="center">高可用软件</td><td align="center"><strong>Keepalived</strong>、Heartbeat、DRBD、corosync+pacemaker</td></tr><tr><td align="center">集中管理工具</td><td align="center"><strong>Ansible</strong>、Saltstack、Chef、Puppet</td></tr><tr><td align="center">虚拟化</td><td align="center">KVM、Xen、Openstack、Cloudstack</td></tr><tr><td align="center">容器化</td><td align="center"><strong>Docker</strong>、<strong>Kubernetes</strong>、Rancher、Openshift</td></tr><tr><td align="center">自动装机</td><td align="center">Kickstart、Cobbler</td></tr><tr><td align="center">抓包分析</td><td align="center">Tcpdump、Wireshark</td></tr><tr><td align="center">持续集成</td><td align="center"><strong>Jenkins</strong>、Gitlab</td></tr><tr><td align="center">MySQL代理</td><td align="center">Altas、Cobar、Mycat</td></tr><tr><td align="center">压力测试</td><td align="center">ab、fifio、sysbench、mysqlslap、Jemter</td></tr><tr><td align="center">日志收集</td><td align="center"><strong>ELK Stack</strong>、Graylog</td></tr><tr><td align="center">监控系统</td><td align="center">Zabbix、<strong>Prometheus</strong>、Open-falcon</td></tr><tr><td align="center">分布式文件系统</td><td align="center"><strong>Ceph</strong>、GlusterFS、FastDFS</td></tr></tbody></table><br><br><p>:::tip 课程知识指南</p><ul><li><p><strong>Linux</strong> 初始基础阶段需要熟悉 Linux 操作系统安装，目录结构、文件权限、网卡文件等配置、系统启动流程等。</p></li><li><p><strong>系统管理</strong>  主要学习Linux系统，掌握常用的几十个基本管理命令，包括用户管理、磁盘分区、软件包管理、文件权限、文本处理、进程管理、性能分析工具等。</p></li><li><p><strong>网络基础</strong> OSI和TCP/IP模型一定要熟悉。基本的交换机、路由器概念及实现原理要知道。</p></li><li><p><strong>Shell脚本编程基础</strong> 掌握Shell基本语法结构，能编写简单的脚本即可。</p></li><li><p><strong>网络服务</strong>  常见的网络服务要会部署，比如vsftp、nfs、samba、bind、dhcp等。 代码版本管理系统少不了，可以学习下主流的GIT，能部署和简单使用就可以了。 经常在服务器之间传输数据，所以要会使用：rsync和scp。 数据同步：inotify/sersync。 重复性完成一些工作，可写成脚本定时去运行，所以得会配置Linux下的定时任务服务crond。 </p></li><li><p><strong>Web服务</strong> 每个公司基本都会有网站，能让网站跑起来，就需要搭建Web服务平台了。 如果是用PHP语言开发的，通常搭建LNMP网站平台，这是一个技术名词组合的拼写，分开讲就是得会部署Nginx、MySQL和PHP。 如果是JAVA语言开发的，通常使用Tomcat运行项目，为了提高访问速度，可以使用Nginx反向代理Tomcat，Nginx处理静态页面，Tomcat处理动态页面，实现动静分离。 不是会部署这么简单，还要知道HTTP协议工作原理、简单的性能调优。</p></li><li><p><strong>负载均衡器</strong> 单台服务器终究资源有限，抵抗高访问量肯定是无法支撑的，解决此问题最关键的技术就是采用负载均衡器，水平扩展多台Web服务器，同时对外提供服务，这样就成倍扩展性能了。负载均衡器主流开源技术有LVS、HAProxy和Nginx。一定要熟悉一两个！</p></li><li><p><strong>数据库</strong> 数据库选择MySQL，它是世界上使用最为广泛的开源数据库。学它准没错！ 也要会一些简单的SQL语句、用户管理、常用存储引擎、数据库备份与恢复。 想要深入点，必须会主从复制、性能优化、主流集群方案：MHA、MGR等。 NoSQL这么流行当然也少不了，学下Redis、MongoDB这两个就好了。</p></li><li><p><strong>监控系统</strong> 监控必不可少，是及时发现问题和追溯问题的救命稻草。可以选择学习主流的Zabbix、Prometheus开源监控系统，功能丰富，能满足企业级监控需求。监控点包括服务器硬件、服务器性能、API、业务、PV/UV、日志等方面。 也可以弄个仪表盘展示几个实时关键的数据，比如Grafana，会非常炫酷。</p></li><li><p><strong>日志分析系统</strong> 日志也很重要，定期的分析，可发现潜在隐患，提炼出有价值的东西。 主流日志系统：ELK Stack 学会部署使用，能分析日志并可视化，方便故障排查。</p></li><li><p><strong>安全防范</strong> 安全很重要，不要等到系统被攻击了，再做安全策略，此时已晚！所以，当一台服务器上线后应马上做安全访问控制策略，比如使用iptables限制只允许信任源IP访问，关闭一些无用的服务和端口等。 一些常见的攻击类型一定得知道啊，否则怎么对症下药呢！比如CC、DDOS、ARP等。</p></li><li><p><strong>Shell脚本编程进阶</strong> Shell脚本是Linux自动完成工作的利器，必须得熟练编写，所以得进一步学习函数、数组、信号、发邮件等。 文本处理三剑客（grep、sed、awk）得玩6啊，Linux下文本处理就指望它们了。</p></li><li><p><strong>Python/Go 开发基础</strong> Shell脚本只能完成一些基本的任务，想要完成更复杂些的任务，比如调用API、多进程等。就需要学高级语言了。Python是运维领域使用最多的语言，简单易用，学它准没错！此阶段掌握基础就可以了，例如基本语法结构、文件对象操作、函数、迭代对象、异常处理、发邮件、数据库编程等。</p><p>:::</p></li></ul><p>::: warning  版权声明</p><p>本站文章来源于互联网与个人学习笔记总结，仅用于技术分享交流使用。未经允许不得转载！</p><p>:::</p>]]></content>
    
    
    <categories>
      
      <category>linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux学习之旅</tag>
      
      <tag>集群架構</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
